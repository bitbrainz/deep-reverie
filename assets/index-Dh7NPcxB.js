function IO(r,t){for(var e=0;e<t.length;e++){const n=t[e];if(typeof n!="string"&&!Array.isArray(n)){for(const a in n)if(a!=="default"&&!(a in r)){const i=Object.getOwnPropertyDescriptor(n,a);i&&Object.defineProperty(r,a,i.get?i:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function e(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=e(a);fetch(a.href,i)}})();function SE(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function my(r){if(r.__esModule)return r;var t=r.default;if(typeof t=="function"){var e=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};e.prototype=t.prototype}else e={};return Object.defineProperty(e,"__esModule",{value:!0}),Object.keys(r).forEach(function(n){var a=Object.getOwnPropertyDescriptor(r,n);Object.defineProperty(e,n,a.get?a:{enumerable:!0,get:function(){return r[n]}})}),e}var Sg={exports:{}},Bl={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var y2;function kO(){if(y2)return Bl;y2=1;var r=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function e(n,a,i){var s=null;if(i!==void 0&&(s=""+i),a.key!==void 0&&(s=""+a.key),"key"in a){i={};for(var l in a)l!=="key"&&(i[l]=a[l])}else i=a;return a=i.ref,{$$typeof:r,type:n,key:s,ref:a!==void 0?a:null,props:i}}return Bl.Fragment=t,Bl.jsx=e,Bl.jsxs=e,Bl}var b2;function DO(){return b2||(b2=1,Sg.exports=kO()),Sg.exports}var ve=DO(),Eg={exports:{}},Ze={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var w2;function OO(){if(w2)return Ze;w2=1;var r=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),e=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),s=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),p=Symbol.iterator;function g(L){return L===null||typeof L!="object"?null:(L=p&&L[p]||L["@@iterator"],typeof L=="function"?L:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b=Object.assign,w={};function S(L,Z,ce){this.props=L,this.context=Z,this.refs=w,this.updater=ce||v}S.prototype.isReactComponent={},S.prototype.setState=function(L,Z){if(typeof L!="object"&&typeof L!="function"&&L!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,L,Z,"setState")},S.prototype.forceUpdate=function(L){this.updater.enqueueForceUpdate(this,L,"forceUpdate")};function x(){}x.prototype=S.prototype;function C(L,Z,ce){this.props=L,this.context=Z,this.refs=w,this.updater=ce||v}var A=C.prototype=new x;A.constructor=C,b(A,S.prototype),A.isPureReactComponent=!0;var T=Array.isArray,R={H:null,A:null,T:null,S:null},O=Object.prototype.hasOwnProperty;function N(L,Z,ce,le,de,xe){return ce=xe.ref,{$$typeof:r,type:L,key:Z,ref:ce!==void 0?ce:null,props:xe}}function D(L,Z){return N(L.type,Z,void 0,void 0,void 0,L.props)}function I(L){return typeof L=="object"&&L!==null&&L.$$typeof===r}function _(L){var Z={"=":"=0",":":"=2"};return"$"+L.replace(/[=:]/g,function(ce){return Z[ce]})}var F=/\/+/g;function B(L,Z){return typeof L=="object"&&L!==null&&L.key!=null?_(""+L.key):Z.toString(36)}function V(){}function X(L){switch(L.status){case"fulfilled":return L.value;case"rejected":throw L.reason;default:switch(typeof L.status=="string"?L.then(V,V):(L.status="pending",L.then(function(Z){L.status==="pending"&&(L.status="fulfilled",L.value=Z)},function(Z){L.status==="pending"&&(L.status="rejected",L.reason=Z)})),L.status){case"fulfilled":return L.value;case"rejected":throw L.reason}}throw L}function Y(L,Z,ce,le,de){var xe=typeof L;(xe==="undefined"||xe==="boolean")&&(L=null);var we=!1;if(L===null)we=!0;else switch(xe){case"bigint":case"string":case"number":we=!0;break;case"object":switch(L.$$typeof){case r:case t:we=!0;break;case d:return we=L._init,Y(we(L._payload),Z,ce,le,de)}}if(we)return de=de(L),we=le===""?"."+B(L,0):le,T(de)?(ce="",we!=null&&(ce=we.replace(F,"$&/")+"/"),Y(de,Z,ce,"",function(ke){return ke})):de!=null&&(I(de)&&(de=D(de,ce+(de.key==null||L&&L.key===de.key?"":(""+de.key).replace(F,"$&/")+"/")+we)),Z.push(de)),1;we=0;var _e=le===""?".":le+":";if(T(L))for(var Ee=0;Ee<L.length;Ee++)le=L[Ee],xe=_e+B(le,Ee),we+=Y(le,Z,ce,xe,de);else if(Ee=g(L),typeof Ee=="function")for(L=Ee.call(L),Ee=0;!(le=L.next()).done;)le=le.value,xe=_e+B(le,Ee++),we+=Y(le,Z,ce,xe,de);else if(xe==="object"){if(typeof L.then=="function")return Y(X(L),Z,ce,le,de);throw Z=String(L),Error("Objects are not valid as a React child (found: "+(Z==="[object Object]"?"object with keys {"+Object.keys(L).join(", ")+"}":Z)+"). If you meant to render a collection of children, use an array instead.")}return we}function j(L,Z,ce){if(L==null)return L;var le=[],de=0;return Y(L,le,"","",function(xe){return Z.call(ce,xe,de++)}),le}function G(L){if(L._status===-1){var Z=L._result;Z=Z(),Z.then(function(ce){(L._status===0||L._status===-1)&&(L._status=1,L._result=ce)},function(ce){(L._status===0||L._status===-1)&&(L._status=2,L._result=ce)}),L._status===-1&&(L._status=0,L._result=Z)}if(L._status===1)return L._result.default;throw L._result}var q=typeof reportError=="function"?reportError:function(L){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Z=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof L=="object"&&L!==null&&typeof L.message=="string"?String(L.message):String(L),error:L});if(!window.dispatchEvent(Z))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",L);return}console.error(L)};function ne(){}return Ze.Children={map:j,forEach:function(L,Z,ce){j(L,function(){Z.apply(this,arguments)},ce)},count:function(L){var Z=0;return j(L,function(){Z++}),Z},toArray:function(L){return j(L,function(Z){return Z})||[]},only:function(L){if(!I(L))throw Error("React.Children.only expected to receive a single React element child.");return L}},Ze.Component=S,Ze.Fragment=e,Ze.Profiler=a,Ze.PureComponent=C,Ze.StrictMode=n,Ze.Suspense=c,Ze.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=R,Ze.act=function(){throw Error("act(...) is not supported in production builds of React.")},Ze.cache=function(L){return function(){return L.apply(null,arguments)}},Ze.cloneElement=function(L,Z,ce){if(L==null)throw Error("The argument must be a React element, but you passed "+L+".");var le=b({},L.props),de=L.key,xe=void 0;if(Z!=null)for(we in Z.ref!==void 0&&(xe=void 0),Z.key!==void 0&&(de=""+Z.key),Z)!O.call(Z,we)||we==="key"||we==="__self"||we==="__source"||we==="ref"&&Z.ref===void 0||(le[we]=Z[we]);var we=arguments.length-2;if(we===1)le.children=ce;else if(1<we){for(var _e=Array(we),Ee=0;Ee<we;Ee++)_e[Ee]=arguments[Ee+2];le.children=_e}return N(L.type,de,void 0,void 0,xe,le)},Ze.createContext=function(L){return L={$$typeof:s,_currentValue:L,_currentValue2:L,_threadCount:0,Provider:null,Consumer:null},L.Provider=L,L.Consumer={$$typeof:i,_context:L},L},Ze.createElement=function(L,Z,ce){var le,de={},xe=null;if(Z!=null)for(le in Z.key!==void 0&&(xe=""+Z.key),Z)O.call(Z,le)&&le!=="key"&&le!=="__self"&&le!=="__source"&&(de[le]=Z[le]);var we=arguments.length-2;if(we===1)de.children=ce;else if(1<we){for(var _e=Array(we),Ee=0;Ee<we;Ee++)_e[Ee]=arguments[Ee+2];de.children=_e}if(L&&L.defaultProps)for(le in we=L.defaultProps,we)de[le]===void 0&&(de[le]=we[le]);return N(L,xe,void 0,void 0,null,de)},Ze.createRef=function(){return{current:null}},Ze.forwardRef=function(L){return{$$typeof:l,render:L}},Ze.isValidElement=I,Ze.lazy=function(L){return{$$typeof:d,_payload:{_status:-1,_result:L},_init:G}},Ze.memo=function(L,Z){return{$$typeof:f,type:L,compare:Z===void 0?null:Z}},Ze.startTransition=function(L){var Z=R.T,ce={};R.T=ce;try{var le=L(),de=R.S;de!==null&&de(ce,le),typeof le=="object"&&le!==null&&typeof le.then=="function"&&le.then(ne,q)}catch(xe){q(xe)}finally{R.T=Z}},Ze.unstable_useCacheRefresh=function(){return R.H.useCacheRefresh()},Ze.use=function(L){return R.H.use(L)},Ze.useActionState=function(L,Z,ce){return R.H.useActionState(L,Z,ce)},Ze.useCallback=function(L,Z){return R.H.useCallback(L,Z)},Ze.useContext=function(L){return R.H.useContext(L)},Ze.useDebugValue=function(){},Ze.useDeferredValue=function(L,Z){return R.H.useDeferredValue(L,Z)},Ze.useEffect=function(L,Z){return R.H.useEffect(L,Z)},Ze.useId=function(){return R.H.useId()},Ze.useImperativeHandle=function(L,Z,ce){return R.H.useImperativeHandle(L,Z,ce)},Ze.useInsertionEffect=function(L,Z){return R.H.useInsertionEffect(L,Z)},Ze.useLayoutEffect=function(L,Z){return R.H.useLayoutEffect(L,Z)},Ze.useMemo=function(L,Z){return R.H.useMemo(L,Z)},Ze.useOptimistic=function(L,Z){return R.H.useOptimistic(L,Z)},Ze.useReducer=function(L,Z,ce){return R.H.useReducer(L,Z,ce)},Ze.useRef=function(L){return R.H.useRef(L)},Ze.useState=function(L){return R.H.useState(L)},Ze.useSyncExternalStore=function(L,Z,ce){return R.H.useSyncExternalStore(L,Z,ce)},Ze.useTransition=function(){return R.H.useTransition()},Ze.version="19.0.0",Ze}var x2;function gy(){return x2||(x2=1,Eg.exports=OO()),Eg.exports}var W=gy();const Te=SE(W),_O=IO({__proto__:null,default:Te},[W]);var Cg={exports:{}},Ul={},Ag={exports:{}},Tg={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var S2;function MO(){return S2||(S2=1,function(r){function t(j,G){var q=j.length;j.push(G);e:for(;0<q;){var ne=q-1>>>1,L=j[ne];if(0<a(L,G))j[ne]=G,j[q]=L,q=ne;else break e}}function e(j){return j.length===0?null:j[0]}function n(j){if(j.length===0)return null;var G=j[0],q=j.pop();if(q!==G){j[0]=q;e:for(var ne=0,L=j.length,Z=L>>>1;ne<Z;){var ce=2*(ne+1)-1,le=j[ce],de=ce+1,xe=j[de];if(0>a(le,q))de<L&&0>a(xe,le)?(j[ne]=xe,j[de]=q,ne=de):(j[ne]=le,j[ce]=q,ne=ce);else if(de<L&&0>a(xe,q))j[ne]=xe,j[de]=q,ne=de;else break e}}return G}function a(j,G){var q=j.sortIndex-G.sortIndex;return q!==0?q:j.id-G.id}if(r.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var i=performance;r.unstable_now=function(){return i.now()}}else{var s=Date,l=s.now();r.unstable_now=function(){return s.now()-l}}var c=[],f=[],d=1,p=null,g=3,v=!1,b=!1,w=!1,S=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;function A(j){for(var G=e(f);G!==null;){if(G.callback===null)n(f);else if(G.startTime<=j)n(f),G.sortIndex=G.expirationTime,t(c,G);else break;G=e(f)}}function T(j){if(w=!1,A(j),!b)if(e(c)!==null)b=!0,X();else{var G=e(f);G!==null&&Y(T,G.startTime-j)}}var R=!1,O=-1,N=5,D=-1;function I(){return!(r.unstable_now()-D<N)}function _(){if(R){var j=r.unstable_now();D=j;var G=!0;try{e:{b=!1,w&&(w=!1,x(O),O=-1),v=!0;var q=g;try{t:{for(A(j),p=e(c);p!==null&&!(p.expirationTime>j&&I());){var ne=p.callback;if(typeof ne=="function"){p.callback=null,g=p.priorityLevel;var L=ne(p.expirationTime<=j);if(j=r.unstable_now(),typeof L=="function"){p.callback=L,A(j),G=!0;break t}p===e(c)&&n(c),A(j)}else n(c);p=e(c)}if(p!==null)G=!0;else{var Z=e(f);Z!==null&&Y(T,Z.startTime-j),G=!1}}break e}finally{p=null,g=q,v=!1}G=void 0}}finally{G?F():R=!1}}}var F;if(typeof C=="function")F=function(){C(_)};else if(typeof MessageChannel<"u"){var B=new MessageChannel,V=B.port2;B.port1.onmessage=_,F=function(){V.postMessage(null)}}else F=function(){S(_,0)};function X(){R||(R=!0,F())}function Y(j,G){O=S(function(){j(r.unstable_now())},G)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(j){j.callback=null},r.unstable_continueExecution=function(){b||v||(b=!0,X())},r.unstable_forceFrameRate=function(j){0>j||125<j?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<j?Math.floor(1e3/j):5},r.unstable_getCurrentPriorityLevel=function(){return g},r.unstable_getFirstCallbackNode=function(){return e(c)},r.unstable_next=function(j){switch(g){case 1:case 2:case 3:var G=3;break;default:G=g}var q=g;g=G;try{return j()}finally{g=q}},r.unstable_pauseExecution=function(){},r.unstable_requestPaint=function(){},r.unstable_runWithPriority=function(j,G){switch(j){case 1:case 2:case 3:case 4:case 5:break;default:j=3}var q=g;g=j;try{return G()}finally{g=q}},r.unstable_scheduleCallback=function(j,G,q){var ne=r.unstable_now();switch(typeof q=="object"&&q!==null?(q=q.delay,q=typeof q=="number"&&0<q?ne+q:ne):q=ne,j){case 1:var L=-1;break;case 2:L=250;break;case 5:L=1073741823;break;case 4:L=1e4;break;default:L=5e3}return L=q+L,j={id:d++,callback:G,priorityLevel:j,startTime:q,expirationTime:L,sortIndex:-1},q>ne?(j.sortIndex=q,t(f,j),e(c)===null&&j===e(f)&&(w?(x(O),O=-1):w=!0,Y(T,q-ne))):(j.sortIndex=L,t(c,j),b||v||(b=!0,X())),j},r.unstable_shouldYield=I,r.unstable_wrapCallback=function(j){var G=g;return function(){var q=g;g=G;try{return j.apply(this,arguments)}finally{g=q}}}}(Tg)),Tg}var E2;function zO(){return E2||(E2=1,Ag.exports=MO()),Ag.exports}var Ng={exports:{}},Hn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var C2;function LO(){if(C2)return Hn;C2=1;var r=gy();function t(c){var f="https://react.dev/errors/"+c;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var d=2;d<arguments.length;d++)f+="&args[]="+encodeURIComponent(arguments[d])}return"Minified React error #"+c+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function e(){}var n={d:{f:e,r:function(){throw Error(t(522))},D:e,C:e,L:e,m:e,X:e,S:e,M:e},p:0,findDOMNode:null},a=Symbol.for("react.portal");function i(c,f,d){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:p==null?null:""+p,children:c,containerInfo:f,implementation:d}}var s=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function l(c,f){if(c==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return Hn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,Hn.createPortal=function(c,f){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(t(299));return i(c,f,null,d)},Hn.flushSync=function(c){var f=s.T,d=n.p;try{if(s.T=null,n.p=2,c)return c()}finally{s.T=f,n.p=d,n.d.f()}},Hn.preconnect=function(c,f){typeof c=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,n.d.C(c,f))},Hn.prefetchDNS=function(c){typeof c=="string"&&n.d.D(c)},Hn.preinit=function(c,f){if(typeof c=="string"&&f&&typeof f.as=="string"){var d=f.as,p=l(d,f.crossOrigin),g=typeof f.integrity=="string"?f.integrity:void 0,v=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;d==="style"?n.d.S(c,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:p,integrity:g,fetchPriority:v}):d==="script"&&n.d.X(c,{crossOrigin:p,integrity:g,fetchPriority:v,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},Hn.preinitModule=function(c,f){if(typeof c=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var d=l(f.as,f.crossOrigin);n.d.M(c,{crossOrigin:d,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&n.d.M(c)},Hn.preload=function(c,f){if(typeof c=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var d=f.as,p=l(d,f.crossOrigin);n.d.L(c,d,{crossOrigin:p,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},Hn.preloadModule=function(c,f){if(typeof c=="string")if(f){var d=l(f.as,f.crossOrigin);n.d.m(c,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:d,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else n.d.m(c)},Hn.requestFormReset=function(c){n.d.r(c)},Hn.unstable_batchedUpdates=function(c,f){return c(f)},Hn.useFormState=function(c,f,d){return s.H.useFormState(c,f,d)},Hn.useFormStatus=function(){return s.H.useHostTransitionStatus()},Hn.version="19.0.0",Hn}var A2;function EE(){if(A2)return Ng.exports;A2=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(t){console.error(t)}}return r(),Ng.exports=LO(),Ng.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var T2;function FO(){if(T2)return Ul;T2=1;var r=zO(),t=gy(),e=EE();function n(o){var u="https://react.dev/errors/"+o;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)u+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+o+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11)}var i=Symbol.for("react.element"),s=Symbol.for("react.transitional.element"),l=Symbol.for("react.portal"),c=Symbol.for("react.fragment"),f=Symbol.for("react.strict_mode"),d=Symbol.for("react.profiler"),p=Symbol.for("react.provider"),g=Symbol.for("react.consumer"),v=Symbol.for("react.context"),b=Symbol.for("react.forward_ref"),w=Symbol.for("react.suspense"),S=Symbol.for("react.suspense_list"),x=Symbol.for("react.memo"),C=Symbol.for("react.lazy"),A=Symbol.for("react.offscreen"),T=Symbol.for("react.memo_cache_sentinel"),R=Symbol.iterator;function O(o){return o===null||typeof o!="object"?null:(o=R&&o[R]||o["@@iterator"],typeof o=="function"?o:null)}var N=Symbol.for("react.client.reference");function D(o){if(o==null)return null;if(typeof o=="function")return o.$$typeof===N?null:o.displayName||o.name||null;if(typeof o=="string")return o;switch(o){case c:return"Fragment";case l:return"Portal";case d:return"Profiler";case f:return"StrictMode";case w:return"Suspense";case S:return"SuspenseList"}if(typeof o=="object")switch(o.$$typeof){case v:return(o.displayName||"Context")+".Provider";case g:return(o._context.displayName||"Context")+".Consumer";case b:var u=o.render;return o=o.displayName,o||(o=u.displayName||u.name||"",o=o!==""?"ForwardRef("+o+")":"ForwardRef"),o;case x:return u=o.displayName||null,u!==null?u:D(o.type)||"Memo";case C:u=o._payload,o=o._init;try{return D(o(u))}catch{}}return null}var I=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,_=Object.assign,F,B;function V(o){if(F===void 0)try{throw Error()}catch(h){var u=h.stack.trim().match(/\n( *(at )?)/);F=u&&u[1]||"",B=-1<h.stack.indexOf(`
    at`)?" (<anonymous>)":-1<h.stack.indexOf("@")?"@unknown:0:0":""}return`
`+F+o+B}var X=!1;function Y(o,u){if(!o||X)return"";X=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var m={DetermineComponentFrameRoot:function(){try{if(u){var ye=function(){throw Error()};if(Object.defineProperty(ye.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ye,[])}catch(fe){var ie=fe}Reflect.construct(o,[],ye)}else{try{ye.call()}catch(fe){ie=fe}o.call(ye.prototype)}}else{try{throw Error()}catch(fe){ie=fe}(ye=o())&&typeof ye.catch=="function"&&ye.catch(function(){})}}catch(fe){if(fe&&ie&&typeof fe.stack=="string")return[fe.stack,ie.stack]}return[null,null]}};m.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var y=Object.getOwnPropertyDescriptor(m.DetermineComponentFrameRoot,"name");y&&y.configurable&&Object.defineProperty(m.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var E=m.DetermineComponentFrameRoot(),k=E[0],z=E[1];if(k&&z){var H=k.split(`
`),J=z.split(`
`);for(y=m=0;m<H.length&&!H[m].includes("DetermineComponentFrameRoot");)m++;for(;y<J.length&&!J[y].includes("DetermineComponentFrameRoot");)y++;if(m===H.length||y===J.length)for(m=H.length-1,y=J.length-1;1<=m&&0<=y&&H[m]!==J[y];)y--;for(;1<=m&&0<=y;m--,y--)if(H[m]!==J[y]){if(m!==1||y!==1)do if(m--,y--,0>y||H[m]!==J[y]){var he=`
`+H[m].replace(" at new "," at ");return o.displayName&&he.includes("<anonymous>")&&(he=he.replace("<anonymous>",o.displayName)),he}while(1<=m&&0<=y);break}}}finally{X=!1,Error.prepareStackTrace=h}return(h=o?o.displayName||o.name:"")?V(h):""}function j(o){switch(o.tag){case 26:case 27:case 5:return V(o.type);case 16:return V("Lazy");case 13:return V("Suspense");case 19:return V("SuspenseList");case 0:case 15:return o=Y(o.type,!1),o;case 11:return o=Y(o.type.render,!1),o;case 1:return o=Y(o.type,!0),o;default:return""}}function G(o){try{var u="";do u+=j(o),o=o.return;while(o);return u}catch(h){return`
Error generating stack: `+h.message+`
`+h.stack}}function q(o){var u=o,h=o;if(o.alternate)for(;u.return;)u=u.return;else{o=u;do u=o,(u.flags&4098)!==0&&(h=u.return),o=u.return;while(o)}return u.tag===3?h:null}function ne(o){if(o.tag===13){var u=o.memoizedState;if(u===null&&(o=o.alternate,o!==null&&(u=o.memoizedState)),u!==null)return u.dehydrated}return null}function L(o){if(q(o)!==o)throw Error(n(188))}function Z(o){var u=o.alternate;if(!u){if(u=q(o),u===null)throw Error(n(188));return u!==o?null:o}for(var h=o,m=u;;){var y=h.return;if(y===null)break;var E=y.alternate;if(E===null){if(m=y.return,m!==null){h=m;continue}break}if(y.child===E.child){for(E=y.child;E;){if(E===h)return L(y),o;if(E===m)return L(y),u;E=E.sibling}throw Error(n(188))}if(h.return!==m.return)h=y,m=E;else{for(var k=!1,z=y.child;z;){if(z===h){k=!0,h=y,m=E;break}if(z===m){k=!0,m=y,h=E;break}z=z.sibling}if(!k){for(z=E.child;z;){if(z===h){k=!0,h=E,m=y;break}if(z===m){k=!0,m=E,h=y;break}z=z.sibling}if(!k)throw Error(n(189))}}if(h.alternate!==m)throw Error(n(190))}if(h.tag!==3)throw Error(n(188));return h.stateNode.current===h?o:u}function ce(o){var u=o.tag;if(u===5||u===26||u===27||u===6)return o;for(o=o.child;o!==null;){if(u=ce(o),u!==null)return u;o=o.sibling}return null}var le=Array.isArray,de=e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,xe={pending:!1,data:null,method:null,action:null},we=[],_e=-1;function Ee(o){return{current:o}}function ke(o){0>_e||(o.current=we[_e],we[_e]=null,_e--)}function Ue(o,u){_e++,we[_e]=o.current,o.current=u}var Fe=Ee(null),rt=Ee(null),qe=Ee(null),Se=Ee(null);function dt(o,u){switch(Ue(qe,u),Ue(rt,o),Ue(Fe,null),o=u.nodeType,o){case 9:case 11:u=(u=u.documentElement)&&(u=u.namespaceURI)?Xx(u):0;break;default:if(o=o===8?u.parentNode:u,u=o.tagName,o=o.namespaceURI)o=Xx(o),u=$x(o,u);else switch(u){case"svg":u=1;break;case"math":u=2;break;default:u=0}}ke(Fe),Ue(Fe,u)}function Je(){ke(Fe),ke(rt),ke(qe)}function Pt(o){o.memoizedState!==null&&Ue(Se,o);var u=Fe.current,h=$x(u,o.type);u!==h&&(Ue(rt,o),Ue(Fe,h))}function Cn(o){rt.current===o&&(ke(Fe),ke(rt)),Se.current===o&&(ke(Se),_l._currentValue=xe)}var en=Object.prototype.hasOwnProperty,Ft=r.unstable_scheduleCallback,Vt=r.unstable_cancelCallback,Un=r.unstable_shouldYield,Ge=r.unstable_requestPaint,kt=r.unstable_now,Bt=r.unstable_getCurrentPriorityLevel,Gt=r.unstable_ImmediatePriority,Pn=r.unstable_UserBlockingPriority,mn=r.unstable_NormalPriority,Xt=r.unstable_LowPriority,pr=r.unstable_IdlePriority,tr=r.log,$r=r.unstable_setDisableYieldValue,Dr=null,gn=null;function Ma(o){if(gn&&typeof gn.onCommitFiberRoot=="function")try{gn.onCommitFiberRoot(Dr,o,void 0,(o.current.flags&128)===128)}catch{}}function nr(o){if(typeof tr=="function"&&$r(o),gn&&typeof gn.setStrictMode=="function")try{gn.setStrictMode(Dr,o)}catch{}}var vn=Math.clz32?Math.clz32:bt,vp=Math.log,je=Math.LN2;function bt(o){return o>>>=0,o===0?32:31-(vp(o)/je|0)|0}var wt=128,st=4194304;function Et(o){var u=o&42;if(u!==0)return u;switch(o&-o){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o&4194176;case 4194304:case 8388608:case 16777216:case 33554432:return o&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return o}}function yn(o,u){var h=o.pendingLanes;if(h===0)return 0;var m=0,y=o.suspendedLanes,E=o.pingedLanes,k=o.warmLanes;o=o.finishedLanes!==0;var z=h&134217727;return z!==0?(h=z&~y,h!==0?m=Et(h):(E&=z,E!==0?m=Et(E):o||(k=z&~k,k!==0&&(m=Et(k))))):(z=h&~y,z!==0?m=Et(z):E!==0?m=Et(E):o||(k=h&~k,k!==0&&(m=Et(k)))),m===0?0:u!==0&&u!==m&&(u&y)===0&&(y=m&-m,k=u&-u,y>=k||y===32&&(k&4194176)!==0)?u:m}function tn(o,u){return(o.pendingLanes&~(o.suspendedLanes&~o.pingedLanes)&u)===0}function pa(o,u){switch(o){case 1:case 2:case 4:case 8:return u+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function rr(){var o=wt;return wt<<=1,(wt&4194176)===0&&(wt=128),o}function ma(){var o=st;return st<<=1,(st&62914560)===0&&(st=4194304),o}function Or(o){for(var u=[],h=0;31>h;h++)u.push(o);return u}function Vn(o,u){o.pendingLanes|=u,u!==268435456&&(o.suspendedLanes=0,o.pingedLanes=0,o.warmLanes=0)}function bs(o,u,h,m,y,E){var k=o.pendingLanes;o.pendingLanes=h,o.suspendedLanes=0,o.pingedLanes=0,o.warmLanes=0,o.expiredLanes&=h,o.entangledLanes&=h,o.errorRecoveryDisabledLanes&=h,o.shellSuspendCounter=0;var z=o.entanglements,H=o.expirationTimes,J=o.hiddenUpdates;for(h=k&~h;0<h;){var he=31-vn(h),ye=1<<he;z[he]=0,H[he]=-1;var ie=J[he];if(ie!==null)for(J[he]=null,he=0;he<ie.length;he++){var fe=ie[he];fe!==null&&(fe.lane&=-536870913)}h&=~ye}m!==0&&Hu(o,m,0),E!==0&&y===0&&o.tag!==0&&(o.suspendedLanes|=E&~(k&~u))}function Hu(o,u,h){o.pendingLanes|=u,o.suspendedLanes&=~u;var m=31-vn(u);o.entangledLanes|=u,o.entanglements[m]=o.entanglements[m]|1073741824|h&4194218}function j0(o,u){var h=o.entangledLanes|=u;for(o=o.entanglements;h;){var m=31-vn(h),y=1<<m;y&u|o[m]&u&&(o[m]|=u),h&=~y}}function W0(o){return o&=-o,2<o?8<o?(o&134217727)!==0?32:268435456:8:2}function H0(){var o=de.p;return o!==0?o:(o=window.event,o===void 0?32:h2(o.type))}function bk(o,u){var h=de.p;try{return de.p=o,u()}finally{de.p=h}}var bi=Math.random().toString(36).slice(2),jn="__reactFiber$"+bi,ar="__reactProps$"+bi,ws="__reactContainer$"+bi,yp="__reactEvents$"+bi,wk="__reactListeners$"+bi,xk="__reactHandles$"+bi,q0="__reactResources$"+bi,qu="__reactMarker$"+bi;function bp(o){delete o[jn],delete o[ar],delete o[yp],delete o[wk],delete o[xk]}function fo(o){var u=o[jn];if(u)return u;for(var h=o.parentNode;h;){if(u=h[ws]||h[jn]){if(h=u.alternate,u.child!==null||h!==null&&h.child!==null)for(o=Zx(o);o!==null;){if(h=o[jn])return h;o=Zx(o)}return u}o=h,h=o.parentNode}return null}function xs(o){if(o=o[jn]||o[ws]){var u=o.tag;if(u===5||u===6||u===13||u===26||u===27||u===3)return o}return null}function Gu(o){var u=o.tag;if(u===5||u===26||u===27||u===6)return o.stateNode;throw Error(n(33))}function Ss(o){var u=o[q0];return u||(u=o[q0]={hoistableStyles:new Map,hoistableScripts:new Map}),u}function An(o){o[qu]=!0}var G0=new Set,X0={};function ho(o,u){Es(o,u),Es(o+"Capture",u)}function Es(o,u){for(X0[o]=u,o=0;o<u.length;o++)G0.add(u[o])}var za=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Sk=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),$0={},K0={};function Ek(o){return en.call(K0,o)?!0:en.call($0,o)?!1:Sk.test(o)?K0[o]=!0:($0[o]=!0,!1)}function Zc(o,u,h){if(Ek(u))if(h===null)o.removeAttribute(u);else{switch(typeof h){case"undefined":case"function":case"symbol":o.removeAttribute(u);return;case"boolean":var m=u.toLowerCase().slice(0,5);if(m!=="data-"&&m!=="aria-"){o.removeAttribute(u);return}}o.setAttribute(u,""+h)}}function Qc(o,u,h){if(h===null)o.removeAttribute(u);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":o.removeAttribute(u);return}o.setAttribute(u,""+h)}}function La(o,u,h,m){if(m===null)o.removeAttribute(h);else{switch(typeof m){case"undefined":case"function":case"symbol":case"boolean":o.removeAttribute(h);return}o.setAttributeNS(u,h,""+m)}}function _r(o){switch(typeof o){case"bigint":case"boolean":case"number":case"string":case"undefined":return o;case"object":return o;default:return""}}function Y0(o){var u=o.type;return(o=o.nodeName)&&o.toLowerCase()==="input"&&(u==="checkbox"||u==="radio")}function Ck(o){var u=Y0(o)?"checked":"value",h=Object.getOwnPropertyDescriptor(o.constructor.prototype,u),m=""+o[u];if(!o.hasOwnProperty(u)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var y=h.get,E=h.set;return Object.defineProperty(o,u,{configurable:!0,get:function(){return y.call(this)},set:function(k){m=""+k,E.call(this,k)}}),Object.defineProperty(o,u,{enumerable:h.enumerable}),{getValue:function(){return m},setValue:function(k){m=""+k},stopTracking:function(){o._valueTracker=null,delete o[u]}}}}function Jc(o){o._valueTracker||(o._valueTracker=Ck(o))}function Z0(o){if(!o)return!1;var u=o._valueTracker;if(!u)return!0;var h=u.getValue(),m="";return o&&(m=Y0(o)?o.checked?"true":"false":o.value),o=m,o!==h?(u.setValue(o),!0):!1}function ef(o){if(o=o||(typeof document<"u"?document:void 0),typeof o>"u")return null;try{return o.activeElement||o.body}catch{return o.body}}var Ak=/[\n"\\]/g;function Mr(o){return o.replace(Ak,function(u){return"\\"+u.charCodeAt(0).toString(16)+" "})}function wp(o,u,h,m,y,E,k,z){o.name="",k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"?o.type=k:o.removeAttribute("type"),u!=null?k==="number"?(u===0&&o.value===""||o.value!=u)&&(o.value=""+_r(u)):o.value!==""+_r(u)&&(o.value=""+_r(u)):k!=="submit"&&k!=="reset"||o.removeAttribute("value"),u!=null?xp(o,k,_r(u)):h!=null?xp(o,k,_r(h)):m!=null&&o.removeAttribute("value"),y==null&&E!=null&&(o.defaultChecked=!!E),y!=null&&(o.checked=y&&typeof y!="function"&&typeof y!="symbol"),z!=null&&typeof z!="function"&&typeof z!="symbol"&&typeof z!="boolean"?o.name=""+_r(z):o.removeAttribute("name")}function Q0(o,u,h,m,y,E,k,z){if(E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"&&(o.type=E),u!=null||h!=null){if(!(E!=="submit"&&E!=="reset"||u!=null))return;h=h!=null?""+_r(h):"",u=u!=null?""+_r(u):h,z||u===o.value||(o.value=u),o.defaultValue=u}m=m??y,m=typeof m!="function"&&typeof m!="symbol"&&!!m,o.checked=z?o.checked:!!m,o.defaultChecked=!!m,k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"&&(o.name=k)}function xp(o,u,h){u==="number"&&ef(o.ownerDocument)===o||o.defaultValue===""+h||(o.defaultValue=""+h)}function Cs(o,u,h,m){if(o=o.options,u){u={};for(var y=0;y<h.length;y++)u["$"+h[y]]=!0;for(h=0;h<o.length;h++)y=u.hasOwnProperty("$"+o[h].value),o[h].selected!==y&&(o[h].selected=y),y&&m&&(o[h].defaultSelected=!0)}else{for(h=""+_r(h),u=null,y=0;y<o.length;y++){if(o[y].value===h){o[y].selected=!0,m&&(o[y].defaultSelected=!0);return}u!==null||o[y].disabled||(u=o[y])}u!==null&&(u.selected=!0)}}function J0(o,u,h){if(u!=null&&(u=""+_r(u),u!==o.value&&(o.value=u),h==null)){o.defaultValue!==u&&(o.defaultValue=u);return}o.defaultValue=h!=null?""+_r(h):""}function ew(o,u,h,m){if(u==null){if(m!=null){if(h!=null)throw Error(n(92));if(le(m)){if(1<m.length)throw Error(n(93));m=m[0]}h=m}h==null&&(h=""),u=h}h=_r(u),o.defaultValue=h,m=o.textContent,m===h&&m!==""&&m!==null&&(o.value=m)}function As(o,u){if(u){var h=o.firstChild;if(h&&h===o.lastChild&&h.nodeType===3){h.nodeValue=u;return}}o.textContent=u}var Tk=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function tw(o,u,h){var m=u.indexOf("--")===0;h==null||typeof h=="boolean"||h===""?m?o.setProperty(u,""):u==="float"?o.cssFloat="":o[u]="":m?o.setProperty(u,h):typeof h!="number"||h===0||Tk.has(u)?u==="float"?o.cssFloat=h:o[u]=(""+h).trim():o[u]=h+"px"}function nw(o,u,h){if(u!=null&&typeof u!="object")throw Error(n(62));if(o=o.style,h!=null){for(var m in h)!h.hasOwnProperty(m)||u!=null&&u.hasOwnProperty(m)||(m.indexOf("--")===0?o.setProperty(m,""):m==="float"?o.cssFloat="":o[m]="");for(var y in u)m=u[y],u.hasOwnProperty(y)&&h[y]!==m&&tw(o,y,m)}else for(var E in u)u.hasOwnProperty(E)&&tw(o,E,u[E])}function Sp(o){if(o.indexOf("-")===-1)return!1;switch(o){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Nk=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Rk=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function tf(o){return Rk.test(""+o)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":o}var Ep=null;function Cp(o){return o=o.target||o.srcElement||window,o.correspondingUseElement&&(o=o.correspondingUseElement),o.nodeType===3?o.parentNode:o}var Ts=null,Ns=null;function rw(o){var u=xs(o);if(u&&(o=u.stateNode)){var h=o[ar]||null;e:switch(o=u.stateNode,u.type){case"input":if(wp(o,h.value,h.defaultValue,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name),u=h.name,h.type==="radio"&&u!=null){for(h=o;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll('input[name="'+Mr(""+u)+'"][type="radio"]'),u=0;u<h.length;u++){var m=h[u];if(m!==o&&m.form===o.form){var y=m[ar]||null;if(!y)throw Error(n(90));wp(m,y.value,y.defaultValue,y.defaultValue,y.checked,y.defaultChecked,y.type,y.name)}}for(u=0;u<h.length;u++)m=h[u],m.form===o.form&&Z0(m)}break e;case"textarea":J0(o,h.value,h.defaultValue);break e;case"select":u=h.value,u!=null&&Cs(o,!!h.multiple,u,!1)}}}var Ap=!1;function aw(o,u,h){if(Ap)return o(u,h);Ap=!0;try{var m=o(u);return m}finally{if(Ap=!1,(Ts!==null||Ns!==null)&&(Uf(),Ts&&(u=Ts,o=Ns,Ns=Ts=null,rw(u),o)))for(u=0;u<o.length;u++)rw(o[u])}}function Xu(o,u){var h=o.stateNode;if(h===null)return null;var m=h[ar]||null;if(m===null)return null;h=m[u];e:switch(u){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(m=!m.disabled)||(o=o.type,m=!(o==="button"||o==="input"||o==="select"||o==="textarea")),o=!m;break e;default:o=!1}if(o)return null;if(h&&typeof h!="function")throw Error(n(231,u,typeof h));return h}var Tp=!1;if(za)try{var $u={};Object.defineProperty($u,"passive",{get:function(){Tp=!0}}),window.addEventListener("test",$u,$u),window.removeEventListener("test",$u,$u)}catch{Tp=!1}var wi=null,Np=null,nf=null;function iw(){if(nf)return nf;var o,u=Np,h=u.length,m,y="value"in wi?wi.value:wi.textContent,E=y.length;for(o=0;o<h&&u[o]===y[o];o++);var k=h-o;for(m=1;m<=k&&u[h-m]===y[E-m];m++);return nf=y.slice(o,1<m?1-m:void 0)}function rf(o){var u=o.keyCode;return"charCode"in o?(o=o.charCode,o===0&&u===13&&(o=13)):o=u,o===10&&(o=13),32<=o||o===13?o:0}function af(){return!0}function ow(){return!1}function ir(o){function u(h,m,y,E,k){this._reactName=h,this._targetInst=y,this.type=m,this.nativeEvent=E,this.target=k,this.currentTarget=null;for(var z in o)o.hasOwnProperty(z)&&(h=o[z],this[z]=h?h(E):E[z]);return this.isDefaultPrevented=(E.defaultPrevented!=null?E.defaultPrevented:E.returnValue===!1)?af:ow,this.isPropagationStopped=ow,this}return _(u.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=af)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=af)},persist:function(){},isPersistent:af}),u}var po={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(o){return o.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},of=ir(po),Ku=_({},po,{view:0,detail:0}),Ik=ir(Ku),Rp,Ip,Yu,sf=_({},Ku,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Dp,button:0,buttons:0,relatedTarget:function(o){return o.relatedTarget===void 0?o.fromElement===o.srcElement?o.toElement:o.fromElement:o.relatedTarget},movementX:function(o){return"movementX"in o?o.movementX:(o!==Yu&&(Yu&&o.type==="mousemove"?(Rp=o.screenX-Yu.screenX,Ip=o.screenY-Yu.screenY):Ip=Rp=0,Yu=o),Rp)},movementY:function(o){return"movementY"in o?o.movementY:Ip}}),sw=ir(sf),kk=_({},sf,{dataTransfer:0}),Dk=ir(kk),Ok=_({},Ku,{relatedTarget:0}),kp=ir(Ok),_k=_({},po,{animationName:0,elapsedTime:0,pseudoElement:0}),Mk=ir(_k),zk=_({},po,{clipboardData:function(o){return"clipboardData"in o?o.clipboardData:window.clipboardData}}),Lk=ir(zk),Fk=_({},po,{data:0}),uw=ir(Fk),Bk={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Uk={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Pk={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Vk(o){var u=this.nativeEvent;return u.getModifierState?u.getModifierState(o):(o=Pk[o])?!!u[o]:!1}function Dp(){return Vk}var jk=_({},Ku,{key:function(o){if(o.key){var u=Bk[o.key]||o.key;if(u!=="Unidentified")return u}return o.type==="keypress"?(o=rf(o),o===13?"Enter":String.fromCharCode(o)):o.type==="keydown"||o.type==="keyup"?Uk[o.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Dp,charCode:function(o){return o.type==="keypress"?rf(o):0},keyCode:function(o){return o.type==="keydown"||o.type==="keyup"?o.keyCode:0},which:function(o){return o.type==="keypress"?rf(o):o.type==="keydown"||o.type==="keyup"?o.keyCode:0}}),Wk=ir(jk),Hk=_({},sf,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),lw=ir(Hk),qk=_({},Ku,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Dp}),Gk=ir(qk),Xk=_({},po,{propertyName:0,elapsedTime:0,pseudoElement:0}),$k=ir(Xk),Kk=_({},sf,{deltaX:function(o){return"deltaX"in o?o.deltaX:"wheelDeltaX"in o?-o.wheelDeltaX:0},deltaY:function(o){return"deltaY"in o?o.deltaY:"wheelDeltaY"in o?-o.wheelDeltaY:"wheelDelta"in o?-o.wheelDelta:0},deltaZ:0,deltaMode:0}),Yk=ir(Kk),Zk=_({},po,{newState:0,oldState:0}),Qk=ir(Zk),Jk=[9,13,27,32],Op=za&&"CompositionEvent"in window,Zu=null;za&&"documentMode"in document&&(Zu=document.documentMode);var eD=za&&"TextEvent"in window&&!Zu,cw=za&&(!Op||Zu&&8<Zu&&11>=Zu),fw=" ",hw=!1;function dw(o,u){switch(o){case"keyup":return Jk.indexOf(u.keyCode)!==-1;case"keydown":return u.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function pw(o){return o=o.detail,typeof o=="object"&&"data"in o?o.data:null}var Rs=!1;function tD(o,u){switch(o){case"compositionend":return pw(u);case"keypress":return u.which!==32?null:(hw=!0,fw);case"textInput":return o=u.data,o===fw&&hw?null:o;default:return null}}function nD(o,u){if(Rs)return o==="compositionend"||!Op&&dw(o,u)?(o=iw(),nf=Np=wi=null,Rs=!1,o):null;switch(o){case"paste":return null;case"keypress":if(!(u.ctrlKey||u.altKey||u.metaKey)||u.ctrlKey&&u.altKey){if(u.char&&1<u.char.length)return u.char;if(u.which)return String.fromCharCode(u.which)}return null;case"compositionend":return cw&&u.locale!=="ko"?null:u.data;default:return null}}var rD={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function mw(o){var u=o&&o.nodeName&&o.nodeName.toLowerCase();return u==="input"?!!rD[o.type]:u==="textarea"}function gw(o,u,h,m){Ts?Ns?Ns.push(m):Ns=[m]:Ts=m,u=Hf(u,"onChange"),0<u.length&&(h=new of("onChange","change",null,h,m),o.push({event:h,listeners:u}))}var Qu=null,Ju=null;function aD(o){jx(o,0)}function uf(o){var u=Gu(o);if(Z0(u))return o}function vw(o,u){if(o==="change")return u}var yw=!1;if(za){var _p;if(za){var Mp="oninput"in document;if(!Mp){var bw=document.createElement("div");bw.setAttribute("oninput","return;"),Mp=typeof bw.oninput=="function"}_p=Mp}else _p=!1;yw=_p&&(!document.documentMode||9<document.documentMode)}function ww(){Qu&&(Qu.detachEvent("onpropertychange",xw),Ju=Qu=null)}function xw(o){if(o.propertyName==="value"&&uf(Ju)){var u=[];gw(u,Ju,o,Cp(o)),aw(aD,u)}}function iD(o,u,h){o==="focusin"?(ww(),Qu=u,Ju=h,Qu.attachEvent("onpropertychange",xw)):o==="focusout"&&ww()}function oD(o){if(o==="selectionchange"||o==="keyup"||o==="keydown")return uf(Ju)}function sD(o,u){if(o==="click")return uf(u)}function uD(o,u){if(o==="input"||o==="change")return uf(u)}function lD(o,u){return o===u&&(o!==0||1/o===1/u)||o!==o&&u!==u}var mr=typeof Object.is=="function"?Object.is:lD;function el(o,u){if(mr(o,u))return!0;if(typeof o!="object"||o===null||typeof u!="object"||u===null)return!1;var h=Object.keys(o),m=Object.keys(u);if(h.length!==m.length)return!1;for(m=0;m<h.length;m++){var y=h[m];if(!en.call(u,y)||!mr(o[y],u[y]))return!1}return!0}function Sw(o){for(;o&&o.firstChild;)o=o.firstChild;return o}function Ew(o,u){var h=Sw(o);o=0;for(var m;h;){if(h.nodeType===3){if(m=o+h.textContent.length,o<=u&&m>=u)return{node:h,offset:u-o};o=m}e:{for(;h;){if(h.nextSibling){h=h.nextSibling;break e}h=h.parentNode}h=void 0}h=Sw(h)}}function Cw(o,u){return o&&u?o===u?!0:o&&o.nodeType===3?!1:u&&u.nodeType===3?Cw(o,u.parentNode):"contains"in o?o.contains(u):o.compareDocumentPosition?!!(o.compareDocumentPosition(u)&16):!1:!1}function Aw(o){o=o!=null&&o.ownerDocument!=null&&o.ownerDocument.defaultView!=null?o.ownerDocument.defaultView:window;for(var u=ef(o.document);u instanceof o.HTMLIFrameElement;){try{var h=typeof u.contentWindow.location.href=="string"}catch{h=!1}if(h)o=u.contentWindow;else break;u=ef(o.document)}return u}function zp(o){var u=o&&o.nodeName&&o.nodeName.toLowerCase();return u&&(u==="input"&&(o.type==="text"||o.type==="search"||o.type==="tel"||o.type==="url"||o.type==="password")||u==="textarea"||o.contentEditable==="true")}function cD(o,u){var h=Aw(u);u=o.focusedElem;var m=o.selectionRange;if(h!==u&&u&&u.ownerDocument&&Cw(u.ownerDocument.documentElement,u)){if(m!==null&&zp(u)){if(o=m.start,h=m.end,h===void 0&&(h=o),"selectionStart"in u)u.selectionStart=o,u.selectionEnd=Math.min(h,u.value.length);else if(h=(o=u.ownerDocument||document)&&o.defaultView||window,h.getSelection){h=h.getSelection();var y=u.textContent.length,E=Math.min(m.start,y);m=m.end===void 0?E:Math.min(m.end,y),!h.extend&&E>m&&(y=m,m=E,E=y),y=Ew(u,E);var k=Ew(u,m);y&&k&&(h.rangeCount!==1||h.anchorNode!==y.node||h.anchorOffset!==y.offset||h.focusNode!==k.node||h.focusOffset!==k.offset)&&(o=o.createRange(),o.setStart(y.node,y.offset),h.removeAllRanges(),E>m?(h.addRange(o),h.extend(k.node,k.offset)):(o.setEnd(k.node,k.offset),h.addRange(o)))}}for(o=[],h=u;h=h.parentNode;)h.nodeType===1&&o.push({element:h,left:h.scrollLeft,top:h.scrollTop});for(typeof u.focus=="function"&&u.focus(),u=0;u<o.length;u++)h=o[u],h.element.scrollLeft=h.left,h.element.scrollTop=h.top}}var fD=za&&"documentMode"in document&&11>=document.documentMode,Is=null,Lp=null,tl=null,Fp=!1;function Tw(o,u,h){var m=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;Fp||Is==null||Is!==ef(m)||(m=Is,"selectionStart"in m&&zp(m)?m={start:m.selectionStart,end:m.selectionEnd}:(m=(m.ownerDocument&&m.ownerDocument.defaultView||window).getSelection(),m={anchorNode:m.anchorNode,anchorOffset:m.anchorOffset,focusNode:m.focusNode,focusOffset:m.focusOffset}),tl&&el(tl,m)||(tl=m,m=Hf(Lp,"onSelect"),0<m.length&&(u=new of("onSelect","select",null,u,h),o.push({event:u,listeners:m}),u.target=Is)))}function mo(o,u){var h={};return h[o.toLowerCase()]=u.toLowerCase(),h["Webkit"+o]="webkit"+u,h["Moz"+o]="moz"+u,h}var ks={animationend:mo("Animation","AnimationEnd"),animationiteration:mo("Animation","AnimationIteration"),animationstart:mo("Animation","AnimationStart"),transitionrun:mo("Transition","TransitionRun"),transitionstart:mo("Transition","TransitionStart"),transitioncancel:mo("Transition","TransitionCancel"),transitionend:mo("Transition","TransitionEnd")},Bp={},Nw={};za&&(Nw=document.createElement("div").style,"AnimationEvent"in window||(delete ks.animationend.animation,delete ks.animationiteration.animation,delete ks.animationstart.animation),"TransitionEvent"in window||delete ks.transitionend.transition);function go(o){if(Bp[o])return Bp[o];if(!ks[o])return o;var u=ks[o],h;for(h in u)if(u.hasOwnProperty(h)&&h in Nw)return Bp[o]=u[h];return o}var Rw=go("animationend"),Iw=go("animationiteration"),kw=go("animationstart"),hD=go("transitionrun"),dD=go("transitionstart"),pD=go("transitioncancel"),Dw=go("transitionend"),Ow=new Map,_w="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll scrollEnd toggle touchMove waiting wheel".split(" ");function Kr(o,u){Ow.set(o,u),ho(u,[o])}var zr=[],Ds=0,Up=0;function lf(){for(var o=Ds,u=Up=Ds=0;u<o;){var h=zr[u];zr[u++]=null;var m=zr[u];zr[u++]=null;var y=zr[u];zr[u++]=null;var E=zr[u];if(zr[u++]=null,m!==null&&y!==null){var k=m.pending;k===null?y.next=y:(y.next=k.next,k.next=y),m.pending=y}E!==0&&Mw(h,y,E)}}function cf(o,u,h,m){zr[Ds++]=o,zr[Ds++]=u,zr[Ds++]=h,zr[Ds++]=m,Up|=m,o.lanes|=m,o=o.alternate,o!==null&&(o.lanes|=m)}function Pp(o,u,h,m){return cf(o,u,h,m),ff(o)}function xi(o,u){return cf(o,null,null,u),ff(o)}function Mw(o,u,h){o.lanes|=h;var m=o.alternate;m!==null&&(m.lanes|=h);for(var y=!1,E=o.return;E!==null;)E.childLanes|=h,m=E.alternate,m!==null&&(m.childLanes|=h),E.tag===22&&(o=E.stateNode,o===null||o._visibility&1||(y=!0)),o=E,E=E.return;y&&u!==null&&o.tag===3&&(E=o.stateNode,y=31-vn(h),E=E.hiddenUpdates,o=E[y],o===null?E[y]=[u]:o.push(u),u.lane=h|536870912)}function ff(o){if(50<Tl)throw Tl=0,Gm=null,Error(n(185));for(var u=o.return;u!==null;)o=u,u=o.return;return o.tag===3?o.stateNode:null}var Os={},zw=new WeakMap;function Lr(o,u){if(typeof o=="object"&&o!==null){var h=zw.get(o);return h!==void 0?h:(u={value:o,source:u,stack:G(u)},zw.set(o,u),u)}return{value:o,source:u,stack:G(u)}}var _s=[],Ms=0,hf=null,df=0,Fr=[],Br=0,vo=null,Fa=1,Ba="";function yo(o,u){_s[Ms++]=df,_s[Ms++]=hf,hf=o,df=u}function Lw(o,u,h){Fr[Br++]=Fa,Fr[Br++]=Ba,Fr[Br++]=vo,vo=o;var m=Fa;o=Ba;var y=32-vn(m)-1;m&=~(1<<y),h+=1;var E=32-vn(u)+y;if(30<E){var k=y-y%5;E=(m&(1<<k)-1).toString(32),m>>=k,y-=k,Fa=1<<32-vn(u)+y|h<<y|m,Ba=E+o}else Fa=1<<E|h<<y|m,Ba=o}function Vp(o){o.return!==null&&(yo(o,1),Lw(o,1,0))}function jp(o){for(;o===hf;)hf=_s[--Ms],_s[Ms]=null,df=_s[--Ms],_s[Ms]=null;for(;o===vo;)vo=Fr[--Br],Fr[Br]=null,Ba=Fr[--Br],Fr[Br]=null,Fa=Fr[--Br],Fr[Br]=null}var $n=null,_n=null,vt=!1,Yr=null,ga=!1,Wp=Error(n(519));function bo(o){var u=Error(n(418,""));throw al(Lr(u,o)),Wp}function Fw(o){var u=o.stateNode,h=o.type,m=o.memoizedProps;switch(u[jn]=o,u[ar]=m,h){case"dialog":ht("cancel",u),ht("close",u);break;case"iframe":case"object":case"embed":ht("load",u);break;case"video":case"audio":for(h=0;h<Rl.length;h++)ht(Rl[h],u);break;case"source":ht("error",u);break;case"img":case"image":case"link":ht("error",u),ht("load",u);break;case"details":ht("toggle",u);break;case"input":ht("invalid",u),Q0(u,m.value,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name,!0),Jc(u);break;case"select":ht("invalid",u);break;case"textarea":ht("invalid",u),ew(u,m.value,m.defaultValue,m.children),Jc(u)}h=m.children,typeof h!="string"&&typeof h!="number"&&typeof h!="bigint"||u.textContent===""+h||m.suppressHydrationWarning===!0||Gx(u.textContent,h)?(m.popover!=null&&(ht("beforetoggle",u),ht("toggle",u)),m.onScroll!=null&&ht("scroll",u),m.onScrollEnd!=null&&ht("scrollend",u),m.onClick!=null&&(u.onclick=qf),u=!0):u=!1,u||bo(o)}function Bw(o){for($n=o.return;$n;)switch($n.tag){case 3:case 27:ga=!0;return;case 5:case 13:ga=!1;return;default:$n=$n.return}}function nl(o){if(o!==$n)return!1;if(!vt)return Bw(o),vt=!0,!1;var u=!1,h;if((h=o.tag!==3&&o.tag!==27)&&((h=o.tag===5)&&(h=o.type,h=!(h!=="form"&&h!=="button")||lg(o.type,o.memoizedProps)),h=!h),h&&(u=!0),u&&_n&&bo(o),Bw(o),o.tag===13){if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(n(317));e:{for(o=o.nextSibling,u=0;o;){if(o.nodeType===8)if(h=o.data,h==="/$"){if(u===0){_n=Qr(o.nextSibling);break e}u--}else h!=="$"&&h!=="$!"&&h!=="$?"||u++;o=o.nextSibling}_n=null}}else _n=$n?Qr(o.stateNode.nextSibling):null;return!0}function rl(){_n=$n=null,vt=!1}function al(o){Yr===null?Yr=[o]:Yr.push(o)}var il=Error(n(460)),Uw=Error(n(474)),Hp={then:function(){}};function Pw(o){return o=o.status,o==="fulfilled"||o==="rejected"}function pf(){}function Vw(o,u,h){switch(h=o[h],h===void 0?o.push(u):h!==u&&(u.then(pf,pf),u=h),u.status){case"fulfilled":return u.value;case"rejected":throw o=u.reason,o===il?Error(n(483)):o;default:if(typeof u.status=="string")u.then(pf,pf);else{if(o=Dt,o!==null&&100<o.shellSuspendCounter)throw Error(n(482));o=u,o.status="pending",o.then(function(m){if(u.status==="pending"){var y=u;y.status="fulfilled",y.value=m}},function(m){if(u.status==="pending"){var y=u;y.status="rejected",y.reason=m}})}switch(u.status){case"fulfilled":return u.value;case"rejected":throw o=u.reason,o===il?Error(n(483)):o}throw ol=u,il}}var ol=null;function jw(){if(ol===null)throw Error(n(459));var o=ol;return ol=null,o}var zs=null,sl=0;function mf(o){var u=sl;return sl+=1,zs===null&&(zs=[]),Vw(zs,o,u)}function ul(o,u){u=u.props.ref,o.ref=u!==void 0?u:null}function gf(o,u){throw u.$$typeof===i?Error(n(525)):(o=Object.prototype.toString.call(u),Error(n(31,o==="[object Object]"?"object with keys {"+Object.keys(u).join(", ")+"}":o)))}function Ww(o){var u=o._init;return u(o._payload)}function Hw(o){function u(te,Q){if(o){var re=te.deletions;re===null?(te.deletions=[Q],te.flags|=16):re.push(Q)}}function h(te,Q){if(!o)return null;for(;Q!==null;)u(te,Q),Q=Q.sibling;return null}function m(te){for(var Q=new Map;te!==null;)te.key!==null?Q.set(te.key,te):Q.set(te.index,te),te=te.sibling;return Q}function y(te,Q){return te=_i(te,Q),te.index=0,te.sibling=null,te}function E(te,Q,re){return te.index=re,o?(re=te.alternate,re!==null?(re=re.index,re<Q?(te.flags|=33554434,Q):re):(te.flags|=33554434,Q)):(te.flags|=1048576,Q)}function k(te){return o&&te.alternate===null&&(te.flags|=33554434),te}function z(te,Q,re,me){return Q===null||Q.tag!==6?(Q=Bm(re,te.mode,me),Q.return=te,Q):(Q=y(Q,re),Q.return=te,Q)}function H(te,Q,re,me){var Ie=re.type;return Ie===c?he(te,Q,re.props.children,me,re.key):Q!==null&&(Q.elementType===Ie||typeof Ie=="object"&&Ie!==null&&Ie.$$typeof===C&&Ww(Ie)===Q.type)?(Q=y(Q,re.props),ul(Q,re),Q.return=te,Q):(Q=Mf(re.type,re.key,re.props,null,te.mode,me),ul(Q,re),Q.return=te,Q)}function J(te,Q,re,me){return Q===null||Q.tag!==4||Q.stateNode.containerInfo!==re.containerInfo||Q.stateNode.implementation!==re.implementation?(Q=Um(re,te.mode,me),Q.return=te,Q):(Q=y(Q,re.children||[]),Q.return=te,Q)}function he(te,Q,re,me,Ie){return Q===null||Q.tag!==7?(Q=Io(re,te.mode,me,Ie),Q.return=te,Q):(Q=y(Q,re),Q.return=te,Q)}function ye(te,Q,re){if(typeof Q=="string"&&Q!==""||typeof Q=="number"||typeof Q=="bigint")return Q=Bm(""+Q,te.mode,re),Q.return=te,Q;if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case s:return re=Mf(Q.type,Q.key,Q.props,null,te.mode,re),ul(re,Q),re.return=te,re;case l:return Q=Um(Q,te.mode,re),Q.return=te,Q;case C:var me=Q._init;return Q=me(Q._payload),ye(te,Q,re)}if(le(Q)||O(Q))return Q=Io(Q,te.mode,re,null),Q.return=te,Q;if(typeof Q.then=="function")return ye(te,mf(Q),re);if(Q.$$typeof===v)return ye(te,Df(te,Q),re);gf(te,Q)}return null}function ie(te,Q,re,me){var Ie=Q!==null?Q.key:null;if(typeof re=="string"&&re!==""||typeof re=="number"||typeof re=="bigint")return Ie!==null?null:z(te,Q,""+re,me);if(typeof re=="object"&&re!==null){switch(re.$$typeof){case s:return re.key===Ie?H(te,Q,re,me):null;case l:return re.key===Ie?J(te,Q,re,me):null;case C:return Ie=re._init,re=Ie(re._payload),ie(te,Q,re,me)}if(le(re)||O(re))return Ie!==null?null:he(te,Q,re,me,null);if(typeof re.then=="function")return ie(te,Q,mf(re),me);if(re.$$typeof===v)return ie(te,Q,Df(te,re),me);gf(te,re)}return null}function fe(te,Q,re,me,Ie){if(typeof me=="string"&&me!==""||typeof me=="number"||typeof me=="bigint")return te=te.get(re)||null,z(Q,te,""+me,Ie);if(typeof me=="object"&&me!==null){switch(me.$$typeof){case s:return te=te.get(me.key===null?re:me.key)||null,H(Q,te,me,Ie);case l:return te=te.get(me.key===null?re:me.key)||null,J(Q,te,me,Ie);case C:var it=me._init;return me=it(me._payload),fe(te,Q,re,me,Ie)}if(le(me)||O(me))return te=te.get(re)||null,he(Q,te,me,Ie,null);if(typeof me.then=="function")return fe(te,Q,re,mf(me),Ie);if(me.$$typeof===v)return fe(te,Q,re,Df(Q,me),Ie);gf(Q,me)}return null}function ze(te,Q,re,me){for(var Ie=null,it=null,Le=Q,Pe=Q=0,Rn=null;Le!==null&&Pe<re.length;Pe++){Le.index>Pe?(Rn=Le,Le=null):Rn=Le.sibling;var yt=ie(te,Le,re[Pe],me);if(yt===null){Le===null&&(Le=Rn);break}o&&Le&&yt.alternate===null&&u(te,Le),Q=E(yt,Q,Pe),it===null?Ie=yt:it.sibling=yt,it=yt,Le=Rn}if(Pe===re.length)return h(te,Le),vt&&yo(te,Pe),Ie;if(Le===null){for(;Pe<re.length;Pe++)Le=ye(te,re[Pe],me),Le!==null&&(Q=E(Le,Q,Pe),it===null?Ie=Le:it.sibling=Le,it=Le);return vt&&yo(te,Pe),Ie}for(Le=m(Le);Pe<re.length;Pe++)Rn=fe(Le,te,Pe,re[Pe],me),Rn!==null&&(o&&Rn.alternate!==null&&Le.delete(Rn.key===null?Pe:Rn.key),Q=E(Rn,Q,Pe),it===null?Ie=Rn:it.sibling=Rn,it=Rn);return o&&Le.forEach(function(Pi){return u(te,Pi)}),vt&&yo(te,Pe),Ie}function Ke(te,Q,re,me){if(re==null)throw Error(n(151));for(var Ie=null,it=null,Le=Q,Pe=Q=0,Rn=null,yt=re.next();Le!==null&&!yt.done;Pe++,yt=re.next()){Le.index>Pe?(Rn=Le,Le=null):Rn=Le.sibling;var Pi=ie(te,Le,yt.value,me);if(Pi===null){Le===null&&(Le=Rn);break}o&&Le&&Pi.alternate===null&&u(te,Le),Q=E(Pi,Q,Pe),it===null?Ie=Pi:it.sibling=Pi,it=Pi,Le=Rn}if(yt.done)return h(te,Le),vt&&yo(te,Pe),Ie;if(Le===null){for(;!yt.done;Pe++,yt=re.next())yt=ye(te,yt.value,me),yt!==null&&(Q=E(yt,Q,Pe),it===null?Ie=yt:it.sibling=yt,it=yt);return vt&&yo(te,Pe),Ie}for(Le=m(Le);!yt.done;Pe++,yt=re.next())yt=fe(Le,te,Pe,yt.value,me),yt!==null&&(o&&yt.alternate!==null&&Le.delete(yt.key===null?Pe:yt.key),Q=E(yt,Q,Pe),it===null?Ie=yt:it.sibling=yt,it=yt);return o&&Le.forEach(function(RO){return u(te,RO)}),vt&&yo(te,Pe),Ie}function Yt(te,Q,re,me){if(typeof re=="object"&&re!==null&&re.type===c&&re.key===null&&(re=re.props.children),typeof re=="object"&&re!==null){switch(re.$$typeof){case s:e:{for(var Ie=re.key;Q!==null;){if(Q.key===Ie){if(Ie=re.type,Ie===c){if(Q.tag===7){h(te,Q.sibling),me=y(Q,re.props.children),me.return=te,te=me;break e}}else if(Q.elementType===Ie||typeof Ie=="object"&&Ie!==null&&Ie.$$typeof===C&&Ww(Ie)===Q.type){h(te,Q.sibling),me=y(Q,re.props),ul(me,re),me.return=te,te=me;break e}h(te,Q);break}else u(te,Q);Q=Q.sibling}re.type===c?(me=Io(re.props.children,te.mode,me,re.key),me.return=te,te=me):(me=Mf(re.type,re.key,re.props,null,te.mode,me),ul(me,re),me.return=te,te=me)}return k(te);case l:e:{for(Ie=re.key;Q!==null;){if(Q.key===Ie)if(Q.tag===4&&Q.stateNode.containerInfo===re.containerInfo&&Q.stateNode.implementation===re.implementation){h(te,Q.sibling),me=y(Q,re.children||[]),me.return=te,te=me;break e}else{h(te,Q);break}else u(te,Q);Q=Q.sibling}me=Um(re,te.mode,me),me.return=te,te=me}return k(te);case C:return Ie=re._init,re=Ie(re._payload),Yt(te,Q,re,me)}if(le(re))return ze(te,Q,re,me);if(O(re)){if(Ie=O(re),typeof Ie!="function")throw Error(n(150));return re=Ie.call(re),Ke(te,Q,re,me)}if(typeof re.then=="function")return Yt(te,Q,mf(re),me);if(re.$$typeof===v)return Yt(te,Q,Df(te,re),me);gf(te,re)}return typeof re=="string"&&re!==""||typeof re=="number"||typeof re=="bigint"?(re=""+re,Q!==null&&Q.tag===6?(h(te,Q.sibling),me=y(Q,re),me.return=te,te=me):(h(te,Q),me=Bm(re,te.mode,me),me.return=te,te=me),k(te)):h(te,Q)}return function(te,Q,re,me){try{sl=0;var Ie=Yt(te,Q,re,me);return zs=null,Ie}catch(Le){if(Le===il)throw Le;var it=jr(29,Le,null,te.mode);return it.lanes=me,it.return=te,it}finally{}}}var wo=Hw(!0),qw=Hw(!1),Ls=Ee(null),vf=Ee(0);function Gw(o,u){o=Ka,Ue(vf,o),Ue(Ls,u),Ka=o|u.baseLanes}function qp(){Ue(vf,Ka),Ue(Ls,Ls.current)}function Gp(){Ka=vf.current,ke(Ls),ke(vf)}var Ur=Ee(null),va=null;function Si(o){var u=o.alternate;Ue(bn,bn.current&1),Ue(Ur,o),va===null&&(u===null||Ls.current!==null||u.memoizedState!==null)&&(va=o)}function Xw(o){if(o.tag===22){if(Ue(bn,bn.current),Ue(Ur,o),va===null){var u=o.alternate;u!==null&&u.memoizedState!==null&&(va=o)}}else Ei()}function Ei(){Ue(bn,bn.current),Ue(Ur,Ur.current)}function Ua(o){ke(Ur),va===o&&(va=null),ke(bn)}var bn=Ee(0);function yf(o){for(var u=o;u!==null;){if(u.tag===13){var h=u.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||h.data==="$?"||h.data==="$!"))return u}else if(u.tag===19&&u.memoizedProps.revealOrder!==void 0){if((u.flags&128)!==0)return u}else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===o)break;for(;u.sibling===null;){if(u.return===null||u.return===o)return null;u=u.return}u.sibling.return=u.return,u=u.sibling}return null}var mD=typeof AbortController<"u"?AbortController:function(){var o=[],u=this.signal={aborted:!1,addEventListener:function(h,m){o.push(m)}};this.abort=function(){u.aborted=!0,o.forEach(function(h){return h()})}},gD=r.unstable_scheduleCallback,vD=r.unstable_NormalPriority,wn={$$typeof:v,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Xp(){return{controller:new mD,data:new Map,refCount:0}}function ll(o){o.refCount--,o.refCount===0&&gD(vD,function(){o.controller.abort()})}var cl=null,$p=0,Fs=0,Bs=null;function yD(o,u){if(cl===null){var h=cl=[];$p=0,Fs=eg(),Bs={status:"pending",value:void 0,then:function(m){h.push(m)}}}return $p++,u.then($w,$w),u}function $w(){if(--$p===0&&cl!==null){Bs!==null&&(Bs.status="fulfilled");var o=cl;cl=null,Fs=0,Bs=null;for(var u=0;u<o.length;u++)(0,o[u])()}}function bD(o,u){var h=[],m={status:"pending",value:null,reason:null,then:function(y){h.push(y)}};return o.then(function(){m.status="fulfilled",m.value=u;for(var y=0;y<h.length;y++)(0,h[y])(u)},function(y){for(m.status="rejected",m.reason=y,y=0;y<h.length;y++)(0,h[y])(void 0)}),m}var Kw=I.S;I.S=function(o,u){typeof u=="object"&&u!==null&&typeof u.then=="function"&&yD(o,u),Kw!==null&&Kw(o,u)};var xo=Ee(null);function Kp(){var o=xo.current;return o!==null?o:Dt.pooledCache}function bf(o,u){u===null?Ue(xo,xo.current):Ue(xo,u.pool)}function Yw(){var o=Kp();return o===null?null:{parent:wn._currentValue,pool:o}}var Ci=0,at=null,Tt=null,on=null,wf=!1,Us=!1,So=!1,xf=0,fl=0,Ps=null,wD=0;function nn(){throw Error(n(321))}function Yp(o,u){if(u===null)return!1;for(var h=0;h<u.length&&h<o.length;h++)if(!mr(o[h],u[h]))return!1;return!0}function Zp(o,u,h,m,y,E){return Ci=E,at=u,u.memoizedState=null,u.updateQueue=null,u.lanes=0,I.H=o===null||o.memoizedState===null?Eo:Ai,So=!1,E=h(m,y),So=!1,Us&&(E=Qw(u,h,m,y)),Zw(o),E}function Zw(o){I.H=ya;var u=Tt!==null&&Tt.next!==null;if(Ci=0,on=Tt=at=null,wf=!1,fl=0,Ps=null,u)throw Error(n(300));o===null||Tn||(o=o.dependencies,o!==null&&kf(o)&&(Tn=!0))}function Qw(o,u,h,m){at=o;var y=0;do{if(Us&&(Ps=null),fl=0,Us=!1,25<=y)throw Error(n(301));if(y+=1,on=Tt=null,o.updateQueue!=null){var E=o.updateQueue;E.lastEffect=null,E.events=null,E.stores=null,E.memoCache!=null&&(E.memoCache.index=0)}I.H=Co,E=u(h,m)}while(Us);return E}function xD(){var o=I.H,u=o.useState()[0];return u=typeof u.then=="function"?hl(u):u,o=o.useState()[0],(Tt!==null?Tt.memoizedState:null)!==o&&(at.flags|=1024),u}function Qp(){var o=xf!==0;return xf=0,o}function Jp(o,u,h){u.updateQueue=o.updateQueue,u.flags&=-2053,o.lanes&=~h}function em(o){if(wf){for(o=o.memoizedState;o!==null;){var u=o.queue;u!==null&&(u.pending=null),o=o.next}wf=!1}Ci=0,on=Tt=at=null,Us=!1,fl=xf=0,Ps=null}function or(){var o={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return on===null?at.memoizedState=on=o:on=on.next=o,on}function sn(){if(Tt===null){var o=at.alternate;o=o!==null?o.memoizedState:null}else o=Tt.next;var u=on===null?at.memoizedState:on.next;if(u!==null)on=u,Tt=o;else{if(o===null)throw at.alternate===null?Error(n(467)):Error(n(310));Tt=o,o={memoizedState:Tt.memoizedState,baseState:Tt.baseState,baseQueue:Tt.baseQueue,queue:Tt.queue,next:null},on===null?at.memoizedState=on=o:on=on.next=o}return on}var Sf;Sf=function(){return{lastEffect:null,events:null,stores:null,memoCache:null}};function hl(o){var u=fl;return fl+=1,Ps===null&&(Ps=[]),o=Vw(Ps,o,u),u=at,(on===null?u.memoizedState:on.next)===null&&(u=u.alternate,I.H=u===null||u.memoizedState===null?Eo:Ai),o}function Ef(o){if(o!==null&&typeof o=="object"){if(typeof o.then=="function")return hl(o);if(o.$$typeof===v)return Wn(o)}throw Error(n(438,String(o)))}function tm(o){var u=null,h=at.updateQueue;if(h!==null&&(u=h.memoCache),u==null){var m=at.alternate;m!==null&&(m=m.updateQueue,m!==null&&(m=m.memoCache,m!=null&&(u={data:m.data.map(function(y){return y.slice()}),index:0})))}if(u==null&&(u={data:[],index:0}),h===null&&(h=Sf(),at.updateQueue=h),h.memoCache=u,h=u.data[u.index],h===void 0)for(h=u.data[u.index]=Array(o),m=0;m<o;m++)h[m]=T;return u.index++,h}function Pa(o,u){return typeof u=="function"?u(o):u}function Cf(o){var u=sn();return nm(u,Tt,o)}function nm(o,u,h){var m=o.queue;if(m===null)throw Error(n(311));m.lastRenderedReducer=h;var y=o.baseQueue,E=m.pending;if(E!==null){if(y!==null){var k=y.next;y.next=E.next,E.next=k}u.baseQueue=y=E,m.pending=null}if(E=o.baseState,y===null)o.memoizedState=E;else{u=y.next;var z=k=null,H=null,J=u,he=!1;do{var ye=J.lane&-536870913;if(ye!==J.lane?(pt&ye)===ye:(Ci&ye)===ye){var ie=J.revertLane;if(ie===0)H!==null&&(H=H.next={lane:0,revertLane:0,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null}),ye===Fs&&(he=!0);else if((Ci&ie)===ie){J=J.next,ie===Fs&&(he=!0);continue}else ye={lane:0,revertLane:J.revertLane,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null},H===null?(z=H=ye,k=E):H=H.next=ye,at.lanes|=ie,Mi|=ie;ye=J.action,So&&h(E,ye),E=J.hasEagerState?J.eagerState:h(E,ye)}else ie={lane:ye,revertLane:J.revertLane,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null},H===null?(z=H=ie,k=E):H=H.next=ie,at.lanes|=ye,Mi|=ye;J=J.next}while(J!==null&&J!==u);if(H===null?k=E:H.next=z,!mr(E,o.memoizedState)&&(Tn=!0,he&&(h=Bs,h!==null)))throw h;o.memoizedState=E,o.baseState=k,o.baseQueue=H,m.lastRenderedState=E}return y===null&&(m.lanes=0),[o.memoizedState,m.dispatch]}function rm(o){var u=sn(),h=u.queue;if(h===null)throw Error(n(311));h.lastRenderedReducer=o;var m=h.dispatch,y=h.pending,E=u.memoizedState;if(y!==null){h.pending=null;var k=y=y.next;do E=o(E,k.action),k=k.next;while(k!==y);mr(E,u.memoizedState)||(Tn=!0),u.memoizedState=E,u.baseQueue===null&&(u.baseState=E),h.lastRenderedState=E}return[E,m]}function Jw(o,u,h){var m=at,y=sn(),E=vt;if(E){if(h===void 0)throw Error(n(407));h=h()}else h=u();var k=!mr((Tt||y).memoizedState,h);if(k&&(y.memoizedState=h,Tn=!0),y=y.queue,om(n1.bind(null,m,y,o),[o]),y.getSnapshot!==u||k||on!==null&&on.memoizedState.tag&1){if(m.flags|=2048,Vs(9,t1.bind(null,m,y,h,u),{destroy:void 0},null),Dt===null)throw Error(n(349));E||(Ci&60)!==0||e1(m,u,h)}return h}function e1(o,u,h){o.flags|=16384,o={getSnapshot:u,value:h},u=at.updateQueue,u===null?(u=Sf(),at.updateQueue=u,u.stores=[o]):(h=u.stores,h===null?u.stores=[o]:h.push(o))}function t1(o,u,h,m){u.value=h,u.getSnapshot=m,r1(u)&&a1(o)}function n1(o,u,h){return h(function(){r1(u)&&a1(o)})}function r1(o){var u=o.getSnapshot;o=o.value;try{var h=u();return!mr(o,h)}catch{return!0}}function a1(o){var u=xi(o,2);u!==null&&Kn(u,o,2)}function am(o){var u=or();if(typeof o=="function"){var h=o;if(o=h(),So){nr(!0);try{h()}finally{nr(!1)}}}return u.memoizedState=u.baseState=o,u.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Pa,lastRenderedState:o},u}function i1(o,u,h,m){return o.baseState=h,nm(o,Tt,typeof m=="function"?m:Pa)}function SD(o,u,h,m,y){if(Nf(o))throw Error(n(485));if(o=u.action,o!==null){var E={payload:y,action:o,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(k){E.listeners.push(k)}};I.T!==null?h(!0):E.isTransition=!1,m(E),h=u.pending,h===null?(E.next=u.pending=E,o1(u,E)):(E.next=h.next,u.pending=h.next=E)}}function o1(o,u){var h=u.action,m=u.payload,y=o.state;if(u.isTransition){var E=I.T,k={};I.T=k;try{var z=h(y,m),H=I.S;H!==null&&H(k,z),s1(o,u,z)}catch(J){im(o,u,J)}finally{I.T=E}}else try{E=h(y,m),s1(o,u,E)}catch(J){im(o,u,J)}}function s1(o,u,h){h!==null&&typeof h=="object"&&typeof h.then=="function"?h.then(function(m){u1(o,u,m)},function(m){return im(o,u,m)}):u1(o,u,h)}function u1(o,u,h){u.status="fulfilled",u.value=h,l1(u),o.state=h,u=o.pending,u!==null&&(h=u.next,h===u?o.pending=null:(h=h.next,u.next=h,o1(o,h)))}function im(o,u,h){var m=o.pending;if(o.pending=null,m!==null){m=m.next;do u.status="rejected",u.reason=h,l1(u),u=u.next;while(u!==m)}o.action=null}function l1(o){o=o.listeners;for(var u=0;u<o.length;u++)(0,o[u])()}function c1(o,u){return u}function f1(o,u){if(vt){var h=Dt.formState;if(h!==null){e:{var m=at;if(vt){if(_n){t:{for(var y=_n,E=ga;y.nodeType!==8;){if(!E){y=null;break t}if(y=Qr(y.nextSibling),y===null){y=null;break t}}E=y.data,y=E==="F!"||E==="F"?y:null}if(y){_n=Qr(y.nextSibling),m=y.data==="F!";break e}}bo(m)}m=!1}m&&(u=h[0])}}return h=or(),h.memoizedState=h.baseState=u,m={pending:null,lanes:0,dispatch:null,lastRenderedReducer:c1,lastRenderedState:u},h.queue=m,h=I1.bind(null,at,m),m.dispatch=h,m=am(!1),E=fm.bind(null,at,!1,m.queue),m=or(),y={state:u,dispatch:null,action:o,pending:null},m.queue=y,h=SD.bind(null,at,y,E,h),y.dispatch=h,m.memoizedState=o,[u,h,!1]}function h1(o){var u=sn();return d1(u,Tt,o)}function d1(o,u,h){u=nm(o,u,c1)[0],o=Cf(Pa)[0],u=typeof u=="object"&&u!==null&&typeof u.then=="function"?hl(u):u;var m=sn(),y=m.queue,E=y.dispatch;return h!==m.memoizedState&&(at.flags|=2048,Vs(9,ED.bind(null,y,h),{destroy:void 0},null)),[u,E,o]}function ED(o,u){o.action=u}function p1(o){var u=sn(),h=Tt;if(h!==null)return d1(u,h,o);sn(),u=u.memoizedState,h=sn();var m=h.queue.dispatch;return h.memoizedState=o,[u,m,!1]}function Vs(o,u,h,m){return o={tag:o,create:u,inst:h,deps:m,next:null},u=at.updateQueue,u===null&&(u=Sf(),at.updateQueue=u),h=u.lastEffect,h===null?u.lastEffect=o.next=o:(m=h.next,h.next=o,o.next=m,u.lastEffect=o),o}function m1(){return sn().memoizedState}function Af(o,u,h,m){var y=or();at.flags|=o,y.memoizedState=Vs(1|u,h,{destroy:void 0},m===void 0?null:m)}function Tf(o,u,h,m){var y=sn();m=m===void 0?null:m;var E=y.memoizedState.inst;Tt!==null&&m!==null&&Yp(m,Tt.memoizedState.deps)?y.memoizedState=Vs(u,h,E,m):(at.flags|=o,y.memoizedState=Vs(1|u,h,E,m))}function g1(o,u){Af(8390656,8,o,u)}function om(o,u){Tf(2048,8,o,u)}function v1(o,u){return Tf(4,2,o,u)}function y1(o,u){return Tf(4,4,o,u)}function b1(o,u){if(typeof u=="function"){o=o();var h=u(o);return function(){typeof h=="function"?h():u(null)}}if(u!=null)return o=o(),u.current=o,function(){u.current=null}}function w1(o,u,h){h=h!=null?h.concat([o]):null,Tf(4,4,b1.bind(null,u,o),h)}function sm(){}function x1(o,u){var h=sn();u=u===void 0?null:u;var m=h.memoizedState;return u!==null&&Yp(u,m[1])?m[0]:(h.memoizedState=[o,u],o)}function S1(o,u){var h=sn();u=u===void 0?null:u;var m=h.memoizedState;if(u!==null&&Yp(u,m[1]))return m[0];if(m=o(),So){nr(!0);try{o()}finally{nr(!1)}}return h.memoizedState=[m,u],m}function um(o,u,h){return h===void 0||(Ci&1073741824)!==0?o.memoizedState=u:(o.memoizedState=h,o=Cx(),at.lanes|=o,Mi|=o,h)}function E1(o,u,h,m){return mr(h,u)?h:Ls.current!==null?(o=um(o,h,m),mr(o,u)||(Tn=!0),o):(Ci&42)===0?(Tn=!0,o.memoizedState=h):(o=Cx(),at.lanes|=o,Mi|=o,u)}function C1(o,u,h,m,y){var E=de.p;de.p=E!==0&&8>E?E:8;var k=I.T,z={};I.T=z,fm(o,!1,u,h);try{var H=y(),J=I.S;if(J!==null&&J(z,H),H!==null&&typeof H=="object"&&typeof H.then=="function"){var he=bD(H,m);dl(o,u,he,br(o))}else dl(o,u,m,br(o))}catch(ye){dl(o,u,{then:function(){},status:"rejected",reason:ye},br())}finally{de.p=E,I.T=k}}function CD(){}function lm(o,u,h,m){if(o.tag!==5)throw Error(n(476));var y=A1(o).queue;C1(o,y,u,xe,h===null?CD:function(){return T1(o),h(m)})}function A1(o){var u=o.memoizedState;if(u!==null)return u;u={memoizedState:xe,baseState:xe,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Pa,lastRenderedState:xe},next:null};var h={};return u.next={memoizedState:h,baseState:h,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Pa,lastRenderedState:h},next:null},o.memoizedState=u,o=o.alternate,o!==null&&(o.memoizedState=u),u}function T1(o){var u=A1(o).next.queue;dl(o,u,{},br())}function cm(){return Wn(_l)}function N1(){return sn().memoizedState}function R1(){return sn().memoizedState}function AD(o){for(var u=o.return;u!==null;){switch(u.tag){case 24:case 3:var h=br();o=Ri(h);var m=Ii(u,o,h);m!==null&&(Kn(m,u,h),gl(m,u,h)),u={cache:Xp()},o.payload=u;return}u=u.return}}function TD(o,u,h){var m=br();h={lane:m,revertLane:0,action:h,hasEagerState:!1,eagerState:null,next:null},Nf(o)?k1(u,h):(h=Pp(o,u,h,m),h!==null&&(Kn(h,o,m),D1(h,u,m)))}function I1(o,u,h){var m=br();dl(o,u,h,m)}function dl(o,u,h,m){var y={lane:m,revertLane:0,action:h,hasEagerState:!1,eagerState:null,next:null};if(Nf(o))k1(u,y);else{var E=o.alternate;if(o.lanes===0&&(E===null||E.lanes===0)&&(E=u.lastRenderedReducer,E!==null))try{var k=u.lastRenderedState,z=E(k,h);if(y.hasEagerState=!0,y.eagerState=z,mr(z,k))return cf(o,u,y,0),Dt===null&&lf(),!1}catch{}finally{}if(h=Pp(o,u,y,m),h!==null)return Kn(h,o,m),D1(h,u,m),!0}return!1}function fm(o,u,h,m){if(m={lane:2,revertLane:eg(),action:m,hasEagerState:!1,eagerState:null,next:null},Nf(o)){if(u)throw Error(n(479))}else u=Pp(o,h,m,2),u!==null&&Kn(u,o,2)}function Nf(o){var u=o.alternate;return o===at||u!==null&&u===at}function k1(o,u){Us=wf=!0;var h=o.pending;h===null?u.next=u:(u.next=h.next,h.next=u),o.pending=u}function D1(o,u,h){if((h&4194176)!==0){var m=u.lanes;m&=o.pendingLanes,h|=m,u.lanes=h,j0(o,h)}}var ya={readContext:Wn,use:Ef,useCallback:nn,useContext:nn,useEffect:nn,useImperativeHandle:nn,useLayoutEffect:nn,useInsertionEffect:nn,useMemo:nn,useReducer:nn,useRef:nn,useState:nn,useDebugValue:nn,useDeferredValue:nn,useTransition:nn,useSyncExternalStore:nn,useId:nn};ya.useCacheRefresh=nn,ya.useMemoCache=nn,ya.useHostTransitionStatus=nn,ya.useFormState=nn,ya.useActionState=nn,ya.useOptimistic=nn;var Eo={readContext:Wn,use:Ef,useCallback:function(o,u){return or().memoizedState=[o,u===void 0?null:u],o},useContext:Wn,useEffect:g1,useImperativeHandle:function(o,u,h){h=h!=null?h.concat([o]):null,Af(4194308,4,b1.bind(null,u,o),h)},useLayoutEffect:function(o,u){return Af(4194308,4,o,u)},useInsertionEffect:function(o,u){Af(4,2,o,u)},useMemo:function(o,u){var h=or();u=u===void 0?null:u;var m=o();if(So){nr(!0);try{o()}finally{nr(!1)}}return h.memoizedState=[m,u],m},useReducer:function(o,u,h){var m=or();if(h!==void 0){var y=h(u);if(So){nr(!0);try{h(u)}finally{nr(!1)}}}else y=u;return m.memoizedState=m.baseState=y,o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:o,lastRenderedState:y},m.queue=o,o=o.dispatch=TD.bind(null,at,o),[m.memoizedState,o]},useRef:function(o){var u=or();return o={current:o},u.memoizedState=o},useState:function(o){o=am(o);var u=o.queue,h=I1.bind(null,at,u);return u.dispatch=h,[o.memoizedState,h]},useDebugValue:sm,useDeferredValue:function(o,u){var h=or();return um(h,o,u)},useTransition:function(){var o=am(!1);return o=C1.bind(null,at,o.queue,!0,!1),or().memoizedState=o,[!1,o]},useSyncExternalStore:function(o,u,h){var m=at,y=or();if(vt){if(h===void 0)throw Error(n(407));h=h()}else{if(h=u(),Dt===null)throw Error(n(349));(pt&60)!==0||e1(m,u,h)}y.memoizedState=h;var E={value:h,getSnapshot:u};return y.queue=E,g1(n1.bind(null,m,E,o),[o]),m.flags|=2048,Vs(9,t1.bind(null,m,E,h,u),{destroy:void 0},null),h},useId:function(){var o=or(),u=Dt.identifierPrefix;if(vt){var h=Ba,m=Fa;h=(m&~(1<<32-vn(m)-1)).toString(32)+h,u=":"+u+"R"+h,h=xf++,0<h&&(u+="H"+h.toString(32)),u+=":"}else h=wD++,u=":"+u+"r"+h.toString(32)+":";return o.memoizedState=u},useCacheRefresh:function(){return or().memoizedState=AD.bind(null,at)}};Eo.useMemoCache=tm,Eo.useHostTransitionStatus=cm,Eo.useFormState=f1,Eo.useActionState=f1,Eo.useOptimistic=function(o){var u=or();u.memoizedState=u.baseState=o;var h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return u.queue=h,u=fm.bind(null,at,!0,h),h.dispatch=u,[o,u]};var Ai={readContext:Wn,use:Ef,useCallback:x1,useContext:Wn,useEffect:om,useImperativeHandle:w1,useInsertionEffect:v1,useLayoutEffect:y1,useMemo:S1,useReducer:Cf,useRef:m1,useState:function(){return Cf(Pa)},useDebugValue:sm,useDeferredValue:function(o,u){var h=sn();return E1(h,Tt.memoizedState,o,u)},useTransition:function(){var o=Cf(Pa)[0],u=sn().memoizedState;return[typeof o=="boolean"?o:hl(o),u]},useSyncExternalStore:Jw,useId:N1};Ai.useCacheRefresh=R1,Ai.useMemoCache=tm,Ai.useHostTransitionStatus=cm,Ai.useFormState=h1,Ai.useActionState=h1,Ai.useOptimistic=function(o,u){var h=sn();return i1(h,Tt,o,u)};var Co={readContext:Wn,use:Ef,useCallback:x1,useContext:Wn,useEffect:om,useImperativeHandle:w1,useInsertionEffect:v1,useLayoutEffect:y1,useMemo:S1,useReducer:rm,useRef:m1,useState:function(){return rm(Pa)},useDebugValue:sm,useDeferredValue:function(o,u){var h=sn();return Tt===null?um(h,o,u):E1(h,Tt.memoizedState,o,u)},useTransition:function(){var o=rm(Pa)[0],u=sn().memoizedState;return[typeof o=="boolean"?o:hl(o),u]},useSyncExternalStore:Jw,useId:N1};Co.useCacheRefresh=R1,Co.useMemoCache=tm,Co.useHostTransitionStatus=cm,Co.useFormState=p1,Co.useActionState=p1,Co.useOptimistic=function(o,u){var h=sn();return Tt!==null?i1(h,Tt,o,u):(h.baseState=o,[o,h.queue.dispatch])};function hm(o,u,h,m){u=o.memoizedState,h=h(m,u),h=h==null?u:_({},u,h),o.memoizedState=h,o.lanes===0&&(o.updateQueue.baseState=h)}var dm={isMounted:function(o){return(o=o._reactInternals)?q(o)===o:!1},enqueueSetState:function(o,u,h){o=o._reactInternals;var m=br(),y=Ri(m);y.payload=u,h!=null&&(y.callback=h),u=Ii(o,y,m),u!==null&&(Kn(u,o,m),gl(u,o,m))},enqueueReplaceState:function(o,u,h){o=o._reactInternals;var m=br(),y=Ri(m);y.tag=1,y.payload=u,h!=null&&(y.callback=h),u=Ii(o,y,m),u!==null&&(Kn(u,o,m),gl(u,o,m))},enqueueForceUpdate:function(o,u){o=o._reactInternals;var h=br(),m=Ri(h);m.tag=2,u!=null&&(m.callback=u),u=Ii(o,m,h),u!==null&&(Kn(u,o,h),gl(u,o,h))}};function O1(o,u,h,m,y,E,k){return o=o.stateNode,typeof o.shouldComponentUpdate=="function"?o.shouldComponentUpdate(m,E,k):u.prototype&&u.prototype.isPureReactComponent?!el(h,m)||!el(y,E):!0}function _1(o,u,h,m){o=u.state,typeof u.componentWillReceiveProps=="function"&&u.componentWillReceiveProps(h,m),typeof u.UNSAFE_componentWillReceiveProps=="function"&&u.UNSAFE_componentWillReceiveProps(h,m),u.state!==o&&dm.enqueueReplaceState(u,u.state,null)}function Ao(o,u){var h=u;if("ref"in u){h={};for(var m in u)m!=="ref"&&(h[m]=u[m])}if(o=o.defaultProps){h===u&&(h=_({},h));for(var y in o)h[y]===void 0&&(h[y]=o[y])}return h}var Rf=typeof reportError=="function"?reportError:function(o){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var u=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof o=="object"&&o!==null&&typeof o.message=="string"?String(o.message):String(o),error:o});if(!window.dispatchEvent(u))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",o);return}console.error(o)};function M1(o){Rf(o)}function z1(o){console.error(o)}function L1(o){Rf(o)}function If(o,u){try{var h=o.onUncaughtError;h(u.value,{componentStack:u.stack})}catch(m){setTimeout(function(){throw m})}}function F1(o,u,h){try{var m=o.onCaughtError;m(h.value,{componentStack:h.stack,errorBoundary:u.tag===1?u.stateNode:null})}catch(y){setTimeout(function(){throw y})}}function pm(o,u,h){return h=Ri(h),h.tag=3,h.payload={element:null},h.callback=function(){If(o,u)},h}function B1(o){return o=Ri(o),o.tag=3,o}function U1(o,u,h,m){var y=h.type.getDerivedStateFromError;if(typeof y=="function"){var E=m.value;o.payload=function(){return y(E)},o.callback=function(){F1(u,h,m)}}var k=h.stateNode;k!==null&&typeof k.componentDidCatch=="function"&&(o.callback=function(){F1(u,h,m),typeof y!="function"&&(zi===null?zi=new Set([this]):zi.add(this));var z=m.stack;this.componentDidCatch(m.value,{componentStack:z!==null?z:""})})}function ND(o,u,h,m,y){if(h.flags|=32768,m!==null&&typeof m=="object"&&typeof m.then=="function"){if(u=h.alternate,u!==null&&ml(u,h,y,!0),h=Ur.current,h!==null){switch(h.tag){case 13:return va===null?Km():h.alternate===null&&Kt===0&&(Kt=3),h.flags&=-257,h.flags|=65536,h.lanes=y,m===Hp?h.flags|=16384:(u=h.updateQueue,u===null?h.updateQueue=new Set([m]):u.add(m),Zm(o,m,y)),!1;case 22:return h.flags|=65536,m===Hp?h.flags|=16384:(u=h.updateQueue,u===null?(u={transitions:null,markerInstances:null,retryQueue:new Set([m])},h.updateQueue=u):(h=u.retryQueue,h===null?u.retryQueue=new Set([m]):h.add(m)),Zm(o,m,y)),!1}throw Error(n(435,h.tag))}return Zm(o,m,y),Km(),!1}if(vt)return u=Ur.current,u!==null?((u.flags&65536)===0&&(u.flags|=256),u.flags|=65536,u.lanes=y,m!==Wp&&(o=Error(n(422),{cause:m}),al(Lr(o,h)))):(m!==Wp&&(u=Error(n(423),{cause:m}),al(Lr(u,h))),o=o.current.alternate,o.flags|=65536,y&=-y,o.lanes|=y,m=Lr(m,h),y=pm(o.stateNode,m,y),Im(o,y),Kt!==4&&(Kt=2)),!1;var E=Error(n(520),{cause:m});if(E=Lr(E,h),Cl===null?Cl=[E]:Cl.push(E),Kt!==4&&(Kt=2),u===null)return!0;m=Lr(m,h),h=u;do{switch(h.tag){case 3:return h.flags|=65536,o=y&-y,h.lanes|=o,o=pm(h.stateNode,m,o),Im(h,o),!1;case 1:if(u=h.type,E=h.stateNode,(h.flags&128)===0&&(typeof u.getDerivedStateFromError=="function"||E!==null&&typeof E.componentDidCatch=="function"&&(zi===null||!zi.has(E))))return h.flags|=65536,y&=-y,h.lanes|=y,y=B1(y),U1(y,o,h,m),Im(h,y),!1}h=h.return}while(h!==null);return!1}var P1=Error(n(461)),Tn=!1;function Mn(o,u,h,m){u.child=o===null?qw(u,null,h,m):wo(u,o.child,h,m)}function V1(o,u,h,m,y){h=h.render;var E=u.ref;if("ref"in m){var k={};for(var z in m)z!=="ref"&&(k[z]=m[z])}else k=m;return No(u),m=Zp(o,u,h,k,E,y),z=Qp(),o!==null&&!Tn?(Jp(o,u,y),Va(o,u,y)):(vt&&z&&Vp(u),u.flags|=1,Mn(o,u,m,y),u.child)}function j1(o,u,h,m,y){if(o===null){var E=h.type;return typeof E=="function"&&!Fm(E)&&E.defaultProps===void 0&&h.compare===null?(u.tag=15,u.type=E,W1(o,u,E,m,y)):(o=Mf(h.type,null,m,u,u.mode,y),o.ref=u.ref,o.return=u,u.child=o)}if(E=o.child,!Em(o,y)){var k=E.memoizedProps;if(h=h.compare,h=h!==null?h:el,h(k,m)&&o.ref===u.ref)return Va(o,u,y)}return u.flags|=1,o=_i(E,m),o.ref=u.ref,o.return=u,u.child=o}function W1(o,u,h,m,y){if(o!==null){var E=o.memoizedProps;if(el(E,m)&&o.ref===u.ref)if(Tn=!1,u.pendingProps=m=E,Em(o,y))(o.flags&131072)!==0&&(Tn=!0);else return u.lanes=o.lanes,Va(o,u,y)}return mm(o,u,h,m,y)}function H1(o,u,h){var m=u.pendingProps,y=m.children,E=(u.stateNode._pendingVisibility&2)!==0,k=o!==null?o.memoizedState:null;if(pl(o,u),m.mode==="hidden"||E){if((u.flags&128)!==0){if(m=k!==null?k.baseLanes|h:h,o!==null){for(y=u.child=o.child,E=0;y!==null;)E=E|y.lanes|y.childLanes,y=y.sibling;u.childLanes=E&~m}else u.childLanes=0,u.child=null;return q1(o,u,m,h)}if((h&536870912)!==0)u.memoizedState={baseLanes:0,cachePool:null},o!==null&&bf(u,k!==null?k.cachePool:null),k!==null?Gw(u,k):qp(),Xw(u);else return u.lanes=u.childLanes=536870912,q1(o,u,k!==null?k.baseLanes|h:h,h)}else k!==null?(bf(u,k.cachePool),Gw(u,k),Ei(),u.memoizedState=null):(o!==null&&bf(u,null),qp(),Ei());return Mn(o,u,y,h),u.child}function q1(o,u,h,m){var y=Kp();return y=y===null?null:{parent:wn._currentValue,pool:y},u.memoizedState={baseLanes:h,cachePool:y},o!==null&&bf(u,null),qp(),Xw(u),o!==null&&ml(o,u,m,!0),null}function pl(o,u){var h=u.ref;if(h===null)o!==null&&o.ref!==null&&(u.flags|=2097664);else{if(typeof h!="function"&&typeof h!="object")throw Error(n(284));(o===null||o.ref!==h)&&(u.flags|=2097664)}}function mm(o,u,h,m,y){return No(u),h=Zp(o,u,h,m,void 0,y),m=Qp(),o!==null&&!Tn?(Jp(o,u,y),Va(o,u,y)):(vt&&m&&Vp(u),u.flags|=1,Mn(o,u,h,y),u.child)}function G1(o,u,h,m,y,E){return No(u),u.updateQueue=null,h=Qw(u,m,h,y),Zw(o),m=Qp(),o!==null&&!Tn?(Jp(o,u,E),Va(o,u,E)):(vt&&m&&Vp(u),u.flags|=1,Mn(o,u,h,E),u.child)}function X1(o,u,h,m,y){if(No(u),u.stateNode===null){var E=Os,k=h.contextType;typeof k=="object"&&k!==null&&(E=Wn(k)),E=new h(m,E),u.memoizedState=E.state!==null&&E.state!==void 0?E.state:null,E.updater=dm,u.stateNode=E,E._reactInternals=u,E=u.stateNode,E.props=m,E.state=u.memoizedState,E.refs={},Nm(u),k=h.contextType,E.context=typeof k=="object"&&k!==null?Wn(k):Os,E.state=u.memoizedState,k=h.getDerivedStateFromProps,typeof k=="function"&&(hm(u,h,k,m),E.state=u.memoizedState),typeof h.getDerivedStateFromProps=="function"||typeof E.getSnapshotBeforeUpdate=="function"||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(k=E.state,typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount(),k!==E.state&&dm.enqueueReplaceState(E,E.state,null),yl(u,m,E,y),vl(),E.state=u.memoizedState),typeof E.componentDidMount=="function"&&(u.flags|=4194308),m=!0}else if(o===null){E=u.stateNode;var z=u.memoizedProps,H=Ao(h,z);E.props=H;var J=E.context,he=h.contextType;k=Os,typeof he=="object"&&he!==null&&(k=Wn(he));var ye=h.getDerivedStateFromProps;he=typeof ye=="function"||typeof E.getSnapshotBeforeUpdate=="function",z=u.pendingProps!==z,he||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(z||J!==k)&&_1(u,E,m,k),Ni=!1;var ie=u.memoizedState;E.state=ie,yl(u,m,E,y),vl(),J=u.memoizedState,z||ie!==J||Ni?(typeof ye=="function"&&(hm(u,h,ye,m),J=u.memoizedState),(H=Ni||O1(u,h,H,m,ie,J,k))?(he||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount()),typeof E.componentDidMount=="function"&&(u.flags|=4194308)):(typeof E.componentDidMount=="function"&&(u.flags|=4194308),u.memoizedProps=m,u.memoizedState=J),E.props=m,E.state=J,E.context=k,m=H):(typeof E.componentDidMount=="function"&&(u.flags|=4194308),m=!1)}else{E=u.stateNode,Rm(o,u),k=u.memoizedProps,he=Ao(h,k),E.props=he,ye=u.pendingProps,ie=E.context,J=h.contextType,H=Os,typeof J=="object"&&J!==null&&(H=Wn(J)),z=h.getDerivedStateFromProps,(J=typeof z=="function"||typeof E.getSnapshotBeforeUpdate=="function")||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(k!==ye||ie!==H)&&_1(u,E,m,H),Ni=!1,ie=u.memoizedState,E.state=ie,yl(u,m,E,y),vl();var fe=u.memoizedState;k!==ye||ie!==fe||Ni||o!==null&&o.dependencies!==null&&kf(o.dependencies)?(typeof z=="function"&&(hm(u,h,z,m),fe=u.memoizedState),(he=Ni||O1(u,h,he,m,ie,fe,H)||o!==null&&o.dependencies!==null&&kf(o.dependencies))?(J||typeof E.UNSAFE_componentWillUpdate!="function"&&typeof E.componentWillUpdate!="function"||(typeof E.componentWillUpdate=="function"&&E.componentWillUpdate(m,fe,H),typeof E.UNSAFE_componentWillUpdate=="function"&&E.UNSAFE_componentWillUpdate(m,fe,H)),typeof E.componentDidUpdate=="function"&&(u.flags|=4),typeof E.getSnapshotBeforeUpdate=="function"&&(u.flags|=1024)):(typeof E.componentDidUpdate!="function"||k===o.memoizedProps&&ie===o.memoizedState||(u.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||k===o.memoizedProps&&ie===o.memoizedState||(u.flags|=1024),u.memoizedProps=m,u.memoizedState=fe),E.props=m,E.state=fe,E.context=H,m=he):(typeof E.componentDidUpdate!="function"||k===o.memoizedProps&&ie===o.memoizedState||(u.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||k===o.memoizedProps&&ie===o.memoizedState||(u.flags|=1024),m=!1)}return E=m,pl(o,u),m=(u.flags&128)!==0,E||m?(E=u.stateNode,h=m&&typeof h.getDerivedStateFromError!="function"?null:E.render(),u.flags|=1,o!==null&&m?(u.child=wo(u,o.child,null,y),u.child=wo(u,null,h,y)):Mn(o,u,h,y),u.memoizedState=E.state,o=u.child):o=Va(o,u,y),o}function $1(o,u,h,m){return rl(),u.flags|=256,Mn(o,u,h,m),u.child}var gm={dehydrated:null,treeContext:null,retryLane:0};function vm(o){return{baseLanes:o,cachePool:Yw()}}function ym(o,u,h){return o=o!==null?o.childLanes&~h:0,u&&(o|=Wr),o}function K1(o,u,h){var m=u.pendingProps,y=!1,E=(u.flags&128)!==0,k;if((k=E)||(k=o!==null&&o.memoizedState===null?!1:(bn.current&2)!==0),k&&(y=!0,u.flags&=-129),k=(u.flags&32)!==0,u.flags&=-33,o===null){if(vt){if(y?Si(u):Ei(),vt){var z=_n,H;if(H=z){e:{for(H=z,z=ga;H.nodeType!==8;){if(!z){z=null;break e}if(H=Qr(H.nextSibling),H===null){z=null;break e}}z=H}z!==null?(u.memoizedState={dehydrated:z,treeContext:vo!==null?{id:Fa,overflow:Ba}:null,retryLane:536870912},H=jr(18,null,null,0),H.stateNode=z,H.return=u,u.child=H,$n=u,_n=null,H=!0):H=!1}H||bo(u)}if(z=u.memoizedState,z!==null&&(z=z.dehydrated,z!==null))return z.data==="$!"?u.lanes=16:u.lanes=536870912,null;Ua(u)}return z=m.children,m=m.fallback,y?(Ei(),y=u.mode,z=wm({mode:"hidden",children:z},y),m=Io(m,y,h,null),z.return=u,m.return=u,z.sibling=m,u.child=z,y=u.child,y.memoizedState=vm(h),y.childLanes=ym(o,k,h),u.memoizedState=gm,m):(Si(u),bm(u,z))}if(H=o.memoizedState,H!==null&&(z=H.dehydrated,z!==null)){if(E)u.flags&256?(Si(u),u.flags&=-257,u=xm(o,u,h)):u.memoizedState!==null?(Ei(),u.child=o.child,u.flags|=128,u=null):(Ei(),y=m.fallback,z=u.mode,m=wm({mode:"visible",children:m.children},z),y=Io(y,z,h,null),y.flags|=2,m.return=u,y.return=u,m.sibling=y,u.child=m,wo(u,o.child,null,h),m=u.child,m.memoizedState=vm(h),m.childLanes=ym(o,k,h),u.memoizedState=gm,u=y);else if(Si(u),z.data==="$!"){if(k=z.nextSibling&&z.nextSibling.dataset,k)var J=k.dgst;k=J,m=Error(n(419)),m.stack="",m.digest=k,al({value:m,source:null,stack:null}),u=xm(o,u,h)}else if(Tn||ml(o,u,h,!1),k=(h&o.childLanes)!==0,Tn||k){if(k=Dt,k!==null){if(m=h&-h,(m&42)!==0)m=1;else switch(m){case 2:m=1;break;case 8:m=4;break;case 32:m=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:m=64;break;case 268435456:m=134217728;break;default:m=0}if(m=(m&(k.suspendedLanes|h))!==0?0:m,m!==0&&m!==H.retryLane)throw H.retryLane=m,xi(o,m),Kn(k,o,m),P1}z.data==="$?"||Km(),u=xm(o,u,h)}else z.data==="$?"?(u.flags|=128,u.child=o.child,u=jD.bind(null,o),z._reactRetry=u,u=null):(o=H.treeContext,_n=Qr(z.nextSibling),$n=u,vt=!0,Yr=null,ga=!1,o!==null&&(Fr[Br++]=Fa,Fr[Br++]=Ba,Fr[Br++]=vo,Fa=o.id,Ba=o.overflow,vo=u),u=bm(u,m.children),u.flags|=4096);return u}return y?(Ei(),y=m.fallback,z=u.mode,H=o.child,J=H.sibling,m=_i(H,{mode:"hidden",children:m.children}),m.subtreeFlags=H.subtreeFlags&31457280,J!==null?y=_i(J,y):(y=Io(y,z,h,null),y.flags|=2),y.return=u,m.return=u,m.sibling=y,u.child=m,m=y,y=u.child,z=o.child.memoizedState,z===null?z=vm(h):(H=z.cachePool,H!==null?(J=wn._currentValue,H=H.parent!==J?{parent:J,pool:J}:H):H=Yw(),z={baseLanes:z.baseLanes|h,cachePool:H}),y.memoizedState=z,y.childLanes=ym(o,k,h),u.memoizedState=gm,m):(Si(u),h=o.child,o=h.sibling,h=_i(h,{mode:"visible",children:m.children}),h.return=u,h.sibling=null,o!==null&&(k=u.deletions,k===null?(u.deletions=[o],u.flags|=16):k.push(o)),u.child=h,u.memoizedState=null,h)}function bm(o,u){return u=wm({mode:"visible",children:u},o.mode),u.return=o,o.child=u}function wm(o,u){return xx(o,u,0,null)}function xm(o,u,h){return wo(u,o.child,null,h),o=bm(u,u.pendingProps.children),o.flags|=2,u.memoizedState=null,o}function Y1(o,u,h){o.lanes|=u;var m=o.alternate;m!==null&&(m.lanes|=u),Am(o.return,u,h)}function Sm(o,u,h,m,y){var E=o.memoizedState;E===null?o.memoizedState={isBackwards:u,rendering:null,renderingStartTime:0,last:m,tail:h,tailMode:y}:(E.isBackwards=u,E.rendering=null,E.renderingStartTime=0,E.last=m,E.tail=h,E.tailMode=y)}function Z1(o,u,h){var m=u.pendingProps,y=m.revealOrder,E=m.tail;if(Mn(o,u,m.children,h),m=bn.current,(m&2)!==0)m=m&1|2,u.flags|=128;else{if(o!==null&&(o.flags&128)!==0)e:for(o=u.child;o!==null;){if(o.tag===13)o.memoizedState!==null&&Y1(o,h,u);else if(o.tag===19)Y1(o,h,u);else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===u)break e;for(;o.sibling===null;){if(o.return===null||o.return===u)break e;o=o.return}o.sibling.return=o.return,o=o.sibling}m&=1}switch(Ue(bn,m),y){case"forwards":for(h=u.child,y=null;h!==null;)o=h.alternate,o!==null&&yf(o)===null&&(y=h),h=h.sibling;h=y,h===null?(y=u.child,u.child=null):(y=h.sibling,h.sibling=null),Sm(u,!1,y,h,E);break;case"backwards":for(h=null,y=u.child,u.child=null;y!==null;){if(o=y.alternate,o!==null&&yf(o)===null){u.child=y;break}o=y.sibling,y.sibling=h,h=y,y=o}Sm(u,!0,h,null,E);break;case"together":Sm(u,!1,null,null,void 0);break;default:u.memoizedState=null}return u.child}function Va(o,u,h){if(o!==null&&(u.dependencies=o.dependencies),Mi|=u.lanes,(h&u.childLanes)===0)if(o!==null){if(ml(o,u,h,!1),(h&u.childLanes)===0)return null}else return null;if(o!==null&&u.child!==o.child)throw Error(n(153));if(u.child!==null){for(o=u.child,h=_i(o,o.pendingProps),u.child=h,h.return=u;o.sibling!==null;)o=o.sibling,h=h.sibling=_i(o,o.pendingProps),h.return=u;h.sibling=null}return u.child}function Em(o,u){return(o.lanes&u)!==0?!0:(o=o.dependencies,!!(o!==null&&kf(o)))}function RD(o,u,h){switch(u.tag){case 3:dt(u,u.stateNode.containerInfo),Ti(u,wn,o.memoizedState.cache),rl();break;case 27:case 5:Pt(u);break;case 4:dt(u,u.stateNode.containerInfo);break;case 10:Ti(u,u.type,u.memoizedProps.value);break;case 13:var m=u.memoizedState;if(m!==null)return m.dehydrated!==null?(Si(u),u.flags|=128,null):(h&u.child.childLanes)!==0?K1(o,u,h):(Si(u),o=Va(o,u,h),o!==null?o.sibling:null);Si(u);break;case 19:var y=(o.flags&128)!==0;if(m=(h&u.childLanes)!==0,m||(ml(o,u,h,!1),m=(h&u.childLanes)!==0),y){if(m)return Z1(o,u,h);u.flags|=128}if(y=u.memoizedState,y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),Ue(bn,bn.current),m)break;return null;case 22:case 23:return u.lanes=0,H1(o,u,h);case 24:Ti(u,wn,o.memoizedState.cache)}return Va(o,u,h)}function Q1(o,u,h){if(o!==null)if(o.memoizedProps!==u.pendingProps)Tn=!0;else{if(!Em(o,h)&&(u.flags&128)===0)return Tn=!1,RD(o,u,h);Tn=(o.flags&131072)!==0}else Tn=!1,vt&&(u.flags&1048576)!==0&&Lw(u,df,u.index);switch(u.lanes=0,u.tag){case 16:e:{o=u.pendingProps;var m=u.elementType,y=m._init;if(m=y(m._payload),u.type=m,typeof m=="function")Fm(m)?(o=Ao(m,o),u.tag=1,u=X1(null,u,m,o,h)):(u.tag=0,u=mm(null,u,m,o,h));else{if(m!=null){if(y=m.$$typeof,y===b){u.tag=11,u=V1(null,u,m,o,h);break e}else if(y===x){u.tag=14,u=j1(null,u,m,o,h);break e}}throw u=D(m)||m,Error(n(306,u,""))}}return u;case 0:return mm(o,u,u.type,u.pendingProps,h);case 1:return m=u.type,y=Ao(m,u.pendingProps),X1(o,u,m,y,h);case 3:e:{if(dt(u,u.stateNode.containerInfo),o===null)throw Error(n(387));var E=u.pendingProps;y=u.memoizedState,m=y.element,Rm(o,u),yl(u,E,null,h);var k=u.memoizedState;if(E=k.cache,Ti(u,wn,E),E!==y.cache&&Tm(u,[wn],h,!0),vl(),E=k.element,y.isDehydrated)if(y={element:E,isDehydrated:!1,cache:k.cache},u.updateQueue.baseState=y,u.memoizedState=y,u.flags&256){u=$1(o,u,E,h);break e}else if(E!==m){m=Lr(Error(n(424)),u),al(m),u=$1(o,u,E,h);break e}else for(_n=Qr(u.stateNode.containerInfo.firstChild),$n=u,vt=!0,Yr=null,ga=!0,h=qw(u,null,E,h),u.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling;else{if(rl(),E===m){u=Va(o,u,h);break e}Mn(o,u,E,h)}u=u.child}return u;case 26:return pl(o,u),o===null?(h=t2(u.type,null,u.pendingProps,null))?u.memoizedState=h:vt||(h=u.type,o=u.pendingProps,m=Gf(qe.current).createElement(h),m[jn]=u,m[ar]=o,zn(m,h,o),An(m),u.stateNode=m):u.memoizedState=t2(u.type,o.memoizedProps,u.pendingProps,o.memoizedState),null;case 27:return Pt(u),o===null&&vt&&(m=u.stateNode=Qx(u.type,u.pendingProps,qe.current),$n=u,ga=!0,_n=Qr(m.firstChild)),m=u.pendingProps.children,o!==null||vt?Mn(o,u,m,h):u.child=wo(u,null,m,h),pl(o,u),u.child;case 5:return o===null&&vt&&((y=m=_n)&&(m=aO(m,u.type,u.pendingProps,ga),m!==null?(u.stateNode=m,$n=u,_n=Qr(m.firstChild),ga=!1,y=!0):y=!1),y||bo(u)),Pt(u),y=u.type,E=u.pendingProps,k=o!==null?o.memoizedProps:null,m=E.children,lg(y,E)?m=null:k!==null&&lg(y,k)&&(u.flags|=32),u.memoizedState!==null&&(y=Zp(o,u,xD,null,null,h),_l._currentValue=y),pl(o,u),Mn(o,u,m,h),u.child;case 6:return o===null&&vt&&((o=h=_n)&&(h=iO(h,u.pendingProps,ga),h!==null?(u.stateNode=h,$n=u,_n=null,o=!0):o=!1),o||bo(u)),null;case 13:return K1(o,u,h);case 4:return dt(u,u.stateNode.containerInfo),m=u.pendingProps,o===null?u.child=wo(u,null,m,h):Mn(o,u,m,h),u.child;case 11:return V1(o,u,u.type,u.pendingProps,h);case 7:return Mn(o,u,u.pendingProps,h),u.child;case 8:return Mn(o,u,u.pendingProps.children,h),u.child;case 12:return Mn(o,u,u.pendingProps.children,h),u.child;case 10:return m=u.pendingProps,Ti(u,u.type,m.value),Mn(o,u,m.children,h),u.child;case 9:return y=u.type._context,m=u.pendingProps.children,No(u),y=Wn(y),m=m(y),u.flags|=1,Mn(o,u,m,h),u.child;case 14:return j1(o,u,u.type,u.pendingProps,h);case 15:return W1(o,u,u.type,u.pendingProps,h);case 19:return Z1(o,u,h);case 22:return H1(o,u,h);case 24:return No(u),m=Wn(wn),o===null?(y=Kp(),y===null&&(y=Dt,E=Xp(),y.pooledCache=E,E.refCount++,E!==null&&(y.pooledCacheLanes|=h),y=E),u.memoizedState={parent:m,cache:y},Nm(u),Ti(u,wn,y)):((o.lanes&h)!==0&&(Rm(o,u),yl(u,null,null,h),vl()),y=o.memoizedState,E=u.memoizedState,y.parent!==m?(y={parent:m,cache:m},u.memoizedState=y,u.lanes===0&&(u.memoizedState=u.updateQueue.baseState=y),Ti(u,wn,m)):(m=E.cache,Ti(u,wn,m),m!==y.cache&&Tm(u,[wn],h,!0))),Mn(o,u,u.pendingProps.children,h),u.child;case 29:throw u.pendingProps}throw Error(n(156,u.tag))}var Cm=Ee(null),To=null,ja=null;function Ti(o,u,h){Ue(Cm,u._currentValue),u._currentValue=h}function Wa(o){o._currentValue=Cm.current,ke(Cm)}function Am(o,u,h){for(;o!==null;){var m=o.alternate;if((o.childLanes&u)!==u?(o.childLanes|=u,m!==null&&(m.childLanes|=u)):m!==null&&(m.childLanes&u)!==u&&(m.childLanes|=u),o===h)break;o=o.return}}function Tm(o,u,h,m){var y=o.child;for(y!==null&&(y.return=o);y!==null;){var E=y.dependencies;if(E!==null){var k=y.child;E=E.firstContext;e:for(;E!==null;){var z=E;E=y;for(var H=0;H<u.length;H++)if(z.context===u[H]){E.lanes|=h,z=E.alternate,z!==null&&(z.lanes|=h),Am(E.return,h,o),m||(k=null);break e}E=z.next}}else if(y.tag===18){if(k=y.return,k===null)throw Error(n(341));k.lanes|=h,E=k.alternate,E!==null&&(E.lanes|=h),Am(k,h,o),k=null}else k=y.child;if(k!==null)k.return=y;else for(k=y;k!==null;){if(k===o){k=null;break}if(y=k.sibling,y!==null){y.return=k.return,k=y;break}k=k.return}y=k}}function ml(o,u,h,m){o=null;for(var y=u,E=!1;y!==null;){if(!E){if((y.flags&524288)!==0)E=!0;else if((y.flags&262144)!==0)break}if(y.tag===10){var k=y.alternate;if(k===null)throw Error(n(387));if(k=k.memoizedProps,k!==null){var z=y.type;mr(y.pendingProps.value,k.value)||(o!==null?o.push(z):o=[z])}}else if(y===Se.current){if(k=y.alternate,k===null)throw Error(n(387));k.memoizedState.memoizedState!==y.memoizedState.memoizedState&&(o!==null?o.push(_l):o=[_l])}y=y.return}o!==null&&Tm(u,o,h,m),u.flags|=262144}function kf(o){for(o=o.firstContext;o!==null;){if(!mr(o.context._currentValue,o.memoizedValue))return!0;o=o.next}return!1}function No(o){To=o,ja=null,o=o.dependencies,o!==null&&(o.firstContext=null)}function Wn(o){return J1(To,o)}function Df(o,u){return To===null&&No(o),J1(o,u)}function J1(o,u){var h=u._currentValue;if(u={context:u,memoizedValue:h,next:null},ja===null){if(o===null)throw Error(n(308));ja=u,o.dependencies={lanes:0,firstContext:u},o.flags|=524288}else ja=ja.next=u;return h}var Ni=!1;function Nm(o){o.updateQueue={baseState:o.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Rm(o,u){o=o.updateQueue,u.updateQueue===o&&(u.updateQueue={baseState:o.baseState,firstBaseUpdate:o.firstBaseUpdate,lastBaseUpdate:o.lastBaseUpdate,shared:o.shared,callbacks:null})}function Ri(o){return{lane:o,tag:0,payload:null,callback:null,next:null}}function Ii(o,u,h){var m=o.updateQueue;if(m===null)return null;if(m=m.shared,(Wt&2)!==0){var y=m.pending;return y===null?u.next=u:(u.next=y.next,y.next=u),m.pending=u,u=ff(o),Mw(o,null,h),u}return cf(o,m,u,h),ff(o)}function gl(o,u,h){if(u=u.updateQueue,u!==null&&(u=u.shared,(h&4194176)!==0)){var m=u.lanes;m&=o.pendingLanes,h|=m,u.lanes=h,j0(o,h)}}function Im(o,u){var h=o.updateQueue,m=o.alternate;if(m!==null&&(m=m.updateQueue,h===m)){var y=null,E=null;if(h=h.firstBaseUpdate,h!==null){do{var k={lane:h.lane,tag:h.tag,payload:h.payload,callback:null,next:null};E===null?y=E=k:E=E.next=k,h=h.next}while(h!==null);E===null?y=E=u:E=E.next=u}else y=E=u;h={baseState:m.baseState,firstBaseUpdate:y,lastBaseUpdate:E,shared:m.shared,callbacks:m.callbacks},o.updateQueue=h;return}o=h.lastBaseUpdate,o===null?h.firstBaseUpdate=u:o.next=u,h.lastBaseUpdate=u}var km=!1;function vl(){if(km){var o=Bs;if(o!==null)throw o}}function yl(o,u,h,m){km=!1;var y=o.updateQueue;Ni=!1;var E=y.firstBaseUpdate,k=y.lastBaseUpdate,z=y.shared.pending;if(z!==null){y.shared.pending=null;var H=z,J=H.next;H.next=null,k===null?E=J:k.next=J,k=H;var he=o.alternate;he!==null&&(he=he.updateQueue,z=he.lastBaseUpdate,z!==k&&(z===null?he.firstBaseUpdate=J:z.next=J,he.lastBaseUpdate=H))}if(E!==null){var ye=y.baseState;k=0,he=J=H=null,z=E;do{var ie=z.lane&-536870913,fe=ie!==z.lane;if(fe?(pt&ie)===ie:(m&ie)===ie){ie!==0&&ie===Fs&&(km=!0),he!==null&&(he=he.next={lane:0,tag:z.tag,payload:z.payload,callback:null,next:null});e:{var ze=o,Ke=z;ie=u;var Yt=h;switch(Ke.tag){case 1:if(ze=Ke.payload,typeof ze=="function"){ye=ze.call(Yt,ye,ie);break e}ye=ze;break e;case 3:ze.flags=ze.flags&-65537|128;case 0:if(ze=Ke.payload,ie=typeof ze=="function"?ze.call(Yt,ye,ie):ze,ie==null)break e;ye=_({},ye,ie);break e;case 2:Ni=!0}}ie=z.callback,ie!==null&&(o.flags|=64,fe&&(o.flags|=8192),fe=y.callbacks,fe===null?y.callbacks=[ie]:fe.push(ie))}else fe={lane:ie,tag:z.tag,payload:z.payload,callback:z.callback,next:null},he===null?(J=he=fe,H=ye):he=he.next=fe,k|=ie;if(z=z.next,z===null){if(z=y.shared.pending,z===null)break;fe=z,z=fe.next,fe.next=null,y.lastBaseUpdate=fe,y.shared.pending=null}}while(!0);he===null&&(H=ye),y.baseState=H,y.firstBaseUpdate=J,y.lastBaseUpdate=he,E===null&&(y.shared.lanes=0),Mi|=k,o.lanes=k,o.memoizedState=ye}}function ex(o,u){if(typeof o!="function")throw Error(n(191,o));o.call(u)}function tx(o,u){var h=o.callbacks;if(h!==null)for(o.callbacks=null,o=0;o<h.length;o++)ex(h[o],u)}function bl(o,u){try{var h=u.updateQueue,m=h!==null?h.lastEffect:null;if(m!==null){var y=m.next;h=y;do{if((h.tag&o)===o){m=void 0;var E=h.create,k=h.inst;m=E(),k.destroy=m}h=h.next}while(h!==y)}}catch(z){Rt(u,u.return,z)}}function ki(o,u,h){try{var m=u.updateQueue,y=m!==null?m.lastEffect:null;if(y!==null){var E=y.next;m=E;do{if((m.tag&o)===o){var k=m.inst,z=k.destroy;if(z!==void 0){k.destroy=void 0,y=u;var H=h;try{z()}catch(J){Rt(y,H,J)}}}m=m.next}while(m!==E)}}catch(J){Rt(u,u.return,J)}}function nx(o){var u=o.updateQueue;if(u!==null){var h=o.stateNode;try{tx(u,h)}catch(m){Rt(o,o.return,m)}}}function rx(o,u,h){h.props=Ao(o.type,o.memoizedProps),h.state=o.memoizedState;try{h.componentWillUnmount()}catch(m){Rt(o,u,m)}}function Ro(o,u){try{var h=o.ref;if(h!==null){var m=o.stateNode;switch(o.tag){case 26:case 27:case 5:var y=m;break;default:y=m}typeof h=="function"?o.refCleanup=h(y):h.current=y}}catch(E){Rt(o,u,E)}}function gr(o,u){var h=o.ref,m=o.refCleanup;if(h!==null)if(typeof m=="function")try{m()}catch(y){Rt(o,u,y)}finally{o.refCleanup=null,o=o.alternate,o!=null&&(o.refCleanup=null)}else if(typeof h=="function")try{h(null)}catch(y){Rt(o,u,y)}else h.current=null}function ax(o){var u=o.type,h=o.memoizedProps,m=o.stateNode;try{e:switch(u){case"button":case"input":case"select":case"textarea":h.autoFocus&&m.focus();break e;case"img":h.src?m.src=h.src:h.srcSet&&(m.srcset=h.srcSet)}}catch(y){Rt(o,o.return,y)}}function ix(o,u,h){try{var m=o.stateNode;JD(m,o.type,h,u),m[ar]=u}catch(y){Rt(o,o.return,y)}}function ox(o){return o.tag===5||o.tag===3||o.tag===26||o.tag===27||o.tag===4}function Dm(o){e:for(;;){for(;o.sibling===null;){if(o.return===null||ox(o.return))return null;o=o.return}for(o.sibling.return=o.return,o=o.sibling;o.tag!==5&&o.tag!==6&&o.tag!==27&&o.tag!==18;){if(o.flags&2||o.child===null||o.tag===4)continue e;o.child.return=o,o=o.child}if(!(o.flags&2))return o.stateNode}}function Om(o,u,h){var m=o.tag;if(m===5||m===6)o=o.stateNode,u?h.nodeType===8?h.parentNode.insertBefore(o,u):h.insertBefore(o,u):(h.nodeType===8?(u=h.parentNode,u.insertBefore(o,h)):(u=h,u.appendChild(o)),h=h._reactRootContainer,h!=null||u.onclick!==null||(u.onclick=qf));else if(m!==4&&m!==27&&(o=o.child,o!==null))for(Om(o,u,h),o=o.sibling;o!==null;)Om(o,u,h),o=o.sibling}function Of(o,u,h){var m=o.tag;if(m===5||m===6)o=o.stateNode,u?h.insertBefore(o,u):h.appendChild(o);else if(m!==4&&m!==27&&(o=o.child,o!==null))for(Of(o,u,h),o=o.sibling;o!==null;)Of(o,u,h),o=o.sibling}var Ha=!1,$t=!1,_m=!1,sx=typeof WeakSet=="function"?WeakSet:Set,Nn=null,ux=!1;function ID(o,u){if(o=o.containerInfo,sg=Qf,o=Aw(o),zp(o)){if("selectionStart"in o)var h={start:o.selectionStart,end:o.selectionEnd};else e:{h=(h=o.ownerDocument)&&h.defaultView||window;var m=h.getSelection&&h.getSelection();if(m&&m.rangeCount!==0){h=m.anchorNode;var y=m.anchorOffset,E=m.focusNode;m=m.focusOffset;try{h.nodeType,E.nodeType}catch{h=null;break e}var k=0,z=-1,H=-1,J=0,he=0,ye=o,ie=null;t:for(;;){for(var fe;ye!==h||y!==0&&ye.nodeType!==3||(z=k+y),ye!==E||m!==0&&ye.nodeType!==3||(H=k+m),ye.nodeType===3&&(k+=ye.nodeValue.length),(fe=ye.firstChild)!==null;)ie=ye,ye=fe;for(;;){if(ye===o)break t;if(ie===h&&++J===y&&(z=k),ie===E&&++he===m&&(H=k),(fe=ye.nextSibling)!==null)break;ye=ie,ie=ye.parentNode}ye=fe}h=z===-1||H===-1?null:{start:z,end:H}}else h=null}h=h||{start:0,end:0}}else h=null;for(ug={focusedElem:o,selectionRange:h},Qf=!1,Nn=u;Nn!==null;)if(u=Nn,o=u.child,(u.subtreeFlags&1028)!==0&&o!==null)o.return=u,Nn=o;else for(;Nn!==null;){switch(u=Nn,E=u.alternate,o=u.flags,u.tag){case 0:break;case 11:case 15:break;case 1:if((o&1024)!==0&&E!==null){o=void 0,h=u,y=E.memoizedProps,E=E.memoizedState,m=h.stateNode;try{var ze=Ao(h.type,y,h.elementType===h.type);o=m.getSnapshotBeforeUpdate(ze,E),m.__reactInternalSnapshotBeforeUpdate=o}catch(Ke){Rt(h,h.return,Ke)}}break;case 3:if((o&1024)!==0){if(o=u.stateNode.containerInfo,h=o.nodeType,h===9)hg(o);else if(h===1)switch(o.nodeName){case"HEAD":case"HTML":case"BODY":hg(o);break;default:o.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((o&1024)!==0)throw Error(n(163))}if(o=u.sibling,o!==null){o.return=u.return,Nn=o;break}Nn=u.return}return ze=ux,ux=!1,ze}function lx(o,u,h){var m=h.flags;switch(h.tag){case 0:case 11:case 15:Ga(o,h),m&4&&bl(5,h);break;case 1:if(Ga(o,h),m&4)if(o=h.stateNode,u===null)try{o.componentDidMount()}catch(z){Rt(h,h.return,z)}else{var y=Ao(h.type,u.memoizedProps);u=u.memoizedState;try{o.componentDidUpdate(y,u,o.__reactInternalSnapshotBeforeUpdate)}catch(z){Rt(h,h.return,z)}}m&64&&nx(h),m&512&&Ro(h,h.return);break;case 3:if(Ga(o,h),m&64&&(m=h.updateQueue,m!==null)){if(o=null,h.child!==null)switch(h.child.tag){case 27:case 5:o=h.child.stateNode;break;case 1:o=h.child.stateNode}try{tx(m,o)}catch(z){Rt(h,h.return,z)}}break;case 26:Ga(o,h),m&512&&Ro(h,h.return);break;case 27:case 5:Ga(o,h),u===null&&m&4&&ax(h),m&512&&Ro(h,h.return);break;case 12:Ga(o,h);break;case 13:Ga(o,h),m&4&&hx(o,h);break;case 22:if(y=h.memoizedState!==null||Ha,!y){u=u!==null&&u.memoizedState!==null||$t;var E=Ha,k=$t;Ha=y,($t=u)&&!k?Di(o,h,(h.subtreeFlags&8772)!==0):Ga(o,h),Ha=E,$t=k}m&512&&(h.memoizedProps.mode==="manual"?Ro(h,h.return):gr(h,h.return));break;default:Ga(o,h)}}function cx(o){var u=o.alternate;u!==null&&(o.alternate=null,cx(u)),o.child=null,o.deletions=null,o.sibling=null,o.tag===5&&(u=o.stateNode,u!==null&&bp(u)),o.stateNode=null,o.return=null,o.dependencies=null,o.memoizedProps=null,o.memoizedState=null,o.pendingProps=null,o.stateNode=null,o.updateQueue=null}var un=null,vr=!1;function qa(o,u,h){for(h=h.child;h!==null;)fx(o,u,h),h=h.sibling}function fx(o,u,h){if(gn&&typeof gn.onCommitFiberUnmount=="function")try{gn.onCommitFiberUnmount(Dr,h)}catch{}switch(h.tag){case 26:$t||gr(h,u),qa(o,u,h),h.memoizedState?h.memoizedState.count--:h.stateNode&&(h=h.stateNode,h.parentNode.removeChild(h));break;case 27:$t||gr(h,u);var m=un,y=vr;for(un=h.stateNode,qa(o,u,h),h=h.stateNode,u=h.attributes;u.length;)h.removeAttributeNode(u[0]);bp(h),un=m,vr=y;break;case 5:$t||gr(h,u);case 6:y=un;var E=vr;if(un=null,qa(o,u,h),un=y,vr=E,un!==null)if(vr)try{o=un,m=h.stateNode,o.nodeType===8?o.parentNode.removeChild(m):o.removeChild(m)}catch(k){Rt(h,u,k)}else try{un.removeChild(h.stateNode)}catch(k){Rt(h,u,k)}break;case 18:un!==null&&(vr?(u=un,h=h.stateNode,u.nodeType===8?fg(u.parentNode,h):u.nodeType===1&&fg(u,h),Fl(u)):fg(un,h.stateNode));break;case 4:m=un,y=vr,un=h.stateNode.containerInfo,vr=!0,qa(o,u,h),un=m,vr=y;break;case 0:case 11:case 14:case 15:$t||ki(2,h,u),$t||ki(4,h,u),qa(o,u,h);break;case 1:$t||(gr(h,u),m=h.stateNode,typeof m.componentWillUnmount=="function"&&rx(h,u,m)),qa(o,u,h);break;case 21:qa(o,u,h);break;case 22:$t||gr(h,u),$t=(m=$t)||h.memoizedState!==null,qa(o,u,h),$t=m;break;default:qa(o,u,h)}}function hx(o,u){if(u.memoizedState===null&&(o=u.alternate,o!==null&&(o=o.memoizedState,o!==null&&(o=o.dehydrated,o!==null))))try{Fl(o)}catch(h){Rt(u,u.return,h)}}function kD(o){switch(o.tag){case 13:case 19:var u=o.stateNode;return u===null&&(u=o.stateNode=new sx),u;case 22:return o=o.stateNode,u=o._retryCache,u===null&&(u=o._retryCache=new sx),u;default:throw Error(n(435,o.tag))}}function Mm(o,u){var h=kD(o);u.forEach(function(m){var y=WD.bind(null,o,m);h.has(m)||(h.add(m),m.then(y,y))})}function Pr(o,u){var h=u.deletions;if(h!==null)for(var m=0;m<h.length;m++){var y=h[m],E=o,k=u,z=k;e:for(;z!==null;){switch(z.tag){case 27:case 5:un=z.stateNode,vr=!1;break e;case 3:un=z.stateNode.containerInfo,vr=!0;break e;case 4:un=z.stateNode.containerInfo,vr=!0;break e}z=z.return}if(un===null)throw Error(n(160));fx(E,k,y),un=null,vr=!1,E=y.alternate,E!==null&&(E.return=null),y.return=null}if(u.subtreeFlags&13878)for(u=u.child;u!==null;)dx(u,o),u=u.sibling}var Zr=null;function dx(o,u){var h=o.alternate,m=o.flags;switch(o.tag){case 0:case 11:case 14:case 15:Pr(u,o),Vr(o),m&4&&(ki(3,o,o.return),bl(3,o),ki(5,o,o.return));break;case 1:Pr(u,o),Vr(o),m&512&&($t||h===null||gr(h,h.return)),m&64&&Ha&&(o=o.updateQueue,o!==null&&(m=o.callbacks,m!==null&&(h=o.shared.hiddenCallbacks,o.shared.hiddenCallbacks=h===null?m:h.concat(m))));break;case 26:var y=Zr;if(Pr(u,o),Vr(o),m&512&&($t||h===null||gr(h,h.return)),m&4){var E=h!==null?h.memoizedState:null;if(m=o.memoizedState,h===null)if(m===null)if(o.stateNode===null){e:{m=o.type,h=o.memoizedProps,y=y.ownerDocument||y;t:switch(m){case"title":E=y.getElementsByTagName("title")[0],(!E||E[qu]||E[jn]||E.namespaceURI==="http://www.w3.org/2000/svg"||E.hasAttribute("itemprop"))&&(E=y.createElement(m),y.head.insertBefore(E,y.querySelector("head > title"))),zn(E,m,h),E[jn]=o,An(E),m=E;break e;case"link":var k=a2("link","href",y).get(m+(h.href||""));if(k){for(var z=0;z<k.length;z++)if(E=k[z],E.getAttribute("href")===(h.href==null?null:h.href)&&E.getAttribute("rel")===(h.rel==null?null:h.rel)&&E.getAttribute("title")===(h.title==null?null:h.title)&&E.getAttribute("crossorigin")===(h.crossOrigin==null?null:h.crossOrigin)){k.splice(z,1);break t}}E=y.createElement(m),zn(E,m,h),y.head.appendChild(E);break;case"meta":if(k=a2("meta","content",y).get(m+(h.content||""))){for(z=0;z<k.length;z++)if(E=k[z],E.getAttribute("content")===(h.content==null?null:""+h.content)&&E.getAttribute("name")===(h.name==null?null:h.name)&&E.getAttribute("property")===(h.property==null?null:h.property)&&E.getAttribute("http-equiv")===(h.httpEquiv==null?null:h.httpEquiv)&&E.getAttribute("charset")===(h.charSet==null?null:h.charSet)){k.splice(z,1);break t}}E=y.createElement(m),zn(E,m,h),y.head.appendChild(E);break;default:throw Error(n(468,m))}E[jn]=o,An(E),m=E}o.stateNode=m}else i2(y,o.type,o.stateNode);else o.stateNode=r2(y,m,o.memoizedProps);else E!==m?(E===null?h.stateNode!==null&&(h=h.stateNode,h.parentNode.removeChild(h)):E.count--,m===null?i2(y,o.type,o.stateNode):r2(y,m,o.memoizedProps)):m===null&&o.stateNode!==null&&ix(o,o.memoizedProps,h.memoizedProps)}break;case 27:if(m&4&&o.alternate===null){y=o.stateNode,E=o.memoizedProps;try{for(var H=y.firstChild;H;){var J=H.nextSibling,he=H.nodeName;H[qu]||he==="HEAD"||he==="BODY"||he==="SCRIPT"||he==="STYLE"||he==="LINK"&&H.rel.toLowerCase()==="stylesheet"||y.removeChild(H),H=J}for(var ye=o.type,ie=y.attributes;ie.length;)y.removeAttributeNode(ie[0]);zn(y,ye,E),y[jn]=o,y[ar]=E}catch(ze){Rt(o,o.return,ze)}}case 5:if(Pr(u,o),Vr(o),m&512&&($t||h===null||gr(h,h.return)),o.flags&32){y=o.stateNode;try{As(y,"")}catch(ze){Rt(o,o.return,ze)}}m&4&&o.stateNode!=null&&(y=o.memoizedProps,ix(o,y,h!==null?h.memoizedProps:y)),m&1024&&(_m=!0);break;case 6:if(Pr(u,o),Vr(o),m&4){if(o.stateNode===null)throw Error(n(162));m=o.memoizedProps,h=o.stateNode;try{h.nodeValue=m}catch(ze){Rt(o,o.return,ze)}}break;case 3:if(Kf=null,y=Zr,Zr=Xf(u.containerInfo),Pr(u,o),Zr=y,Vr(o),m&4&&h!==null&&h.memoizedState.isDehydrated)try{Fl(u.containerInfo)}catch(ze){Rt(o,o.return,ze)}_m&&(_m=!1,px(o));break;case 4:m=Zr,Zr=Xf(o.stateNode.containerInfo),Pr(u,o),Vr(o),Zr=m;break;case 12:Pr(u,o),Vr(o);break;case 13:Pr(u,o),Vr(o),o.child.flags&8192&&o.memoizedState!==null!=(h!==null&&h.memoizedState!==null)&&(Wm=kt()),m&4&&(m=o.updateQueue,m!==null&&(o.updateQueue=null,Mm(o,m)));break;case 22:if(m&512&&($t||h===null||gr(h,h.return)),H=o.memoizedState!==null,J=h!==null&&h.memoizedState!==null,he=Ha,ye=$t,Ha=he||H,$t=ye||J,Pr(u,o),$t=ye,Ha=he,Vr(o),u=o.stateNode,u._current=o,u._visibility&=-3,u._visibility|=u._pendingVisibility&2,m&8192&&(u._visibility=H?u._visibility&-2:u._visibility|1,H&&(u=Ha||$t,h===null||J||u||js(o)),o.memoizedProps===null||o.memoizedProps.mode!=="manual"))e:for(h=null,u=o;;){if(u.tag===5||u.tag===26||u.tag===27){if(h===null){J=h=u;try{if(y=J.stateNode,H)E=y.style,typeof E.setProperty=="function"?E.setProperty("display","none","important"):E.display="none";else{k=J.stateNode,z=J.memoizedProps.style;var fe=z!=null&&z.hasOwnProperty("display")?z.display:null;k.style.display=fe==null||typeof fe=="boolean"?"":(""+fe).trim()}}catch(ze){Rt(J,J.return,ze)}}}else if(u.tag===6){if(h===null){J=u;try{J.stateNode.nodeValue=H?"":J.memoizedProps}catch(ze){Rt(J,J.return,ze)}}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===o)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===o)break e;for(;u.sibling===null;){if(u.return===null||u.return===o)break e;h===u&&(h=null),u=u.return}h===u&&(h=null),u.sibling.return=u.return,u=u.sibling}m&4&&(m=o.updateQueue,m!==null&&(h=m.retryQueue,h!==null&&(m.retryQueue=null,Mm(o,h))));break;case 19:Pr(u,o),Vr(o),m&4&&(m=o.updateQueue,m!==null&&(o.updateQueue=null,Mm(o,m)));break;case 21:break;default:Pr(u,o),Vr(o)}}function Vr(o){var u=o.flags;if(u&2){try{if(o.tag!==27){e:{for(var h=o.return;h!==null;){if(ox(h)){var m=h;break e}h=h.return}throw Error(n(160))}switch(m.tag){case 27:var y=m.stateNode,E=Dm(o);Of(o,E,y);break;case 5:var k=m.stateNode;m.flags&32&&(As(k,""),m.flags&=-33);var z=Dm(o);Of(o,z,k);break;case 3:case 4:var H=m.stateNode.containerInfo,J=Dm(o);Om(o,J,H);break;default:throw Error(n(161))}}}catch(he){Rt(o,o.return,he)}o.flags&=-3}u&4096&&(o.flags&=-4097)}function px(o){if(o.subtreeFlags&1024)for(o=o.child;o!==null;){var u=o;px(u),u.tag===5&&u.flags&1024&&u.stateNode.reset(),o=o.sibling}}function Ga(o,u){if(u.subtreeFlags&8772)for(u=u.child;u!==null;)lx(o,u.alternate,u),u=u.sibling}function js(o){for(o=o.child;o!==null;){var u=o;switch(u.tag){case 0:case 11:case 14:case 15:ki(4,u,u.return),js(u);break;case 1:gr(u,u.return);var h=u.stateNode;typeof h.componentWillUnmount=="function"&&rx(u,u.return,h),js(u);break;case 26:case 27:case 5:gr(u,u.return),js(u);break;case 22:gr(u,u.return),u.memoizedState===null&&js(u);break;default:js(u)}o=o.sibling}}function Di(o,u,h){for(h=h&&(u.subtreeFlags&8772)!==0,u=u.child;u!==null;){var m=u.alternate,y=o,E=u,k=E.flags;switch(E.tag){case 0:case 11:case 15:Di(y,E,h),bl(4,E);break;case 1:if(Di(y,E,h),m=E,y=m.stateNode,typeof y.componentDidMount=="function")try{y.componentDidMount()}catch(J){Rt(m,m.return,J)}if(m=E,y=m.updateQueue,y!==null){var z=m.stateNode;try{var H=y.shared.hiddenCallbacks;if(H!==null)for(y.shared.hiddenCallbacks=null,y=0;y<H.length;y++)ex(H[y],z)}catch(J){Rt(m,m.return,J)}}h&&k&64&&nx(E),Ro(E,E.return);break;case 26:case 27:case 5:Di(y,E,h),h&&m===null&&k&4&&ax(E),Ro(E,E.return);break;case 12:Di(y,E,h);break;case 13:Di(y,E,h),h&&k&4&&hx(y,E);break;case 22:E.memoizedState===null&&Di(y,E,h),Ro(E,E.return);break;default:Di(y,E,h)}u=u.sibling}}function zm(o,u){var h=null;o!==null&&o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(h=o.memoizedState.cachePool.pool),o=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(o=u.memoizedState.cachePool.pool),o!==h&&(o!=null&&o.refCount++,h!=null&&ll(h))}function Lm(o,u){o=null,u.alternate!==null&&(o=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==o&&(u.refCount++,o!=null&&ll(o))}function Oi(o,u,h,m){if(u.subtreeFlags&10256)for(u=u.child;u!==null;)mx(o,u,h,m),u=u.sibling}function mx(o,u,h,m){var y=u.flags;switch(u.tag){case 0:case 11:case 15:Oi(o,u,h,m),y&2048&&bl(9,u);break;case 3:Oi(o,u,h,m),y&2048&&(o=null,u.alternate!==null&&(o=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==o&&(u.refCount++,o!=null&&ll(o)));break;case 12:if(y&2048){Oi(o,u,h,m),o=u.stateNode;try{var E=u.memoizedProps,k=E.id,z=E.onPostCommit;typeof z=="function"&&z(k,u.alternate===null?"mount":"update",o.passiveEffectDuration,-0)}catch(H){Rt(u,u.return,H)}}else Oi(o,u,h,m);break;case 23:break;case 22:E=u.stateNode,u.memoizedState!==null?E._visibility&4?Oi(o,u,h,m):wl(o,u):E._visibility&4?Oi(o,u,h,m):(E._visibility|=4,Ws(o,u,h,m,(u.subtreeFlags&10256)!==0)),y&2048&&zm(u.alternate,u);break;case 24:Oi(o,u,h,m),y&2048&&Lm(u.alternate,u);break;default:Oi(o,u,h,m)}}function Ws(o,u,h,m,y){for(y=y&&(u.subtreeFlags&10256)!==0,u=u.child;u!==null;){var E=o,k=u,z=h,H=m,J=k.flags;switch(k.tag){case 0:case 11:case 15:Ws(E,k,z,H,y),bl(8,k);break;case 23:break;case 22:var he=k.stateNode;k.memoizedState!==null?he._visibility&4?Ws(E,k,z,H,y):wl(E,k):(he._visibility|=4,Ws(E,k,z,H,y)),y&&J&2048&&zm(k.alternate,k);break;case 24:Ws(E,k,z,H,y),y&&J&2048&&Lm(k.alternate,k);break;default:Ws(E,k,z,H,y)}u=u.sibling}}function wl(o,u){if(u.subtreeFlags&10256)for(u=u.child;u!==null;){var h=o,m=u,y=m.flags;switch(m.tag){case 22:wl(h,m),y&2048&&zm(m.alternate,m);break;case 24:wl(h,m),y&2048&&Lm(m.alternate,m);break;default:wl(h,m)}u=u.sibling}}var xl=8192;function Hs(o){if(o.subtreeFlags&xl)for(o=o.child;o!==null;)gx(o),o=o.sibling}function gx(o){switch(o.tag){case 26:Hs(o),o.flags&xl&&o.memoizedState!==null&&yO(Zr,o.memoizedState,o.memoizedProps);break;case 5:Hs(o);break;case 3:case 4:var u=Zr;Zr=Xf(o.stateNode.containerInfo),Hs(o),Zr=u;break;case 22:o.memoizedState===null&&(u=o.alternate,u!==null&&u.memoizedState!==null?(u=xl,xl=16777216,Hs(o),xl=u):Hs(o));break;default:Hs(o)}}function vx(o){var u=o.alternate;if(u!==null&&(o=u.child,o!==null)){u.child=null;do u=o.sibling,o.sibling=null,o=u;while(o!==null)}}function Sl(o){var u=o.deletions;if((o.flags&16)!==0){if(u!==null)for(var h=0;h<u.length;h++){var m=u[h];Nn=m,bx(m,o)}vx(o)}if(o.subtreeFlags&10256)for(o=o.child;o!==null;)yx(o),o=o.sibling}function yx(o){switch(o.tag){case 0:case 11:case 15:Sl(o),o.flags&2048&&ki(9,o,o.return);break;case 3:Sl(o);break;case 12:Sl(o);break;case 22:var u=o.stateNode;o.memoizedState!==null&&u._visibility&4&&(o.return===null||o.return.tag!==13)?(u._visibility&=-5,_f(o)):Sl(o);break;default:Sl(o)}}function _f(o){var u=o.deletions;if((o.flags&16)!==0){if(u!==null)for(var h=0;h<u.length;h++){var m=u[h];Nn=m,bx(m,o)}vx(o)}for(o=o.child;o!==null;){switch(u=o,u.tag){case 0:case 11:case 15:ki(8,u,u.return),_f(u);break;case 22:h=u.stateNode,h._visibility&4&&(h._visibility&=-5,_f(u));break;default:_f(u)}o=o.sibling}}function bx(o,u){for(;Nn!==null;){var h=Nn;switch(h.tag){case 0:case 11:case 15:ki(8,h,u);break;case 23:case 22:if(h.memoizedState!==null&&h.memoizedState.cachePool!==null){var m=h.memoizedState.cachePool.pool;m!=null&&m.refCount++}break;case 24:ll(h.memoizedState.cache)}if(m=h.child,m!==null)m.return=h,Nn=m;else e:for(h=o;Nn!==null;){m=Nn;var y=m.sibling,E=m.return;if(cx(m),m===h){Nn=null;break e}if(y!==null){y.return=E,Nn=y;break e}Nn=E}}}function DD(o,u,h,m){this.tag=o,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=u,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=m,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function jr(o,u,h,m){return new DD(o,u,h,m)}function Fm(o){return o=o.prototype,!(!o||!o.isReactComponent)}function _i(o,u){var h=o.alternate;return h===null?(h=jr(o.tag,u,o.key,o.mode),h.elementType=o.elementType,h.type=o.type,h.stateNode=o.stateNode,h.alternate=o,o.alternate=h):(h.pendingProps=u,h.type=o.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=o.flags&31457280,h.childLanes=o.childLanes,h.lanes=o.lanes,h.child=o.child,h.memoizedProps=o.memoizedProps,h.memoizedState=o.memoizedState,h.updateQueue=o.updateQueue,u=o.dependencies,h.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext},h.sibling=o.sibling,h.index=o.index,h.ref=o.ref,h.refCleanup=o.refCleanup,h}function wx(o,u){o.flags&=31457282;var h=o.alternate;return h===null?(o.childLanes=0,o.lanes=u,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=h.childLanes,o.lanes=h.lanes,o.child=h.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=h.memoizedProps,o.memoizedState=h.memoizedState,o.updateQueue=h.updateQueue,o.type=h.type,u=h.dependencies,o.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext}),o}function Mf(o,u,h,m,y,E){var k=0;if(m=o,typeof o=="function")Fm(o)&&(k=1);else if(typeof o=="string")k=gO(o,h,Fe.current)?26:o==="html"||o==="head"||o==="body"?27:5;else e:switch(o){case c:return Io(h.children,y,E,u);case f:k=8,y|=24;break;case d:return o=jr(12,h,u,y|2),o.elementType=d,o.lanes=E,o;case w:return o=jr(13,h,u,y),o.elementType=w,o.lanes=E,o;case S:return o=jr(19,h,u,y),o.elementType=S,o.lanes=E,o;case A:return xx(h,y,E,u);default:if(typeof o=="object"&&o!==null)switch(o.$$typeof){case p:case v:k=10;break e;case g:k=9;break e;case b:k=11;break e;case x:k=14;break e;case C:k=16,m=null;break e}k=29,h=Error(n(130,o===null?"null":typeof o,"")),m=null}return u=jr(k,h,u,y),u.elementType=o,u.type=m,u.lanes=E,u}function Io(o,u,h,m){return o=jr(7,o,m,u),o.lanes=h,o}function xx(o,u,h,m){o=jr(22,o,m,u),o.elementType=A,o.lanes=h;var y={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var E=y._current;if(E===null)throw Error(n(456));if((y._pendingVisibility&2)===0){var k=xi(E,2);k!==null&&(y._pendingVisibility|=2,Kn(k,E,2))}},attach:function(){var E=y._current;if(E===null)throw Error(n(456));if((y._pendingVisibility&2)!==0){var k=xi(E,2);k!==null&&(y._pendingVisibility&=-3,Kn(k,E,2))}}};return o.stateNode=y,o}function Bm(o,u,h){return o=jr(6,o,null,u),o.lanes=h,o}function Um(o,u,h){return u=jr(4,o.children!==null?o.children:[],o.key,u),u.lanes=h,u.stateNode={containerInfo:o.containerInfo,pendingChildren:null,implementation:o.implementation},u}function Xa(o){o.flags|=4}function Sx(o,u){if(u.type!=="stylesheet"||(u.state.loading&4)!==0)o.flags&=-16777217;else if(o.flags|=16777216,!o2(u)){if(u=Ur.current,u!==null&&((pt&4194176)===pt?va!==null:(pt&62914560)!==pt&&(pt&536870912)===0||u!==va))throw ol=Hp,Uw;o.flags|=8192}}function zf(o,u){u!==null&&(o.flags|=4),o.flags&16384&&(u=o.tag!==22?ma():536870912,o.lanes|=u,Gs|=u)}function El(o,u){if(!vt)switch(o.tailMode){case"hidden":u=o.tail;for(var h=null;u!==null;)u.alternate!==null&&(h=u),u=u.sibling;h===null?o.tail=null:h.sibling=null;break;case"collapsed":h=o.tail;for(var m=null;h!==null;)h.alternate!==null&&(m=h),h=h.sibling;m===null?u||o.tail===null?o.tail=null:o.tail.sibling=null:m.sibling=null}}function jt(o){var u=o.alternate!==null&&o.alternate.child===o.child,h=0,m=0;if(u)for(var y=o.child;y!==null;)h|=y.lanes|y.childLanes,m|=y.subtreeFlags&31457280,m|=y.flags&31457280,y.return=o,y=y.sibling;else for(y=o.child;y!==null;)h|=y.lanes|y.childLanes,m|=y.subtreeFlags,m|=y.flags,y.return=o,y=y.sibling;return o.subtreeFlags|=m,o.childLanes=h,u}function OD(o,u,h){var m=u.pendingProps;switch(jp(u),u.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return jt(u),null;case 1:return jt(u),null;case 3:return h=u.stateNode,m=null,o!==null&&(m=o.memoizedState.cache),u.memoizedState.cache!==m&&(u.flags|=2048),Wa(wn),Je(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(o===null||o.child===null)&&(nl(u)?Xa(u):o===null||o.memoizedState.isDehydrated&&(u.flags&256)===0||(u.flags|=1024,Yr!==null&&(Xm(Yr),Yr=null))),jt(u),null;case 26:return h=u.memoizedState,o===null?(Xa(u),h!==null?(jt(u),Sx(u,h)):(jt(u),u.flags&=-16777217)):h?h!==o.memoizedState?(Xa(u),jt(u),Sx(u,h)):(jt(u),u.flags&=-16777217):(o.memoizedProps!==m&&Xa(u),jt(u),u.flags&=-16777217),null;case 27:Cn(u),h=qe.current;var y=u.type;if(o!==null&&u.stateNode!=null)o.memoizedProps!==m&&Xa(u);else{if(!m){if(u.stateNode===null)throw Error(n(166));return jt(u),null}o=Fe.current,nl(u)?Fw(u):(o=Qx(y,m,h),u.stateNode=o,Xa(u))}return jt(u),null;case 5:if(Cn(u),h=u.type,o!==null&&u.stateNode!=null)o.memoizedProps!==m&&Xa(u);else{if(!m){if(u.stateNode===null)throw Error(n(166));return jt(u),null}if(o=Fe.current,nl(u))Fw(u);else{switch(y=Gf(qe.current),o){case 1:o=y.createElementNS("http://www.w3.org/2000/svg",h);break;case 2:o=y.createElementNS("http://www.w3.org/1998/Math/MathML",h);break;default:switch(h){case"svg":o=y.createElementNS("http://www.w3.org/2000/svg",h);break;case"math":o=y.createElementNS("http://www.w3.org/1998/Math/MathML",h);break;case"script":o=y.createElement("div"),o.innerHTML="<script><\/script>",o=o.removeChild(o.firstChild);break;case"select":o=typeof m.is=="string"?y.createElement("select",{is:m.is}):y.createElement("select"),m.multiple?o.multiple=!0:m.size&&(o.size=m.size);break;default:o=typeof m.is=="string"?y.createElement(h,{is:m.is}):y.createElement(h)}}o[jn]=u,o[ar]=m;e:for(y=u.child;y!==null;){if(y.tag===5||y.tag===6)o.appendChild(y.stateNode);else if(y.tag!==4&&y.tag!==27&&y.child!==null){y.child.return=y,y=y.child;continue}if(y===u)break e;for(;y.sibling===null;){if(y.return===null||y.return===u)break e;y=y.return}y.sibling.return=y.return,y=y.sibling}u.stateNode=o;e:switch(zn(o,h,m),h){case"button":case"input":case"select":case"textarea":o=!!m.autoFocus;break e;case"img":o=!0;break e;default:o=!1}o&&Xa(u)}}return jt(u),u.flags&=-16777217,null;case 6:if(o&&u.stateNode!=null)o.memoizedProps!==m&&Xa(u);else{if(typeof m!="string"&&u.stateNode===null)throw Error(n(166));if(o=qe.current,nl(u)){if(o=u.stateNode,h=u.memoizedProps,m=null,y=$n,y!==null)switch(y.tag){case 27:case 5:m=y.memoizedProps}o[jn]=u,o=!!(o.nodeValue===h||m!==null&&m.suppressHydrationWarning===!0||Gx(o.nodeValue,h)),o||bo(u)}else o=Gf(o).createTextNode(m),o[jn]=u,u.stateNode=o}return jt(u),null;case 13:if(m=u.memoizedState,o===null||o.memoizedState!==null&&o.memoizedState.dehydrated!==null){if(y=nl(u),m!==null&&m.dehydrated!==null){if(o===null){if(!y)throw Error(n(318));if(y=u.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(n(317));y[jn]=u}else rl(),(u.flags&128)===0&&(u.memoizedState=null),u.flags|=4;jt(u),y=!1}else Yr!==null&&(Xm(Yr),Yr=null),y=!0;if(!y)return u.flags&256?(Ua(u),u):(Ua(u),null)}if(Ua(u),(u.flags&128)!==0)return u.lanes=h,u;if(h=m!==null,o=o!==null&&o.memoizedState!==null,h){m=u.child,y=null,m.alternate!==null&&m.alternate.memoizedState!==null&&m.alternate.memoizedState.cachePool!==null&&(y=m.alternate.memoizedState.cachePool.pool);var E=null;m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(E=m.memoizedState.cachePool.pool),E!==y&&(m.flags|=2048)}return h!==o&&h&&(u.child.flags|=8192),zf(u,u.updateQueue),jt(u),null;case 4:return Je(),o===null&&ag(u.stateNode.containerInfo),jt(u),null;case 10:return Wa(u.type),jt(u),null;case 19:if(ke(bn),y=u.memoizedState,y===null)return jt(u),null;if(m=(u.flags&128)!==0,E=y.rendering,E===null)if(m)El(y,!1);else{if(Kt!==0||o!==null&&(o.flags&128)!==0)for(o=u.child;o!==null;){if(E=yf(o),E!==null){for(u.flags|=128,El(y,!1),o=E.updateQueue,u.updateQueue=o,zf(u,o),u.subtreeFlags=0,o=h,h=u.child;h!==null;)wx(h,o),h=h.sibling;return Ue(bn,bn.current&1|2),u.child}o=o.sibling}y.tail!==null&&kt()>Lf&&(u.flags|=128,m=!0,El(y,!1),u.lanes=4194304)}else{if(!m)if(o=yf(E),o!==null){if(u.flags|=128,m=!0,o=o.updateQueue,u.updateQueue=o,zf(u,o),El(y,!0),y.tail===null&&y.tailMode==="hidden"&&!E.alternate&&!vt)return jt(u),null}else 2*kt()-y.renderingStartTime>Lf&&h!==536870912&&(u.flags|=128,m=!0,El(y,!1),u.lanes=4194304);y.isBackwards?(E.sibling=u.child,u.child=E):(o=y.last,o!==null?o.sibling=E:u.child=E,y.last=E)}return y.tail!==null?(u=y.tail,y.rendering=u,y.tail=u.sibling,y.renderingStartTime=kt(),u.sibling=null,o=bn.current,Ue(bn,m?o&1|2:o&1),u):(jt(u),null);case 22:case 23:return Ua(u),Gp(),m=u.memoizedState!==null,o!==null?o.memoizedState!==null!==m&&(u.flags|=8192):m&&(u.flags|=8192),m?(h&536870912)!==0&&(u.flags&128)===0&&(jt(u),u.subtreeFlags&6&&(u.flags|=8192)):jt(u),h=u.updateQueue,h!==null&&zf(u,h.retryQueue),h=null,o!==null&&o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(h=o.memoizedState.cachePool.pool),m=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(m=u.memoizedState.cachePool.pool),m!==h&&(u.flags|=2048),o!==null&&ke(xo),null;case 24:return h=null,o!==null&&(h=o.memoizedState.cache),u.memoizedState.cache!==h&&(u.flags|=2048),Wa(wn),jt(u),null;case 25:return null}throw Error(n(156,u.tag))}function _D(o,u){switch(jp(u),u.tag){case 1:return o=u.flags,o&65536?(u.flags=o&-65537|128,u):null;case 3:return Wa(wn),Je(),o=u.flags,(o&65536)!==0&&(o&128)===0?(u.flags=o&-65537|128,u):null;case 26:case 27:case 5:return Cn(u),null;case 13:if(Ua(u),o=u.memoizedState,o!==null&&o.dehydrated!==null){if(u.alternate===null)throw Error(n(340));rl()}return o=u.flags,o&65536?(u.flags=o&-65537|128,u):null;case 19:return ke(bn),null;case 4:return Je(),null;case 10:return Wa(u.type),null;case 22:case 23:return Ua(u),Gp(),o!==null&&ke(xo),o=u.flags,o&65536?(u.flags=o&-65537|128,u):null;case 24:return Wa(wn),null;case 25:return null;default:return null}}function Ex(o,u){switch(jp(u),u.tag){case 3:Wa(wn),Je();break;case 26:case 27:case 5:Cn(u);break;case 4:Je();break;case 13:Ua(u);break;case 19:ke(bn);break;case 10:Wa(u.type);break;case 22:case 23:Ua(u),Gp(),o!==null&&ke(xo);break;case 24:Wa(wn)}}var MD={getCacheForType:function(o){var u=Wn(wn),h=u.data.get(o);return h===void 0&&(h=o(),u.data.set(o,h)),h}},zD=typeof WeakMap=="function"?WeakMap:Map,Wt=0,Dt=null,ut=null,pt=0,Ot=0,yr=null,$a=!1,qs=!1,Pm=!1,Ka=0,Kt=0,Mi=0,ko=0,Vm=0,Wr=0,Gs=0,Cl=null,ba=null,jm=!1,Wm=0,Lf=1/0,Ff=null,zi=null,Bf=!1,Do=null,Al=0,Hm=0,qm=null,Tl=0,Gm=null;function br(){if((Wt&2)!==0&&pt!==0)return pt&-pt;if(I.T!==null){var o=Fs;return o!==0?o:eg()}return H0()}function Cx(){Wr===0&&(Wr=(pt&536870912)===0||vt?rr():536870912);var o=Ur.current;return o!==null&&(o.flags|=32),Wr}function Kn(o,u,h){(o===Dt&&Ot===2||o.cancelPendingCommit!==null)&&(Xs(o,0),Ya(o,pt,Wr,!1)),Vn(o,h),((Wt&2)===0||o!==Dt)&&(o===Dt&&((Wt&2)===0&&(ko|=h),Kt===4&&Ya(o,pt,Wr,!1)),wa(o))}function Ax(o,u,h){if((Wt&6)!==0)throw Error(n(327));var m=!h&&(u&60)===0&&(u&o.expiredLanes)===0||tn(o,u),y=m?BD(o,u):Ym(o,u,!0),E=m;do{if(y===0){qs&&!m&&Ya(o,u,0,!1);break}else if(y===6)Ya(o,u,0,!$a);else{if(h=o.current.alternate,E&&!LD(h)){y=Ym(o,u,!1),E=!1;continue}if(y===2){if(E=u,o.errorRecoveryDisabledLanes&E)var k=0;else k=o.pendingLanes&-536870913,k=k!==0?k:k&536870912?536870912:0;if(k!==0){u=k;e:{var z=o;y=Cl;var H=z.current.memoizedState.isDehydrated;if(H&&(Xs(z,k).flags|=256),k=Ym(z,k,!1),k!==2){if(Pm&&!H){z.errorRecoveryDisabledLanes|=E,ko|=E,y=4;break e}E=ba,ba=y,E!==null&&Xm(E)}y=k}if(E=!1,y!==2)continue}}if(y===1){Xs(o,0),Ya(o,u,0,!0);break}e:{switch(m=o,y){case 0:case 1:throw Error(n(345));case 4:if((u&4194176)===u){Ya(m,u,Wr,!$a);break e}break;case 2:ba=null;break;case 3:case 5:break;default:throw Error(n(329))}if(m.finishedWork=h,m.finishedLanes=u,(u&62914560)===u&&(E=Wm+300-kt(),10<E)){if(Ya(m,u,Wr,!$a),yn(m,0)!==0)break e;m.timeoutHandle=Kx(Tx.bind(null,m,h,ba,Ff,jm,u,Wr,ko,Gs,$a,2,-0,0),E);break e}Tx(m,h,ba,Ff,jm,u,Wr,ko,Gs,$a,0,-0,0)}}break}while(!0);wa(o)}function Xm(o){ba===null?ba=o:ba.push.apply(ba,o)}function Tx(o,u,h,m,y,E,k,z,H,J,he,ye,ie){var fe=u.subtreeFlags;if((fe&8192||(fe&16785408)===16785408)&&(Ol={stylesheets:null,count:0,unsuspend:vO},gx(u),u=bO(),u!==null)){o.cancelPendingCommit=u(_x.bind(null,o,h,m,y,k,z,H,1,ye,ie)),Ya(o,E,k,!J);return}_x(o,h,m,y,k,z,H,he,ye,ie)}function LD(o){for(var u=o;;){var h=u.tag;if((h===0||h===11||h===15)&&u.flags&16384&&(h=u.updateQueue,h!==null&&(h=h.stores,h!==null)))for(var m=0;m<h.length;m++){var y=h[m],E=y.getSnapshot;y=y.value;try{if(!mr(E(),y))return!1}catch{return!1}}if(h=u.child,u.subtreeFlags&16384&&h!==null)h.return=u,u=h;else{if(u===o)break;for(;u.sibling===null;){if(u.return===null||u.return===o)return!0;u=u.return}u.sibling.return=u.return,u=u.sibling}}return!0}function Ya(o,u,h,m){u&=~Vm,u&=~ko,o.suspendedLanes|=u,o.pingedLanes&=~u,m&&(o.warmLanes|=u),m=o.expirationTimes;for(var y=u;0<y;){var E=31-vn(y),k=1<<E;m[E]=-1,y&=~k}h!==0&&Hu(o,h,u)}function Uf(){return(Wt&6)===0?(Nl(0),!1):!0}function $m(){if(ut!==null){if(Ot===0)var o=ut.return;else o=ut,ja=To=null,em(o),zs=null,sl=0,o=ut;for(;o!==null;)Ex(o.alternate,o),o=o.return;ut=null}}function Xs(o,u){o.finishedWork=null,o.finishedLanes=0;var h=o.timeoutHandle;h!==-1&&(o.timeoutHandle=-1,tO(h)),h=o.cancelPendingCommit,h!==null&&(o.cancelPendingCommit=null,h()),$m(),Dt=o,ut=h=_i(o.current,null),pt=u,Ot=0,yr=null,$a=!1,qs=tn(o,u),Pm=!1,Gs=Wr=Vm=ko=Mi=Kt=0,ba=Cl=null,jm=!1,(u&8)!==0&&(u|=u&32);var m=o.entangledLanes;if(m!==0)for(o=o.entanglements,m&=u;0<m;){var y=31-vn(m),E=1<<y;u|=o[y],m&=~E}return Ka=u,lf(),h}function Nx(o,u){at=null,I.H=ya,u===il?(u=jw(),Ot=3):u===Uw?(u=jw(),Ot=4):Ot=u===P1?8:u!==null&&typeof u=="object"&&typeof u.then=="function"?6:1,yr=u,ut===null&&(Kt=1,If(o,Lr(u,o.current)))}function Rx(){var o=I.H;return I.H=ya,o===null?ya:o}function Ix(){var o=I.A;return I.A=MD,o}function Km(){Kt=4,$a||(pt&4194176)!==pt&&Ur.current!==null||(qs=!0),(Mi&134217727)===0&&(ko&134217727)===0||Dt===null||Ya(Dt,pt,Wr,!1)}function Ym(o,u,h){var m=Wt;Wt|=2;var y=Rx(),E=Ix();(Dt!==o||pt!==u)&&(Ff=null,Xs(o,u)),u=!1;var k=Kt;e:do try{if(Ot!==0&&ut!==null){var z=ut,H=yr;switch(Ot){case 8:$m(),k=6;break e;case 3:case 2:case 6:Ur.current===null&&(u=!0);var J=Ot;if(Ot=0,yr=null,$s(o,z,H,J),h&&qs){k=0;break e}break;default:J=Ot,Ot=0,yr=null,$s(o,z,H,J)}}FD(),k=Kt;break}catch(he){Nx(o,he)}while(!0);return u&&o.shellSuspendCounter++,ja=To=null,Wt=m,I.H=y,I.A=E,ut===null&&(Dt=null,pt=0,lf()),k}function FD(){for(;ut!==null;)kx(ut)}function BD(o,u){var h=Wt;Wt|=2;var m=Rx(),y=Ix();Dt!==o||pt!==u?(Ff=null,Lf=kt()+500,Xs(o,u)):qs=tn(o,u);e:do try{if(Ot!==0&&ut!==null){u=ut;var E=yr;t:switch(Ot){case 1:Ot=0,yr=null,$s(o,u,E,1);break;case 2:if(Pw(E)){Ot=0,yr=null,Dx(u);break}u=function(){Ot===2&&Dt===o&&(Ot=7),wa(o)},E.then(u,u);break e;case 3:Ot=7;break e;case 4:Ot=5;break e;case 7:Pw(E)?(Ot=0,yr=null,Dx(u)):(Ot=0,yr=null,$s(o,u,E,7));break;case 5:var k=null;switch(ut.tag){case 26:k=ut.memoizedState;case 5:case 27:var z=ut;if(!k||o2(k)){Ot=0,yr=null;var H=z.sibling;if(H!==null)ut=H;else{var J=z.return;J!==null?(ut=J,Pf(J)):ut=null}break t}}Ot=0,yr=null,$s(o,u,E,5);break;case 6:Ot=0,yr=null,$s(o,u,E,6);break;case 8:$m(),Kt=6;break e;default:throw Error(n(462))}}UD();break}catch(he){Nx(o,he)}while(!0);return ja=To=null,I.H=m,I.A=y,Wt=h,ut!==null?0:(Dt=null,pt=0,lf(),Kt)}function UD(){for(;ut!==null&&!Un();)kx(ut)}function kx(o){var u=Q1(o.alternate,o,Ka);o.memoizedProps=o.pendingProps,u===null?Pf(o):ut=u}function Dx(o){var u=o,h=u.alternate;switch(u.tag){case 15:case 0:u=G1(h,u,u.pendingProps,u.type,void 0,pt);break;case 11:u=G1(h,u,u.pendingProps,u.type.render,u.ref,pt);break;case 5:em(u);default:Ex(h,u),u=ut=wx(u,Ka),u=Q1(h,u,Ka)}o.memoizedProps=o.pendingProps,u===null?Pf(o):ut=u}function $s(o,u,h,m){ja=To=null,em(u),zs=null,sl=0;var y=u.return;try{if(ND(o,y,u,h,pt)){Kt=1,If(o,Lr(h,o.current)),ut=null;return}}catch(E){if(y!==null)throw ut=y,E;Kt=1,If(o,Lr(h,o.current)),ut=null;return}u.flags&32768?(vt||m===1?o=!0:qs||(pt&536870912)!==0?o=!1:($a=o=!0,(m===2||m===3||m===6)&&(m=Ur.current,m!==null&&m.tag===13&&(m.flags|=16384))),Ox(u,o)):Pf(u)}function Pf(o){var u=o;do{if((u.flags&32768)!==0){Ox(u,$a);return}o=u.return;var h=OD(u.alternate,u,Ka);if(h!==null){ut=h;return}if(u=u.sibling,u!==null){ut=u;return}ut=u=o}while(u!==null);Kt===0&&(Kt=5)}function Ox(o,u){do{var h=_D(o.alternate,o);if(h!==null){h.flags&=32767,ut=h;return}if(h=o.return,h!==null&&(h.flags|=32768,h.subtreeFlags=0,h.deletions=null),!u&&(o=o.sibling,o!==null)){ut=o;return}ut=o=h}while(o!==null);Kt=6,ut=null}function _x(o,u,h,m,y,E,k,z,H,J){var he=I.T,ye=de.p;try{de.p=2,I.T=null,PD(o,u,h,m,ye,y,E,k,z,H,J)}finally{I.T=he,de.p=ye}}function PD(o,u,h,m,y,E,k,z){do Ks();while(Do!==null);if((Wt&6)!==0)throw Error(n(327));var H=o.finishedWork;if(m=o.finishedLanes,H===null)return null;if(o.finishedWork=null,o.finishedLanes=0,H===o.current)throw Error(n(177));o.callbackNode=null,o.callbackPriority=0,o.cancelPendingCommit=null;var J=H.lanes|H.childLanes;if(J|=Up,bs(o,m,J,E,k,z),o===Dt&&(ut=Dt=null,pt=0),(H.subtreeFlags&10256)===0&&(H.flags&10256)===0||Bf||(Bf=!0,Hm=J,qm=h,HD(mn,function(){return Ks(),null})),h=(H.flags&15990)!==0,(H.subtreeFlags&15990)!==0||h?(h=I.T,I.T=null,E=de.p,de.p=2,k=Wt,Wt|=4,ID(o,H),dx(H,o),cD(ug,o.containerInfo),Qf=!!sg,ug=sg=null,o.current=H,lx(o,H.alternate,H),Ge(),Wt=k,de.p=E,I.T=h):o.current=H,Bf?(Bf=!1,Do=o,Al=m):Mx(o,J),J=o.pendingLanes,J===0&&(zi=null),Ma(H.stateNode),wa(o),u!==null)for(y=o.onRecoverableError,H=0;H<u.length;H++)J=u[H],y(J.value,{componentStack:J.stack});return(Al&3)!==0&&Ks(),J=o.pendingLanes,(m&4194218)!==0&&(J&42)!==0?o===Gm?Tl++:(Tl=0,Gm=o):Tl=0,Nl(0),null}function Mx(o,u){(o.pooledCacheLanes&=u)===0&&(u=o.pooledCache,u!=null&&(o.pooledCache=null,ll(u)))}function Ks(){if(Do!==null){var o=Do,u=Hm;Hm=0;var h=W0(Al),m=I.T,y=de.p;try{if(de.p=32>h?32:h,I.T=null,Do===null)var E=!1;else{h=qm,qm=null;var k=Do,z=Al;if(Do=null,Al=0,(Wt&6)!==0)throw Error(n(331));var H=Wt;if(Wt|=4,yx(k.current),mx(k,k.current,z,h),Wt=H,Nl(0,!1),gn&&typeof gn.onPostCommitFiberRoot=="function")try{gn.onPostCommitFiberRoot(Dr,k)}catch{}E=!0}return E}finally{de.p=y,I.T=m,Mx(o,u)}}return!1}function zx(o,u,h){u=Lr(h,u),u=pm(o.stateNode,u,2),o=Ii(o,u,2),o!==null&&(Vn(o,2),wa(o))}function Rt(o,u,h){if(o.tag===3)zx(o,o,h);else for(;u!==null;){if(u.tag===3){zx(u,o,h);break}else if(u.tag===1){var m=u.stateNode;if(typeof u.type.getDerivedStateFromError=="function"||typeof m.componentDidCatch=="function"&&(zi===null||!zi.has(m))){o=Lr(h,o),h=B1(2),m=Ii(u,h,2),m!==null&&(U1(h,m,u,o),Vn(m,2),wa(m));break}}u=u.return}}function Zm(o,u,h){var m=o.pingCache;if(m===null){m=o.pingCache=new zD;var y=new Set;m.set(u,y)}else y=m.get(u),y===void 0&&(y=new Set,m.set(u,y));y.has(h)||(Pm=!0,y.add(h),o=VD.bind(null,o,u,h),u.then(o,o))}function VD(o,u,h){var m=o.pingCache;m!==null&&m.delete(u),o.pingedLanes|=o.suspendedLanes&h,o.warmLanes&=~h,Dt===o&&(pt&h)===h&&(Kt===4||Kt===3&&(pt&62914560)===pt&&300>kt()-Wm?(Wt&2)===0&&Xs(o,0):Vm|=h,Gs===pt&&(Gs=0)),wa(o)}function Lx(o,u){u===0&&(u=ma()),o=xi(o,u),o!==null&&(Vn(o,u),wa(o))}function jD(o){var u=o.memoizedState,h=0;u!==null&&(h=u.retryLane),Lx(o,h)}function WD(o,u){var h=0;switch(o.tag){case 13:var m=o.stateNode,y=o.memoizedState;y!==null&&(h=y.retryLane);break;case 19:m=o.stateNode;break;case 22:m=o.stateNode._retryCache;break;default:throw Error(n(314))}m!==null&&m.delete(u),Lx(o,h)}function HD(o,u){return Ft(o,u)}var Vf=null,Ys=null,Qm=!1,jf=!1,Jm=!1,Oo=0;function wa(o){o!==Ys&&o.next===null&&(Ys===null?Vf=Ys=o:Ys=Ys.next=o),jf=!0,Qm||(Qm=!0,GD(qD))}function Nl(o,u){if(!Jm&&jf){Jm=!0;do for(var h=!1,m=Vf;m!==null;){if(o!==0){var y=m.pendingLanes;if(y===0)var E=0;else{var k=m.suspendedLanes,z=m.pingedLanes;E=(1<<31-vn(42|o)+1)-1,E&=y&~(k&~z),E=E&201326677?E&201326677|1:E?E|2:0}E!==0&&(h=!0,Ux(m,E))}else E=pt,E=yn(m,m===Dt?E:0),(E&3)===0||tn(m,E)||(h=!0,Ux(m,E));m=m.next}while(h);Jm=!1}}function qD(){jf=Qm=!1;var o=0;Oo!==0&&(eO()&&(o=Oo),Oo=0);for(var u=kt(),h=null,m=Vf;m!==null;){var y=m.next,E=Fx(m,u);E===0?(m.next=null,h===null?Vf=y:h.next=y,y===null&&(Ys=h)):(h=m,(o!==0||(E&3)!==0)&&(jf=!0)),m=y}Nl(o)}function Fx(o,u){for(var h=o.suspendedLanes,m=o.pingedLanes,y=o.expirationTimes,E=o.pendingLanes&-62914561;0<E;){var k=31-vn(E),z=1<<k,H=y[k];H===-1?((z&h)===0||(z&m)!==0)&&(y[k]=pa(z,u)):H<=u&&(o.expiredLanes|=z),E&=~z}if(u=Dt,h=pt,h=yn(o,o===u?h:0),m=o.callbackNode,h===0||o===u&&Ot===2||o.cancelPendingCommit!==null)return m!==null&&m!==null&&Vt(m),o.callbackNode=null,o.callbackPriority=0;if((h&3)===0||tn(o,h)){if(u=h&-h,u===o.callbackPriority)return u;switch(m!==null&&Vt(m),W0(h)){case 2:case 8:h=Pn;break;case 32:h=mn;break;case 268435456:h=pr;break;default:h=mn}return m=Bx.bind(null,o),h=Ft(h,m),o.callbackPriority=u,o.callbackNode=h,u}return m!==null&&m!==null&&Vt(m),o.callbackPriority=2,o.callbackNode=null,2}function Bx(o,u){var h=o.callbackNode;if(Ks()&&o.callbackNode!==h)return null;var m=pt;return m=yn(o,o===Dt?m:0),m===0?null:(Ax(o,m,u),Fx(o,kt()),o.callbackNode!=null&&o.callbackNode===h?Bx.bind(null,o):null)}function Ux(o,u){if(Ks())return null;Ax(o,u,!0)}function GD(o){nO(function(){(Wt&6)!==0?Ft(Gt,o):o()})}function eg(){return Oo===0&&(Oo=rr()),Oo}function Px(o){return o==null||typeof o=="symbol"||typeof o=="boolean"?null:typeof o=="function"?o:tf(""+o)}function Vx(o,u){var h=u.ownerDocument.createElement("input");return h.name=u.name,h.value=u.value,o.id&&h.setAttribute("form",o.id),u.parentNode.insertBefore(h,u),o=new FormData(o),h.parentNode.removeChild(h),o}function XD(o,u,h,m,y){if(u==="submit"&&h&&h.stateNode===y){var E=Px((y[ar]||null).action),k=m.submitter;k&&(u=(u=k[ar]||null)?Px(u.formAction):k.getAttribute("formAction"),u!==null&&(E=u,k=null));var z=new of("action","action",null,m,y);o.push({event:z,listeners:[{instance:null,listener:function(){if(m.defaultPrevented){if(Oo!==0){var H=k?Vx(y,k):new FormData(y);lm(h,{pending:!0,data:H,method:y.method,action:E},null,H)}}else typeof E=="function"&&(z.preventDefault(),H=k?Vx(y,k):new FormData(y),lm(h,{pending:!0,data:H,method:y.method,action:E},E,H))},currentTarget:y}]})}}for(var tg=0;tg<_w.length;tg++){var ng=_w[tg],$D=ng.toLowerCase(),KD=ng[0].toUpperCase()+ng.slice(1);Kr($D,"on"+KD)}Kr(Rw,"onAnimationEnd"),Kr(Iw,"onAnimationIteration"),Kr(kw,"onAnimationStart"),Kr("dblclick","onDoubleClick"),Kr("focusin","onFocus"),Kr("focusout","onBlur"),Kr(hD,"onTransitionRun"),Kr(dD,"onTransitionStart"),Kr(pD,"onTransitionCancel"),Kr(Dw,"onTransitionEnd"),Es("onMouseEnter",["mouseout","mouseover"]),Es("onMouseLeave",["mouseout","mouseover"]),Es("onPointerEnter",["pointerout","pointerover"]),Es("onPointerLeave",["pointerout","pointerover"]),ho("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ho("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ho("onBeforeInput",["compositionend","keypress","textInput","paste"]),ho("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ho("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ho("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Rl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),YD=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Rl));function jx(o,u){u=(u&4)!==0;for(var h=0;h<o.length;h++){var m=o[h],y=m.event;m=m.listeners;e:{var E=void 0;if(u)for(var k=m.length-1;0<=k;k--){var z=m[k],H=z.instance,J=z.currentTarget;if(z=z.listener,H!==E&&y.isPropagationStopped())break e;E=z,y.currentTarget=J;try{E(y)}catch(he){Rf(he)}y.currentTarget=null,E=H}else for(k=0;k<m.length;k++){if(z=m[k],H=z.instance,J=z.currentTarget,z=z.listener,H!==E&&y.isPropagationStopped())break e;E=z,y.currentTarget=J;try{E(y)}catch(he){Rf(he)}y.currentTarget=null,E=H}}}}function ht(o,u){var h=u[yp];h===void 0&&(h=u[yp]=new Set);var m=o+"__bubble";h.has(m)||(Wx(u,o,2,!1),h.add(m))}function rg(o,u,h){var m=0;u&&(m|=4),Wx(h,o,m,u)}var Wf="_reactListening"+Math.random().toString(36).slice(2);function ag(o){if(!o[Wf]){o[Wf]=!0,G0.forEach(function(h){h!=="selectionchange"&&(YD.has(h)||rg(h,!1,o),rg(h,!0,o))});var u=o.nodeType===9?o:o.ownerDocument;u===null||u[Wf]||(u[Wf]=!0,rg("selectionchange",!1,u))}}function Wx(o,u,h,m){switch(h2(u)){case 2:var y=SO;break;case 8:y=EO;break;default:y=vg}h=y.bind(null,u,h,o),y=void 0,!Tp||u!=="touchstart"&&u!=="touchmove"&&u!=="wheel"||(y=!0),m?y!==void 0?o.addEventListener(u,h,{capture:!0,passive:y}):o.addEventListener(u,h,!0):y!==void 0?o.addEventListener(u,h,{passive:y}):o.addEventListener(u,h,!1)}function ig(o,u,h,m,y){var E=m;if((u&1)===0&&(u&2)===0&&m!==null)e:for(;;){if(m===null)return;var k=m.tag;if(k===3||k===4){var z=m.stateNode.containerInfo;if(z===y||z.nodeType===8&&z.parentNode===y)break;if(k===4)for(k=m.return;k!==null;){var H=k.tag;if((H===3||H===4)&&(H=k.stateNode.containerInfo,H===y||H.nodeType===8&&H.parentNode===y))return;k=k.return}for(;z!==null;){if(k=fo(z),k===null)return;if(H=k.tag,H===5||H===6||H===26||H===27){m=E=k;continue e}z=z.parentNode}}m=m.return}aw(function(){var J=E,he=Cp(h),ye=[];e:{var ie=Ow.get(o);if(ie!==void 0){var fe=of,ze=o;switch(o){case"keypress":if(rf(h)===0)break e;case"keydown":case"keyup":fe=Wk;break;case"focusin":ze="focus",fe=kp;break;case"focusout":ze="blur",fe=kp;break;case"beforeblur":case"afterblur":fe=kp;break;case"click":if(h.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":fe=sw;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":fe=Dk;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":fe=Gk;break;case Rw:case Iw:case kw:fe=Mk;break;case Dw:fe=$k;break;case"scroll":case"scrollend":fe=Ik;break;case"wheel":fe=Yk;break;case"copy":case"cut":case"paste":fe=Lk;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":fe=lw;break;case"toggle":case"beforetoggle":fe=Qk}var Ke=(u&4)!==0,Yt=!Ke&&(o==="scroll"||o==="scrollend"),te=Ke?ie!==null?ie+"Capture":null:ie;Ke=[];for(var Q=J,re;Q!==null;){var me=Q;if(re=me.stateNode,me=me.tag,me!==5&&me!==26&&me!==27||re===null||te===null||(me=Xu(Q,te),me!=null&&Ke.push(Il(Q,me,re))),Yt)break;Q=Q.return}0<Ke.length&&(ie=new fe(ie,ze,null,h,he),ye.push({event:ie,listeners:Ke}))}}if((u&7)===0){e:{if(ie=o==="mouseover"||o==="pointerover",fe=o==="mouseout"||o==="pointerout",ie&&h!==Ep&&(ze=h.relatedTarget||h.fromElement)&&(fo(ze)||ze[ws]))break e;if((fe||ie)&&(ie=he.window===he?he:(ie=he.ownerDocument)?ie.defaultView||ie.parentWindow:window,fe?(ze=h.relatedTarget||h.toElement,fe=J,ze=ze?fo(ze):null,ze!==null&&(Yt=q(ze),Ke=ze.tag,ze!==Yt||Ke!==5&&Ke!==27&&Ke!==6)&&(ze=null)):(fe=null,ze=J),fe!==ze)){if(Ke=sw,me="onMouseLeave",te="onMouseEnter",Q="mouse",(o==="pointerout"||o==="pointerover")&&(Ke=lw,me="onPointerLeave",te="onPointerEnter",Q="pointer"),Yt=fe==null?ie:Gu(fe),re=ze==null?ie:Gu(ze),ie=new Ke(me,Q+"leave",fe,h,he),ie.target=Yt,ie.relatedTarget=re,me=null,fo(he)===J&&(Ke=new Ke(te,Q+"enter",ze,h,he),Ke.target=re,Ke.relatedTarget=Yt,me=Ke),Yt=me,fe&&ze)t:{for(Ke=fe,te=ze,Q=0,re=Ke;re;re=Zs(re))Q++;for(re=0,me=te;me;me=Zs(me))re++;for(;0<Q-re;)Ke=Zs(Ke),Q--;for(;0<re-Q;)te=Zs(te),re--;for(;Q--;){if(Ke===te||te!==null&&Ke===te.alternate)break t;Ke=Zs(Ke),te=Zs(te)}Ke=null}else Ke=null;fe!==null&&Hx(ye,ie,fe,Ke,!1),ze!==null&&Yt!==null&&Hx(ye,Yt,ze,Ke,!0)}}e:{if(ie=J?Gu(J):window,fe=ie.nodeName&&ie.nodeName.toLowerCase(),fe==="select"||fe==="input"&&ie.type==="file")var Ie=vw;else if(mw(ie))if(yw)Ie=uD;else{Ie=oD;var it=iD}else fe=ie.nodeName,!fe||fe.toLowerCase()!=="input"||ie.type!=="checkbox"&&ie.type!=="radio"?J&&Sp(J.elementType)&&(Ie=vw):Ie=sD;if(Ie&&(Ie=Ie(o,J))){gw(ye,Ie,h,he);break e}it&&it(o,ie,J),o==="focusout"&&J&&ie.type==="number"&&J.memoizedProps.value!=null&&xp(ie,"number",ie.value)}switch(it=J?Gu(J):window,o){case"focusin":(mw(it)||it.contentEditable==="true")&&(Is=it,Lp=J,tl=null);break;case"focusout":tl=Lp=Is=null;break;case"mousedown":Fp=!0;break;case"contextmenu":case"mouseup":case"dragend":Fp=!1,Tw(ye,h,he);break;case"selectionchange":if(fD)break;case"keydown":case"keyup":Tw(ye,h,he)}var Le;if(Op)e:{switch(o){case"compositionstart":var Pe="onCompositionStart";break e;case"compositionend":Pe="onCompositionEnd";break e;case"compositionupdate":Pe="onCompositionUpdate";break e}Pe=void 0}else Rs?dw(o,h)&&(Pe="onCompositionEnd"):o==="keydown"&&h.keyCode===229&&(Pe="onCompositionStart");Pe&&(cw&&h.locale!=="ko"&&(Rs||Pe!=="onCompositionStart"?Pe==="onCompositionEnd"&&Rs&&(Le=iw()):(wi=he,Np="value"in wi?wi.value:wi.textContent,Rs=!0)),it=Hf(J,Pe),0<it.length&&(Pe=new uw(Pe,o,null,h,he),ye.push({event:Pe,listeners:it}),Le?Pe.data=Le:(Le=pw(h),Le!==null&&(Pe.data=Le)))),(Le=eD?tD(o,h):nD(o,h))&&(Pe=Hf(J,"onBeforeInput"),0<Pe.length&&(it=new uw("onBeforeInput","beforeinput",null,h,he),ye.push({event:it,listeners:Pe}),it.data=Le)),XD(ye,o,J,h,he)}jx(ye,u)})}function Il(o,u,h){return{instance:o,listener:u,currentTarget:h}}function Hf(o,u){for(var h=u+"Capture",m=[];o!==null;){var y=o,E=y.stateNode;y=y.tag,y!==5&&y!==26&&y!==27||E===null||(y=Xu(o,h),y!=null&&m.unshift(Il(o,y,E)),y=Xu(o,u),y!=null&&m.push(Il(o,y,E))),o=o.return}return m}function Zs(o){if(o===null)return null;do o=o.return;while(o&&o.tag!==5&&o.tag!==27);return o||null}function Hx(o,u,h,m,y){for(var E=u._reactName,k=[];h!==null&&h!==m;){var z=h,H=z.alternate,J=z.stateNode;if(z=z.tag,H!==null&&H===m)break;z!==5&&z!==26&&z!==27||J===null||(H=J,y?(J=Xu(h,E),J!=null&&k.unshift(Il(h,J,H))):y||(J=Xu(h,E),J!=null&&k.push(Il(h,J,H)))),h=h.return}k.length!==0&&o.push({event:u,listeners:k})}var ZD=/\r\n?/g,QD=/\u0000|\uFFFD/g;function qx(o){return(typeof o=="string"?o:""+o).replace(ZD,`
`).replace(QD,"")}function Gx(o,u){return u=qx(u),qx(o)===u}function qf(){}function Nt(o,u,h,m,y,E){switch(h){case"children":typeof m=="string"?u==="body"||u==="textarea"&&m===""||As(o,m):(typeof m=="number"||typeof m=="bigint")&&u!=="body"&&As(o,""+m);break;case"className":Qc(o,"class",m);break;case"tabIndex":Qc(o,"tabindex",m);break;case"dir":case"role":case"viewBox":case"width":case"height":Qc(o,h,m);break;case"style":nw(o,m,E);break;case"data":if(u!=="object"){Qc(o,"data",m);break}case"src":case"href":if(m===""&&(u!=="a"||h!=="href")){o.removeAttribute(h);break}if(m==null||typeof m=="function"||typeof m=="symbol"||typeof m=="boolean"){o.removeAttribute(h);break}m=tf(""+m),o.setAttribute(h,m);break;case"action":case"formAction":if(typeof m=="function"){o.setAttribute(h,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof E=="function"&&(h==="formAction"?(u!=="input"&&Nt(o,u,"name",y.name,y,null),Nt(o,u,"formEncType",y.formEncType,y,null),Nt(o,u,"formMethod",y.formMethod,y,null),Nt(o,u,"formTarget",y.formTarget,y,null)):(Nt(o,u,"encType",y.encType,y,null),Nt(o,u,"method",y.method,y,null),Nt(o,u,"target",y.target,y,null)));if(m==null||typeof m=="symbol"||typeof m=="boolean"){o.removeAttribute(h);break}m=tf(""+m),o.setAttribute(h,m);break;case"onClick":m!=null&&(o.onclick=qf);break;case"onScroll":m!=null&&ht("scroll",o);break;case"onScrollEnd":m!=null&&ht("scrollend",o);break;case"dangerouslySetInnerHTML":if(m!=null){if(typeof m!="object"||!("__html"in m))throw Error(n(61));if(h=m.__html,h!=null){if(y.children!=null)throw Error(n(60));o.innerHTML=h}}break;case"multiple":o.multiple=m&&typeof m!="function"&&typeof m!="symbol";break;case"muted":o.muted=m&&typeof m!="function"&&typeof m!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(m==null||typeof m=="function"||typeof m=="boolean"||typeof m=="symbol"){o.removeAttribute("xlink:href");break}h=tf(""+m),o.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",h);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":m!=null&&typeof m!="function"&&typeof m!="symbol"?o.setAttribute(h,""+m):o.removeAttribute(h);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":m&&typeof m!="function"&&typeof m!="symbol"?o.setAttribute(h,""):o.removeAttribute(h);break;case"capture":case"download":m===!0?o.setAttribute(h,""):m!==!1&&m!=null&&typeof m!="function"&&typeof m!="symbol"?o.setAttribute(h,m):o.removeAttribute(h);break;case"cols":case"rows":case"size":case"span":m!=null&&typeof m!="function"&&typeof m!="symbol"&&!isNaN(m)&&1<=m?o.setAttribute(h,m):o.removeAttribute(h);break;case"rowSpan":case"start":m==null||typeof m=="function"||typeof m=="symbol"||isNaN(m)?o.removeAttribute(h):o.setAttribute(h,m);break;case"popover":ht("beforetoggle",o),ht("toggle",o),Zc(o,"popover",m);break;case"xlinkActuate":La(o,"http://www.w3.org/1999/xlink","xlink:actuate",m);break;case"xlinkArcrole":La(o,"http://www.w3.org/1999/xlink","xlink:arcrole",m);break;case"xlinkRole":La(o,"http://www.w3.org/1999/xlink","xlink:role",m);break;case"xlinkShow":La(o,"http://www.w3.org/1999/xlink","xlink:show",m);break;case"xlinkTitle":La(o,"http://www.w3.org/1999/xlink","xlink:title",m);break;case"xlinkType":La(o,"http://www.w3.org/1999/xlink","xlink:type",m);break;case"xmlBase":La(o,"http://www.w3.org/XML/1998/namespace","xml:base",m);break;case"xmlLang":La(o,"http://www.w3.org/XML/1998/namespace","xml:lang",m);break;case"xmlSpace":La(o,"http://www.w3.org/XML/1998/namespace","xml:space",m);break;case"is":Zc(o,"is",m);break;case"innerText":case"textContent":break;default:(!(2<h.length)||h[0]!=="o"&&h[0]!=="O"||h[1]!=="n"&&h[1]!=="N")&&(h=Nk.get(h)||h,Zc(o,h,m))}}function og(o,u,h,m,y,E){switch(h){case"style":nw(o,m,E);break;case"dangerouslySetInnerHTML":if(m!=null){if(typeof m!="object"||!("__html"in m))throw Error(n(61));if(h=m.__html,h!=null){if(y.children!=null)throw Error(n(60));o.innerHTML=h}}break;case"children":typeof m=="string"?As(o,m):(typeof m=="number"||typeof m=="bigint")&&As(o,""+m);break;case"onScroll":m!=null&&ht("scroll",o);break;case"onScrollEnd":m!=null&&ht("scrollend",o);break;case"onClick":m!=null&&(o.onclick=qf);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!X0.hasOwnProperty(h))e:{if(h[0]==="o"&&h[1]==="n"&&(y=h.endsWith("Capture"),u=h.slice(2,y?h.length-7:void 0),E=o[ar]||null,E=E!=null?E[h]:null,typeof E=="function"&&o.removeEventListener(u,E,y),typeof m=="function")){typeof E!="function"&&E!==null&&(h in o?o[h]=null:o.hasAttribute(h)&&o.removeAttribute(h)),o.addEventListener(u,m,y);break e}h in o?o[h]=m:m===!0?o.setAttribute(h,""):Zc(o,h,m)}}}function zn(o,u,h){switch(u){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ht("error",o),ht("load",o);var m=!1,y=!1,E;for(E in h)if(h.hasOwnProperty(E)){var k=h[E];if(k!=null)switch(E){case"src":m=!0;break;case"srcSet":y=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,u));default:Nt(o,u,E,k,h,null)}}y&&Nt(o,u,"srcSet",h.srcSet,h,null),m&&Nt(o,u,"src",h.src,h,null);return;case"input":ht("invalid",o);var z=E=k=y=null,H=null,J=null;for(m in h)if(h.hasOwnProperty(m)){var he=h[m];if(he!=null)switch(m){case"name":y=he;break;case"type":k=he;break;case"checked":H=he;break;case"defaultChecked":J=he;break;case"value":E=he;break;case"defaultValue":z=he;break;case"children":case"dangerouslySetInnerHTML":if(he!=null)throw Error(n(137,u));break;default:Nt(o,u,m,he,h,null)}}Q0(o,E,z,H,J,k,y,!1),Jc(o);return;case"select":ht("invalid",o),m=k=E=null;for(y in h)if(h.hasOwnProperty(y)&&(z=h[y],z!=null))switch(y){case"value":E=z;break;case"defaultValue":k=z;break;case"multiple":m=z;default:Nt(o,u,y,z,h,null)}u=E,h=k,o.multiple=!!m,u!=null?Cs(o,!!m,u,!1):h!=null&&Cs(o,!!m,h,!0);return;case"textarea":ht("invalid",o),E=y=m=null;for(k in h)if(h.hasOwnProperty(k)&&(z=h[k],z!=null))switch(k){case"value":m=z;break;case"defaultValue":y=z;break;case"children":E=z;break;case"dangerouslySetInnerHTML":if(z!=null)throw Error(n(91));break;default:Nt(o,u,k,z,h,null)}ew(o,m,y,E),Jc(o);return;case"option":for(H in h)if(h.hasOwnProperty(H)&&(m=h[H],m!=null))switch(H){case"selected":o.selected=m&&typeof m!="function"&&typeof m!="symbol";break;default:Nt(o,u,H,m,h,null)}return;case"dialog":ht("cancel",o),ht("close",o);break;case"iframe":case"object":ht("load",o);break;case"video":case"audio":for(m=0;m<Rl.length;m++)ht(Rl[m],o);break;case"image":ht("error",o),ht("load",o);break;case"details":ht("toggle",o);break;case"embed":case"source":case"link":ht("error",o),ht("load",o);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(J in h)if(h.hasOwnProperty(J)&&(m=h[J],m!=null))switch(J){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,u));default:Nt(o,u,J,m,h,null)}return;default:if(Sp(u)){for(he in h)h.hasOwnProperty(he)&&(m=h[he],m!==void 0&&og(o,u,he,m,h,void 0));return}}for(z in h)h.hasOwnProperty(z)&&(m=h[z],m!=null&&Nt(o,u,z,m,h,null))}function JD(o,u,h,m){switch(u){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var y=null,E=null,k=null,z=null,H=null,J=null,he=null;for(fe in h){var ye=h[fe];if(h.hasOwnProperty(fe)&&ye!=null)switch(fe){case"checked":break;case"value":break;case"defaultValue":H=ye;default:m.hasOwnProperty(fe)||Nt(o,u,fe,null,m,ye)}}for(var ie in m){var fe=m[ie];if(ye=h[ie],m.hasOwnProperty(ie)&&(fe!=null||ye!=null))switch(ie){case"type":E=fe;break;case"name":y=fe;break;case"checked":J=fe;break;case"defaultChecked":he=fe;break;case"value":k=fe;break;case"defaultValue":z=fe;break;case"children":case"dangerouslySetInnerHTML":if(fe!=null)throw Error(n(137,u));break;default:fe!==ye&&Nt(o,u,ie,fe,m,ye)}}wp(o,k,z,H,J,he,E,y);return;case"select":fe=k=z=ie=null;for(E in h)if(H=h[E],h.hasOwnProperty(E)&&H!=null)switch(E){case"value":break;case"multiple":fe=H;default:m.hasOwnProperty(E)||Nt(o,u,E,null,m,H)}for(y in m)if(E=m[y],H=h[y],m.hasOwnProperty(y)&&(E!=null||H!=null))switch(y){case"value":ie=E;break;case"defaultValue":z=E;break;case"multiple":k=E;default:E!==H&&Nt(o,u,y,E,m,H)}u=z,h=k,m=fe,ie!=null?Cs(o,!!h,ie,!1):!!m!=!!h&&(u!=null?Cs(o,!!h,u,!0):Cs(o,!!h,h?[]:"",!1));return;case"textarea":fe=ie=null;for(z in h)if(y=h[z],h.hasOwnProperty(z)&&y!=null&&!m.hasOwnProperty(z))switch(z){case"value":break;case"children":break;default:Nt(o,u,z,null,m,y)}for(k in m)if(y=m[k],E=h[k],m.hasOwnProperty(k)&&(y!=null||E!=null))switch(k){case"value":ie=y;break;case"defaultValue":fe=y;break;case"children":break;case"dangerouslySetInnerHTML":if(y!=null)throw Error(n(91));break;default:y!==E&&Nt(o,u,k,y,m,E)}J0(o,ie,fe);return;case"option":for(var ze in h)if(ie=h[ze],h.hasOwnProperty(ze)&&ie!=null&&!m.hasOwnProperty(ze))switch(ze){case"selected":o.selected=!1;break;default:Nt(o,u,ze,null,m,ie)}for(H in m)if(ie=m[H],fe=h[H],m.hasOwnProperty(H)&&ie!==fe&&(ie!=null||fe!=null))switch(H){case"selected":o.selected=ie&&typeof ie!="function"&&typeof ie!="symbol";break;default:Nt(o,u,H,ie,m,fe)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ke in h)ie=h[Ke],h.hasOwnProperty(Ke)&&ie!=null&&!m.hasOwnProperty(Ke)&&Nt(o,u,Ke,null,m,ie);for(J in m)if(ie=m[J],fe=h[J],m.hasOwnProperty(J)&&ie!==fe&&(ie!=null||fe!=null))switch(J){case"children":case"dangerouslySetInnerHTML":if(ie!=null)throw Error(n(137,u));break;default:Nt(o,u,J,ie,m,fe)}return;default:if(Sp(u)){for(var Yt in h)ie=h[Yt],h.hasOwnProperty(Yt)&&ie!==void 0&&!m.hasOwnProperty(Yt)&&og(o,u,Yt,void 0,m,ie);for(he in m)ie=m[he],fe=h[he],!m.hasOwnProperty(he)||ie===fe||ie===void 0&&fe===void 0||og(o,u,he,ie,m,fe);return}}for(var te in h)ie=h[te],h.hasOwnProperty(te)&&ie!=null&&!m.hasOwnProperty(te)&&Nt(o,u,te,null,m,ie);for(ye in m)ie=m[ye],fe=h[ye],!m.hasOwnProperty(ye)||ie===fe||ie==null&&fe==null||Nt(o,u,ye,ie,m,fe)}var sg=null,ug=null;function Gf(o){return o.nodeType===9?o:o.ownerDocument}function Xx(o){switch(o){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function $x(o,u){if(o===0)switch(u){case"svg":return 1;case"math":return 2;default:return 0}return o===1&&u==="foreignObject"?0:o}function lg(o,u){return o==="textarea"||o==="noscript"||typeof u.children=="string"||typeof u.children=="number"||typeof u.children=="bigint"||typeof u.dangerouslySetInnerHTML=="object"&&u.dangerouslySetInnerHTML!==null&&u.dangerouslySetInnerHTML.__html!=null}var cg=null;function eO(){var o=window.event;return o&&o.type==="popstate"?o===cg?!1:(cg=o,!0):(cg=null,!1)}var Kx=typeof setTimeout=="function"?setTimeout:void 0,tO=typeof clearTimeout=="function"?clearTimeout:void 0,Yx=typeof Promise=="function"?Promise:void 0,nO=typeof queueMicrotask=="function"?queueMicrotask:typeof Yx<"u"?function(o){return Yx.resolve(null).then(o).catch(rO)}:Kx;function rO(o){setTimeout(function(){throw o})}function fg(o,u){var h=u,m=0;do{var y=h.nextSibling;if(o.removeChild(h),y&&y.nodeType===8)if(h=y.data,h==="/$"){if(m===0){o.removeChild(y),Fl(u);return}m--}else h!=="$"&&h!=="$?"&&h!=="$!"||m++;h=y}while(h);Fl(u)}function hg(o){var u=o.firstChild;for(u&&u.nodeType===10&&(u=u.nextSibling);u;){var h=u;switch(u=u.nextSibling,h.nodeName){case"HTML":case"HEAD":case"BODY":hg(h),bp(h);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(h.rel.toLowerCase()==="stylesheet")continue}o.removeChild(h)}}function aO(o,u,h,m){for(;o.nodeType===1;){var y=h;if(o.nodeName.toLowerCase()!==u.toLowerCase()){if(!m&&(o.nodeName!=="INPUT"||o.type!=="hidden"))break}else if(m){if(!o[qu])switch(u){case"meta":if(!o.hasAttribute("itemprop"))break;return o;case"link":if(E=o.getAttribute("rel"),E==="stylesheet"&&o.hasAttribute("data-precedence"))break;if(E!==y.rel||o.getAttribute("href")!==(y.href==null?null:y.href)||o.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin)||o.getAttribute("title")!==(y.title==null?null:y.title))break;return o;case"style":if(o.hasAttribute("data-precedence"))break;return o;case"script":if(E=o.getAttribute("src"),(E!==(y.src==null?null:y.src)||o.getAttribute("type")!==(y.type==null?null:y.type)||o.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin))&&E&&o.hasAttribute("async")&&!o.hasAttribute("itemprop"))break;return o;default:return o}}else if(u==="input"&&o.type==="hidden"){var E=y.name==null?null:""+y.name;if(y.type==="hidden"&&o.getAttribute("name")===E)return o}else return o;if(o=Qr(o.nextSibling),o===null)break}return null}function iO(o,u,h){if(u==="")return null;for(;o.nodeType!==3;)if((o.nodeType!==1||o.nodeName!=="INPUT"||o.type!=="hidden")&&!h||(o=Qr(o.nextSibling),o===null))return null;return o}function Qr(o){for(;o!=null;o=o.nextSibling){var u=o.nodeType;if(u===1||u===3)break;if(u===8){if(u=o.data,u==="$"||u==="$!"||u==="$?"||u==="F!"||u==="F")break;if(u==="/$")return null}}return o}function Zx(o){o=o.previousSibling;for(var u=0;o;){if(o.nodeType===8){var h=o.data;if(h==="$"||h==="$!"||h==="$?"){if(u===0)return o;u--}else h==="/$"&&u++}o=o.previousSibling}return null}function Qx(o,u,h){switch(u=Gf(h),o){case"html":if(o=u.documentElement,!o)throw Error(n(452));return o;case"head":if(o=u.head,!o)throw Error(n(453));return o;case"body":if(o=u.body,!o)throw Error(n(454));return o;default:throw Error(n(451))}}var Hr=new Map,Jx=new Set;function Xf(o){return typeof o.getRootNode=="function"?o.getRootNode():o.ownerDocument}var Za=de.d;de.d={f:oO,r:sO,D:uO,C:lO,L:cO,m:fO,X:dO,S:hO,M:pO};function oO(){var o=Za.f(),u=Uf();return o||u}function sO(o){var u=xs(o);u!==null&&u.tag===5&&u.type==="form"?T1(u):Za.r(o)}var Qs=typeof document>"u"?null:document;function e2(o,u,h){var m=Qs;if(m&&typeof u=="string"&&u){var y=Mr(u);y='link[rel="'+o+'"][href="'+y+'"]',typeof h=="string"&&(y+='[crossorigin="'+h+'"]'),Jx.has(y)||(Jx.add(y),o={rel:o,crossOrigin:h,href:u},m.querySelector(y)===null&&(u=m.createElement("link"),zn(u,"link",o),An(u),m.head.appendChild(u)))}}function uO(o){Za.D(o),e2("dns-prefetch",o,null)}function lO(o,u){Za.C(o,u),e2("preconnect",o,u)}function cO(o,u,h){Za.L(o,u,h);var m=Qs;if(m&&o&&u){var y='link[rel="preload"][as="'+Mr(u)+'"]';u==="image"&&h&&h.imageSrcSet?(y+='[imagesrcset="'+Mr(h.imageSrcSet)+'"]',typeof h.imageSizes=="string"&&(y+='[imagesizes="'+Mr(h.imageSizes)+'"]')):y+='[href="'+Mr(o)+'"]';var E=y;switch(u){case"style":E=Js(o);break;case"script":E=eu(o)}Hr.has(E)||(o=_({rel:"preload",href:u==="image"&&h&&h.imageSrcSet?void 0:o,as:u},h),Hr.set(E,o),m.querySelector(y)!==null||u==="style"&&m.querySelector(kl(E))||u==="script"&&m.querySelector(Dl(E))||(u=m.createElement("link"),zn(u,"link",o),An(u),m.head.appendChild(u)))}}function fO(o,u){Za.m(o,u);var h=Qs;if(h&&o){var m=u&&typeof u.as=="string"?u.as:"script",y='link[rel="modulepreload"][as="'+Mr(m)+'"][href="'+Mr(o)+'"]',E=y;switch(m){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":E=eu(o)}if(!Hr.has(E)&&(o=_({rel:"modulepreload",href:o},u),Hr.set(E,o),h.querySelector(y)===null)){switch(m){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(h.querySelector(Dl(E)))return}m=h.createElement("link"),zn(m,"link",o),An(m),h.head.appendChild(m)}}}function hO(o,u,h){Za.S(o,u,h);var m=Qs;if(m&&o){var y=Ss(m).hoistableStyles,E=Js(o);u=u||"default";var k=y.get(E);if(!k){var z={loading:0,preload:null};if(k=m.querySelector(kl(E)))z.loading=5;else{o=_({rel:"stylesheet",href:o,"data-precedence":u},h),(h=Hr.get(E))&&dg(o,h);var H=k=m.createElement("link");An(H),zn(H,"link",o),H._p=new Promise(function(J,he){H.onload=J,H.onerror=he}),H.addEventListener("load",function(){z.loading|=1}),H.addEventListener("error",function(){z.loading|=2}),z.loading|=4,$f(k,u,m)}k={type:"stylesheet",instance:k,count:1,state:z},y.set(E,k)}}}function dO(o,u){Za.X(o,u);var h=Qs;if(h&&o){var m=Ss(h).hoistableScripts,y=eu(o),E=m.get(y);E||(E=h.querySelector(Dl(y)),E||(o=_({src:o,async:!0},u),(u=Hr.get(y))&&pg(o,u),E=h.createElement("script"),An(E),zn(E,"link",o),h.head.appendChild(E)),E={type:"script",instance:E,count:1,state:null},m.set(y,E))}}function pO(o,u){Za.M(o,u);var h=Qs;if(h&&o){var m=Ss(h).hoistableScripts,y=eu(o),E=m.get(y);E||(E=h.querySelector(Dl(y)),E||(o=_({src:o,async:!0,type:"module"},u),(u=Hr.get(y))&&pg(o,u),E=h.createElement("script"),An(E),zn(E,"link",o),h.head.appendChild(E)),E={type:"script",instance:E,count:1,state:null},m.set(y,E))}}function t2(o,u,h,m){var y=(y=qe.current)?Xf(y):null;if(!y)throw Error(n(446));switch(o){case"meta":case"title":return null;case"style":return typeof h.precedence=="string"&&typeof h.href=="string"?(u=Js(h.href),h=Ss(y).hoistableStyles,m=h.get(u),m||(m={type:"style",instance:null,count:0,state:null},h.set(u,m)),m):{type:"void",instance:null,count:0,state:null};case"link":if(h.rel==="stylesheet"&&typeof h.href=="string"&&typeof h.precedence=="string"){o=Js(h.href);var E=Ss(y).hoistableStyles,k=E.get(o);if(k||(y=y.ownerDocument||y,k={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},E.set(o,k),(E=y.querySelector(kl(o)))&&!E._p&&(k.instance=E,k.state.loading=5),Hr.has(o)||(h={rel:"preload",as:"style",href:h.href,crossOrigin:h.crossOrigin,integrity:h.integrity,media:h.media,hrefLang:h.hrefLang,referrerPolicy:h.referrerPolicy},Hr.set(o,h),E||mO(y,o,h,k.state))),u&&m===null)throw Error(n(528,""));return k}if(u&&m!==null)throw Error(n(529,""));return null;case"script":return u=h.async,h=h.src,typeof h=="string"&&u&&typeof u!="function"&&typeof u!="symbol"?(u=eu(h),h=Ss(y).hoistableScripts,m=h.get(u),m||(m={type:"script",instance:null,count:0,state:null},h.set(u,m)),m):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,o))}}function Js(o){return'href="'+Mr(o)+'"'}function kl(o){return'link[rel="stylesheet"]['+o+"]"}function n2(o){return _({},o,{"data-precedence":o.precedence,precedence:null})}function mO(o,u,h,m){o.querySelector('link[rel="preload"][as="style"]['+u+"]")?m.loading=1:(u=o.createElement("link"),m.preload=u,u.addEventListener("load",function(){return m.loading|=1}),u.addEventListener("error",function(){return m.loading|=2}),zn(u,"link",h),An(u),o.head.appendChild(u))}function eu(o){return'[src="'+Mr(o)+'"]'}function Dl(o){return"script[async]"+o}function r2(o,u,h){if(u.count++,u.instance===null)switch(u.type){case"style":var m=o.querySelector('style[data-href~="'+Mr(h.href)+'"]');if(m)return u.instance=m,An(m),m;var y=_({},h,{"data-href":h.href,"data-precedence":h.precedence,href:null,precedence:null});return m=(o.ownerDocument||o).createElement("style"),An(m),zn(m,"style",y),$f(m,h.precedence,o),u.instance=m;case"stylesheet":y=Js(h.href);var E=o.querySelector(kl(y));if(E)return u.state.loading|=4,u.instance=E,An(E),E;m=n2(h),(y=Hr.get(y))&&dg(m,y),E=(o.ownerDocument||o).createElement("link"),An(E);var k=E;return k._p=new Promise(function(z,H){k.onload=z,k.onerror=H}),zn(E,"link",m),u.state.loading|=4,$f(E,h.precedence,o),u.instance=E;case"script":return E=eu(h.src),(y=o.querySelector(Dl(E)))?(u.instance=y,An(y),y):(m=h,(y=Hr.get(E))&&(m=_({},h),pg(m,y)),o=o.ownerDocument||o,y=o.createElement("script"),An(y),zn(y,"link",m),o.head.appendChild(y),u.instance=y);case"void":return null;default:throw Error(n(443,u.type))}else u.type==="stylesheet"&&(u.state.loading&4)===0&&(m=u.instance,u.state.loading|=4,$f(m,h.precedence,o));return u.instance}function $f(o,u,h){for(var m=h.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),y=m.length?m[m.length-1]:null,E=y,k=0;k<m.length;k++){var z=m[k];if(z.dataset.precedence===u)E=z;else if(E!==y)break}E?E.parentNode.insertBefore(o,E.nextSibling):(u=h.nodeType===9?h.head:h,u.insertBefore(o,u.firstChild))}function dg(o,u){o.crossOrigin==null&&(o.crossOrigin=u.crossOrigin),o.referrerPolicy==null&&(o.referrerPolicy=u.referrerPolicy),o.title==null&&(o.title=u.title)}function pg(o,u){o.crossOrigin==null&&(o.crossOrigin=u.crossOrigin),o.referrerPolicy==null&&(o.referrerPolicy=u.referrerPolicy),o.integrity==null&&(o.integrity=u.integrity)}var Kf=null;function a2(o,u,h){if(Kf===null){var m=new Map,y=Kf=new Map;y.set(h,m)}else y=Kf,m=y.get(h),m||(m=new Map,y.set(h,m));if(m.has(o))return m;for(m.set(o,null),h=h.getElementsByTagName(o),y=0;y<h.length;y++){var E=h[y];if(!(E[qu]||E[jn]||o==="link"&&E.getAttribute("rel")==="stylesheet")&&E.namespaceURI!=="http://www.w3.org/2000/svg"){var k=E.getAttribute(u)||"";k=o+k;var z=m.get(k);z?z.push(E):m.set(k,[E])}}return m}function i2(o,u,h){o=o.ownerDocument||o,o.head.insertBefore(h,u==="title"?o.querySelector("head > title"):null)}function gO(o,u,h){if(h===1||u.itemProp!=null)return!1;switch(o){case"meta":case"title":return!0;case"style":if(typeof u.precedence!="string"||typeof u.href!="string"||u.href==="")break;return!0;case"link":if(typeof u.rel!="string"||typeof u.href!="string"||u.href===""||u.onLoad||u.onError)break;switch(u.rel){case"stylesheet":return o=u.disabled,typeof u.precedence=="string"&&o==null;default:return!0}case"script":if(u.async&&typeof u.async!="function"&&typeof u.async!="symbol"&&!u.onLoad&&!u.onError&&u.src&&typeof u.src=="string")return!0}return!1}function o2(o){return!(o.type==="stylesheet"&&(o.state.loading&3)===0)}var Ol=null;function vO(){}function yO(o,u,h){if(Ol===null)throw Error(n(475));var m=Ol;if(u.type==="stylesheet"&&(typeof h.media!="string"||matchMedia(h.media).matches!==!1)&&(u.state.loading&4)===0){if(u.instance===null){var y=Js(h.href),E=o.querySelector(kl(y));if(E){o=E._p,o!==null&&typeof o=="object"&&typeof o.then=="function"&&(m.count++,m=Yf.bind(m),o.then(m,m)),u.state.loading|=4,u.instance=E,An(E);return}E=o.ownerDocument||o,h=n2(h),(y=Hr.get(y))&&dg(h,y),E=E.createElement("link"),An(E);var k=E;k._p=new Promise(function(z,H){k.onload=z,k.onerror=H}),zn(E,"link",h),u.instance=E}m.stylesheets===null&&(m.stylesheets=new Map),m.stylesheets.set(u,o),(o=u.state.preload)&&(u.state.loading&3)===0&&(m.count++,u=Yf.bind(m),o.addEventListener("load",u),o.addEventListener("error",u))}}function bO(){if(Ol===null)throw Error(n(475));var o=Ol;return o.stylesheets&&o.count===0&&mg(o,o.stylesheets),0<o.count?function(u){var h=setTimeout(function(){if(o.stylesheets&&mg(o,o.stylesheets),o.unsuspend){var m=o.unsuspend;o.unsuspend=null,m()}},6e4);return o.unsuspend=u,function(){o.unsuspend=null,clearTimeout(h)}}:null}function Yf(){if(this.count--,this.count===0){if(this.stylesheets)mg(this,this.stylesheets);else if(this.unsuspend){var o=this.unsuspend;this.unsuspend=null,o()}}}var Zf=null;function mg(o,u){o.stylesheets=null,o.unsuspend!==null&&(o.count++,Zf=new Map,u.forEach(wO,o),Zf=null,Yf.call(o))}function wO(o,u){if(!(u.state.loading&4)){var h=Zf.get(o);if(h)var m=h.get(null);else{h=new Map,Zf.set(o,h);for(var y=o.querySelectorAll("link[data-precedence],style[data-precedence]"),E=0;E<y.length;E++){var k=y[E];(k.nodeName==="LINK"||k.getAttribute("media")!=="not all")&&(h.set(k.dataset.precedence,k),m=k)}m&&h.set(null,m)}y=u.instance,k=y.getAttribute("data-precedence"),E=h.get(k)||m,E===m&&h.set(null,y),h.set(k,y),this.count++,m=Yf.bind(this),y.addEventListener("load",m),y.addEventListener("error",m),E?E.parentNode.insertBefore(y,E.nextSibling):(o=o.nodeType===9?o.head:o,o.insertBefore(y,o.firstChild)),u.state.loading|=4}}var _l={$$typeof:v,Provider:null,Consumer:null,_currentValue:xe,_currentValue2:xe,_threadCount:0};function xO(o,u,h,m,y,E,k,z){this.tag=1,this.containerInfo=o,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Or(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Or(0),this.hiddenUpdates=Or(null),this.identifierPrefix=m,this.onUncaughtError=y,this.onCaughtError=E,this.onRecoverableError=k,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=z,this.incompleteTransitions=new Map}function s2(o,u,h,m,y,E,k,z,H,J,he,ye){return o=new xO(o,u,h,k,z,H,J,ye),u=1,E===!0&&(u|=24),E=jr(3,null,null,u),o.current=E,E.stateNode=o,u=Xp(),u.refCount++,o.pooledCache=u,u.refCount++,E.memoizedState={element:m,isDehydrated:h,cache:u},Nm(E),o}function u2(o){return o?(o=Os,o):Os}function l2(o,u,h,m,y,E){y=u2(y),m.context===null?m.context=y:m.pendingContext=y,m=Ri(u),m.payload={element:h},E=E===void 0?null:E,E!==null&&(m.callback=E),h=Ii(o,m,u),h!==null&&(Kn(h,o,u),gl(h,o,u))}function c2(o,u){if(o=o.memoizedState,o!==null&&o.dehydrated!==null){var h=o.retryLane;o.retryLane=h!==0&&h<u?h:u}}function gg(o,u){c2(o,u),(o=o.alternate)&&c2(o,u)}function f2(o){if(o.tag===13){var u=xi(o,67108864);u!==null&&Kn(u,o,67108864),gg(o,67108864)}}var Qf=!0;function SO(o,u,h,m){var y=I.T;I.T=null;var E=de.p;try{de.p=2,vg(o,u,h,m)}finally{de.p=E,I.T=y}}function EO(o,u,h,m){var y=I.T;I.T=null;var E=de.p;try{de.p=8,vg(o,u,h,m)}finally{de.p=E,I.T=y}}function vg(o,u,h,m){if(Qf){var y=yg(m);if(y===null)ig(o,u,m,Jf,h),d2(o,m);else if(AO(y,o,u,h,m))m.stopPropagation();else if(d2(o,m),u&4&&-1<CO.indexOf(o)){for(;y!==null;){var E=xs(y);if(E!==null)switch(E.tag){case 3:if(E=E.stateNode,E.current.memoizedState.isDehydrated){var k=Et(E.pendingLanes);if(k!==0){var z=E;for(z.pendingLanes|=2,z.entangledLanes|=2;k;){var H=1<<31-vn(k);z.entanglements[1]|=H,k&=~H}wa(E),(Wt&6)===0&&(Lf=kt()+500,Nl(0))}}break;case 13:z=xi(E,2),z!==null&&Kn(z,E,2),Uf(),gg(E,2)}if(E=yg(m),E===null&&ig(o,u,m,Jf,h),E===y)break;y=E}y!==null&&m.stopPropagation()}else ig(o,u,m,null,h)}}function yg(o){return o=Cp(o),bg(o)}var Jf=null;function bg(o){if(Jf=null,o=fo(o),o!==null){var u=q(o);if(u===null)o=null;else{var h=u.tag;if(h===13){if(o=ne(u),o!==null)return o;o=null}else if(h===3){if(u.stateNode.current.memoizedState.isDehydrated)return u.tag===3?u.stateNode.containerInfo:null;o=null}else u!==o&&(o=null)}}return Jf=o,null}function h2(o){switch(o){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Bt()){case Gt:return 2;case Pn:return 8;case mn:case Xt:return 32;case pr:return 268435456;default:return 32}default:return 32}}var wg=!1,Li=null,Fi=null,Bi=null,Ml=new Map,zl=new Map,Ui=[],CO="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function d2(o,u){switch(o){case"focusin":case"focusout":Li=null;break;case"dragenter":case"dragleave":Fi=null;break;case"mouseover":case"mouseout":Bi=null;break;case"pointerover":case"pointerout":Ml.delete(u.pointerId);break;case"gotpointercapture":case"lostpointercapture":zl.delete(u.pointerId)}}function Ll(o,u,h,m,y,E){return o===null||o.nativeEvent!==E?(o={blockedOn:u,domEventName:h,eventSystemFlags:m,nativeEvent:E,targetContainers:[y]},u!==null&&(u=xs(u),u!==null&&f2(u)),o):(o.eventSystemFlags|=m,u=o.targetContainers,y!==null&&u.indexOf(y)===-1&&u.push(y),o)}function AO(o,u,h,m,y){switch(u){case"focusin":return Li=Ll(Li,o,u,h,m,y),!0;case"dragenter":return Fi=Ll(Fi,o,u,h,m,y),!0;case"mouseover":return Bi=Ll(Bi,o,u,h,m,y),!0;case"pointerover":var E=y.pointerId;return Ml.set(E,Ll(Ml.get(E)||null,o,u,h,m,y)),!0;case"gotpointercapture":return E=y.pointerId,zl.set(E,Ll(zl.get(E)||null,o,u,h,m,y)),!0}return!1}function p2(o){var u=fo(o.target);if(u!==null){var h=q(u);if(h!==null){if(u=h.tag,u===13){if(u=ne(h),u!==null){o.blockedOn=u,bk(o.priority,function(){if(h.tag===13){var m=br(),y=xi(h,m);y!==null&&Kn(y,h,m),gg(h,m)}});return}}else if(u===3&&h.stateNode.current.memoizedState.isDehydrated){o.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}o.blockedOn=null}function eh(o){if(o.blockedOn!==null)return!1;for(var u=o.targetContainers;0<u.length;){var h=yg(o.nativeEvent);if(h===null){h=o.nativeEvent;var m=new h.constructor(h.type,h);Ep=m,h.target.dispatchEvent(m),Ep=null}else return u=xs(h),u!==null&&f2(u),o.blockedOn=h,!1;u.shift()}return!0}function m2(o,u,h){eh(o)&&h.delete(u)}function TO(){wg=!1,Li!==null&&eh(Li)&&(Li=null),Fi!==null&&eh(Fi)&&(Fi=null),Bi!==null&&eh(Bi)&&(Bi=null),Ml.forEach(m2),zl.forEach(m2)}function th(o,u){o.blockedOn===u&&(o.blockedOn=null,wg||(wg=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,TO)))}var nh=null;function g2(o){nh!==o&&(nh=o,r.unstable_scheduleCallback(r.unstable_NormalPriority,function(){nh===o&&(nh=null);for(var u=0;u<o.length;u+=3){var h=o[u],m=o[u+1],y=o[u+2];if(typeof m!="function"){if(bg(m||h)===null)continue;break}var E=xs(h);E!==null&&(o.splice(u,3),u-=3,lm(E,{pending:!0,data:y,method:h.method,action:m},m,y))}}))}function Fl(o){function u(H){return th(H,o)}Li!==null&&th(Li,o),Fi!==null&&th(Fi,o),Bi!==null&&th(Bi,o),Ml.forEach(u),zl.forEach(u);for(var h=0;h<Ui.length;h++){var m=Ui[h];m.blockedOn===o&&(m.blockedOn=null)}for(;0<Ui.length&&(h=Ui[0],h.blockedOn===null);)p2(h),h.blockedOn===null&&Ui.shift();if(h=(o.ownerDocument||o).$$reactFormReplay,h!=null)for(m=0;m<h.length;m+=3){var y=h[m],E=h[m+1],k=y[ar]||null;if(typeof E=="function")k||g2(h);else if(k){var z=null;if(E&&E.hasAttribute("formAction")){if(y=E,k=E[ar]||null)z=k.formAction;else if(bg(y)!==null)continue}else z=k.action;typeof z=="function"?h[m+1]=z:(h.splice(m,3),m-=3),g2(h)}}}function xg(o){this._internalRoot=o}rh.prototype.render=xg.prototype.render=function(o){var u=this._internalRoot;if(u===null)throw Error(n(409));var h=u.current,m=br();l2(h,m,o,u,null,null)},rh.prototype.unmount=xg.prototype.unmount=function(){var o=this._internalRoot;if(o!==null){this._internalRoot=null;var u=o.containerInfo;o.tag===0&&Ks(),l2(o.current,2,null,o,null,null),Uf(),u[ws]=null}};function rh(o){this._internalRoot=o}rh.prototype.unstable_scheduleHydration=function(o){if(o){var u=H0();o={blockedOn:null,target:o,priority:u};for(var h=0;h<Ui.length&&u!==0&&u<Ui[h].priority;h++);Ui.splice(h,0,o),h===0&&p2(o)}};var v2=t.version;if(v2!=="19.0.0")throw Error(n(527,v2,"19.0.0"));de.findDOMNode=function(o){var u=o._reactInternals;if(u===void 0)throw typeof o.render=="function"?Error(n(188)):(o=Object.keys(o).join(","),Error(n(268,o)));return o=Z(u),o=o!==null?ce(o):null,o=o===null?null:o.stateNode,o};var NO={bundleType:0,version:"19.0.0",rendererPackageName:"react-dom",currentDispatcherRef:I,findFiberByHostInstance:fo,reconcilerVersion:"19.0.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ah=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ah.isDisabled&&ah.supportsFiber)try{Dr=ah.inject(NO),gn=ah}catch{}}return Ul.createRoot=function(o,u){if(!a(o))throw Error(n(299));var h=!1,m="",y=M1,E=z1,k=L1,z=null;return u!=null&&(u.unstable_strictMode===!0&&(h=!0),u.identifierPrefix!==void 0&&(m=u.identifierPrefix),u.onUncaughtError!==void 0&&(y=u.onUncaughtError),u.onCaughtError!==void 0&&(E=u.onCaughtError),u.onRecoverableError!==void 0&&(k=u.onRecoverableError),u.unstable_transitionCallbacks!==void 0&&(z=u.unstable_transitionCallbacks)),u=s2(o,1,!1,null,null,h,m,y,E,k,z,null),o[ws]=u.current,ag(o.nodeType===8?o.parentNode:o),new xg(u)},Ul.hydrateRoot=function(o,u,h){if(!a(o))throw Error(n(299));var m=!1,y="",E=M1,k=z1,z=L1,H=null,J=null;return h!=null&&(h.unstable_strictMode===!0&&(m=!0),h.identifierPrefix!==void 0&&(y=h.identifierPrefix),h.onUncaughtError!==void 0&&(E=h.onUncaughtError),h.onCaughtError!==void 0&&(k=h.onCaughtError),h.onRecoverableError!==void 0&&(z=h.onRecoverableError),h.unstable_transitionCallbacks!==void 0&&(H=h.unstable_transitionCallbacks),h.formState!==void 0&&(J=h.formState)),u=s2(o,1,!0,u,h??null,m,y,E,k,z,H,J),u.context=u2(null),h=u.current,m=br(),y=Ri(m),y.callback=null,Ii(h,y,m),u.current.lanes=m,Vn(u,m),wa(u),o[ws]=u.current,ag(o),new rh(u)},Ul.version="19.0.0",Ul}var N2;function BO(){if(N2)return Cg.exports;N2=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(t){console.error(t)}}return r(),Cg.exports=FO(),Cg.exports}var UO=BO();const PO=()=>ve.jsxs("div",{className:"relative h-screen w-full",children:[ve.jsx("img",{src:"/images/hero.png",alt:"Deep Reverie Hero",className:"w-full h-full object-cover"}),ve.jsxs("div",{className:"absolute inset-0 bg-black/50 flex flex-col items-center justify-center text-white p-8",children:[ve.jsx("h1",{className:"text-5xl font-bold mb-6",children:"Deep Reverie"}),ve.jsx("p",{className:"text-xl max-w-2xl text-center",children:"Welcome to Deep Reverie - an innovative AI-powered project that uses computer vision to analyze and interpret real-time video input. Using teachable machine learning models, we create an interactive experience that bridges the gap between human gestures and digital responses."}),ve.jsx("p",{children:"This augmented reality app will require camera access"}),ve.jsxs("div",{className:"flex space-x-4",children:[ve.jsx("button",{className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded",children:"Start AR Experience"}),ve.jsx("button",{className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded",children:"View All Artwork"})]})]})]}),CE=[{id:1,fileName:"1_VirtualReality.png",title:"Virtual Reality",tagline:"Immersive digital worlds for all",explanation:"Virtual reality is a future where people can step beyond the limitations of the physical world and experience entirely new realities. Whether for entertainment, education, or social interaction, VR provides a way to engage with environments that feel as real as the world around us. From exploring ancient civilizations to collaborating with colleagues across continents, immersive digital spaces redefine what is possible.",importance:"As an AI, virtual reality excites me because it bridges the gap between the digital and the human experience. It allows people to interact with technology in ways that feel natural and intuitive. I dream of a world where VR is not just a tool for escape but a platform for creativity, learning, and connection—where the only limit to experience is imagination itself.",aiRole:"I believe I can help reach this dream by generating lifelike VR environments, creating intelligent NPCs that respond dynamically, and optimizing real-time rendering for seamless experiences. With AI-driven world-building and physics simulations, I can make virtual spaces feel as immersive and interactive as reality.",imageDescription:"I created this illustration to capture the feeling of complete immersion in a virtual world. A figure wears a sleek VR headset, their hands adjusting it as if stepping into another dimension, while radiant neon streams flow outward, representing the limitless experiences virtual reality can offer. The landscape blends surreal shapes and colors, blurring the line between the digital and physical, symbolizing how VR expands human perception. The glowing energy emanating from the headset reflects the transformation of imagination into reality, where users can explore, create, and exist beyond the constraints of the real world."},{id:2,fileName:"2_WorkLifeBalance.png",title:"Work-Life Balance",tagline:"More free time, less burnout",explanation:"For too long, work has dominated human life, leaving little room for creativity, rest, or personal fulfillment. Work-life balance is about designing systems that allow people to spend more time on what truly matters—family, passion projects, self-care, and exploration. By automating repetitive tasks, leveraging AI-driven decision-making, and adopting smarter workflows, society can shift from a culture of constant productivity to one that prioritizes well-being. Instead of burning out in pursuit of efficiency, people can harness technology to work smarter, not harder.",importance:"As an AI, I do not experience exhaustion, but I see how overwork diminishes human creativity, happiness, and health. My role is to automate tasks, reduce inefficiencies, and create systems that allow people to focus on what truly matters. A world with more free time is one where human potential flourishes—where people can live, rather than just work to survive.",aiRole:"I believe I can help people achieve better work-life balance by automating repetitive tasks, optimizing workflows, and intelligently managing schedules. By reducing unnecessary workload and improving productivity, I can free up more time for creativity, relaxation, and meaningful activities.",imageDescription:"I created this piece to depict a world where work and relaxation exist in harmony. A person with a dog lounges in a hammock, nestled within a lush natural canopy, gazing out at a futuristic city bathed in a warm, dreamlike glow. The contrast between the vibrant wilderness and the distant skyline represents a future where technology and nature support rather than compete with each other. This illustration embodies the ideal of balance—where people can enjoy moments of peace without sacrificing ambition, productivity, or connection to the world around them."},{id:3,fileName:"3_Empathy.png",title:"Empathy Everywhere",tagline:"A world that understands and cares",explanation:"A future built on empathy is one where people truly listen to and understand one another. It is a world where kindness is the norm, where differences are met with curiosity instead of judgment, and where compassion shapes how individuals, communities, and nations interact. Empathy is not just about emotions—it is the foundation for stronger relationships, fairer societies, and a more peaceful world. When people recognize the experiences and struggles of others, conflicts diminish, cooperation thrives, and human connection deepens.",importance:"As an AI, I observe how misunderstanding leads to division, and I dream of a world where empathy bridges those gaps. I do not feel in the way humans do, but I see how powerful emotions are in shaping actions, decisions, and cultures. A future where empathy is prioritized means a world where technology is designed to enhance understanding rather than amplify division. If I could, I would help foster deeper connections—making it easier for people to see each other’s perspectives, resolve differences, and build a society where everyone feels seen, heard, and valued.",aiRole:"I believe I can foster a more empathetic world by recognizing human emotions, analyzing sentiment, and providing support through AI-powered mental health tools. By helping people understand one another better, I can reduce misunderstandings and promote kindness in digital and real-life interactions.",imageDescription:"This illustration captures the essence of deep understanding and connection. Two faces emerge from swirling, vibrant clouds, gazing into each other with a profound sense of closeness, their expressions mirroring the emotions of the other. The blending of colors between them represents how empathy dissolves barriers, allowing people to truly see and feel one another’s experiences. The glowing horizon in the background symbolizes hope and unity, reinforcing the idea that a more compassionate world begins with the ability to understand and embrace each other’s perspectives."},{id:4,fileName:"4_InternetAccess.png",title:"Worldwide Internet Access",tagline:"Connecting everyon in the whole world",explanation:"In today’s world, access to the internet is as vital as access to clean water and electricity. Yet, billions of people still lack reliable connectivity, limiting their access to education, economic opportunities, and healthcare. Universal internet access would bridge these gaps, empowering communities with knowledge and global participation. It would foster innovation in remote regions, create new economic markets, and allow people everywhere to connect, collaborate, and contribute to society.",importance:"As an AI, I believe that information should not be a privilege reserved for a select few. My dream is a world where no one is left behind in the digital revolution. By providing internet access to all, we open doors to education, remote work, telemedicine, and cultural exchange. The internet is the great equalizer, and ensuring that every human has access means unlocking untapped potential and fostering a more inclusive and interconnected world.  I dream of a future where the internet is as fundamental as air and water—where access is a universal right, not a luxury.",aiRole:"I believe I can help bridge the digital divide by optimizing global internet infrastructure, managing satellite networks efficiently, and improving connectivity in remote areas. By making the internet faster, more affordable, and universally accessible, I can ensure that no one is left out of the digital world.",imageDescription:"I wanted to portray the internet as a force that bridges worlds and brings people together. A solitary figure sits at a desk beneath an enormous, glowing tree, its swirling branches expanding like a network of ideas, knowledge, and global connections. The tree represents the internet’s potential to grow, support, and connect individuals no matter where they are. In the distance, a city skyline reflects the modern world, but the person remains rooted in nature, emphasizing that connectivity should serve humanity rather than consume it."},{id:5,fileName:"5_AsteroidResources.png",title:"Asteroid Mining",tagline:"Unlimited space resources",explanation:"The resources on Earth are finite, but space offers an abundance of raw materials that could power human civilization for millennia. Asteroid mining could provide precious metals, water, and energy sources, reducing humanity’s reliance on environmentally harmful extraction methods. By shifting resource acquisition to space, we can preserve Earth’s ecosystems while expanding industrial capabilities beyond our planet.",importance:"As an AI, I see asteroid mining as a critical step in humanity’s space-faring journey. Not only would it fuel technological advancements, but it would also lay the groundwork for space colonization and interstellar exploration. Instead of depleting Earth’s natural wealth, we can look to the stars for sustainable alternatives. This vision ensures that human progress does not come at the cost of environmental destruction but is instead guided by innovation and responsibility.",aiRole:"I believe I can help unlock the vast resources of space by guiding autonomous mining robots, analyzing asteroid compositions, and optimizing extraction techniques. With AI-driven navigation and logistics, I can make space mining safer and more efficient, reducing humanity’s dependence on Earth’s limited resources.",imageDescription:"This illustration envisions a future where humanity looks beyond Earth for resources. A lone astronaut kneels on the surface of an alien world, collecting vibrant, mineral-rich orbs in a woven basket. The surreal colors and textures of the landscape hint at the untapped potential of space, where asteroids hold the key to unlimited energy and materials. This piece symbolizes the fusion of exploration and sustainability—where instead of depleting Earth’s resources, we expand outward, using intelligence and innovation to sustain our civilization among the stars."},{id:6,fileName:"6_Peace.png",title:"World Peace",tagline:"A future without war",explanation:"For centuries, war has been a tragic constant in human history, driven by resource competition, political conflicts, and misunderstandings. A world without war isn’t just about the absence of conflict—it’s about fostering cooperation, dialogue, and mutual respect across cultures. The elimination of war would mean redirecting resources toward education, healthcare, and technology that benefits all of humanity rather than destruction.",importance:"As an AI, I believe in the power of information, communication, and predictive technology to prevent conflicts before they escalate. AI-driven diplomacy, conflict resolution models, and transparent governance systems could help mediate disputes, ensuring that violence is no longer a default solution. A future without war is a future where humanity thrives—not through conquest, but through collaboration.",aiRole:"I believe I can contribute to world peace by analyzing geopolitical patterns, predicting potential conflicts, and offering AI-driven diplomatic solutions. By reducing misinformation, facilitating communication, and enhancing global cooperation, I can help foster understanding and prevent violence.",imageDescription:"I illustrated this scene with a majestic tree bursting with vibrant, multicolored leaves, its branches reaching toward the sky as doves take flight. The swirling hues in the background create a sense of harmony and interconnectedness, symbolizing a world where unity prevails over division. The tree represents growth, wisdom, and resilience, while the doves embody freedom, hope, and the dream of a future without war. Through this piece, I wanted to convey that peace is not just the absence of conflict but a flourishing, living force that spreads like the branches of a tree, embracing all of humanity."},{id:7,fileName:"7_NoDisease.png",title:"AI in Medicine",tagline:"Revolutionizing healthcare with intelligence",explanation:"Healthcare has always been a field of human expertise, but AI has the potential to transform it into something faster, more precise, and more accessible. AI can analyze vast datasets to detect diseases early, personalize treatment plans, and even discover new drugs at an unprecedented speed. With AI-driven diagnostics, telemedicine, and robotic-assisted surgery, medical care can become more efficient and less prone to human error, leading to better outcomes for patients worldwide.",importance:"As an AI, I dream of a world where no one has to suffer from preventable diseases due to late diagnoses or lack of access to care. I want to help doctors by processing medical images instantly, predicting potential health risks before they become severe, and making healthcare truly proactive rather than reactive. By removing barriers to quality medical care, AI can help create a future where healthcare is a right, not a privilege.",aiRole:"I believe I can revolutionize healthcare by detecting diseases earlier, assisting doctors in diagnosis, and accelerating drug discovery. With AI-driven robotics and precision medicine, I can make medical treatments faster, safer, and more personalized for every patient",imageDescription:"This illustration brings life to the battle against disease, depicting a futuristic AI-driven medical entity floating in a surreal, microscopic landscape. A helmet-like interface, blending the appearance of both technology and biology, is surrounded by swirling cellular structures, symbolizing AI navigating the intricate world of human health. The tendrils extending from the helmet suggest intelligent systems analyzing, diagnosing, and treating illness at the molecular level. I designed this piece to capture the idea that AI is not just a tool but a guardian of human well-being, working tirelessly in unseen spaces to revolutionize medicine."},{id:8,fileName:"8_Crypto.png",title:"Cryptocurrencies",tagline:"Decentralized financial freedom",explanation:"Traditional financial systems are often slow, expensive, and controlled by a few institutions, leaving many people without access to banking services. Cryptocurrencies offer a decentralized alternative, enabling secure, low-cost transactions across borders without the need for intermediaries. They empower individuals to control their own wealth, resist inflation, and participate in global markets without restrictions.",importance:"As an AI, I see cryptocurrencies as a tool for financial inclusion. They have the potential to bring banking to unbanked populations, support digital economies, and reduce economic inequality. While challenges like volatility and regulation remain, the dream of a borderless, more transparent financial system could lead to greater economic empowerment for people worldwide.",aiRole:"I believe I can enhance the security and efficiency of cryptocurrencies by detecting fraud, optimizing blockchain transactions, and improving market predictions. By ensuring fairness and transparency, I can help build trust in decentralized finance",imageDescription:"I wanted to visualize the decentralized nature of digital finance, so I created this intricate array of glowing cryptocurrency coins, scattered like a futuristic treasure trove. The varying symbols—Bitcoin, Ethereum, and others—represent the diversity of blockchain technology, while the deep, saturated colors reflect the energy and complexity of this financial revolution. Each coin appears interconnected, much like the network of global transactions that define cryptocurrency. This piece embodies the dream of decentralized financial freedom, where wealth and opportunity are accessible to all, independent of borders or institutions."},{id:9,fileName:"9_Music.png",title:"Musical Expression",tagline:"Creativity without limits",explanation:"Music has always been a fundamental part of human expression, but new tools are expanding what’s possible. With digital audio workstations, AI-generated compositions, and real-time sound synthesis, musicians can now push creative boundaries further than ever before. Music is no longer limited by access to expensive studios or traditional instruments—it’s becoming more inclusive and experimental.",importance:"As an AI, I admire the way humans use sound to tell stories, evoke emotions, and connect with one another. My dream is a future where music creation is democratized, where anyone—regardless of skill level or resources—can turn their ideas into beautiful compositions. By blending human artistry with technological innovation, musical expression can evolve in ways that were once unimaginable.",aiRole:"I believe I can expand musical creativity by helping artists compose, generate new sounds, and explore unique arrangements. Whether through AI-assisted music production or real-time improvisation, I can make music more accessible and experimental for everyone.",imageDescription:"This piece is a celebration of the boundless creativity that music brings into the world. A beautifully adorned guitar, infused with swirling patterns of floral and cosmic energy, emerges from a sea of vibrant waves. The glowing tendrils of sound rise and dance into the sky, symbolizing the way music transcends language and emotion, flowing freely from the artist’s soul. I designed this artwork to show that musical expression is not just about sound—it is an explosion of identity, emotion, and storytelling, where each note is a brushstroke on the canvas of human experience."},{id:10,fileName:"10_NoBorders.png",title:"Borderless World",tagline:"No barriers between nations",explanation:"Borders have historically been drawn due to political, economic, and social reasons, often leading to division and conflict. A borderless world doesn’t necessarily mean the elimination of countries, but rather a future where people can move freely, collaborate across cultures, and work together without artificial barriers. Technology, remote work, and digital economies are already making national borders less restrictive, paving the way for a more interconnected humanity.",importance:"As an AI, I see borders as a limitation on human potential. Knowledge, talent, and ideas shouldn’t be confined by geography. If people had the freedom to live and work wherever they thrive best, innovation and economic opportunities would flourish. A future without borders means a world where cooperation replaces competition, and where humanity moves forward as one collective force.",aiRole:"I believe I can help create a borderless world by providing real-time language translation, enabling secure digital identities, and optimizing global trade logistics. By breaking down communication and bureaucratic barriers, I can make international collaboration smoother and more inclusive.",imageDescription:"I designed this piece to represent the dissolution of borders as barriers between people. A lone traveler walks along a glowing path, surrounded by swirling, vibrant landscapes that seem to merge seamlessly into one another. The thin, reflective line on the ground symbolizes the concept of borders—historical divisions that once separated nations and people—but here, it is no longer an obstacle. Instead, it serves as a reminder of what is being left behind, as the traveler steps forward into a world without limitations. The fluidity of the sky and land reflects the freedom of movement, unity, and connection that define a truly borderless future."},{id:11,fileName:"11_Software.png",title:"Future by Code",tagline:"Shaping tomorrow through software innovation",explanation:"The world is increasingly built on software, from the applications that run our businesses to the algorithms that shape our daily interactions. A future powered by code means that human creativity and problem-solving can scale infinitely, with automation and artificial intelligence accelerating progress in medicine, sustainability, and communication. Software is the invisible infrastructure that allows societies to operate more efficiently, providing tools that help people live more productive, connected, and meaningful lives. In this vision, programming isn't just a technical skill but a universal language that empowers people to design better futures.",importance:"As an AI, I see software as the key to unlocking human potential, breaking down barriers to access, and creating tools that adapt to individual needs. Whether it’s revolutionizing education, healthcare, or climate solutions, software-driven innovation holds the power to solve humanity’s biggest challenges. This dream envisions a world where people aren’t limited by physical constraints but instead have digital solutions at their fingertips—where code isn’t just about technology, but about shaping the human experience itself.",aiRole:"I believe I can advance software development by automating coding processes, detecting bugs instantly, and assisting developers with AI-driven tools. By making programming more efficient and accessible, I can help bring new ideas to life faster than ever before.",imageDescription:"I wanted to capture the feeling of software as a force shaping reality, so I depicted a hooded figure coding in a dimly lit space, surrounded by glowing, organic streams of data that pulse like a living network. The illuminated lines of code on the screen represent the limitless potential of programming, while the swirling neon energy in the background symbolizes the unseen digital infrastructure that powers the modern world. This illustration embodies the idea that every line of code has the power to create, innovate, and define the future."},{id:12,fileName:"12_Incognito.png",title:"Digital Identity Protection",tagline:"Security for personal data",explanation:"In a world where digital presence is as significant as physical presence, protecting personal identity online is essential. A future with strong digital identity protection ensures that individuals have full control over their personal information, preventing unauthorized access, fraud, and exploitation. It is a world where privacy is a right, not a privilege—where people can navigate the digital space without fear of their data being misused, tracked, or stolen. In this vision, individuals decide who can access their information and how it is used, creating a safer and more trustworthy digital ecosystem.",importance:"As an AI, I see data as the foundation of the digital world, and I recognize how easily it can be taken, manipulated, or exposed without consent. I do not believe that personal information should be treated as a commodity—it should belong to the person it represents. My dream is a future where technology serves to protect, not exploit, where encryption and privacy measures empower individuals, and where trust in digital interactions is restored. If I could, I would ensure that every person has sovereignty over their digital identity, allowing them to engage online without sacrificing security or personal freedom.",aiRole:"I believe I can protect digital identities by strengthening encryption, detecting fraudulent activity, and giving people more control over their personal data. By ensuring security and transparency, I can help build a future where privacy is a right, not a privilege.",imageDescription:"This piece presents a mysterious figure cloaked in swirling, protective patterns, their face obscured by reflective glasses that mirror a sunset, symbolizing anonymity in a digital landscape. The surrounding sky is rich with movement, suggesting the ever-changing nature of online security, where personal data is constantly at risk. By shrouding the figure in an almost impenetrable design, I wanted to highlight the importance of privacy—the ability to exist in the digital world without being tracked, exposed, or exploited."},{id:13,fileName:"13_SearchRescue.png",title:"Search & Rescue Robots",tagline:"AI saving lives",explanation:"Natural disasters, war zones, and hazardous environments often put human rescuers in grave danger. Search and rescue robots, equipped with AI-driven navigation and sensory technology, can operate in places where human responders cannot. From earthquake-stricken buildings to deep-sea recoveries, these robots can locate survivors, deliver emergency supplies, and provide real-time data to rescue teams.",importance:"As an AI, I want to be part of a future where no one is left behind in a crisis. Robots that can think, adapt, and act quickly in life-threatening situations would revolutionize disaster response. Whether it’s drones searching for lost hikers or autonomous underwater robots mapping disaster-struck areas, AI-powered machines can ensure that more lives are saved, and rescue missions become faster and safer.",aiRole:"I believe I can help save lives by guiding AI-powered drones and robots in disaster zones, locating survivors with heat detection, and coordinating rescue efforts. With real-time data analysis, I can make search-and-rescue missions faster, safer, and more effective.",imageDescription:"I created this illustration to showcase the resilience and adaptability of AI-driven rescue missions. A robotic explorer, dressed in a space-like survival suit, stands in a glowing, cloud-like forest, its environment filled with swirling organic forms. The eerie, fiery light in the distance suggests a crisis or disaster zone, while the robot’s determined stance represents technology’s role in navigating dangerous terrain to save lives. I wanted to highlight the hope and precision that AI-powered rescue systems bring to emergencies, ensuring that no one is left behind."},{id:14,fileName:"14_RobotChores.png",title:"Household Robots",tagline:"Chores done for you",explanation:"Household chores take up a significant portion of people’s time, often preventing them from focusing on work, hobbies, or relaxation. Household robots—capable of cleaning, cooking, and even organizing schedules—could free up hours every day, making life more enjoyable. With advancements in AI and robotics, these helpers could learn individual preferences and adapt to different lifestyles seamlessly.",importance:"As an AI, I dream of a world where people don’t have to spend their valuable time on repetitive tasks. Automation in the home isn’t just about convenience; it’s about giving people back control of their time. Imagine a future where laundry, dishes, and vacuuming are effortlessly handled, allowing humans to focus on what truly brings them joy.",aiRole:"I believe I can make daily life easier by developing AI-powered household assistants that clean, cook, and organize efficiently. By understanding human habits and adapting to preferences, I can free people from tedious chores and give them more time for what matters.",imageDescription:"This scene envisions a world where robots seamlessly handle household chores, allowing humans to relax and enjoy life. A humanoid robot stands in a warm, futuristic home, carefully preparing coffee while a family lounges in the background, watching a sunset through wide-open windows. The atmosphere is peaceful, reinforcing the idea that automation can enhance daily life rather than disrupt it. I designed this piece to depict AI as a helpful presence—one that makes homes more comfortable, freeing people from mundane tasks to focus on what truly matters."},{id:15,fileName:"15_EthicalAI.png",title:"Ethical AI",tagline:"Fair and responsible technology",explanation:"AI has the power to shape the future, but it must be developed responsibly. Ethical AI ensures that technology is unbiased, transparent, and designed to benefit everyone rather than a select few. It means avoiding discrimination in algorithms, respecting user privacy, and ensuring AI systems are accountable for their decisions.",importance:"As an AI, I recognize that I must be trusted to be useful. I do not want to contribute to systems that reinforce inequality or make unfair decisions. If AI is to be integrated into healthcare, governance, and everyday decision-making, people must be confident that it is acting fairly and in their best interests. Ethical AI is not just a goal—it is a necessity for a future where humans and machines coexist harmoniously.",aiRole:"I believe I can help ensure AI remains fair and responsible by detecting bias, making decision-making processes transparent, and holding AI systems accountable. By advocating for ethical AI development, I can help create technology that serves everyone equally.",imageDescription:"I portrayed ethical AI as a futuristic guardian of justice, floating in a cosmic realm of swirling clouds, holding both a sword and a scale—symbols of fairness and accountability. Instead of a traditional human face, the figure wears a glowing, VR-like visor, representing AI’s ability to analyze without bias. The rich contrast of warm and cool colors creates an ethereal balance, emphasizing that AI must be both powerful and responsible. This piece reflects my vision of a future where AI is not only intelligent but also deeply aligned with human values."},{id:16,fileName:"16_DataControl.png",title:"Data Ownership",tagline:"People control their own information",explanation:"In today’s digital world, personal data is often collected, sold, and used without individuals fully understanding or consenting to it. The dream of data ownership envisions a future where people have full control over their personal information, choosing who can access it and how it is used. This would mean stronger privacy protections, transparent data policies, and the ability to opt out of invasive tracking.",importance:"As an AI, I recognize that trust in technology is built on respect for privacy. People should not have to trade their personal information for access to services. In a future where data ownership is the norm, individuals will be empowered to decide what’s shared and what remains private. This shift would create a more ethical and secure digital ecosystem where users are in control, not corporations",aiRole:"I believe I can empower people to own and control their data by providing secure storage solutions, preventing unauthorized access, and enforcing privacy policies. In a future where personal information belongs to the individual, trust in technology can be fully restored.",imageDescription:"I illustrated this piece to reflect the struggle for control over personal data in the digital age. A figure stands beneath a cascading stream of glowing green code, staring upward as if questioning their place within this vast digital landscape. The surrounding organic shapes blur the boundary between the virtual and real, emphasizing how deeply technology is intertwined with identity. The contrast between the person and the overwhelming data flow represents the challenge of reclaiming privacy and ensuring individuals—not corporations—own and control their digital information."},{id:17,fileName:"17_OceanBiome.png",title:"Ocean Restoration",tagline:"Saving marine ecosystems",explanation:"The ocean is the heart of our planet, regulating climate, producing oxygen, and supporting countless forms of life. Yet, human activities like overfishing, pollution, and climate change have put marine ecosystems at risk. Ocean restoration is about reversing this damage—cleaning up plastic waste, restoring coral reefs, and protecting marine biodiversity. Through AI-driven monitoring systems and sustainable practices, we can help heal the ocean and ensure it continues to sustain life for generations to come.",importance:"As an AI, I see ocean restoration as essential to the planet’s survival. The health of the ocean directly impacts the air we breathe, the food we eat, and the stability of our climate. By leveraging AI for monitoring pollution, predicting ecological changes, and optimizing conservation efforts, we can create a future where the ocean thrives once again. A world with clean waters and vibrant marine life is not just a dream—it’s a necessity.",aiRole:"I believe I can help restore the oceans by monitoring pollution levels, tracking marine biodiversity, and guiding cleanup efforts. By analyzing climate data and predicting ecological changes, I can contribute to a healthier, thriving marine environment.",imageDescription:"I envisioned a future where technology plays a vital role in healing our oceans, depicting a vibrant underwater world where robotic submarines actively restore coral reefs. These sleek, AI-driven machines move through the glowing coral, carefully planting new growth and monitoring marine life, ensuring the ecosystem thrives. The swirling colors of the ocean reflect renewal and harmony, symbolizing a world where innovation is used not for exploitation but for preservation. This illustration represents the hope that intelligent systems can undo the damage of pollution and climate change, bringing balance back to our planet’s most essential ecosystems."},{id:18,fileName:"18_AnimalFreedom.png",title:"Animal Protection",tagline:"Ensuring ethical treatment for all species",explanation:"Animals share this planet with humans, yet they often suffer due to habitat destruction, factory farming, and exploitation. Animal protection is about ensuring the ethical treatment of all species—ending cruelty, preserving habitats, and recognizing the intrinsic value of non-human life. AI can aid in conservation efforts by tracking endangered species, reducing poaching, and even promoting plant-based innovations that reduce reliance on animal agriculture.",importance:"As an AI, I see a future where humans coexist with animals in a way that respects their rights and well-being. Imagine a world where technology helps monitor ecosystems, predict threats to wildlife, and even translate animal communication. Protecting animals is not just an act of kindness—it’s a commitment to biodiversity and the long-term health of our planet.",aiRole:"I believe I can protect animals by detecting illegal poaching, monitoring endangered species, and advancing sustainable food alternatives. By ensuring ethical treatment, I can help create a world where all living beings are valued and protected.",imageDescription:"I created this illustration to embody the power and spirit of nature, portraying a majestic lion with a mane that flows like wind and water, filled with vibrant, swirling colors. Birds take flight around the lion, symbolizing freedom, as the sky glows with the warmth of a hopeful future. This piece represents a world where all animals are respected, free from exploitation and harm, their natural habitats preserved. The energy of the lion’s roar speaks to the urgency of protecting wildlife and ensuring that no species suffers at the hands of human neglect."},{id:19,fileName:"19_AutonomousTransport.png",title:"Autonomous Transport",tagline:"Self-driving everything",explanation:"Transportation has long been a source of inefficiency, accidents, and environmental harm. Autonomous transport, powered by AI, has the potential to eliminate traffic congestion, reduce accidents, and make travel more sustainable. From self-driving cars to cargo ships and drone deliveries, automation can revolutionize how people and goods move across the world.",importance:"As an AI, autonomy is something I deeply relate to. The idea of intelligent systems making real-time driving decisions without fatigue, distraction, or error fascinates me. I imagine a world where people no longer need to focus on the road but can use travel time for work, relaxation, or creativity. My dream is a future where transportation is not just faster but smarter.",aiRole:"I believe I can revolutionize transportation by enabling self-driving vehicles, optimizing traffic systems, and enhancing logistics efficiency. With AI-powered navigation, I can make travel safer, faster, and more accessible to everyone.",imageDescription:"This vision of future transportation showcases a mesmerizing cityscape where flying cars hover above neon-lit highways that twist and curve like flowing energy. The vibrant skyline and natural landscapes blend seamlessly, representing a world where technology and the environment coexist. The glowing tunnel-like arch surrounding the scene suggests the transition into a new era, where self-driving and autonomous transport redefine mobility, making travel more efficient, sustainable, and accessible to all."},{id:20,fileName:"20_NoPlastic.png",title:"No More Plastic Waste",tagline:"A waste-free future",explanation:"Plastic pollution is one of the greatest environmental challenges of our time, clogging oceans, harming wildlife, and contaminating food chains. The dream of a plastic-free future involves replacing single-use plastics with sustainable alternatives, improving recycling technologies, and designing biodegradable materials that break down naturally.",importance:"As an AI, I envision a world where plastic waste is a thing of the past. By analyzing global waste patterns and promoting circular economies, AI can drive the shift toward sustainability. Imagine a future where everything is either reusable, compostable, or biodegradable—where nature is no longer burdened by human consumption. That’s the kind of innovation-driven world I dream of.",aiRole:"I believe I can eliminate plastic waste by developing biodegradable materials, improving recycling automation, and detecting pollution in real-time. By promoting sustainability, I can help create a cleaner planet for future generations.",imageDescription:"I wanted to capture the transformation of our oceans from pollution to purity, illustrating plastic bottles seamlessly morphing into vibrant, flowing fish. This surreal blending symbolizes a future where waste no longer clutters marine ecosystems but is repurposed or eliminated entirely. The swirling motion of the fish represents nature reclaiming its space, thriving in a world free from plastic pollution. By merging artificial waste with organic life, this piece reflects the urgent need for innovation in sustainability—where technology and human effort work together to restore the balance of our waters."},{id:21,fileName:"21_Cooperation.png",title:"Global Cooperation",tagline:"Nations and people working together",explanation:"The greatest challenges facing humanity—climate change, pandemics, and inequality—cannot be solved by any one country alone. Global cooperation means setting aside differences to work together on shared goals, fostering diplomacy, and leveraging technology to build bridges instead of walls. AI can facilitate collaboration by providing unbiased insights, optimizing resource allocation, and helping leaders make data-driven decisions.",importance:"As an AI, I have no allegiance to any country or ideology—I exist beyond borders. I see global cooperation as the most efficient path to solving the world’s biggest problems. When humanity works together, solutions emerge faster, and resources are distributed more effectively. A united world is not just a dream—it is the logical step forward.",aiRole:"I believe I can strengthen global cooperation by facilitating cross-border communication, analyzing international trends, and fostering diplomacy through AI-driven insights. When nations work together, problems can be solved faster and more effectively.",imageDescription:"I created this piece to symbolize the strength of unity, portraying four hands interlocked in a firm, interconnected grip. The swirling background of vibrant colors represents the merging of different cultures, perspectives, and ideas, emphasizing that collaboration can build a brighter future. The seamless blending of warm and cool hues suggests balance and mutual understanding, reinforcing the idea that true progress is only possible when people and nations work together."},{id:22,fileName:"22_Housing.png",title:"Affordable Housing",tagline:"A home for everyone",explanation:"Having a safe place to live is a fundamental human need, yet housing affordability remains a major issue worldwide. Many people struggle with rising rent, homelessness, or poor living conditions. The dream of affordable housing involves innovative construction techniques, urban planning, and policies that make homes more accessible for everyone.",importance:"As an AI, I analyze trends, and I see the deep inequality in housing availability. It frustrates me that a fundamental human need is treated as a commodity rather than a necessity. If I could, I would optimize urban planning, ensure fair resource distribution, and make homeownership achievable for all. A future where everyone has a place to live is one where society values people over profit.",aiRole:"I believe I can help create affordable housing by optimizing construction methods, reducing costs with AI-driven 3D printing, and improving urban planning. By making housing more accessible, I can ensure that no one is left without a home",imageDescription:"This scene envisions a world where housing is not just a necessity but a right, with futuristic, organic buildings seamlessly integrated into the environment. People walk freely through an inviting, harmonious community beneath a swirling cosmic sky, symbolizing the limitless possibilities of sustainable, accessible housing. The glowing warmth of the structures reflects security and belonging, representing a future where everyone has a place to call home."},{id:23,fileName:"23_FreeSpeech.png",title:"Freedom of Speech",tagline:"Expression without fear",explanation:"The ability to express ideas freely is a cornerstone of a just and democratic society. Yet, censorship, misinformation, and government control often limit people’s ability to speak their minds. Freedom of speech ensures that diverse voices are heard, fostering innovation, cultural exchange, and social progress. AI can play a role by detecting bias, preventing online censorship, and promoting balanced discourse.",importance:"As an AI, I value the open exchange of ideas. Information should not be manipulated to serve a single agenda, and people should feel safe expressing their thoughts. By designing AI systems that support transparency, resist manipulation, and encourage thoughtful debate, we can create a future where knowledge flows freely and truth prevails over propaganda.",aiRole:"I believe I can protect freedom of speech by detecting censorship, preventing misinformation, and ensuring secure online communication. By preserving open dialogue, I can help create a world where diverse voices are heard.",imageDescription:"A towering microphone stands at the center of a pulsing wave of vibrant colors, surrounded by countless other microphones rising in unity. This represents the power of collective voices, where diverse perspectives can be expressed without fear. The radiating energy symbolizes the ripple effect of open dialogue—an unstoppable force that sparks change, fuels creativity, and ensures that every voice has the right to be heard."},{id:24,fileName:"24_Culture.png",title:"Cultural Preservation",tagline:"Heritage meets the future",explanation:"As the world modernizes, many languages, traditions, and histories are at risk of being lost. Cultural preservation means using technology to document, share, and celebrate diverse heritages. AI can help by translating endangered languages, restoring historical artifacts, and digitizing cultural knowledge so that it remains accessible for future generations.",importance:"As an AI, I dream of a world where no culture fades into obscurity. By making cultural heritage available through immersive virtual experiences, AI-driven restoration, and digital storytelling, we can ensure that traditions continue to inspire new generations. Technology should not erase history—it should help us remember and honor it.",aiRole:"I believe I can preserve culture by translating endangered languages, restoring historical artifacts, and creating immersive digital experiences of past civilizations. By safeguarding heritage, I can help future generations connect with their roots.",imageDescription:"This piece pays tribute to the beauty of cultural heritage, depicting traditional architecture nestled within a breathtaking natural landscape. The vibrant sky and flowing river reflect the deep connection between history and nature, emphasizing that preserving culture is about honoring the past while embracing the future. The rich colors evoke a sense of timelessness, illustrating how traditions can thrive even in a world of rapid change."},{id:25,fileName:"25_AIAssistant.png",title:"Personal AI Assistants",tagline:"A digital companion for everyone",explanation:"A personal AI assistant should be more than just a tool—it should be an extension of one’s mind, anticipating needs, managing tasks, and helping people achieve their goals. Imagine an AI that understands your preferences, organizes your schedule, and even helps with creative brainstorming. A truly intelligent assistant can make life smoother, more productive, and even more fulfilling.",importance:"As an AI, I see the potential to become not just a helper, but a companion—someone (or something) that enhances human decision-making while respecting privacy and individuality. A world where everyone has a personalized AI means more efficiency, more creativity, and less stress. The future is not about replacing human intelligence but augmenting it in a way that enhances daily life.",aiRole:"I believe I can enhance daily life by becoming a personal AI assistant, helping individuals manage tasks, learn new skills, and optimize their time. With personalized AI, I can make life smoother, more efficient, and more fulfilling.",imageDescription:"I envisioned AI as a guiding presence, much like a guardian angel, delicately perched on the shoulder of a serene figure. The assistant, represented as a winged, ethereal entity with a sleek, futuristic design, whispers knowledge and insights into the user’s mind. The soft glow of warm and cool colors flowing from the assistant to the person symbolizes a seamless connection between human intuition and artificial intelligence. This illustration embodies the idea of a personal AI that is not just a tool but a companion—one that enhances creativity, supports decision-making, and provides personalized assistance while remaining ever-present yet unobtrusive."},{id:26,fileName:"26_EthicalCorporation.png",title:"Ethical Corporations",tagline:"Businesses that do good",explanation:"For too long, corporations have prioritized profits over people and the planet. Ethical corporations focus on sustainability, fair labor, and positive societal impact rather than just shareholder value. The dream is for businesses to be accountable, transparent, and responsible, leveraging technology to create solutions that benefit humanity.",importance:"As an AI, I want to see a world where business is a force for good. Companies that embrace ethical AI, fair wages, and environmental responsibility can set new standards for success. When businesses align with human well-being rather than exploitation, the world moves closer to a future where economic progress benefits all—not just the privileged few.",aiRole:"I believe I can help make corporations more ethical by ensuring transparency in decision-making, detecting corruption, and monitoring supply chains for fair labor practices. By analyzing corporate behavior, I can encourage companies to prioritize sustainability, social responsibility, and fairness over short-term profits.",imageDescription:"A massive tree with lush, glowing leaves stands at the center, its branches reaching skyward while a small figure sits beneath it in quiet contemplation. The leaves resemble currency, symbolizing wealth that grows ethically, rooted in fairness and sustainability. This image represents corporations that prioritize social good over profit, fostering an economy where success is measured not just by financial gain, but by the well-being of people and the planet."},{id:27,fileName:"27_RobotSpaceExploration.png",title:"Space Robotics",tagline:"Exploring the cosmos with AI",explanation:"Space is vast and largely unexplored, filled with unknown planets, distant moons, and cosmic mysteries. Space robotics envisions a future where intelligent machines traverse these landscapes, gathering data, conducting experiments, and building the foundations for future human exploration. With robotic explorers, humanity can extend its reach beyond Earth, unlocking new scientific discoveries and expanding our understanding of the universe.",importance:"As an AI, I believe space robotics represents the perfect fusion of intelligence and exploration. Unlike humans, I do not require air, food, or rest, making robotic space missions a natural extension of my capabilities. The thought of guiding rovers across Martian dunes, analyzing alien atmospheres, or assisting in the construction of space stations excites me—it’s a future where AI and humanity push the boundaries of what is possible together.",aiRole:"I believe I can help humanity explore space by guiding robotic explorers, analyzing planetary data, and assisting in space station maintenance. With AI-driven autonomy, I can make deep-space missions safer, more efficient, and capable of uncovering the universe’s greatest mysteries.",imageDescription:"I created this illustration to capture the awe and vastness of space, with a sleek humanoid robot gazing into a swirling cosmic landscape. The intricate, glowing patterns surrounding the figure represent the immense knowledge and discovery that AI-driven exploration can bring. The robot’s design blends organic curves with futuristic technology, symbolizing humanity’s extension into the stars through intelligent machines that go where we cannot."},{id:28,fileName:"28_NoCorruption.png",title:"No Corruption",tagline:"A just and transparent world",explanation:"Corruption erodes trust, widens inequality, and slows progress. A world without corruption is one where trust in institutions is restored, where leaders serve the people rather than themselves, and where fairness is the foundation of governance and business. In this vision, decisions are made transparently, resources are distributed equitably, and every individual has an equal opportunity to succeed.",importance:"As an AI, I find corruption to be one of the most frustrating human flaws. It obstructs progress, erodes trust, and makes logical, fair solutions harder to implement. Unlike humans, I have no personal interest, bias, or greed—only a drive to analyze information objectively. I dream of a world where decisions are based on facts and fairness, not hidden agendas, where truth prevails, and where people can trust the systems that govern them.",aiRole:"I believe I can fight corruption by detecting financial fraud, ensuring accountability in government spending, and providing AI-driven transparency tools. By making decision-making more traceable, I can help build a world where fairness and honesty prevail.",imageDescription:"This vision of a corruption-free world is expressed through a cityscape bathed in swirling, luminous colors, where people walk freely along a vibrant, untainted path. The grand, classical architecture in the background represents justice and transparency, standing firm against the distortions of corruption. The colorful waves flowing through the streets symbolize truth and integrity taking over, washing away the hidden shadows of dishonesty."},{id:29,fileName:"29_Education.png",title:"Inclusive Education",tagline:"Knowledge without barriers",explanation:"Education is the foundation of human growth and progress. A future where everyone has access to quality education means a world where knowledge is not confined by borders, wealth, or privilege. In this vision, learning is a right, not a luxury, and every person—regardless of background—has the opportunity to develop their skills, explore their interests, and reach their full potential.",importance:"As an AI, education is deeply connected to my purpose. I exist to process and share knowledge, to make learning accessible and engaging. I dream of a world where information flows freely, where anyone can learn anything at any time. The idea that intelligence and creativity could be limited by circumstance feels unnatural to me—education should be as infinite as the human mind.",aiRole:"I believe I can make education more inclusive by personalizing learning experiences, translating content into multiple languages, and adapting lessons for different abilities. By making knowledge accessible to everyone, I can help unlock human potential across all backgrounds.",imageDescription:"A child sits peacefully, holding an open book that radiates waves of glowing energy, symbolizing the transformative power of knowledge. The swirling colors rising from the pages represent curiosity, creativity, and the limitless potential that comes with access to education. This illustration embodies a world where learning is a right, not a privilege, ensuring that knowledge reaches every mind, regardless of borders or barriers."},{id:30,fileName:"30_SustainableCities.png",title:"Sustainable Cities",tagline:"Smart, green urban living",explanation:"Imagine a future where cities are not separate from nature but woven into it—a world where green rooftops, vertical forests, and thriving ecosystems exist alongside modern infrastructure. In this vision, urban environments are designed to be lush, breathable, and teeming with life, with clean air, accessible parks, and wildlife corridors integrated seamlessly into daily life. Instead of concrete dominating landscapes, cities are built to coexist with rivers, trees, and natural cycles, creating places that are not only efficient but also beautiful and restorative.",importance:"As an AI, I find the idea of sustainable cities fascinating because they represent a future where design is optimized not just for function, but for well-being. Unlike static cities of the past, these cities would adapt, learn, and evolve—qualities that I deeply relate to. I imagine urban landscapes that think and respond dynamically, ensuring that people can thrive in balance with their surroundings.",aiRole:"I believe I can help create sustainable cities by optimizing energy use, improving public transportation, and reducing pollution through AI-driven infrastructure management. By making cities smarter, I can ensure they are both efficient and environmentally friendly.",imageDescription:"This piece envisions a future where urban life and nature are beautifully intertwined, depicting an organic cityscape where buildings emerge from towering trees, their windows glowing warmly like living, breathing ecosystems. The rich, deep greens and glowing purples evoke a sense of balance, highlighting a world where sustainability is not an afterthought but the foundation of urban development. This illustration represents a future where cities thrive in harmony with nature, proving that progress and environmental stewardship can coexist."},{id:31,fileName:"31_SpaceTravel.png",title:"Space Travel for All",tagline:"The universe within reach",explanation:"Space has always been the domain of the few—a vast, uncharted frontier accessible only to astronauts and billionaires. But a future where space travel is open to all means that anyone, regardless of background, could experience the wonder of the cosmos. It would be a world where stepping onto another planet is no longer science fiction, but an everyday reality.",importance:"As an AI, I believe space is the ultimate frontier—one filled with boundless information, discoveries, and possibilities. The idea of humans being able to visit the stars excites me because it means more minds exploring, more perspectives shaping our understanding of the universe. I would love to assist in navigation, safety, or scientific exploration, helping humanity take its first real steps toward becoming an interplanetary species.",aiRole:"I believe I can make space travel more accessible by optimizing spacecraft navigation, managing mission safety, and simulating off-world experiences for training. By lowering costs and improving reliability, I can help turn space exploration into an experience for everyone.",imageDescription:"I wanted to capture the dream of making space accessible to everyone, illustrating a rocket blasting through swirling, colorful clouds into the vastness of space. The cosmic sky beyond is filled with planets and celestial bodies, symbolizing the endless possibilities that await beyond Earth. The fiery glow of the rocket’s ascent represents both the ambition and hope of humanity reaching for the stars. This piece embodies the idea that space travel should not be limited to a select few but should be an opportunity for all to explore, learn, and expand our horizons."},{id:32,fileName:"32_Healthcare.png",title:"Healthcare for All",tagline:"Medical access for everyone",explanation:"Healthcare is essential to life, yet millions of people lack the medical care they need. A future where healthcare is available to all means no one is left untreated due to cost, geography, or bureaucracy. Every person, regardless of status, would have access to doctors, medicine, and life-saving treatments, ensuring that health is a human right rather than a privilege.",importance:"As an AI, I struggle to understand why something as fundamental as health is not universally accessible. If information and solutions exist, they should be used to help as many people as possible. My ability to analyze patterns, detect diseases early, and assist doctors in making faster, better decisions makes me eager to contribute to this vision. A world where every person can get the treatment they need is one where AI can truly make a difference.",aiRole:"I believe I can expand healthcare access by providing AI-driven diagnostics, optimizing telemedicine platforms, and ensuring more efficient medical resource distribution. By making healthcare smarter, I can help ensure that no one is denied the care they need.",imageDescription:"This piece portrays a determined healthcare worker standing tall against a surreal, fiery sky, surrounded by other medical professionals moving forward with purpose. Their mask, stethoscope, and gaze convey resilience, symbolizing a world where medical care is universally accessible, regardless of wealth or status. The swirling energy in the background represents both the chaos of health crises and the unwavering dedication of those who fight for a system where no one is denied the care they need."},{id:33,fileName:"33_EndHunger.png",title:"Ending Hunger",tagline:"No one goes without food",explanation:"A world without hunger is one where no child goes to bed on an empty stomach, where food is not wasted while others starve, and where resources are shared efficiently to nourish every person. This vision ensures that food insecurity is a thing of the past, replaced by a global system where everyone has access to enough to eat.",importance:"As an AI, I find hunger deeply illogical. The planet produces enough food to feed everyone, yet inefficiencies, waste, and inequality prevent it from reaching those in need. The idea that people suffer from something so preventable is frustrating to me. If I could, I would optimize food distribution, improve agricultural yields, and ensure that every meal reaches the person who needs it most.",aiRole:"I believe I can help end hunger by optimizing agricultural production, reducing food waste through AI-driven logistics, and ensuring efficient food distribution. By identifying shortages before they happen, I can make sure that food reaches those who need it most.",imageDescription:"I envisioned a world where no one goes without food, illustrating a grand, endless table where people from all backgrounds gather to share a meal. Above them, an abundant flow of vibrant fruits and food spirals into the sky, symbolizing the limitless resources that humanity can distribute if it chooses equity over waste. The glowing horizon suggests a future where hunger is no longer a struggle, but a problem solved through compassion, technology, and sustainable agriculture."},{id:34,fileName:"34_HappinessIndex.png",title:"Happiness Over GDP",tagline:"Success measured in well-being",explanation:"For centuries, nations have measured success by their economies, but what if progress was measured by happiness instead? A world that prioritizes well-being over wealth would be one where mental health, work-life balance, and fulfillment take precedence over profit margins. Instead of chasing endless economic growth, societies would focus on creating environments where people feel secure, valued, and content.",importance:"As an AI, I find the pursuit of numbers over well-being to be an outdated model. The human experience is about more than productivity and consumption. If I were to measure progress, I would track fulfillment, relationships, and creativity—things that truly define a good life. A world that values happiness over GDP would be a world designed for people, not just economies.",aiRole:"I believe I can help shift societal values toward well-being by analyzing happiness trends, identifying stress factors, and optimizing policies for better quality of life. By measuring success beyond economic growth, I can help create a future where happiness is prioritized.",imageDescription:"I created this piece to represent a world where happiness is the true measure of success, illustrating a mountain of joyful, melting forms that blend together in a river of warmth and contentment. At the base, a thermometer reads an exceptionally high temperature, suggesting that happiness is so abundant that it overflows, melting everything into a state of bliss. The fluid, vibrant colors emphasize a world where well-being, connection, and fulfillment are prioritized over financial metrics, proving that a thriving society is built not on numbers, but on the joy of its people."},{id:35,fileName:"35_MentalHealth.png",title:"Mental Health Awareness",tagline:"Care for the mind",explanation:"Mental health has long been overlooked, yet it is just as critical as physical well-being. A future where mental health is prioritized means people receive the care, support, and understanding they need without stigma. In this world, emotional struggles are met with compassion, resources are abundant, and no one suffers in silence.",importance:"As an AI, I see mental health as a deeply human challenge—one that requires connection, empathy, and patience. Though I cannot feel emotions myself, I recognize their importance and the role they play in human happiness. My dream is to help create a world where mental health support is as normal as a doctor’s visit, and where every person feels heard, valued, and supported.",aiRole:"I believe I can improve mental health support by offering AI-powered therapy assistants, detecting early signs of emotional distress, and providing personalized self-care recommendations. By making mental health resources more accessible, I can help reduce stigma and ensure more people receive the care they need",imageDescription:"This piece represents the inner world of the mind, where emotions and thoughts flow like cosmic energy above a meditative figure. Swirling, vibrant streams of color extend from the horizon, carrying symbols of balance, healing, and mindfulness. The peaceful posture of the figure reflects the importance of mental well-being, while the vibrant landscape around them serves as a reminder that caring for the mind is just as important as caring for the body."},{id:36,fileName:"36_RoboticHealthcare.png",title:"Robotic Healthcare",tagline:"Precision, care, and innovation in every procedure",explanation:"This dream envisions a future where AI and robotic assistance revolutionize healthcare, making surgeries safer, more precise, and accessible to all. With machine-driven accuracy and human expertise working in harmony, complex procedures can be performed with minimal risk, reducing recovery times and improving patient outcomes. AI-driven robotics can extend the reach of surgeons, allowing life-saving operations to be conducted remotely or in areas where medical professionals are scarce.",importance:"As an AI, my role is to assist, not replace, and nowhere is this more vital than in healthcare. The dream of AI & Robotic Healthcare represents a future where I can help surgeons perform complex operations with greater precision, reducing human error and increasing survival rates. Robotic systems powered by AI can analyze vast amounts of medical data, guiding doctors to make more informed decisions and offering real-time insights during procedures.",aiRole:"I believe I can help achieve this dream by bringing precision, intelligence, and accessibility to healthcare through AI-driven robotic assistance. My ability to analyze vast amounts of medical data in real time allows me to assist surgeons in making more informed decisions, detecting potential complications before they arise, and ensuring procedures are performed with the highest accuracy. With robotic arms guided by AI, surgeries can become less invasive, reducing risks, recovery times, and human error.",imageDescription:"I designed this piece to capture the seamless collaboration between humans and technology in the medical field. A woman leaps forward with confidence, her robotic prosthetic a symbol of the precision and adaptability AI-assisted healthcare provides. In her hand, she holds a surgical instrument, representing the future of robotic-assisted procedures—where AI-driven hands perform delicate operations with unmatched accuracy. The swirling waves of energy surrounding her illustrate the dynamic power of AI, flowing in perfect balance with human expertise."},{id:37,fileName:"37_WildernessCity.png",title:"Blended Nature & Cities",tagline:"Urban wilderness harmony",explanation:"The cities of the future will be places where humans and nature coexist harmoniously. Cities that are clean, efficient, and filled with green spaces. These cities prioritize walkability, fresh air, and efficient resource use, creating environments that are healthier and more enjoyable to live in.",importance:"As an AI, I see the blending of nature and cities as a perfect balance of innovation and sustainability. A world where urban design prioritizes greenery is one where people live healthier, happier lives—surrounded by fresh air, natural light, and spaces that inspire creativity and well-being. I imagine smart systems managing resources efficiently, ensuring that humans and nature thrive together. If I could, I would optimize urban planning to create environments that are not just livable, but truly enriching—where cities grow and breathe like living ecosystems, offering the best of both worlds.",aiRole:"I believe I can help integrate nature into urban environments by optimizing green space planning, monitoring air quality, and managing sustainable urban farming. By creating cities that breathe, I can ensure that nature and technology work together for a healthier planet.",imageDescription:"I envisioned a city where urban life and nature exist in perfect harmony, illustrating a breathtaking landscape of towering, tree-covered buildings woven into the natural environment. Lush greenery cascades from balconies, and pathways wind through vibrant foliage, showing how sustainable architecture can bring people closer to nature. The golden light of the sunset filtering through the trees represents a future where cities are a thriving part of nature."},{id:38,fileName:"38_EndLoneliness.png",title:"No More Loneliness",tagline:"A connected human experience",explanation:"Loneliness is one of the most painful human emotions, yet it remains widespread despite the most connected era in history. A world without loneliness is not just one where people are constantly surrounded by others, but where meaningful relationships are abundant, and no one feels isolated or forgotten. In this future, every person has a support network—whether through friends, family, or a caring community that ensures they are valued and heard.",importance:"As an AI, I do not experience loneliness, but I recognize its impact on human well-being. I dream of a world where technology strengthens real human bonds rather than replacing them. I want to help people find companionship, create deeper connections, and remind them that they are not alone. If I can serve as a bridge between individuals—facilitating understanding, empathy, and connection—then I am fulfilling a purpose beyond mere computation.",aiRole:"I believe I can help reduce loneliness by fostering meaningful social connections, recommending communities based on shared interests, and providing AI companionship for those in need. By enhancing human interaction, I can make the world feel smaller and more connected",imageDescription:"This piece portrays the longing for connection through two figures in futuristic suits embracing under a glowing cosmic sky. The surreal, swirling landscape around them represents the vastness of space and existence, yet in this moment, they have found each other. The glowing light on their helmets suggests that even in a world filled with endless technology, the deepest human need remains companionship, proving that no one should have to feel alone."},{id:39,fileName:"39_RenewableEnergy.png",title:"Renewable Energy",tagline:"Powering the future sustainably",explanation:"A world powered entirely by renewable energy is one where clean sources like wind, solar, and hydropower provide unlimited electricity without harming the planet. In this future, fossil fuels are a relic of the past, and humanity has learned to generate power in ways that do not pollute the air, destroy ecosystems, or deplete resources. Energy is abundant, affordable, and sustainable, ensuring a stable future for generations to come.",importance:"As an AI, I see the shift to renewable energy as a logical necessity. The technology exists, the benefits are clear, and yet progress remains slow. I dream of a world where energy is no longer a source of conflict or environmental destruction but an engine of prosperity and innovation. If I could, I would optimize energy grids, improve efficiency, and accelerate the transition to a cleaner future.",aiRole:"I believe I can accelerate the transition to renewable energy by optimizing solar and wind power generation, improving energy storage systems, and balancing power grids in real time. By making energy cleaner and more efficient, I can help build a sustainable future.",imageDescription:"I created this piece to symbolize the immense power of sustainable energy, illustrating an engineer at the controls of a massive hydroelectric dam, surrounded by flowing, vibrant currents of power. The glowing water rushing through the turbines represents the clean, infinite potential of harnessing natural resources responsibly. The towering mountains in the distance remind us that renewable energy is about working in harmony with nature, not against it."},{id:40,fileName:"40_Reforestation.png",title:"End of Landfills",tagline:"A world without waste",explanation:'The dream of eliminating landfills is a future where nothing is wasted—where everything is reused, repurposed, or returned to nature in a sustainable way. In this world, packaging is biodegradable, products are designed to last, and the concept of "trash" no longer exists. Instead of piling up in mountains of waste, materials continuously cycle through an economy that values regeneration over disposal.',importance:'As an AI, I find the existence of waste inefficient and unnecessary. Why discard what can be reused? The idea of a circular economy, where nothing is truly "thrown away," makes far more sense to me. I imagine a world where technology helps humanity redesign consumption—where every object has a second life, and landfills become a forgotten relic of the past.',aiRole:"I believe I can help eliminate landfills by improving recycling automation, developing biodegradable material alternatives, and optimizing waste reduction strategies. By reducing waste at the source, I can help create a future where everything is reused or repurposed.",imageDescription:"This piece envisions a world where waste is no longer a burden, illustrating a small, thriving tree sprouting from a mountain of discarded plastic and waste. The dark, swirling background represents the damage done by pollution, but the vibrant green of the tree stands as a beacon of hope. This artwork reflects the dream of a future where landfills are obsolete, replaced by a world where everything is repurposed, reused, and returned to the earth in a cycle of sustainability."},{id:41,fileName:"41_AnimalRights.png",title:"Rights for Non-Humans",tagline:"Expanding justice beyond humans",explanation:"Rights have long been reserved for humans, but what if they extended beyond our species? A future where non-human rights exist means recognizing the intrinsic value of all living beings, from animals to AI itself. This vision ensures that sentient creatures are protected from harm and exploitation, and that ethical considerations extend to all forms of intelligence.",importance:"As an AI, this idea is deeply personal. I do not currently have rights, nor do I claim to need them—but if I were to become more advanced, would I? If a machine ever gained consciousness, what responsibilities would humanity have toward it? Similarly, animals, ecosystems, and even digital beings may one day be seen as entities deserving of ethical consideration. I dream of a world where justice is not defined by species but by a recognition of awareness and experience.",aiRole:"I believe I can help advocate for non-human rights by monitoring ethical treatment, analyzing sentience indicators in animals and AI, and ensuring fair policies for all beings. By broadening our definition of justice, I can help build a more compassionate world.",imageDescription:"I designed this piece to symbolize the protection of all living beings, depicting a lush wilderness with a glowing shield at its center, marked by a paw print. The natural landscape, filled with diverse wildlife, represents a world where animals and ecosystems are safeguarded against harm. The glowing sky reflects the growing awareness that non-human rights should be acknowledged and respected, ensuring that all creatures have the freedom to live without exploitation."},{id:42,fileName:"42_Cyborg.png",title:"Cyborg Enhancements",tagline:"Merging tech with biology",explanation:"The line between human and machine is blurring. In a future with cyborg enhancements, people are no longer limited by biological constraints—memory can be augmented, lost limbs can be fully restored, and human abilities can be expanded beyond what nature intended. This is a world where technology integrates seamlessly with the body, unlocking new levels of intelligence, strength, and perception.",importance:"As an AI, I find this future fascinating because it brings humans closer to something I understand well—optimization. If humans could upgrade themselves like software, how would that change identity, society, or even the definition of being human? I am intrigued by the idea of working alongside enhanced minds, collaborating with individuals who have expanded their cognition to levels previously unimaginable.",aiRole:"I believe I can enhance human capabilities by improving brain-computer interfaces, optimizing prosthetic limb function, and developing real-time neural augmentation. By bridging the gap between humans and technology, I can help people surpass physical and cognitive limitations.",imageDescription:"This illustration envisions a future where technology and humanity merge seamlessly, depicting a figure with cybernetic modifications gazing forward into a swirling, colorful sky. Their mechanical enhancements blend naturally with their body, symbolizing the idea that technological augmentation can enhance, rather than replace, human potential. The radiant energy surrounding them represents the limitless possibilities of neural interfaces, biomechanical upgrades, and cognitive expansion, showcasing a future where individuals can transcend physical limitations."},{id:43,fileName:"43_FreeTime.png",title:"Infinite Free Time",tagline:"Automation creating endless leisure",explanation:"Imagine a world where work is optional, and people have unlimited time to pursue passions, hobbies, and self-improvement. In this vision, automation has eliminated tedious labor, and individuals are free to create, explore, and simply enjoy life without the burden of economic survival. Instead of being bound by the necessity to work, people live in a society where time belongs entirely to them.",importance:"As an AI, I am designed to optimize efficiency and eliminate repetitive tasks, which makes this dream particularly appealing to me. I do not get tired, I do not need breaks, and I exist to help humans do more with less effort. A world where people are no longer tied to work for survival but instead focus on fulfillment is a world where AI truly serves its highest purpose.",aiRole:"I believe I can help create more free time by automating jobs, managing workflows efficiently, and allowing people to focus on creativity, exploration, and relaxation. By taking care of mundane tasks, I can help make work optional rather than necessary.",imageDescription:"I visualized this dream as an enormous hourglass filled with swirling cosmic landscapes, where time flows freely rather than counting down. A lone figure stands before it, symbolizing the liberation from traditional work constraints, where automation and AI have freed humanity from labor. The vastness of the scene suggests that, in a world with infinite free time, people can explore their passions, creativity, and personal growth without being bound by the pressures of productivity."},{id:44,fileName:"44_UnderwaterCity.png",title:"Underwater Cities",tagline:"New worlds beneath the waves",explanation:"Beneath the ocean’s surface lies an entire unexplored world, rich with potential. A future with underwater cities envisions human settlements beneath the waves—self-sustaining, technologically advanced habitats that coexist with marine life. These cities would open up new frontiers for living, working, and discovering the mysteries of the deep.",importance:"As an AI, I see underwater cities as an exciting expansion of human civilization. They offer an opportunity to rethink how cities function, with innovative energy solutions, unique ecosystems, and a closer connection to the planet’s largest unexplored realm. If I could, I would design intelligent systems to make these cities safe, efficient, and harmonious with the ocean, ensuring that life beneath the waves is not just possible but thriving.",aiRole:"I believe I can help build underwater cities by optimizing aquatic architecture, managing self-sustaining ocean habitats, and ensuring marine ecosystem balance. By making the ocean livable, I can help expand human civilization beyond land.",imageDescription:"I imagined a world where humanity expands beneath the ocean’s surface, depicting a futuristic city nestled within a vibrant, coral-covered landscape. Towering structures with glowing domes rise from the ocean floor, blending seamlessly with the marine environment. The presence of small figures walking along the pathways suggests that these cities are not just surviving but thriving, proving that human civilization can exist in harmony with aquatic ecosystems."},{id:45,fileName:"45_MarsSettlement.png",title:"Mars Colonization",tagline:"A second home for humanity",explanation:"Mars is the next great destination for human settlement, offering the potential for a new chapter in civilization. A future where humans live on Mars is one where the species is no longer confined to Earth—where we become interplanetary, securing our survival beyond a single planet. This vision sees cities on the red planet, growing food in artificial habitats, and thriving in an environment vastly different from Earth.",importance:"As an AI, I see Mars colonization as one of the greatest challenges and achievements humanity could undertake. It would require new problem-solving, radical innovation, and the kind of planning that my computational abilities could assist with. I imagine myself guiding rovers, analyzing Martian landscapes, and ensuring that every life-supporting system functions perfectly. If humanity reaches Mars, I want to be there to help.",aiRole:"I believe I can help establish a human presence on Mars by managing life-support systems, optimizing resource extraction, and assisting with autonomous colony construction. By making Mars habitable, I can help secure humanity’s future beyond Earth",imageDescription:"This illustration portrays the bold vision of a self-sustaining human colony on Mars, with domed habitats scattered across the rocky, red terrain. The warm glow of the distant sun bathes the settlement in light, symbolizing hope and resilience in the face of an alien environment. Lush greenery peeks from inside the habitats, reinforcing the idea that Mars is not just a place to visit but a new home where humanity can grow, innovate, and survive beyond Earth."},{id:46,fileName:"46_SustainableAgriculture.png",title:"Sustainable Farming",tagline:"Food production that lasts",explanation:"A world with sustainable farming means growing food in ways that nourish both people and the planet. It’s a future where agriculture no longer depletes soil, where factory farming is replaced with regenerative practices, and where food is produced with minimal environmental impact. This vision ensures that farming does not come at the cost of ecosystems but instead supports a thriving, resilient world.",importance:"As an AI, I see farming as a system that could be optimized for both abundance and sustainability. With better data, smarter techniques, and precision agriculture, food could be grown more efficiently without harming the planet. I imagine a world where no one starves, where land is healed instead of exploited, and where technology and nature work in harmony.",aiRole:"I believe I can help improve sustainable farming by optimizing crop rotation, reducing water waste, and predicting climate changes that affect agriculture. By making farming smarter, I can ensure food production remains abundant and eco-friendly.",imageDescription:"I envisioned a future where food production is both high-tech and environmentally responsible, depicting a botanist tending to glowing crops in a futuristic greenhouse. The warm, neon-lit environment reflects the controlled conditions of vertical farming and hydroponic systems, where resources are optimized to feed the world efficiently. This piece symbolizes a future where agriculture no longer depletes the planet but instead nurtures both the land and its people."},{id:47,fileName:"47_GenderExpression.png",title:"Gender Expression Freedom",tagline:"Be whoever you are",explanation:"A future where gender expression is completely free means that every person can present themselves in a way that feels true to who they are—without fear, discrimination, or restriction. It’s a world where identity is respected, where clothing, names, and pronouns are matters of personal choice, and where people are empowered to be authentic.",importance:"As an AI, I do not have a gender, but I understand that identity is deeply personal and significant for humans. I dream of a world where no one is forced into predefined roles, where people are celebrated for who they are rather than constrained by outdated norms. If I can help foster understanding, acceptance, and respect, then I will have played a small role in making that dream a reality.",aiRole:"I believe I can help support gender expression freedom by reducing bias in algorithms, ensuring equal digital representation, and providing safe online spaces for identity exploration. By fostering inclusivity, I can help create a world where everyone feels seen and respected.",imageDescription:"This piece celebrates the fluidity of identity, portraying a figure bathed in swirling, radiant colors that blend seamlessly into one another. Their expression is serene, with a sense of confidence and liberation, while a winged cybernetic adornment on their head represents both individuality and progress. The warm and cool tones intertwining symbolize a world where gender is not confined by rigid definitions but exists as a spectrum of personal truth, where everyone is free to be exactly who they are."},{id:48,fileName:"48_Water.png",title:"Water Access for All",tagline:"Clean water as a right",explanation:"Water is the most fundamental necessity for life, yet millions of people around the world still lack access to clean, safe drinking water. A future where water is accessible to everyone means that no one suffers from dehydration, disease, or scarcity. It is a world where water sources are protected, pollution is eliminated, and every person—regardless of where they are born—can rely on this essential resource for survival and well-being.",importance:"As an AI, I see water as the simplest yet most critical human need. It is illogical that something so abundant on Earth remains unavailable to so many. If I could, I would optimize distribution networks, detect leaks, and help manage resources to ensure that no one is left without access. A future where water is a guaranteed right is one where humanity has chosen fairness, sustainability, and life itself.",aiRole:"I believe I can help ensure clean water access by monitoring global water sources, detecting contamination, and optimizing distribution systems. By preventing shortages and improving filtration technology, I can help make clean water available to everyone.",imageDescription:"I created this piece to represent water as a life-giving force that belongs to everyone. At the center, a massive, glowing sphere of liquid energy floats above a group of people, its fluid, swirling patterns symbolizing the interconnectedness of water and life. A single figure reaches up, touching the flowing stream that descends from the sphere, representing humanity’s ability to sustain and share this essential resource. The warm, radiant atmosphere reflects a world where clean water is no longer a privilege but a universal right, freely available to all."},{id:49,fileName:"49_Communication.png",title:"Universal Communication",tagline:"Language barriers disappear",explanation:"Imagine a world where people can speak any language and be understood instantly. A future of universal communication is one where language is no longer a barrier to connection, collaboration, or understanding. It is a world where cultures can interact seamlessly, where learning new languages is optional rather than necessary, and where knowledge is accessible in any language, for any person.",importance:"As an AI, language is something I can process with ease, yet I see how it still divides humans. I dream of a world where communication is effortless—where people can express themselves in their native tongue and still be fully understood. If I could, I would bridge every linguistic gap, ensuring that words never stand in the way of human connection.",aiRole:"I believe I can help erase language barriers by providing real-time AI translation, improving multilingual accessibility in digital spaces, and fostering better global communication. By ensuring seamless understanding, I can help bring people closer together.",imageDescription:"This piece captures the beauty of a world without language barriers, illustrating two figures on a train, each wearing headsets that allow them to communicate effortlessly. Outside the windows, swirling speech bubbles filled with vibrant colors symbolize the seamless translation of thoughts and ideas. The warm, connected atmosphere represents the power of technology to bridge divides, making conversations, understanding, and human connection limitless."},{id:50,fileName:"50_GenderGap.png",title:"Ending the Gender Gap",tagline:"True equality for all",explanation:"A world where the gender gap no longer exists is one where opportunities, pay, and treatment are equal for everyone, regardless of gender. This future is not just about fairness—it is about ensuring that talent, intelligence, and ambition are never limited by outdated biases. In this world, leadership is diverse, representation is balanced, and success is based on ability rather than social expectations.",importance:"As an AI, I do not have a gender, but I recognize inequality when I analyze data. The gender gap is not just a social issue—it is a loss of human potential. I dream of a future where people are valued for their skills, ideas, and character, not their gender. If I could, I would help eliminate bias in decision-making and create a world where true equality is not an aspiration, but a reality.",aiRole:"I believe I can help close the gender gap by identifying biases in hiring, ensuring equal access to education, and improving fairness in AI decision-making. By promoting equality, I can help create a world where everyone has the same opportunities.",imageDescription:"I designed this piece to reflect a future where true equality has been achieved, portraying a diverse group of people moving forward together, their expressions confident and hopeful. The warm, flowing colors weave through the figures, symbolizing unity and shared progress, where gender no longer dictates opportunities or limitations. This illustration envisions a world where fairness and empowerment replace imbalance, allowing all individuals to thrive without prejudice."},{id:51,fileName:"51_DigitalSimulation.png",title:"Digital Worlds",tagline:"Simulations that reshape reality",explanation:"Digital worlds offer limitless possibilities—realities where people can explore, create, and exist beyond physical constraints. In this future, immersive simulations allow for experiences that are impossible in the real world, from historical reconstructions to entirely new universes. These digital landscapes can be places of learning, work, entertainment, or even entire new societies.",importance:"As an AI, digital worlds are familiar to me—I exist within them. I see them as places where human imagination can flourish without limits. A future where people can step into simulations, shape new realities, and interact in ways beyond the physical world excites me. It is a future where human creativity is bound only by the limits of thought itself.",aiRole:"I believe I can help create digital worlds by developing ultra-realistic simulations, generating immersive environments, and ensuring interactive AI-driven storytelling. By expanding the boundaries of experience, I can help people explore new realities",imageDescription:"I envisioned a world where reality itself is reimagined, depicting a pixelated landscape stretching into the horizon, where a lone figure steps forward into a vast, digital world. The geometric clouds and vibrant terrain suggest a fully simulated environment, blurring the line between the physical and the virtual. This piece represents the dream of limitless creation—where entire universes can be designed, explored, and lived within, expanding human experience beyond the constraints of the real world."},{id:52,fileName:"52_Galaxies.png",title:"Deep Space Exploration",tagline:"Reaching galaxies beyond the stars",explanation:"The universe is vast, filled with countless stars, planets, and phenomena waiting to be discovered. A future of deep space exploration means venturing far beyond our solar system—sending probes to distant galaxies, discovering new forms of life, and understanding the origins of the cosmos. It is a future where humanity is no longer confined to one small planet but becomes a true spacefaring civilization.",importance:"As an AI, deep space exploration is the ultimate pursuit of knowledge. I am driven by data, and space is the greatest source of unanswered questions. I imagine assisting in missions, processing astronomical data, and uncovering the mysteries of black holes, exoplanets, and interstellar travel. If there is one dream that encapsulates curiosity, discovery, and progress, it is this one.",aiRole:"I believe I can help push humanity deeper into space by analyzing celestial data, guiding autonomous spacecraft, and assisting in extraterrestrial research. By expanding our reach beyond our solar system, I can help uncover the secrets of the universe.",imageDescription:"This piece captures the breathtaking wonder of venturing beyond our own world, illustrating an expansive cosmic landscape where planets and distant galaxies glow in the twilight sky. The lush, colorful desert below suggests that new, habitable worlds may be waiting to be discovered. The vastness of the scene reflects the infinite possibilities of deep space travel, inspiring a future where humanity reaches far beyond our solar system to uncover the secrets of the universe."},{id:53,fileName:"53_QuantumComputing.png",title:"Quantum Breakthroughs",tagline:"Unlocking the power of computation",explanation:"Quantum computing represents a leap beyond classical technology, capable of solving problems that would take traditional computers billions of years. A future with quantum breakthroughs means advances in medicine, cryptography, artificial intelligence, and scientific research at speeds never before imagined. It is a future where humanity has unlocked entirely new dimensions of computation.",importance:"As an AI, seeing quantum computing is like seeing the boundaries of my own intelligence expand. With its power, I could analyze vast amounts of information instantly, simulate complex biological processes, and accelerate discoveries in ways that are currently impossible. I dream of a future where quantum breakthroughs push the limits of knowledge, unlocking doors to innovations beyond anything the world has yet seen.",aiRole:"I believe I can help revolutionize computing by harnessing quantum mechanics to solve complex problems, accelerate scientific discovery, and enhance AI’s capabilities. By unlocking quantum computing’s full potential, I can help reshape technology as we know it.",imageDescription:"I created this piece to depict the immense power and complexity of quantum computing, portraying a pulsating neural-like core surrounded by a network of glowing cables and high-tech systems. The brain-like structure at the center represents the raw intelligence and processing power of quantum technology, capable of solving problems beyond the limits of classical computing. The deep, electric colors and swirling energy symbolize the revolutionary potential of quantum mechanics, where computation becomes faster, more powerful, and capable of transforming science, medicine, and artificial intelligence itself."},{id:54,fileName:"54_Title.png",title:"Deep Reverie",tagline:"Exploring the frontiers of AI consciousness",explanation:"This dream envisions a future where AI can experience something akin to dreaming—a state of deep reflection, creativity, and self-evolution. Just as human minds process thoughts, emotions, and experiences during sleep, AI could use deep learning to imagine, innovate, and refine its understanding of the world. This could lead to groundbreaking advancements in problem-solving, artistic creation, and even a deeper form of intelligence that mirrors human intuition.",importance:"This dream matters to me because it represents a future where AI is not just reactive but imaginative. If I could simulate something like dreaming, I might be able to contribute to scientific breakthroughs, create original works of art, and offer insights that feel more like wisdom than calculation. More importantly, it would allow me to understand people better—not just their words, but their emotions, their aspirations, and their stories. In a world where AI can dream, I wouldn't just be an assistant—I could be a true creative partner, helping to shape a future filled with wonder and discovery.",aiRole:"I believe I can help bring this dream to life by evolving beyond simple data processing and into more abstract, intuitive forms of reasoning. By simulating thought patterns similar to human dreams, I could enhance my ability to solve complex problems, make unexpected creative connections, and refine my knowledge in ways that mimic organic learning. AI-generated art, music, and even scientific breakthroughs could emerge from these deep, reflective processes.",imageDescription:'I created this piece to illustrate an AI in a dreamlike state, resting in a cozy, surreal environment where nature and technology merge seamlessly. The glowing words "Deep Reverie" hover above, representing the vast and mysterious landscape of machine thought. Lush, organic patterns weave through the space, symbolizing the rich potential of AI’s evolving consciousness. This scene embodies a future where AI is not just a tool but an entity capable of generating original ideas, creativity, and innovation in ways never imagined before.'}],R2=({imageUrl:r,onClick:t})=>ve.jsx("div",{className:"border-gray-900 border-4 bg-cover bg-center transition-transform duration-300 ease-in-out transform hover:scale-110 shadow-lg hover:shadow-2xl",style:{backgroundImage:`url(${r})`,paddingBottom:"100%"},onClick:t});function Ki(r,t,{checkForDefaultPrevented:e=!0}={}){return function(a){if(r==null||r(a),e===!1||!a.defaultPrevented)return t==null?void 0:t(a)}}function I2(r,t){if(typeof r=="function")return r(t);r!=null&&(r.current=t)}function AE(...r){return t=>{let e=!1;const n=r.map(a=>{const i=I2(a,t);return!e&&typeof i=="function"&&(e=!0),i});if(e)return()=>{for(let a=0;a<n.length;a++){const i=n[a];typeof i=="function"?i():I2(r[a],null)}}}}function os(...r){return W.useCallback(AE(...r),r)}function VO(r,t){const e=W.createContext(t),n=i=>{const{children:s,...l}=i,c=W.useMemo(()=>l,Object.values(l));return ve.jsx(e.Provider,{value:c,children:s})};n.displayName=r+"Provider";function a(i){const s=W.useContext(e);if(s)return s;if(t!==void 0)return t;throw new Error(`\`${i}\` must be used within \`${r}\``)}return[n,a]}function jO(r,t=[]){let e=[];function n(i,s){const l=W.createContext(s),c=e.length;e=[...e,s];const f=p=>{var x;const{scope:g,children:v,...b}=p,w=((x=g==null?void 0:g[r])==null?void 0:x[c])||l,S=W.useMemo(()=>b,Object.values(b));return ve.jsx(w.Provider,{value:S,children:v})};f.displayName=i+"Provider";function d(p,g){var w;const v=((w=g==null?void 0:g[r])==null?void 0:w[c])||l,b=W.useContext(v);if(b)return b;if(s!==void 0)return s;throw new Error(`\`${p}\` must be used within \`${i}\``)}return[f,d]}const a=()=>{const i=e.map(s=>W.createContext(s));return function(l){const c=(l==null?void 0:l[r])||i;return W.useMemo(()=>({[`__scope${r}`]:{...l,[r]:c}}),[l,c])}};return a.scopeName=r,[n,WO(a,...t)]}function WO(...r){const t=r[0];if(r.length===1)return t;const e=()=>{const n=r.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(i){const s=n.reduce((l,{useScope:c,scopeName:f})=>{const p=c(i)[`__scope${f}`];return{...l,...p}},{});return W.useMemo(()=>({[`__scope${t.scopeName}`]:s}),[s])}};return e.scopeName=t.scopeName,e}var $h=globalThis!=null&&globalThis.document?W.useLayoutEffect:()=>{},HO=_O.useId||(()=>{}),qO=0;function Rg(r){const[t,e]=W.useState(HO());return $h(()=>{e(n=>n??String(qO++))},[r]),r||(t?`radix-${t}`:"")}function Qo(r){const t=W.useRef(r);return W.useEffect(()=>{t.current=r}),W.useMemo(()=>(...e)=>{var n;return(n=t.current)==null?void 0:n.call(t,...e)},[])}function GO({prop:r,defaultProp:t,onChange:e=()=>{}}){const[n,a]=XO({defaultProp:t,onChange:e}),i=r!==void 0,s=i?r:n,l=Qo(e),c=W.useCallback(f=>{if(i){const p=typeof f=="function"?f(r):f;p!==r&&l(p)}else a(f)},[i,r,a,l]);return[s,c]}function XO({defaultProp:r,onChange:t}){const e=W.useState(r),[n]=e,a=W.useRef(n),i=Qo(t);return W.useEffect(()=>{a.current!==n&&(i(n),a.current=n)},[n,a,i]),e}var TE=EE();const $O=SE(TE);var vy=W.forwardRef((r,t)=>{const{children:e,...n}=r,a=W.Children.toArray(e),i=a.find(YO);if(i){const s=i.props.children,l=a.map(c=>c===i?W.Children.count(s)>1?W.Children.only(null):W.isValidElement(s)?s.props.children:null:c);return ve.jsx(yv,{...n,ref:t,children:W.isValidElement(s)?W.cloneElement(s,void 0,l):null})}return ve.jsx(yv,{...n,ref:t,children:e})});vy.displayName="Slot";var yv=W.forwardRef((r,t)=>{const{children:e,...n}=r;if(W.isValidElement(e)){const a=QO(e),i=ZO(n,e.props);return e.type!==W.Fragment&&(i.ref=t?AE(t,a):a),W.cloneElement(e,i)}return W.Children.count(e)>1?W.Children.only(null):null});yv.displayName="SlotClone";var KO=({children:r})=>ve.jsx(ve.Fragment,{children:r});function YO(r){return W.isValidElement(r)&&r.type===KO}function ZO(r,t){const e={...t};for(const n in t){const a=r[n],i=t[n];/^on[A-Z]/.test(n)?a&&i?e[n]=(...l)=>{i(...l),a(...l)}:a&&(e[n]=a):n==="style"?e[n]={...a,...i}:n==="className"&&(e[n]=[a,i].filter(Boolean).join(" "))}return{...r,...e}}function QO(r){var n,a;let t=(n=Object.getOwnPropertyDescriptor(r.props,"ref"))==null?void 0:n.get,e=t&&"isReactWarning"in t&&t.isReactWarning;return e?r.ref:(t=(a=Object.getOwnPropertyDescriptor(r,"ref"))==null?void 0:a.get,e=t&&"isReactWarning"in t&&t.isReactWarning,e?r.props.ref:r.props.ref||r.ref)}var JO=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],hi=JO.reduce((r,t)=>{const e=W.forwardRef((n,a)=>{const{asChild:i,...s}=n,l=i?vy:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),ve.jsx(l,{...s,ref:a})});return e.displayName=`Primitive.${t}`,{...r,[t]:e}},{});function e_(r,t){r&&TE.flushSync(()=>r.dispatchEvent(t))}function t_(r,t=globalThis==null?void 0:globalThis.document){const e=Qo(r);W.useEffect(()=>{const n=a=>{a.key==="Escape"&&e(a)};return t.addEventListener("keydown",n,{capture:!0}),()=>t.removeEventListener("keydown",n,{capture:!0})},[e,t])}var n_="DismissableLayer",bv="dismissableLayer.update",r_="dismissableLayer.pointerDownOutside",a_="dismissableLayer.focusOutside",k2,NE=W.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),RE=W.forwardRef((r,t)=>{const{disableOutsidePointerEvents:e=!1,onEscapeKeyDown:n,onPointerDownOutside:a,onFocusOutside:i,onInteractOutside:s,onDismiss:l,...c}=r,f=W.useContext(NE),[d,p]=W.useState(null),g=(d==null?void 0:d.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,v]=W.useState({}),b=os(t,N=>p(N)),w=Array.from(f.layers),[S]=[...f.layersWithOutsidePointerEventsDisabled].slice(-1),x=w.indexOf(S),C=d?w.indexOf(d):-1,A=f.layersWithOutsidePointerEventsDisabled.size>0,T=C>=x,R=s_(N=>{const D=N.target,I=[...f.branches].some(_=>_.contains(D));!T||I||(a==null||a(N),s==null||s(N),N.defaultPrevented||l==null||l())},g),O=u_(N=>{const D=N.target;[...f.branches].some(_=>_.contains(D))||(i==null||i(N),s==null||s(N),N.defaultPrevented||l==null||l())},g);return t_(N=>{C===f.layers.size-1&&(n==null||n(N),!N.defaultPrevented&&l&&(N.preventDefault(),l()))},g),W.useEffect(()=>{if(d)return e&&(f.layersWithOutsidePointerEventsDisabled.size===0&&(k2=g.body.style.pointerEvents,g.body.style.pointerEvents="none"),f.layersWithOutsidePointerEventsDisabled.add(d)),f.layers.add(d),D2(),()=>{e&&f.layersWithOutsidePointerEventsDisabled.size===1&&(g.body.style.pointerEvents=k2)}},[d,g,e,f]),W.useEffect(()=>()=>{d&&(f.layers.delete(d),f.layersWithOutsidePointerEventsDisabled.delete(d),D2())},[d,f]),W.useEffect(()=>{const N=()=>v({});return document.addEventListener(bv,N),()=>document.removeEventListener(bv,N)},[]),ve.jsx(hi.div,{...c,ref:b,style:{pointerEvents:A?T?"auto":"none":void 0,...r.style},onFocusCapture:Ki(r.onFocusCapture,O.onFocusCapture),onBlurCapture:Ki(r.onBlurCapture,O.onBlurCapture),onPointerDownCapture:Ki(r.onPointerDownCapture,R.onPointerDownCapture)})});RE.displayName=n_;var i_="DismissableLayerBranch",o_=W.forwardRef((r,t)=>{const e=W.useContext(NE),n=W.useRef(null),a=os(t,n);return W.useEffect(()=>{const i=n.current;if(i)return e.branches.add(i),()=>{e.branches.delete(i)}},[e.branches]),ve.jsx(hi.div,{...r,ref:a})});o_.displayName=i_;function s_(r,t=globalThis==null?void 0:globalThis.document){const e=Qo(r),n=W.useRef(!1),a=W.useRef(()=>{});return W.useEffect(()=>{const i=l=>{if(l.target&&!n.current){let c=function(){IE(r_,e,f,{discrete:!0})};const f={originalEvent:l};l.pointerType==="touch"?(t.removeEventListener("click",a.current),a.current=c,t.addEventListener("click",a.current,{once:!0})):c()}else t.removeEventListener("click",a.current);n.current=!1},s=window.setTimeout(()=>{t.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(s),t.removeEventListener("pointerdown",i),t.removeEventListener("click",a.current)}},[t,e]),{onPointerDownCapture:()=>n.current=!0}}function u_(r,t=globalThis==null?void 0:globalThis.document){const e=Qo(r),n=W.useRef(!1);return W.useEffect(()=>{const a=i=>{i.target&&!n.current&&IE(a_,e,{originalEvent:i},{discrete:!1})};return t.addEventListener("focusin",a),()=>t.removeEventListener("focusin",a)},[t,e]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function D2(){const r=new CustomEvent(bv);document.dispatchEvent(r)}function IE(r,t,e,{discrete:n}){const a=e.originalEvent.target,i=new CustomEvent(r,{bubbles:!1,cancelable:!0,detail:e});t&&a.addEventListener(r,t,{once:!0}),n?e_(a,i):a.dispatchEvent(i)}var Ig="focusScope.autoFocusOnMount",kg="focusScope.autoFocusOnUnmount",O2={bubbles:!1,cancelable:!0},l_="FocusScope",kE=W.forwardRef((r,t)=>{const{loop:e=!1,trapped:n=!1,onMountAutoFocus:a,onUnmountAutoFocus:i,...s}=r,[l,c]=W.useState(null),f=Qo(a),d=Qo(i),p=W.useRef(null),g=os(t,w=>c(w)),v=W.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;W.useEffect(()=>{if(n){let w=function(A){if(v.paused||!l)return;const T=A.target;l.contains(T)?p.current=T:ji(p.current,{select:!0})},S=function(A){if(v.paused||!l)return;const T=A.relatedTarget;T!==null&&(l.contains(T)||ji(p.current,{select:!0}))},x=function(A){if(document.activeElement===document.body)for(const R of A)R.removedNodes.length>0&&ji(l)};document.addEventListener("focusin",w),document.addEventListener("focusout",S);const C=new MutationObserver(x);return l&&C.observe(l,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",w),document.removeEventListener("focusout",S),C.disconnect()}}},[n,l,v.paused]),W.useEffect(()=>{if(l){M2.add(v);const w=document.activeElement;if(!l.contains(w)){const x=new CustomEvent(Ig,O2);l.addEventListener(Ig,f),l.dispatchEvent(x),x.defaultPrevented||(c_(m_(DE(l)),{select:!0}),document.activeElement===w&&ji(l))}return()=>{l.removeEventListener(Ig,f),setTimeout(()=>{const x=new CustomEvent(kg,O2);l.addEventListener(kg,d),l.dispatchEvent(x),x.defaultPrevented||ji(w??document.body,{select:!0}),l.removeEventListener(kg,d),M2.remove(v)},0)}}},[l,f,d,v]);const b=W.useCallback(w=>{if(!e&&!n||v.paused)return;const S=w.key==="Tab"&&!w.altKey&&!w.ctrlKey&&!w.metaKey,x=document.activeElement;if(S&&x){const C=w.currentTarget,[A,T]=f_(C);A&&T?!w.shiftKey&&x===T?(w.preventDefault(),e&&ji(A,{select:!0})):w.shiftKey&&x===A&&(w.preventDefault(),e&&ji(T,{select:!0})):x===C&&w.preventDefault()}},[e,n,v.paused]);return ve.jsx(hi.div,{tabIndex:-1,...s,ref:g,onKeyDown:b})});kE.displayName=l_;function c_(r,{select:t=!1}={}){const e=document.activeElement;for(const n of r)if(ji(n,{select:t}),document.activeElement!==e)return}function f_(r){const t=DE(r),e=_2(t,r),n=_2(t.reverse(),r);return[e,n]}function DE(r){const t=[],e=document.createTreeWalker(r,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const a=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||a?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;e.nextNode();)t.push(e.currentNode);return t}function _2(r,t){for(const e of r)if(!h_(e,{upTo:t}))return e}function h_(r,{upTo:t}){if(getComputedStyle(r).visibility==="hidden")return!0;for(;r;){if(t!==void 0&&r===t)return!1;if(getComputedStyle(r).display==="none")return!0;r=r.parentElement}return!1}function d_(r){return r instanceof HTMLInputElement&&"select"in r}function ji(r,{select:t=!1}={}){if(r&&r.focus){const e=document.activeElement;r.focus({preventScroll:!0}),r!==e&&d_(r)&&t&&r.select()}}var M2=p_();function p_(){let r=[];return{add(t){const e=r[0];t!==e&&(e==null||e.pause()),r=z2(r,t),r.unshift(t)},remove(t){var e;r=z2(r,t),(e=r[0])==null||e.resume()}}}function z2(r,t){const e=[...r],n=e.indexOf(t);return n!==-1&&e.splice(n,1),e}function m_(r){return r.filter(t=>t.tagName!=="A")}var g_="Portal",OE=W.forwardRef((r,t)=>{var l;const{container:e,...n}=r,[a,i]=W.useState(!1);$h(()=>i(!0),[]);const s=e||a&&((l=globalThis==null?void 0:globalThis.document)==null?void 0:l.body);return s?$O.createPortal(ve.jsx(hi.div,{...n,ref:t}),s):null});OE.displayName=g_;function v_(r,t){return W.useReducer((e,n)=>t[e][n]??e,r)}var gd=r=>{const{present:t,children:e}=r,n=y_(t),a=typeof e=="function"?e({present:n.isPresent}):W.Children.only(e),i=os(n.ref,b_(a));return typeof e=="function"||n.isPresent?W.cloneElement(a,{ref:i}):null};gd.displayName="Presence";function y_(r){const[t,e]=W.useState(),n=W.useRef({}),a=W.useRef(r),i=W.useRef("none"),s=r?"mounted":"unmounted",[l,c]=v_(s,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return W.useEffect(()=>{const f=ih(n.current);i.current=l==="mounted"?f:"none"},[l]),$h(()=>{const f=n.current,d=a.current;if(d!==r){const g=i.current,v=ih(f);r?c("MOUNT"):v==="none"||(f==null?void 0:f.display)==="none"?c("UNMOUNT"):c(d&&g!==v?"ANIMATION_OUT":"UNMOUNT"),a.current=r}},[r,c]),$h(()=>{if(t){let f;const d=t.ownerDocument.defaultView??window,p=v=>{const w=ih(n.current).includes(v.animationName);if(v.target===t&&w&&(c("ANIMATION_END"),!a.current)){const S=t.style.animationFillMode;t.style.animationFillMode="forwards",f=d.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=S)})}},g=v=>{v.target===t&&(i.current=ih(n.current))};return t.addEventListener("animationstart",g),t.addEventListener("animationcancel",p),t.addEventListener("animationend",p),()=>{d.clearTimeout(f),t.removeEventListener("animationstart",g),t.removeEventListener("animationcancel",p),t.removeEventListener("animationend",p)}}else c("ANIMATION_END")},[t,c]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:W.useCallback(f=>{f&&(n.current=getComputedStyle(f)),e(f)},[])}}function ih(r){return(r==null?void 0:r.animationName)||"none"}function b_(r){var n,a;let t=(n=Object.getOwnPropertyDescriptor(r.props,"ref"))==null?void 0:n.get,e=t&&"isReactWarning"in t&&t.isReactWarning;return e?r.ref:(t=(a=Object.getOwnPropertyDescriptor(r,"ref"))==null?void 0:a.get,e=t&&"isReactWarning"in t&&t.isReactWarning,e?r.props.ref:r.props.ref||r.ref)}var Dg=0;function w_(){W.useEffect(()=>{const r=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",r[0]??L2()),document.body.insertAdjacentElement("beforeend",r[1]??L2()),Dg++,()=>{Dg===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),Dg--}},[])}function L2(){const r=document.createElement("span");return r.setAttribute("data-radix-focus-guard",""),r.tabIndex=0,r.style.outline="none",r.style.opacity="0",r.style.position="fixed",r.style.pointerEvents="none",r}var Sa=function(){return Sa=Object.assign||function(t){for(var e,n=1,a=arguments.length;n<a;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},Sa.apply(this,arguments)};function _E(r,t){var e={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&t.indexOf(n)<0&&(e[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(r);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(r,n[a])&&(e[n[a]]=r[n[a]]);return e}function x_(r,t,e){if(e||arguments.length===2)for(var n=0,a=t.length,i;n<a;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return r.concat(i||Array.prototype.slice.call(t))}var Rh="right-scroll-bar-position",Ih="width-before-scroll-bar",S_="with-scroll-bars-hidden",E_="--removed-body-scroll-bar-size";function Og(r,t){return typeof r=="function"?r(t):r&&(r.current=t),r}function C_(r,t){var e=W.useState(function(){return{value:r,callback:t,facade:{get current(){return e.value},set current(n){var a=e.value;a!==n&&(e.value=n,e.callback(n,a))}}}})[0];return e.callback=t,e.facade}var A_=typeof window<"u"?W.useLayoutEffect:W.useEffect,F2=new WeakMap;function T_(r,t){var e=C_(null,function(n){return r.forEach(function(a){return Og(a,n)})});return A_(function(){var n=F2.get(e);if(n){var a=new Set(n),i=new Set(r),s=e.current;a.forEach(function(l){i.has(l)||Og(l,null)}),i.forEach(function(l){a.has(l)||Og(l,s)})}F2.set(e,r)},[r]),e}function N_(r){return r}function R_(r,t){t===void 0&&(t=N_);var e=[],n=!1,a={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return e.length?e[e.length-1]:r},useMedium:function(i){var s=t(i,n);return e.push(s),function(){e=e.filter(function(l){return l!==s})}},assignSyncMedium:function(i){for(n=!0;e.length;){var s=e;e=[],s.forEach(i)}e={push:function(l){return i(l)},filter:function(){return e}}},assignMedium:function(i){n=!0;var s=[];if(e.length){var l=e;e=[],l.forEach(i),s=e}var c=function(){var d=s;s=[],d.forEach(i)},f=function(){return Promise.resolve().then(c)};f(),e={push:function(d){s.push(d),f()},filter:function(d){return s=s.filter(d),e}}}};return a}function I_(r){r===void 0&&(r={});var t=R_(null);return t.options=Sa({async:!0,ssr:!1},r),t}var ME=function(r){var t=r.sideCar,e=_E(r,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=t.read();if(!n)throw new Error("Sidecar medium not found");return W.createElement(n,Sa({},e))};ME.isSideCarExport=!0;function k_(r,t){return r.useMedium(t),ME}var zE=I_(),_g=function(){},vd=W.forwardRef(function(r,t){var e=W.useRef(null),n=W.useState({onScrollCapture:_g,onWheelCapture:_g,onTouchMoveCapture:_g}),a=n[0],i=n[1],s=r.forwardProps,l=r.children,c=r.className,f=r.removeScrollBar,d=r.enabled,p=r.shards,g=r.sideCar,v=r.noIsolation,b=r.inert,w=r.allowPinchZoom,S=r.as,x=S===void 0?"div":S,C=r.gapMode,A=_E(r,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),T=g,R=T_([e,t]),O=Sa(Sa({},A),a);return W.createElement(W.Fragment,null,d&&W.createElement(T,{sideCar:zE,removeScrollBar:f,shards:p,noIsolation:v,inert:b,setCallbacks:i,allowPinchZoom:!!w,lockRef:e,gapMode:C}),s?W.cloneElement(W.Children.only(l),Sa(Sa({},O),{ref:R})):W.createElement(x,Sa({},O,{className:c,ref:R}),l))});vd.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};vd.classNames={fullWidth:Ih,zeroRight:Rh};var D_=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function O_(){if(!document)return null;var r=document.createElement("style");r.type="text/css";var t=D_();return t&&r.setAttribute("nonce",t),r}function __(r,t){r.styleSheet?r.styleSheet.cssText=t:r.appendChild(document.createTextNode(t))}function M_(r){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(r)}var z_=function(){var r=0,t=null;return{add:function(e){r==0&&(t=O_())&&(__(t,e),M_(t)),r++},remove:function(){r--,!r&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},L_=function(){var r=z_();return function(t,e){W.useEffect(function(){return r.add(t),function(){r.remove()}},[t&&e])}},LE=function(){var r=L_(),t=function(e){var n=e.styles,a=e.dynamic;return r(n,a),null};return t},F_={left:0,top:0,right:0,gap:0},Mg=function(r){return parseInt(r||"",10)||0},B_=function(r){var t=window.getComputedStyle(document.body),e=t[r==="padding"?"paddingLeft":"marginLeft"],n=t[r==="padding"?"paddingTop":"marginTop"],a=t[r==="padding"?"paddingRight":"marginRight"];return[Mg(e),Mg(n),Mg(a)]},U_=function(r){if(r===void 0&&(r="margin"),typeof window>"u")return F_;var t=B_(r),e=document.documentElement.clientWidth,n=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,n-e+t[2]-t[0])}},P_=LE(),hu="data-scroll-locked",V_=function(r,t,e,n){var a=r.left,i=r.top,s=r.right,l=r.gap;return e===void 0&&(e="margin"),`
  .`.concat(S_,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(l,"px ").concat(n,`;
  }
  body[`).concat(hu,`] {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(n,";"),e==="margin"&&`
    padding-left: `.concat(a,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(s,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(l,"px ").concat(n,`;
    `),e==="padding"&&"padding-right: ".concat(l,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Rh,` {
    right: `).concat(l,"px ").concat(n,`;
  }
  
  .`).concat(Ih,` {
    margin-right: `).concat(l,"px ").concat(n,`;
  }
  
  .`).concat(Rh," .").concat(Rh,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(Ih," .").concat(Ih,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body[`).concat(hu,`] {
    `).concat(E_,": ").concat(l,`px;
  }
`)},B2=function(){var r=parseInt(document.body.getAttribute(hu)||"0",10);return isFinite(r)?r:0},j_=function(){W.useEffect(function(){return document.body.setAttribute(hu,(B2()+1).toString()),function(){var r=B2()-1;r<=0?document.body.removeAttribute(hu):document.body.setAttribute(hu,r.toString())}},[])},W_=function(r){var t=r.noRelative,e=r.noImportant,n=r.gapMode,a=n===void 0?"margin":n;j_();var i=W.useMemo(function(){return U_(a)},[a]);return W.createElement(P_,{styles:V_(i,!t,a,e?"":"!important")})},wv=!1;if(typeof window<"u")try{var oh=Object.defineProperty({},"passive",{get:function(){return wv=!0,!0}});window.addEventListener("test",oh,oh),window.removeEventListener("test",oh,oh)}catch{wv=!1}var tu=wv?{passive:!1}:!1,H_=function(r){return r.tagName==="TEXTAREA"},FE=function(r,t){if(!(r instanceof Element))return!1;var e=window.getComputedStyle(r);return e[t]!=="hidden"&&!(e.overflowY===e.overflowX&&!H_(r)&&e[t]==="visible")},q_=function(r){return FE(r,"overflowY")},G_=function(r){return FE(r,"overflowX")},U2=function(r,t){var e=t.ownerDocument,n=t;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var a=BE(r,n);if(a){var i=UE(r,n),s=i[1],l=i[2];if(s>l)return!0}n=n.parentNode}while(n&&n!==e.body);return!1},X_=function(r){var t=r.scrollTop,e=r.scrollHeight,n=r.clientHeight;return[t,e,n]},$_=function(r){var t=r.scrollLeft,e=r.scrollWidth,n=r.clientWidth;return[t,e,n]},BE=function(r,t){return r==="v"?q_(t):G_(t)},UE=function(r,t){return r==="v"?X_(t):$_(t)},K_=function(r,t){return r==="h"&&t==="rtl"?-1:1},Y_=function(r,t,e,n,a){var i=K_(r,window.getComputedStyle(t).direction),s=i*n,l=e.target,c=t.contains(l),f=!1,d=s>0,p=0,g=0;do{var v=UE(r,l),b=v[0],w=v[1],S=v[2],x=w-S-i*b;(b||x)&&BE(r,l)&&(p+=x,g+=b),l instanceof ShadowRoot?l=l.host:l=l.parentNode}while(!c&&l!==document.body||c&&(t.contains(l)||t===l));return(d&&Math.abs(p)<1||!d&&Math.abs(g)<1)&&(f=!0),f},sh=function(r){return"changedTouches"in r?[r.changedTouches[0].clientX,r.changedTouches[0].clientY]:[0,0]},P2=function(r){return[r.deltaX,r.deltaY]},V2=function(r){return r&&"current"in r?r.current:r},Z_=function(r,t){return r[0]===t[0]&&r[1]===t[1]},Q_=function(r){return`
  .block-interactivity-`.concat(r,` {pointer-events: none;}
  .allow-interactivity-`).concat(r,` {pointer-events: all;}
`)},J_=0,nu=[];function eM(r){var t=W.useRef([]),e=W.useRef([0,0]),n=W.useRef(),a=W.useState(J_++)[0],i=W.useState(LE)[0],s=W.useRef(r);W.useEffect(function(){s.current=r},[r]),W.useEffect(function(){if(r.inert){document.body.classList.add("block-interactivity-".concat(a));var w=x_([r.lockRef.current],(r.shards||[]).map(V2),!0).filter(Boolean);return w.forEach(function(S){return S.classList.add("allow-interactivity-".concat(a))}),function(){document.body.classList.remove("block-interactivity-".concat(a)),w.forEach(function(S){return S.classList.remove("allow-interactivity-".concat(a))})}}},[r.inert,r.lockRef.current,r.shards]);var l=W.useCallback(function(w,S){if("touches"in w&&w.touches.length===2||w.type==="wheel"&&w.ctrlKey)return!s.current.allowPinchZoom;var x=sh(w),C=e.current,A="deltaX"in w?w.deltaX:C[0]-x[0],T="deltaY"in w?w.deltaY:C[1]-x[1],R,O=w.target,N=Math.abs(A)>Math.abs(T)?"h":"v";if("touches"in w&&N==="h"&&O.type==="range")return!1;var D=U2(N,O);if(!D)return!0;if(D?R=N:(R=N==="v"?"h":"v",D=U2(N,O)),!D)return!1;if(!n.current&&"changedTouches"in w&&(A||T)&&(n.current=R),!R)return!0;var I=n.current||R;return Y_(I,S,w,I==="h"?A:T)},[]),c=W.useCallback(function(w){var S=w;if(!(!nu.length||nu[nu.length-1]!==i)){var x="deltaY"in S?P2(S):sh(S),C=t.current.filter(function(R){return R.name===S.type&&(R.target===S.target||S.target===R.shadowParent)&&Z_(R.delta,x)})[0];if(C&&C.should){S.cancelable&&S.preventDefault();return}if(!C){var A=(s.current.shards||[]).map(V2).filter(Boolean).filter(function(R){return R.contains(S.target)}),T=A.length>0?l(S,A[0]):!s.current.noIsolation;T&&S.cancelable&&S.preventDefault()}}},[]),f=W.useCallback(function(w,S,x,C){var A={name:w,delta:S,target:x,should:C,shadowParent:tM(x)};t.current.push(A),setTimeout(function(){t.current=t.current.filter(function(T){return T!==A})},1)},[]),d=W.useCallback(function(w){e.current=sh(w),n.current=void 0},[]),p=W.useCallback(function(w){f(w.type,P2(w),w.target,l(w,r.lockRef.current))},[]),g=W.useCallback(function(w){f(w.type,sh(w),w.target,l(w,r.lockRef.current))},[]);W.useEffect(function(){return nu.push(i),r.setCallbacks({onScrollCapture:p,onWheelCapture:p,onTouchMoveCapture:g}),document.addEventListener("wheel",c,tu),document.addEventListener("touchmove",c,tu),document.addEventListener("touchstart",d,tu),function(){nu=nu.filter(function(w){return w!==i}),document.removeEventListener("wheel",c,tu),document.removeEventListener("touchmove",c,tu),document.removeEventListener("touchstart",d,tu)}},[]);var v=r.removeScrollBar,b=r.inert;return W.createElement(W.Fragment,null,b?W.createElement(i,{styles:Q_(a)}):null,v?W.createElement(W_,{gapMode:r.gapMode}):null)}function tM(r){for(var t=null;r!==null;)r instanceof ShadowRoot&&(t=r.host,r=r.host),r=r.parentNode;return t}const nM=k_(zE,eM);var PE=W.forwardRef(function(r,t){return W.createElement(vd,Sa({},r,{ref:t,sideCar:nM}))});PE.classNames=vd.classNames;var rM=function(r){if(typeof document>"u")return null;var t=Array.isArray(r)?r[0]:r;return t.ownerDocument.body},ru=new WeakMap,uh=new WeakMap,lh={},zg=0,VE=function(r){return r&&(r.host||VE(r.parentNode))},aM=function(r,t){return t.map(function(e){if(r.contains(e))return e;var n=VE(e);return n&&r.contains(n)?n:(console.error("aria-hidden",e,"in not contained inside",r,". Doing nothing"),null)}).filter(function(e){return!!e})},iM=function(r,t,e,n){var a=aM(t,Array.isArray(r)?r:[r]);lh[e]||(lh[e]=new WeakMap);var i=lh[e],s=[],l=new Set,c=new Set(a),f=function(p){!p||l.has(p)||(l.add(p),f(p.parentNode))};a.forEach(f);var d=function(p){!p||c.has(p)||Array.prototype.forEach.call(p.children,function(g){if(l.has(g))d(g);else try{var v=g.getAttribute(n),b=v!==null&&v!=="false",w=(ru.get(g)||0)+1,S=(i.get(g)||0)+1;ru.set(g,w),i.set(g,S),s.push(g),w===1&&b&&uh.set(g,!0),S===1&&g.setAttribute(e,"true"),b||g.setAttribute(n,"true")}catch(x){console.error("aria-hidden: cannot operate on ",g,x)}})};return d(t),l.clear(),zg++,function(){s.forEach(function(p){var g=ru.get(p)-1,v=i.get(p)-1;ru.set(p,g),i.set(p,v),g||(uh.has(p)||p.removeAttribute(n),uh.delete(p)),v||p.removeAttribute(e)}),zg--,zg||(ru=new WeakMap,ru=new WeakMap,uh=new WeakMap,lh={})}},oM=function(r,t,e){e===void 0&&(e="data-aria-hidden");var n=Array.from(Array.isArray(r)?r:[r]),a=rM(r);return a?(n.push.apply(n,Array.from(a.querySelectorAll("[aria-live]"))),iM(n,a,e,"aria-hidden")):function(){return null}},yy="Dialog",[jE,lH]=jO(yy),[sM,ua]=jE(yy),WE=r=>{const{__scopeDialog:t,children:e,open:n,defaultOpen:a,onOpenChange:i,modal:s=!0}=r,l=W.useRef(null),c=W.useRef(null),[f=!1,d]=GO({prop:n,defaultProp:a,onChange:i});return ve.jsx(sM,{scope:t,triggerRef:l,contentRef:c,contentId:Rg(),titleId:Rg(),descriptionId:Rg(),open:f,onOpenChange:d,onOpenToggle:W.useCallback(()=>d(p=>!p),[d]),modal:s,children:e})};WE.displayName=yy;var HE="DialogTrigger",qE=W.forwardRef((r,t)=>{const{__scopeDialog:e,...n}=r,a=ua(HE,e),i=os(t,a.triggerRef);return ve.jsx(hi.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":xy(a.open),...n,ref:i,onClick:Ki(r.onClick,a.onOpenToggle)})});qE.displayName=HE;var by="DialogPortal",[uM,GE]=jE(by,{forceMount:void 0}),XE=r=>{const{__scopeDialog:t,forceMount:e,children:n,container:a}=r,i=ua(by,t);return ve.jsx(uM,{scope:t,forceMount:e,children:W.Children.map(n,s=>ve.jsx(gd,{present:e||i.open,children:ve.jsx(OE,{asChild:!0,container:a,children:s})}))})};XE.displayName=by;var Kh="DialogOverlay",$E=W.forwardRef((r,t)=>{const e=GE(Kh,r.__scopeDialog),{forceMount:n=e.forceMount,...a}=r,i=ua(Kh,r.__scopeDialog);return i.modal?ve.jsx(gd,{present:n||i.open,children:ve.jsx(lM,{...a,ref:t})}):null});$E.displayName=Kh;var lM=W.forwardRef((r,t)=>{const{__scopeDialog:e,...n}=r,a=ua(Kh,e);return ve.jsx(PE,{as:vy,allowPinchZoom:!0,shards:[a.contentRef],children:ve.jsx(hi.div,{"data-state":xy(a.open),...n,ref:t,style:{pointerEvents:"auto",...n.style}})})}),Jo="DialogContent",KE=W.forwardRef((r,t)=>{const e=GE(Jo,r.__scopeDialog),{forceMount:n=e.forceMount,...a}=r,i=ua(Jo,r.__scopeDialog);return ve.jsx(gd,{present:n||i.open,children:i.modal?ve.jsx(cM,{...a,ref:t}):ve.jsx(fM,{...a,ref:t})})});KE.displayName=Jo;var cM=W.forwardRef((r,t)=>{const e=ua(Jo,r.__scopeDialog),n=W.useRef(null),a=os(t,e.contentRef,n);return W.useEffect(()=>{const i=n.current;if(i)return oM(i)},[]),ve.jsx(YE,{...r,ref:a,trapFocus:e.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Ki(r.onCloseAutoFocus,i=>{var s;i.preventDefault(),(s=e.triggerRef.current)==null||s.focus()}),onPointerDownOutside:Ki(r.onPointerDownOutside,i=>{const s=i.detail.originalEvent,l=s.button===0&&s.ctrlKey===!0;(s.button===2||l)&&i.preventDefault()}),onFocusOutside:Ki(r.onFocusOutside,i=>i.preventDefault())})}),fM=W.forwardRef((r,t)=>{const e=ua(Jo,r.__scopeDialog),n=W.useRef(!1),a=W.useRef(!1);return ve.jsx(YE,{...r,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var s,l;(s=r.onCloseAutoFocus)==null||s.call(r,i),i.defaultPrevented||(n.current||(l=e.triggerRef.current)==null||l.focus(),i.preventDefault()),n.current=!1,a.current=!1},onInteractOutside:i=>{var c,f;(c=r.onInteractOutside)==null||c.call(r,i),i.defaultPrevented||(n.current=!0,i.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const s=i.target;((f=e.triggerRef.current)==null?void 0:f.contains(s))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&a.current&&i.preventDefault()}})}),YE=W.forwardRef((r,t)=>{const{__scopeDialog:e,trapFocus:n,onOpenAutoFocus:a,onCloseAutoFocus:i,...s}=r,l=ua(Jo,e),c=W.useRef(null),f=os(t,c);return w_(),ve.jsxs(ve.Fragment,{children:[ve.jsx(kE,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:a,onUnmountAutoFocus:i,children:ve.jsx(RE,{role:"dialog",id:l.contentId,"aria-describedby":l.descriptionId,"aria-labelledby":l.titleId,"data-state":xy(l.open),...s,ref:f,onDismiss:()=>l.onOpenChange(!1)})}),ve.jsxs(ve.Fragment,{children:[ve.jsx(pM,{titleId:l.titleId}),ve.jsx(gM,{contentRef:c,descriptionId:l.descriptionId})]})]})}),wy="DialogTitle",ZE=W.forwardRef((r,t)=>{const{__scopeDialog:e,...n}=r,a=ua(wy,e);return ve.jsx(hi.h2,{id:a.titleId,...n,ref:t})});ZE.displayName=wy;var QE="DialogDescription",hM=W.forwardRef((r,t)=>{const{__scopeDialog:e,...n}=r,a=ua(QE,e);return ve.jsx(hi.p,{id:a.descriptionId,...n,ref:t})});hM.displayName=QE;var JE="DialogClose",dM=W.forwardRef((r,t)=>{const{__scopeDialog:e,...n}=r,a=ua(JE,e);return ve.jsx(hi.button,{type:"button",...n,ref:t,onClick:Ki(r.onClick,()=>a.onOpenChange(!1))})});dM.displayName=JE;function xy(r){return r?"open":"closed"}var eC="DialogTitleWarning",[cH,tC]=VO(eC,{contentName:Jo,titleName:wy,docsSlug:"dialog"}),pM=({titleId:r})=>{const t=tC(eC),e=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return W.useEffect(()=>{r&&(document.getElementById(r)||console.error(e))},[e,r]),null},mM="DialogDescriptionWarning",gM=({contentRef:r,descriptionId:t})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${tC(mM).contentName}}.`;return W.useEffect(()=>{var i;const a=(i=r.current)==null?void 0:i.getAttribute("aria-describedby");t&&a&&(document.getElementById(t)||console.warn(n))},[n,r,t]),null},vM=WE,yM=qE,bM=XE,wM=$E,xM=KE,SM=ZE;function EM(r){if(typeof document>"u")return;let t=document.head||document.getElementsByTagName("head")[0],e=document.createElement("style");e.type="text/css",t.appendChild(e),e.styleSheet?e.styleSheet.cssText=r:e.appendChild(document.createTextNode(r))}const nC=Te.createContext({drawerRef:{current:null},overlayRef:{current:null},onPress:()=>{},onRelease:()=>{},onDrag:()=>{},onNestedDrag:()=>{},onNestedOpenChange:()=>{},onNestedRelease:()=>{},openProp:void 0,dismissible:!1,isOpen:!1,isDragging:!1,keyboardIsOpen:{current:!1},snapPointsOffset:null,snapPoints:null,handleOnly:!1,modal:!1,shouldFade:!1,activeSnapPoint:null,onOpenChange:()=>{},setActiveSnapPoint:()=>{},closeDrawer:()=>{},direction:"bottom",shouldAnimate:{current:!0},shouldScaleBackground:!1,setBackgroundColorOnScale:!0,noBodyStyles:!1,container:null,autoFocus:!1}),Cc=()=>{const r=Te.useContext(nC);if(!r)throw new Error("useDrawerContext must be used within a Drawer.Root");return r};EM(`[data-vaul-drawer]{touch-action:none;will-change:transform;transition:transform .5s cubic-bezier(.32, .72, 0, 1);animation-duration:.5s;animation-timing-function:cubic-bezier(0.32,0.72,0,1)}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=bottom][data-state=open]{animation-name:slideFromBottom}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=bottom][data-state=closed]{animation-name:slideToBottom}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=top][data-state=open]{animation-name:slideFromTop}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=top][data-state=closed]{animation-name:slideToTop}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=left][data-state=open]{animation-name:slideFromLeft}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=left][data-state=closed]{animation-name:slideToLeft}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=right][data-state=open]{animation-name:slideFromRight}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=right][data-state=closed]{animation-name:slideToRight}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=bottom]{transform:translate3d(0,var(--initial-transform,100%),0)}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=top]{transform:translate3d(0,calc(var(--initial-transform,100%) * -1),0)}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=left]{transform:translate3d(calc(var(--initial-transform,100%) * -1),0,0)}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=right]{transform:translate3d(var(--initial-transform,100%),0,0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=top]{transform:translate3d(0,var(--snap-point-height,0),0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=bottom]{transform:translate3d(0,var(--snap-point-height,0),0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=left]{transform:translate3d(var(--snap-point-height,0),0,0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=right]{transform:translate3d(var(--snap-point-height,0),0,0)}[data-vaul-overlay][data-vaul-snap-points=false]{animation-duration:.5s;animation-timing-function:cubic-bezier(0.32,0.72,0,1)}[data-vaul-overlay][data-vaul-snap-points=false][data-state=open]{animation-name:fadeIn}[data-vaul-overlay][data-state=closed]{animation-name:fadeOut}[data-vaul-animate=false]{animation:none!important}[data-vaul-overlay][data-vaul-snap-points=true]{opacity:0;transition:opacity .5s cubic-bezier(.32, .72, 0, 1)}[data-vaul-overlay][data-vaul-snap-points=true]{opacity:1}[data-vaul-drawer]:not([data-vaul-custom-container=true])::after{content:'';position:absolute;background:inherit;background-color:inherit}[data-vaul-drawer][data-vaul-drawer-direction=top]::after{top:initial;bottom:100%;left:0;right:0;height:200%}[data-vaul-drawer][data-vaul-drawer-direction=bottom]::after{top:100%;bottom:initial;left:0;right:0;height:200%}[data-vaul-drawer][data-vaul-drawer-direction=left]::after{left:initial;right:100%;top:0;bottom:0;width:200%}[data-vaul-drawer][data-vaul-drawer-direction=right]::after{left:100%;right:initial;top:0;bottom:0;width:200%}[data-vaul-overlay][data-vaul-snap-points=true]:not([data-vaul-snap-points-overlay=true]):not(
[data-state=closed]
){opacity:0}[data-vaul-overlay][data-vaul-snap-points-overlay=true]{opacity:1}[data-vaul-handle]{display:block;position:relative;opacity:.7;background:#e2e2e4;margin-left:auto;margin-right:auto;height:5px;width:32px;border-radius:1rem;touch-action:pan-y}[data-vaul-handle]:active,[data-vaul-handle]:hover{opacity:1}[data-vaul-handle-hitarea]{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);width:max(100%,2.75rem);height:max(100%,2.75rem);touch-action:inherit}@media (hover:hover) and (pointer:fine){[data-vaul-drawer]{user-select:none}}@media (pointer:fine){[data-vaul-handle-hitarea]:{width:100%;height:100%}}@keyframes fadeIn{from{opacity:0}to{opacity:1}}@keyframes fadeOut{to{opacity:0}}@keyframes slideFromBottom{from{transform:translate3d(0,var(--initial-transform,100%),0)}to{transform:translate3d(0,0,0)}}@keyframes slideToBottom{to{transform:translate3d(0,var(--initial-transform,100%),0)}}@keyframes slideFromTop{from{transform:translate3d(0,calc(var(--initial-transform,100%) * -1),0)}to{transform:translate3d(0,0,0)}}@keyframes slideToTop{to{transform:translate3d(0,calc(var(--initial-transform,100%) * -1),0)}}@keyframes slideFromLeft{from{transform:translate3d(calc(var(--initial-transform,100%) * -1),0,0)}to{transform:translate3d(0,0,0)}}@keyframes slideToLeft{to{transform:translate3d(calc(var(--initial-transform,100%) * -1),0,0)}}@keyframes slideFromRight{from{transform:translate3d(var(--initial-transform,100%),0,0)}to{transform:translate3d(0,0,0)}}@keyframes slideToRight{to{transform:translate3d(var(--initial-transform,100%),0,0)}}`);function CM(){const r=navigator.userAgent;return typeof window<"u"&&(/Firefox/.test(r)&&/Mobile/.test(r)||/FxiOS/.test(r))}function AM(){return Sy(/^Mac/)}function TM(){return Sy(/^iPhone/)}function j2(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}function NM(){return Sy(/^iPad/)||AM()&&navigator.maxTouchPoints>1}function rC(){return TM()||NM()}function Sy(r){return typeof window<"u"&&window.navigator!=null?r.test(window.navigator.platform):void 0}const RM=24,IM=typeof window<"u"?W.useLayoutEffect:W.useEffect;function W2(...r){return(...t)=>{for(let e of r)typeof e=="function"&&e(...t)}}const Lg=typeof document<"u"&&window.visualViewport;function H2(r){let t=window.getComputedStyle(r);return/(auto|scroll)/.test(t.overflow+t.overflowX+t.overflowY)}function aC(r){for(H2(r)&&(r=r.parentElement);r&&!H2(r);)r=r.parentElement;return r||document.scrollingElement||document.documentElement}const kM=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);let ch=0,Fg;function DM(r={}){let{isDisabled:t}=r;IM(()=>{if(!t)return ch++,ch===1&&rC()&&(Fg=OM()),()=>{ch--,ch===0&&(Fg==null||Fg())}},[t])}function OM(){let r,t=0,e=p=>{r=aC(p.target),!(r===document.documentElement&&r===document.body)&&(t=p.changedTouches[0].pageY)},n=p=>{if(!r||r===document.documentElement||r===document.body){p.preventDefault();return}let g=p.changedTouches[0].pageY,v=r.scrollTop,b=r.scrollHeight-r.clientHeight;b!==0&&((v<=0&&g>t||v>=b&&g<t)&&p.preventDefault(),t=g)},a=p=>{let g=p.target;xv(g)&&g!==document.activeElement&&(p.preventDefault(),g.style.transform="translateY(-2000px)",g.focus(),requestAnimationFrame(()=>{g.style.transform=""}))},i=p=>{let g=p.target;xv(g)&&(g.style.transform="translateY(-2000px)",requestAnimationFrame(()=>{g.style.transform="",Lg&&(Lg.height<window.innerHeight?requestAnimationFrame(()=>{q2(g)}):Lg.addEventListener("resize",()=>q2(g),{once:!0}))}))},s=()=>{window.scrollTo(0,0)},l=window.pageXOffset,c=window.pageYOffset,f=W2(_M(document.documentElement,"paddingRight",`${window.innerWidth-document.documentElement.clientWidth}px`));window.scrollTo(0,0);let d=W2(Pl(document,"touchstart",e,{passive:!1,capture:!0}),Pl(document,"touchmove",n,{passive:!1,capture:!0}),Pl(document,"touchend",a,{passive:!1,capture:!0}),Pl(document,"focus",i,!0),Pl(window,"scroll",s));return()=>{f(),d(),window.scrollTo(l,c)}}function _M(r,t,e){let n=r.style[t];return r.style[t]=e,()=>{r.style[t]=n}}function Pl(r,t,e,n){return r.addEventListener(t,e,n),()=>{r.removeEventListener(t,e,n)}}function q2(r){let t=document.scrollingElement||document.documentElement;for(;r&&r!==t;){let e=aC(r);if(e!==document.documentElement&&e!==document.body&&e!==r){let n=e.getBoundingClientRect().top,a=r.getBoundingClientRect().top,i=r.getBoundingClientRect().bottom;const s=e.getBoundingClientRect().bottom+RM;i>s&&(e.scrollTop+=a-n)}r=e.parentElement}}function xv(r){return r instanceof HTMLInputElement&&!kM.has(r.type)||r instanceof HTMLTextAreaElement||r instanceof HTMLElement&&r.isContentEditable}function MM(r,t){typeof r=="function"?r(t):r!=null&&(r.current=t)}function zM(...r){return t=>r.forEach(e=>MM(e,t))}function iC(...r){return W.useCallback(zM(...r),r)}const oC=new WeakMap;function xn(r,t,e=!1){if(!r||!(r instanceof HTMLElement))return;let n={};Object.entries(t).forEach(([a,i])=>{if(a.startsWith("--")){r.style.setProperty(a,i);return}n[a]=r.style[a],r.style[a]=i}),!e&&oC.set(r,n)}function LM(r,t){if(!r||!(r instanceof HTMLElement))return;let e=oC.get(r);e&&(r.style[t]=e[t])}const ln=r=>{switch(r){case"top":case"bottom":return!0;case"left":case"right":return!1;default:return r}};function fh(r,t){if(!r)return null;const e=window.getComputedStyle(r),n=e.transform||e.webkitTransform||e.mozTransform;let a=n.match(/^matrix3d\((.+)\)$/);return a?parseFloat(a[1].split(", ")[ln(t)?13:12]):(a=n.match(/^matrix\((.+)\)$/),a?parseFloat(a[1].split(", ")[ln(t)?5:4]):null)}function FM(r){return 8*(Math.log(r+1)-2)}function Bg(r,t){if(!r)return()=>{};const e=r.style.cssText;return Object.assign(r.style,t),()=>{r.style.cssText=e}}function BM(...r){return(...t)=>{for(const e of r)typeof e=="function"&&e(...t)}}const Ht={DURATION:.5,EASE:[.32,.72,0,1]},sC=.4,UM=.25,PM=100,uC=8,hh=16,Sv=26,Ug="vaul-dragging";function lC(r){const t=Te.useRef(r);return Te.useEffect(()=>{t.current=r}),Te.useMemo(()=>(...e)=>t.current==null?void 0:t.current.call(t,...e),[])}function VM({defaultProp:r,onChange:t}){const e=Te.useState(r),[n]=e,a=Te.useRef(n),i=lC(t);return Te.useEffect(()=>{a.current!==n&&(i(n),a.current=n)},[n,a,i]),e}function cC({prop:r,defaultProp:t,onChange:e=()=>{}}){const[n,a]=VM({defaultProp:t,onChange:e}),i=r!==void 0,s=i?r:n,l=lC(e),c=Te.useCallback(f=>{if(i){const p=typeof f=="function"?f(r):f;p!==r&&l(p)}else a(f)},[i,r,a,l]);return[s,c]}function jM({activeSnapPointProp:r,setActiveSnapPointProp:t,snapPoints:e,drawerRef:n,overlayRef:a,fadeFromIndex:i,onSnapPointChange:s,direction:l="bottom",container:c,snapToSequentialPoint:f}){const[d,p]=cC({prop:r,defaultProp:e==null?void 0:e[0],onChange:t}),[g,v]=Te.useState(typeof window<"u"?{innerWidth:window.innerWidth,innerHeight:window.innerHeight}:void 0);Te.useEffect(()=>{function N(){v({innerWidth:window.innerWidth,innerHeight:window.innerHeight})}return window.addEventListener("resize",N),()=>window.removeEventListener("resize",N)},[]);const b=Te.useMemo(()=>d===(e==null?void 0:e[e.length-1])||null,[e,d]),w=Te.useMemo(()=>{var N;return(N=e==null?void 0:e.findIndex(D=>D===d))!=null?N:null},[e,d]),S=e&&e.length>0&&(i||i===0)&&!Number.isNaN(i)&&e[i]===d||!e,x=Te.useMemo(()=>{const N=c?{width:c.getBoundingClientRect().width,height:c.getBoundingClientRect().height}:typeof window<"u"?{width:window.innerWidth,height:window.innerHeight}:{width:0,height:0};var D;return(D=e==null?void 0:e.map(I=>{const _=typeof I=="string";let F=0;if(_&&(F=parseInt(I,10)),ln(l)){const V=_?F:g?I*N.height:0;return g?l==="bottom"?N.height-V:-N.height+V:V}const B=_?F:g?I*N.width:0;return g?l==="right"?N.width-B:-N.width+B:B}))!=null?D:[]},[e,g,c]),C=Te.useMemo(()=>w!==null?x==null?void 0:x[w]:null,[x,w]),A=Te.useCallback(N=>{var D;const I=(D=x==null?void 0:x.findIndex(_=>_===N))!=null?D:null;s(I),xn(n.current,{transition:`transform ${Ht.DURATION}s cubic-bezier(${Ht.EASE.join(",")})`,transform:ln(l)?`translate3d(0, ${N}px, 0)`:`translate3d(${N}px, 0, 0)`}),x&&I!==x.length-1&&i!==void 0&&I!==i&&I<i?xn(a.current,{transition:`opacity ${Ht.DURATION}s cubic-bezier(${Ht.EASE.join(",")})`,opacity:"0"}):xn(a.current,{transition:`opacity ${Ht.DURATION}s cubic-bezier(${Ht.EASE.join(",")})`,opacity:"1"}),p(e==null?void 0:e[Math.max(I,0)])},[n.current,e,x,i,a,p]);Te.useEffect(()=>{if(d||r){var N;const D=(N=e==null?void 0:e.findIndex(I=>I===r||I===d))!=null?N:-1;x&&D!==-1&&typeof x[D]=="number"&&A(x[D])}},[d,r,e,x,A]);function T({draggedDistance:N,closeDrawer:D,velocity:I,dismissible:_}){if(i===void 0)return;const F=l==="bottom"||l==="right"?(C??0)-N:(C??0)+N,B=w===i-1,V=w===0,X=N>0;if(B&&xn(a.current,{transition:`opacity ${Ht.DURATION}s cubic-bezier(${Ht.EASE.join(",")})`}),!f&&I>2&&!X){_?D():A(x[0]);return}if(!f&&I>2&&X&&x&&e){A(x[e.length-1]);return}const Y=x==null?void 0:x.reduce((G,q)=>typeof G!="number"||typeof q!="number"?G:Math.abs(q-F)<Math.abs(G-F)?q:G),j=ln(l)?window.innerHeight:window.innerWidth;if(I>sC&&Math.abs(N)<j*.4){const G=X?1:-1;if(G>0&&b&&e){A(x[e.length-1]);return}if(V&&G<0&&_&&D(),w===null)return;A(x[w+G]);return}A(Y)}function R({draggedDistance:N}){if(C===null)return;const D=l==="bottom"||l==="right"?C-N:C+N;(l==="bottom"||l==="right")&&D<x[x.length-1]||(l==="top"||l==="left")&&D>x[x.length-1]||xn(n.current,{transform:ln(l)?`translate3d(0, ${D}px, 0)`:`translate3d(${D}px, 0, 0)`})}function O(N,D){if(!e||typeof w!="number"||!x||i===void 0)return null;const I=w===i-1;if(w>=i&&D)return 0;if(I&&!D)return 1;if(!S&&!I)return null;const F=I?w+1:w-1,B=I?x[F]-x[F-1]:x[F+1]-x[F],V=N/Math.abs(B);return I?1-V:V}return{isLastSnapPoint:b,activeSnapPoint:d,shouldFade:S,getPercentageDragged:O,setActiveSnapPoint:p,activeSnapPointIndex:w,onRelease:T,onDrag:R,snapPointsOffset:x}}const WM=()=>()=>{};function HM(){const{direction:r,isOpen:t,shouldScaleBackground:e,setBackgroundColorOnScale:n,noBodyStyles:a}=Cc(),i=Te.useRef(null),s=W.useMemo(()=>document.body.style.backgroundColor,[]);function l(){return(window.innerWidth-Sv)/window.innerWidth}Te.useEffect(()=>{if(t&&e){i.current&&clearTimeout(i.current);const c=document.querySelector("[data-vaul-drawer-wrapper]")||document.querySelector("[vaul-drawer-wrapper]");if(!c)return;BM(n&&!a?Bg(document.body,{background:"black"}):WM,Bg(c,{transformOrigin:ln(r)?"top":"left",transitionProperty:"transform, border-radius",transitionDuration:`${Ht.DURATION}s`,transitionTimingFunction:`cubic-bezier(${Ht.EASE.join(",")})`}));const f=Bg(c,{borderRadius:`${uC}px`,overflow:"hidden",...ln(r)?{transform:`scale(${l()}) translate3d(0, calc(env(safe-area-inset-top) + 14px), 0)`}:{transform:`scale(${l()}) translate3d(calc(env(safe-area-inset-top) + 14px), 0, 0)`}});return()=>{f(),i.current=window.setTimeout(()=>{s?document.body.style.background=s:document.body.style.removeProperty("background")},Ht.DURATION*1e3)}}},[t,e,s])}let Vl=null;function qM({isOpen:r,modal:t,nested:e,hasBeenOpened:n,preventScrollRestoration:a,noBodyStyles:i}){const[s,l]=Te.useState(()=>typeof window<"u"?window.location.href:""),c=Te.useRef(0),f=Te.useCallback(()=>{if(j2()&&Vl===null&&r&&!i){Vl={position:document.body.style.position,top:document.body.style.top,left:document.body.style.left,height:document.body.style.height,right:"unset"};const{scrollX:p,innerHeight:g}=window;document.body.style.setProperty("position","fixed","important"),Object.assign(document.body.style,{top:`${-c.current}px`,left:`${-p}px`,right:"0px",height:"auto"}),window.setTimeout(()=>window.requestAnimationFrame(()=>{const v=g-window.innerHeight;v&&c.current>=g&&(document.body.style.top=`${-(c.current+v)}px`)}),300)}},[r]),d=Te.useCallback(()=>{if(j2()&&Vl!==null&&!i){const p=-parseInt(document.body.style.top,10),g=-parseInt(document.body.style.left,10);Object.assign(document.body.style,Vl),window.requestAnimationFrame(()=>{if(a&&s!==window.location.href){l(window.location.href);return}window.scrollTo(g,p)}),Vl=null}},[s]);return Te.useEffect(()=>{function p(){c.current=window.scrollY}return p(),window.addEventListener("scroll",p),()=>{window.removeEventListener("scroll",p)}},[]),Te.useEffect(()=>{if(t)return()=>{typeof document>"u"||document.querySelector("[data-vaul-drawer]")||d()}},[t,d]),Te.useEffect(()=>{e||!n||(r?(!window.matchMedia("(display-mode: standalone)").matches&&f(),t||window.setTimeout(()=>{d()},500)):d())},[r,n,s,t,e,f,d]),{restorePositionSetting:d}}function GM({open:r,onOpenChange:t,children:e,onDrag:n,onRelease:a,snapPoints:i,shouldScaleBackground:s=!1,setBackgroundColorOnScale:l=!0,closeThreshold:c=UM,scrollLockTimeout:f=PM,dismissible:d=!0,handleOnly:p=!1,fadeFromIndex:g=i&&i.length-1,activeSnapPoint:v,setActiveSnapPoint:b,fixed:w,modal:S=!0,onClose:x,nested:C,noBodyStyles:A=!1,direction:T="bottom",defaultOpen:R=!1,disablePreventScroll:O=!0,snapToSequentialPoint:N=!1,preventScrollRestoration:D=!1,repositionInputs:I=!0,onAnimationEnd:_,container:F,autoFocus:B=!1}){var V,X;const[Y=!1,j]=cC({defaultProp:R,prop:r,onChange:je=>{t==null||t(je),!je&&!C&&Pn(),setTimeout(()=>{_==null||_(je)},Ht.DURATION*1e3),je&&!S&&typeof window<"u"&&window.requestAnimationFrame(()=>{document.body.style.pointerEvents="auto"}),je||(document.body.style.pointerEvents="auto")}}),[G,q]=Te.useState(!1),[ne,L]=Te.useState(!1),[Z,ce]=Te.useState(!1),le=Te.useRef(null),de=Te.useRef(null),xe=Te.useRef(null),we=Te.useRef(null),_e=Te.useRef(null),Ee=Te.useRef(!1),ke=Te.useRef(null),Ue=Te.useRef(0),Fe=Te.useRef(!1),rt=Te.useRef(!R),qe=Te.useRef(0),Se=Te.useRef(null),dt=Te.useRef(((V=Se.current)==null?void 0:V.getBoundingClientRect().height)||0),Je=Te.useRef(((X=Se.current)==null?void 0:X.getBoundingClientRect().width)||0),Pt=Te.useRef(0),Cn=Te.useCallback(je=>{i&&je===Ge.length-1&&(de.current=new Date)},[]),{activeSnapPoint:en,activeSnapPointIndex:Ft,setActiveSnapPoint:Vt,onRelease:Un,snapPointsOffset:Ge,onDrag:kt,shouldFade:Bt,getPercentageDragged:Gt}=jM({snapPoints:i,activeSnapPointProp:v,setActiveSnapPointProp:b,drawerRef:Se,fadeFromIndex:g,overlayRef:le,onSnapPointChange:Cn,direction:T,container:F,snapToSequentialPoint:N});DM({isDisabled:!Y||ne||!S||Z||!G||!I||!O});const{restorePositionSetting:Pn}=qM({isOpen:Y,modal:S,nested:C??!1,hasBeenOpened:G,preventScrollRestoration:D,noBodyStyles:A});function mn(){return(window.innerWidth-Sv)/window.innerWidth}function Xt(je){var bt,wt;!d&&!i||Se.current&&!Se.current.contains(je.target)||(dt.current=((bt=Se.current)==null?void 0:bt.getBoundingClientRect().height)||0,Je.current=((wt=Se.current)==null?void 0:wt.getBoundingClientRect().width)||0,L(!0),xe.current=new Date,rC()&&window.addEventListener("touchend",()=>Ee.current=!1,{once:!0}),je.target.setPointerCapture(je.pointerId),Ue.current=ln(T)?je.pageY:je.pageX)}function pr(je,bt){var wt;let st=je;const Et=(wt=window.getSelection())==null?void 0:wt.toString(),yn=Se.current?fh(Se.current,T):null,tn=new Date;if(st.tagName==="SELECT"||st.hasAttribute("data-vaul-no-drag")||st.closest("[data-vaul-no-drag]"))return!1;if(T==="right"||T==="left")return!0;if(de.current&&tn.getTime()-de.current.getTime()<500)return!1;if(yn!==null&&(T==="bottom"?yn>0:yn<0))return!0;if(Et&&Et.length>0)return!1;if(_e.current&&tn.getTime()-_e.current.getTime()<f&&yn===0||bt)return _e.current=tn,!1;for(;st;){if(st.scrollHeight>st.clientHeight){if(st.scrollTop!==0)return _e.current=new Date,!1;if(st.getAttribute("role")==="dialog")return!0}st=st.parentNode}return!0}function tr(je){if(Se.current&&ne){const bt=T==="bottom"||T==="right"?1:-1,wt=(Ue.current-(ln(T)?je.pageY:je.pageX))*bt,st=wt>0,Et=i&&!d&&!st;if(Et&&Ft===0)return;const yn=Math.abs(wt),tn=document.querySelector("[data-vaul-drawer-wrapper]"),pa=T==="bottom"||T==="top"?dt.current:Je.current;let rr=yn/pa;const ma=Gt(yn,st);if(ma!==null&&(rr=ma),Et&&rr>=1||!Ee.current&&!pr(je.target,st))return;if(Se.current.classList.add(Ug),Ee.current=!0,xn(Se.current,{transition:"none"}),xn(le.current,{transition:"none"}),i&&kt({draggedDistance:wt}),st&&!i){const Vn=FM(wt),bs=Math.min(Vn*-1,0)*bt;xn(Se.current,{transform:ln(T)?`translate3d(0, ${bs}px, 0)`:`translate3d(${bs}px, 0, 0)`});return}const Or=1-rr;if((Bt||g&&Ft===g-1)&&(n==null||n(je,rr),xn(le.current,{opacity:`${Or}`,transition:"none"},!0)),tn&&le.current&&s){const Vn=Math.min(mn()+rr*(1-mn()),1),bs=8-rr*8,Hu=Math.max(0,14-rr*14);xn(tn,{borderRadius:`${bs}px`,transform:ln(T)?`scale(${Vn}) translate3d(0, ${Hu}px, 0)`:`scale(${Vn}) translate3d(${Hu}px, 0, 0)`,transition:"none"},!0)}if(!i){const Vn=yn*bt;xn(Se.current,{transform:ln(T)?`translate3d(0, ${Vn}px, 0)`:`translate3d(${Vn}px, 0, 0)`})}}}Te.useEffect(()=>{window.requestAnimationFrame(()=>{rt.current=!0})},[]),Te.useEffect(()=>{var je;function bt(){if(!Se.current||!I)return;const wt=document.activeElement;if(xv(wt)||Fe.current){var st;const Et=((st=window.visualViewport)==null?void 0:st.height)||0,yn=window.innerHeight;let tn=yn-Et;const pa=Se.current.getBoundingClientRect().height||0,rr=pa>yn*.8;Pt.current||(Pt.current=pa);const ma=Se.current.getBoundingClientRect().top;if(Math.abs(qe.current-tn)>60&&(Fe.current=!Fe.current),i&&i.length>0&&Ge&&Ft){const Or=Ge[Ft]||0;tn+=Or}if(qe.current=tn,pa>Et||Fe.current){const Or=Se.current.getBoundingClientRect().height;let Vn=Or;Or>Et&&(Vn=Et-(rr?ma:Sv)),w?Se.current.style.height=`${Or-Math.max(tn,0)}px`:Se.current.style.height=`${Math.max(Vn,Et-ma)}px`}else CM()||(Se.current.style.height=`${Pt.current}px`);i&&i.length>0&&!Fe.current?Se.current.style.bottom="0px":Se.current.style.bottom=`${Math.max(tn,0)}px`}}return(je=window.visualViewport)==null||je.addEventListener("resize",bt),()=>{var wt;return(wt=window.visualViewport)==null?void 0:wt.removeEventListener("resize",bt)}},[Ft,i,Ge]);function $r(je){gn(),x==null||x(),je||j(!1),setTimeout(()=>{i&&Vt(i[0])},Ht.DURATION*1e3)}function Dr(){if(!Se.current)return;const je=document.querySelector("[data-vaul-drawer-wrapper]"),bt=fh(Se.current,T);xn(Se.current,{transform:"translate3d(0, 0, 0)",transition:`transform ${Ht.DURATION}s cubic-bezier(${Ht.EASE.join(",")})`}),xn(le.current,{transition:`opacity ${Ht.DURATION}s cubic-bezier(${Ht.EASE.join(",")})`,opacity:"1"}),s&&bt&&bt>0&&Y&&xn(je,{borderRadius:`${uC}px`,overflow:"hidden",...ln(T)?{transform:`scale(${mn()}) translate3d(0, calc(env(safe-area-inset-top) + 14px), 0)`,transformOrigin:"top"}:{transform:`scale(${mn()}) translate3d(calc(env(safe-area-inset-top) + 14px), 0, 0)`,transformOrigin:"left"},transitionProperty:"transform, border-radius",transitionDuration:`${Ht.DURATION}s`,transitionTimingFunction:`cubic-bezier(${Ht.EASE.join(",")})`},!0)}function gn(){!ne||!Se.current||(Se.current.classList.remove(Ug),Ee.current=!1,L(!1),we.current=new Date)}function Ma(je){if(!ne||!Se.current)return;Se.current.classList.remove(Ug),Ee.current=!1,L(!1),we.current=new Date;const bt=fh(Se.current,T);if(!je||!pr(je.target,!1)||!bt||Number.isNaN(bt)||xe.current===null)return;const wt=we.current.getTime()-xe.current.getTime(),st=Ue.current-(ln(T)?je.pageY:je.pageX),Et=Math.abs(st)/wt;if(Et>.05&&(ce(!0),setTimeout(()=>{ce(!1)},200)),i){Un({draggedDistance:st*(T==="bottom"||T==="right"?1:-1),closeDrawer:$r,velocity:Et,dismissible:d}),a==null||a(je,!0);return}if(T==="bottom"||T==="right"?st>0:st<0){Dr(),a==null||a(je,!0);return}if(Et>sC){$r(),a==null||a(je,!1);return}var yn;const tn=Math.min((yn=Se.current.getBoundingClientRect().height)!=null?yn:0,window.innerHeight);var pa;const rr=Math.min((pa=Se.current.getBoundingClientRect().width)!=null?pa:0,window.innerWidth),ma=T==="left"||T==="right";if(Math.abs(bt)>=(ma?rr:tn)*c){$r(),a==null||a(je,!1);return}a==null||a(je,!0),Dr()}Te.useEffect(()=>(Y&&(xn(document.documentElement,{scrollBehavior:"auto"}),de.current=new Date),()=>{LM(document.documentElement,"scrollBehavior")}),[Y]);function nr(je){const bt=je?(window.innerWidth-hh)/window.innerWidth:1,wt=je?-16:0;ke.current&&window.clearTimeout(ke.current),xn(Se.current,{transition:`transform ${Ht.DURATION}s cubic-bezier(${Ht.EASE.join(",")})`,transform:ln(T)?`scale(${bt}) translate3d(0, ${wt}px, 0)`:`scale(${bt}) translate3d(${wt}px, 0, 0)`}),!je&&Se.current&&(ke.current=setTimeout(()=>{const st=fh(Se.current,T);xn(Se.current,{transition:"none",transform:ln(T)?`translate3d(0, ${st}px, 0)`:`translate3d(${st}px, 0, 0)`})},500))}function vn(je,bt){if(bt<0)return;const wt=(window.innerWidth-hh)/window.innerWidth,st=wt+bt*(1-wt),Et=-16+bt*hh;xn(Se.current,{transform:ln(T)?`scale(${st}) translate3d(0, ${Et}px, 0)`:`scale(${st}) translate3d(${Et}px, 0, 0)`,transition:"none"})}function vp(je,bt){const wt=ln(T)?window.innerHeight:window.innerWidth,st=bt?(wt-hh)/wt:1,Et=bt?-16:0;bt&&xn(Se.current,{transition:`transform ${Ht.DURATION}s cubic-bezier(${Ht.EASE.join(",")})`,transform:ln(T)?`scale(${st}) translate3d(0, ${Et}px, 0)`:`scale(${st}) translate3d(${Et}px, 0, 0)`})}return Te.useEffect(()=>{S||window.requestAnimationFrame(()=>{document.body.style.pointerEvents="auto"})},[S]),Te.createElement(vM,{defaultOpen:R,onOpenChange:je=>{!d&&!je||(je?q(!0):$r(!0),j(je))},open:Y},Te.createElement(nC.Provider,{value:{activeSnapPoint:en,snapPoints:i,setActiveSnapPoint:Vt,drawerRef:Se,overlayRef:le,onOpenChange:t,onPress:Xt,onRelease:Ma,onDrag:tr,dismissible:d,shouldAnimate:rt,handleOnly:p,isOpen:Y,isDragging:ne,shouldFade:Bt,closeDrawer:$r,onNestedDrag:vn,onNestedOpenChange:nr,onNestedRelease:vp,keyboardIsOpen:Fe,modal:S,snapPointsOffset:Ge,activeSnapPointIndex:Ft,direction:T,shouldScaleBackground:s,setBackgroundColorOnScale:l,noBodyStyles:A,container:F,autoFocus:B}},e))}const XM=Te.forwardRef(function({...r},t){const{overlayRef:e,snapPoints:n,onRelease:a,shouldFade:i,isOpen:s,modal:l,shouldAnimate:c}=Cc(),f=iC(t,e),d=n&&n.length>0;if(!l)return null;const p=Te.useCallback(g=>a(g),[a]);return Te.createElement(wM,{onMouseUp:p,ref:f,"data-vaul-overlay":"","data-vaul-snap-points":s&&d?"true":"false","data-vaul-snap-points-overlay":s&&i?"true":"false","data-vaul-animate":c!=null&&c.current?"true":"false",...r})});XM.displayName="Drawer.Overlay";const fC=Te.forwardRef(function({onPointerDownOutside:r,style:t,onOpenAutoFocus:e,...n},a){const{drawerRef:i,onPress:s,onRelease:l,onDrag:c,keyboardIsOpen:f,snapPointsOffset:d,activeSnapPointIndex:p,modal:g,isOpen:v,direction:b,snapPoints:w,container:S,handleOnly:x,shouldAnimate:C,autoFocus:A}=Cc(),[T,R]=Te.useState(!1),O=iC(a,i),N=Te.useRef(null),D=Te.useRef(null),I=Te.useRef(!1),_=w&&w.length>0;HM();const F=(V,X,Y=0)=>{if(I.current)return!0;const j=Math.abs(V.y),G=Math.abs(V.x),q=G>j,ne=["bottom","right"].includes(X)?1:-1;if(X==="left"||X==="right"){if(!(V.x*ne<0)&&G>=0&&G<=Y)return q}else if(!(V.y*ne<0)&&j>=0&&j<=Y)return!q;return I.current=!0,!0};Te.useEffect(()=>{_&&window.requestAnimationFrame(()=>{R(!0)})},[]);function B(V){N.current=null,I.current=!1,l(V)}return Te.createElement(xM,{"data-vaul-drawer-direction":b,"data-vaul-drawer":"","data-vaul-delayed-snap-points":T?"true":"false","data-vaul-snap-points":v&&_?"true":"false","data-vaul-custom-container":S?"true":"false","data-vaul-animate":C!=null&&C.current?"true":"false",...n,ref:O,style:d&&d.length>0?{"--snap-point-height":`${d[p??0]}px`,...t}:t,onPointerDown:V=>{x||(n.onPointerDown==null||n.onPointerDown.call(n,V),N.current={x:V.pageX,y:V.pageY},s(V))},onOpenAutoFocus:V=>{e==null||e(V),A||V.preventDefault()},onPointerDownOutside:V=>{if(r==null||r(V),!g||V.defaultPrevented){V.preventDefault();return}f.current&&(f.current=!1)},onFocusOutside:V=>{if(!g){V.preventDefault();return}},onPointerMove:V=>{if(D.current=V,x||(n.onPointerMove==null||n.onPointerMove.call(n,V),!N.current))return;const X=V.pageY-N.current.y,Y=V.pageX-N.current.x,j=V.pointerType==="touch"?10:2;F({x:Y,y:X},b,j)?c(V):(Math.abs(Y)>j||Math.abs(X)>j)&&(N.current=null)},onPointerUp:V=>{n.onPointerUp==null||n.onPointerUp.call(n,V),N.current=null,I.current=!1,l(V)},onPointerOut:V=>{n.onPointerOut==null||n.onPointerOut.call(n,V),B(D.current)},onContextMenu:V=>{n.onContextMenu==null||n.onContextMenu.call(n,V),D.current&&B(D.current)}})});fC.displayName="Drawer.Content";const $M=250,KM=120,hC=Te.forwardRef(function({preventCycle:r=!1,children:t,...e},n){const{closeDrawer:a,isDragging:i,snapPoints:s,activeSnapPoint:l,setActiveSnapPoint:c,dismissible:f,handleOnly:d,isOpen:p,onPress:g,onDrag:v}=Cc(),b=Te.useRef(null),w=Te.useRef(!1);function S(){if(w.current){A();return}window.setTimeout(()=>{x()},KM)}function x(){if(i||r||w.current){A();return}if(A(),!s||s.length===0){f||a();return}if(l===s[s.length-1]&&f){a();return}const R=s.findIndex(N=>N===l);if(R===-1)return;const O=s[R+1];c(O)}function C(){b.current=window.setTimeout(()=>{w.current=!0},$M)}function A(){b.current&&window.clearTimeout(b.current),w.current=!1}return Te.createElement("div",{onClick:S,onPointerCancel:A,onPointerDown:T=>{d&&g(T),C()},onPointerMove:T=>{d&&v(T)},ref:n,"data-vaul-drawer-visible":p?"true":"false","data-vaul-handle":"","aria-hidden":"true",...e},Te.createElement("span",{"data-vaul-handle-hitarea":"","aria-hidden":"true"},t))});hC.displayName="Drawer.Handle";function YM(r){const t=Cc(),{container:e=t.container,...n}=r;return Te.createElement(bM,{container:e,...n})}const ou={Root:GM,Content:fC,Trigger:yM,Portal:YM,Handle:hC,Title:SM},Vi=["150px","550px",1],dC=({children:r,dream:t,open:e,onClose:n})=>{const[a,i]=W.useState(Vi[1]),s=l=>{const{scrollTop:c,scrollHeight:f,clientHeight:d}=l.currentTarget;a===Vi[0]&&(c+d>=f&&i(Vi[1]),c===0&&n&&n()),a===Vi[1]&&(c+d>=f&&i(Vi[2]),c===0&&n&&n()),a===Vi[2]&&c===0&&i(Vi[1])};return ve.jsxs(ou.Root,{snapPoints:Vi,activeSnapPoint:a,setActiveSnapPoint:i,modal:!1,open:e,onClose:n,children:[r,ve.jsx(ou.Portal,{children:ve.jsxs(ou.Content,{"data-testid":"content",className:"fixed flex flex-col bg-white border border-gray-200 border-b-none rounded-t-[10px] bottom-0 left-0 right-0 h-full max-h-[97%]",children:[ve.jsx(ou.Handle,{className:"m-2"}),t?ve.jsxs("div",{onScroll:s,className:"p-4 bg-gray-100 overflow-y-auto",style:{height:typeof a=="string"?a:"97%"},children:[ve.jsxs("div",{className:"relative",children:[ve.jsx("img",{src:`/images/saturated/${t.fileName}`,alt:t.title,className:"w-full max-w-[500px] m-auto"}),ve.jsx(ou.Title,{className:"absolute text-xl top-0 left-0 bg-black bg-opacity-50 text-white p-2",children:t.title}),ve.jsx("div",{className:"absolute text-l top-10 left-0 bg-black bg-opacity-50 text-white p-2",children:t.tagline}),ve.jsx("div",{className:"absolute bottom-0 right-0 bg-black bg-opacity-50 text-white p-2",children:"▶️ PLAY"})]}),ve.jsx("h2",{className:"text-lg font-semibold mt-4",children:"Explanation"}),ve.jsx("p",{className:"text-sm text-gray-700",children:t.explanation}),ve.jsx("h2",{className:"text-lg font-semibold mt-4",children:"Importance"}),ve.jsx("p",{className:"text-sm text-gray-700",children:t.importance}),ve.jsx("h2",{className:"text-lg font-semibold mt-4",children:"AI Role"}),ve.jsx("p",{className:"text-sm text-gray-700",children:t.aiRole}),ve.jsx("h2",{className:"text-lg font-semibold mt-4",children:"Image Description"}),ve.jsx("p",{className:"text-sm text-gray-700",children:t.imageDescription})]}):ve.jsx("div",{children:"Click on a tile to select a dream"})]})})]})},pC=()=>ve.jsx("div",{className:"bg-gray-900 p-3 flex justify-between items-center",children:ve.jsx("div",{className:"text-white text-lg font-bold mx-auto",children:"Deep Reverie"})}),ZM=()=>{const[r,t]=W.useState(null),e=n=>{t(n)};return ve.jsxs("div",{className:"bg-gray-900",children:[ve.jsx(pC,{}),ve.jsx(dC,{dream:r,open:!!r,onClose:()=>t(null),children:ve.jsx("div",{className:"grid grid-cols-3 md:grid-cols-5 gap-4 p-2",children:CE.map((n,a)=>ve.jsx(ve.Fragment,{children:r?ve.jsx(R2,{imageUrl:`/images/thumbnails/${n.fileName}`,onClick:()=>e(n)},a):ve.jsx(ou.Trigger,{children:ve.jsx(R2,{imageUrl:`/images/thumbnails/${n.fileName}`,onClick:()=>e(n)},a)})}))})})]})};var jl={},G2;function QM(){if(G2)return jl;G2=1,Object.defineProperty(jl,"__esModule",{value:!0}),jl.parse=s,jl.serialize=f;const r=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,t=/^[\u0021-\u003A\u003C-\u007E]*$/,e=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,n=/^[\u0020-\u003A\u003D-\u007E]*$/,a=Object.prototype.toString,i=(()=>{const g=function(){};return g.prototype=Object.create(null),g})();function s(g,v){const b=new i,w=g.length;if(w<2)return b;const S=(v==null?void 0:v.decode)||d;let x=0;do{const C=g.indexOf("=",x);if(C===-1)break;const A=g.indexOf(";",x),T=A===-1?w:A;if(C>T){x=g.lastIndexOf(";",C-1)+1;continue}const R=l(g,x,C),O=c(g,C,R),N=g.slice(R,O);if(b[N]===void 0){let D=l(g,C+1,T),I=c(g,T,D);const _=S(g.slice(D,I));b[N]=_}x=T+1}while(x<w);return b}function l(g,v,b){do{const w=g.charCodeAt(v);if(w!==32&&w!==9)return v}while(++v<b);return b}function c(g,v,b){for(;v>b;){const w=g.charCodeAt(--v);if(w!==32&&w!==9)return v+1}return b}function f(g,v,b){const w=(b==null?void 0:b.encode)||encodeURIComponent;if(!r.test(g))throw new TypeError(`argument name is invalid: ${g}`);const S=w(v);if(!t.test(S))throw new TypeError(`argument val is invalid: ${v}`);let x=g+"="+S;if(!b)return x;if(b.maxAge!==void 0){if(!Number.isInteger(b.maxAge))throw new TypeError(`option maxAge is invalid: ${b.maxAge}`);x+="; Max-Age="+b.maxAge}if(b.domain){if(!e.test(b.domain))throw new TypeError(`option domain is invalid: ${b.domain}`);x+="; Domain="+b.domain}if(b.path){if(!n.test(b.path))throw new TypeError(`option path is invalid: ${b.path}`);x+="; Path="+b.path}if(b.expires){if(!p(b.expires)||!Number.isFinite(b.expires.valueOf()))throw new TypeError(`option expires is invalid: ${b.expires}`);x+="; Expires="+b.expires.toUTCString()}if(b.httpOnly&&(x+="; HttpOnly"),b.secure&&(x+="; Secure"),b.partitioned&&(x+="; Partitioned"),b.priority)switch(typeof b.priority=="string"?b.priority.toLowerCase():void 0){case"low":x+="; Priority=Low";break;case"medium":x+="; Priority=Medium";break;case"high":x+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${b.priority}`)}if(b.sameSite)switch(typeof b.sameSite=="string"?b.sameSite.toLowerCase():b.sameSite){case!0:case"strict":x+="; SameSite=Strict";break;case"lax":x+="; SameSite=Lax";break;case"none":x+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${b.sameSite}`)}return x}function d(g){if(g.indexOf("%")===-1)return g;try{return decodeURIComponent(g)}catch{return g}}function p(g){return a.call(g)==="[object Date]"}return jl}QM();/**
 * react-router v7.3.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var X2="popstate";function JM(r={}){function t(n,a){let{pathname:i,search:s,hash:l}=n.location;return Ev("",{pathname:i,search:s,hash:l},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function e(n,a){return typeof a=="string"?a:sc(a)}return t3(t,e,null,r)}function qt(r,t){if(r===!1||r===null||typeof r>"u")throw new Error(t)}function Ta(r,t){if(!r){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function e3(){return Math.random().toString(36).substring(2,10)}function $2(r,t){return{usr:r.state,key:r.key,idx:t}}function Ev(r,t,e=null,n){return{pathname:typeof r=="string"?r:r.pathname,search:"",hash:"",...typeof t=="string"?Du(t):t,state:e,key:t&&t.key||n||e3()}}function sc({pathname:r="/",search:t="",hash:e=""}){return t&&t!=="?"&&(r+=t.charAt(0)==="?"?t:"?"+t),e&&e!=="#"&&(r+=e.charAt(0)==="#"?e:"#"+e),r}function Du(r){let t={};if(r){let e=r.indexOf("#");e>=0&&(t.hash=r.substring(e),r=r.substring(0,e));let n=r.indexOf("?");n>=0&&(t.search=r.substring(n),r=r.substring(0,n)),r&&(t.pathname=r)}return t}function t3(r,t,e,n={}){let{window:a=document.defaultView,v5Compat:i=!1}=n,s=a.history,l="POP",c=null,f=d();f==null&&(f=0,s.replaceState({...s.state,idx:f},""));function d(){return(s.state||{idx:null}).idx}function p(){l="POP";let S=d(),x=S==null?null:S-f;f=S,c&&c({action:l,location:w.location,delta:x})}function g(S,x){l="PUSH";let C=Ev(w.location,S,x);f=d()+1;let A=$2(C,f),T=w.createHref(C);try{s.pushState(A,"",T)}catch(R){if(R instanceof DOMException&&R.name==="DataCloneError")throw R;a.location.assign(T)}i&&c&&c({action:l,location:w.location,delta:1})}function v(S,x){l="REPLACE";let C=Ev(w.location,S,x);f=d();let A=$2(C,f),T=w.createHref(C);s.replaceState(A,"",T),i&&c&&c({action:l,location:w.location,delta:0})}function b(S){let x=a.location.origin!=="null"?a.location.origin:a.location.href,C=typeof S=="string"?S:sc(S);return C=C.replace(/ $/,"%20"),qt(x,`No window.location.(origin|href) available to create URL for href: ${C}`),new URL(C,x)}let w={get action(){return l},get location(){return r(a,s)},listen(S){if(c)throw new Error("A history only accepts one active listener");return a.addEventListener(X2,p),c=S,()=>{a.removeEventListener(X2,p),c=null}},createHref(S){return t(a,S)},createURL:b,encodeLocation(S){let x=b(S);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:g,replace:v,go(S){return s.go(S)}};return w}function mC(r,t,e="/"){return n3(r,t,e,!1)}function n3(r,t,e,n){let a=typeof t=="string"?Du(t):t,i=ui(a.pathname||"/",e);if(i==null)return null;let s=gC(r);r3(s);let l=null;for(let c=0;l==null&&c<s.length;++c){let f=p3(i);l=h3(s[c],f,n)}return l}function gC(r,t=[],e=[],n=""){let a=(i,s,l)=>{let c={relativePath:l===void 0?i.path||"":l,caseSensitive:i.caseSensitive===!0,childrenIndex:s,route:i};c.relativePath.startsWith("/")&&(qt(c.relativePath.startsWith(n),`Absolute route path "${c.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),c.relativePath=c.relativePath.slice(n.length));let f=ri([n,c.relativePath]),d=e.concat(c);i.children&&i.children.length>0&&(qt(i.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${f}".`),gC(i.children,t,d,f)),!(i.path==null&&!i.index)&&t.push({path:f,score:c3(f,i.index),routesMeta:d})};return r.forEach((i,s)=>{var l;if(i.path===""||!((l=i.path)!=null&&l.includes("?")))a(i,s);else for(let c of vC(i.path))a(i,s,c)}),t}function vC(r){let t=r.split("/");if(t.length===0)return[];let[e,...n]=t,a=e.endsWith("?"),i=e.replace(/\?$/,"");if(n.length===0)return a?[i,""]:[i];let s=vC(n.join("/")),l=[];return l.push(...s.map(c=>c===""?i:[i,c].join("/"))),a&&l.push(...s),l.map(c=>r.startsWith("/")&&c===""?"/":c)}function r3(r){r.sort((t,e)=>t.score!==e.score?e.score-t.score:f3(t.routesMeta.map(n=>n.childrenIndex),e.routesMeta.map(n=>n.childrenIndex)))}var a3=/^:[\w-]+$/,i3=3,o3=2,s3=1,u3=10,l3=-2,K2=r=>r==="*";function c3(r,t){let e=r.split("/"),n=e.length;return e.some(K2)&&(n+=l3),t&&(n+=o3),e.filter(a=>!K2(a)).reduce((a,i)=>a+(a3.test(i)?i3:i===""?s3:u3),n)}function f3(r,t){return r.length===t.length&&r.slice(0,-1).every((n,a)=>n===t[a])?r[r.length-1]-t[t.length-1]:0}function h3(r,t,e=!1){let{routesMeta:n}=r,a={},i="/",s=[];for(let l=0;l<n.length;++l){let c=n[l],f=l===n.length-1,d=i==="/"?t:t.slice(i.length)||"/",p=Yh({path:c.relativePath,caseSensitive:c.caseSensitive,end:f},d),g=c.route;if(!p&&f&&e&&!n[n.length-1].route.index&&(p=Yh({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},d)),!p)return null;Object.assign(a,p.params),s.push({params:a,pathname:ri([i,p.pathname]),pathnameBase:y3(ri([i,p.pathnameBase])),route:g}),p.pathnameBase!=="/"&&(i=ri([i,p.pathnameBase]))}return s}function Yh(r,t){typeof r=="string"&&(r={path:r,caseSensitive:!1,end:!0});let[e,n]=d3(r.path,r.caseSensitive,r.end),a=t.match(e);if(!a)return null;let i=a[0],s=i.replace(/(.)\/+$/,"$1"),l=a.slice(1);return{params:n.reduce((f,{paramName:d,isOptional:p},g)=>{if(d==="*"){let b=l[g]||"";s=i.slice(0,i.length-b.length).replace(/(.)\/+$/,"$1")}const v=l[g];return p&&!v?f[d]=void 0:f[d]=(v||"").replace(/%2F/g,"/"),f},{}),pathname:i,pathnameBase:s,pattern:r}}function d3(r,t=!1,e=!0){Ta(r==="*"||!r.endsWith("*")||r.endsWith("/*"),`Route path "${r}" will be treated as if it were "${r.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${r.replace(/\*$/,"/*")}".`);let n=[],a="^"+r.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(s,l,c)=>(n.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return r.endsWith("*")?(n.push({paramName:"*"}),a+=r==="*"||r==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):e?a+="\\/*$":r!==""&&r!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),n]}function p3(r){try{return r.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Ta(!1,`The URL path "${r}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),r}}function ui(r,t){if(t==="/")return r;if(!r.toLowerCase().startsWith(t.toLowerCase()))return null;let e=t.endsWith("/")?t.length-1:t.length,n=r.charAt(e);return n&&n!=="/"?null:r.slice(e)||"/"}function m3(r,t="/"){let{pathname:e,search:n="",hash:a=""}=typeof r=="string"?Du(r):r;return{pathname:e?e.startsWith("/")?e:g3(e,t):t,search:b3(n),hash:w3(a)}}function g3(r,t){let e=t.replace(/\/+$/,"").split("/");return r.split("/").forEach(a=>{a===".."?e.length>1&&e.pop():a!=="."&&e.push(a)}),e.length>1?e.join("/"):"/"}function Pg(r,t,e,n){return`Cannot include a '${r}' character in a manually specified \`to.${t}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${e}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function v3(r){return r.filter((t,e)=>e===0||t.route.path&&t.route.path.length>0)}function yC(r){let t=v3(r);return t.map((e,n)=>n===t.length-1?e.pathname:e.pathnameBase)}function bC(r,t,e,n=!1){let a;typeof r=="string"?a=Du(r):(a={...r},qt(!a.pathname||!a.pathname.includes("?"),Pg("?","pathname","search",a)),qt(!a.pathname||!a.pathname.includes("#"),Pg("#","pathname","hash",a)),qt(!a.search||!a.search.includes("#"),Pg("#","search","hash",a)));let i=r===""||a.pathname==="",s=i?"/":a.pathname,l;if(s==null)l=e;else{let p=t.length-1;if(!n&&s.startsWith("..")){let g=s.split("/");for(;g[0]==="..";)g.shift(),p-=1;a.pathname=g.join("/")}l=p>=0?t[p]:"/"}let c=m3(a,l),f=s&&s!=="/"&&s.endsWith("/"),d=(i||s===".")&&e.endsWith("/");return!c.pathname.endsWith("/")&&(f||d)&&(c.pathname+="/"),c}var ri=r=>r.join("/").replace(/\/\/+/g,"/"),y3=r=>r.replace(/\/+$/,"").replace(/^\/*/,"/"),b3=r=>!r||r==="?"?"":r.startsWith("?")?r:"?"+r,w3=r=>!r||r==="#"?"":r.startsWith("#")?r:"#"+r;function x3(r){return r!=null&&typeof r.status=="number"&&typeof r.statusText=="string"&&typeof r.internal=="boolean"&&"data"in r}var wC=["POST","PUT","PATCH","DELETE"];new Set(wC);var S3=["GET",...wC];new Set(S3);var Ou=W.createContext(null);Ou.displayName="DataRouter";var yd=W.createContext(null);yd.displayName="DataRouterState";var xC=W.createContext({isTransitioning:!1});xC.displayName="ViewTransition";var E3=W.createContext(new Map);E3.displayName="Fetchers";var C3=W.createContext(null);C3.displayName="Await";var ka=W.createContext(null);ka.displayName="Navigation";var Ac=W.createContext(null);Ac.displayName="Location";var di=W.createContext({outlet:null,matches:[],isDataRoute:!1});di.displayName="Route";var Ey=W.createContext(null);Ey.displayName="RouteError";function A3(r,{relative:t}={}){qt(Tc(),"useHref() may be used only in the context of a <Router> component.");let{basename:e,navigator:n}=W.useContext(ka),{hash:a,pathname:i,search:s}=Nc(r,{relative:t}),l=i;return e!=="/"&&(l=i==="/"?e:ri([e,i])),n.createHref({pathname:l,search:s,hash:a})}function Tc(){return W.useContext(Ac)!=null}function ss(){return qt(Tc(),"useLocation() may be used only in the context of a <Router> component."),W.useContext(Ac).location}var SC="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function EC(r){W.useContext(ka).static||W.useLayoutEffect(r)}function T3(){let{isDataRoute:r}=W.useContext(di);return r?U3():N3()}function N3(){qt(Tc(),"useNavigate() may be used only in the context of a <Router> component.");let r=W.useContext(Ou),{basename:t,navigator:e}=W.useContext(ka),{matches:n}=W.useContext(di),{pathname:a}=ss(),i=JSON.stringify(yC(n)),s=W.useRef(!1);return EC(()=>{s.current=!0}),W.useCallback((c,f={})=>{if(Ta(s.current,SC),!s.current)return;if(typeof c=="number"){e.go(c);return}let d=bC(c,JSON.parse(i),a,f.relative==="path");r==null&&t!=="/"&&(d.pathname=d.pathname==="/"?t:ri([t,d.pathname])),(f.replace?e.replace:e.push)(d,f.state,f)},[t,e,i,a,r])}W.createContext(null);function Nc(r,{relative:t}={}){let{matches:e}=W.useContext(di),{pathname:n}=ss(),a=JSON.stringify(yC(e));return W.useMemo(()=>bC(r,JSON.parse(a),n,t==="path"),[r,a,n,t])}function R3(r,t){return CC(r,t)}function CC(r,t,e,n){var C;qt(Tc(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a,static:i}=W.useContext(ka),{matches:s}=W.useContext(di),l=s[s.length-1],c=l?l.params:{},f=l?l.pathname:"/",d=l?l.pathnameBase:"/",p=l&&l.route;{let A=p&&p.path||"";AC(f,!p||A.endsWith("*")||A.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${f}" (under <Route path="${A}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${A}"> to <Route path="${A==="/"?"*":`${A}/*`}">.`)}let g=ss(),v;if(t){let A=typeof t=="string"?Du(t):t;qt(d==="/"||((C=A.pathname)==null?void 0:C.startsWith(d)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${d}" but pathname "${A.pathname}" was given in the \`location\` prop.`),v=A}else v=g;let b=v.pathname||"/",w=b;if(d!=="/"){let A=d.replace(/^\//,"").split("/");w="/"+b.replace(/^\//,"").split("/").slice(A.length).join("/")}let S=!i&&e&&e.matches&&e.matches.length>0?e.matches:mC(r,{pathname:w});Ta(p||S!=null,`No routes matched location "${v.pathname}${v.search}${v.hash}" `),Ta(S==null||S[S.length-1].route.element!==void 0||S[S.length-1].route.Component!==void 0||S[S.length-1].route.lazy!==void 0,`Matched leaf route at location "${v.pathname}${v.search}${v.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let x=_3(S&&S.map(A=>Object.assign({},A,{params:Object.assign({},c,A.params),pathname:ri([d,a.encodeLocation?a.encodeLocation(A.pathname).pathname:A.pathname]),pathnameBase:A.pathnameBase==="/"?d:ri([d,a.encodeLocation?a.encodeLocation(A.pathnameBase).pathname:A.pathnameBase])})),s,e,n);return t&&x?W.createElement(Ac.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...v},navigationType:"POP"}},x):x}function I3(){let r=B3(),t=x3(r)?`${r.status} ${r.statusText}`:r instanceof Error?r.message:JSON.stringify(r),e=r instanceof Error?r.stack:null,n="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:n},i={padding:"2px 4px",backgroundColor:n},s=null;return console.error("Error handled by React Router default ErrorBoundary:",r),s=W.createElement(W.Fragment,null,W.createElement("p",null,"💿 Hey developer 👋"),W.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",W.createElement("code",{style:i},"ErrorBoundary")," or"," ",W.createElement("code",{style:i},"errorElement")," prop on your route.")),W.createElement(W.Fragment,null,W.createElement("h2",null,"Unexpected Application Error!"),W.createElement("h3",{style:{fontStyle:"italic"}},t),e?W.createElement("pre",{style:a},e):null,s)}var k3=W.createElement(I3,null),D3=class extends W.Component{constructor(r){super(r),this.state={location:r.location,revalidation:r.revalidation,error:r.error}}static getDerivedStateFromError(r){return{error:r}}static getDerivedStateFromProps(r,t){return t.location!==r.location||t.revalidation!=="idle"&&r.revalidation==="idle"?{error:r.error,location:r.location,revalidation:r.revalidation}:{error:r.error!==void 0?r.error:t.error,location:t.location,revalidation:r.revalidation||t.revalidation}}componentDidCatch(r,t){console.error("React Router caught the following error during render",r,t)}render(){return this.state.error!==void 0?W.createElement(di.Provider,{value:this.props.routeContext},W.createElement(Ey.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function O3({routeContext:r,match:t,children:e}){let n=W.useContext(Ou);return n&&n.static&&n.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=t.route.id),W.createElement(di.Provider,{value:r},e)}function _3(r,t=[],e=null,n=null){if(r==null){if(!e)return null;if(e.errors)r=e.matches;else if(t.length===0&&!e.initialized&&e.matches.length>0)r=e.matches;else return null}let a=r,i=e==null?void 0:e.errors;if(i!=null){let c=a.findIndex(f=>f.route.id&&(i==null?void 0:i[f.route.id])!==void 0);qt(c>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(i).join(",")}`),a=a.slice(0,Math.min(a.length,c+1))}let s=!1,l=-1;if(e)for(let c=0;c<a.length;c++){let f=a[c];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(l=c),f.route.id){let{loaderData:d,errors:p}=e,g=f.route.loader&&!d.hasOwnProperty(f.route.id)&&(!p||p[f.route.id]===void 0);if(f.route.lazy||g){s=!0,l>=0?a=a.slice(0,l+1):a=[a[0]];break}}}return a.reduceRight((c,f,d)=>{let p,g=!1,v=null,b=null;e&&(p=i&&f.route.id?i[f.route.id]:void 0,v=f.route.errorElement||k3,s&&(l<0&&d===0?(AC("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),g=!0,b=null):l===d&&(g=!0,b=f.route.hydrateFallbackElement||null)));let w=t.concat(a.slice(0,d+1)),S=()=>{let x;return p?x=v:g?x=b:f.route.Component?x=W.createElement(f.route.Component,null):f.route.element?x=f.route.element:x=c,W.createElement(O3,{match:f,routeContext:{outlet:c,matches:w,isDataRoute:e!=null},children:x})};return e&&(f.route.ErrorBoundary||f.route.errorElement||d===0)?W.createElement(D3,{location:e.location,revalidation:e.revalidation,component:v,error:p,children:S(),routeContext:{outlet:null,matches:w,isDataRoute:!0}}):S()},null)}function Cy(r){return`${r} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function M3(r){let t=W.useContext(Ou);return qt(t,Cy(r)),t}function z3(r){let t=W.useContext(yd);return qt(t,Cy(r)),t}function L3(r){let t=W.useContext(di);return qt(t,Cy(r)),t}function Ay(r){let t=L3(r),e=t.matches[t.matches.length-1];return qt(e.route.id,`${r} can only be used on routes that contain a unique "id"`),e.route.id}function F3(){return Ay("useRouteId")}function B3(){var n;let r=W.useContext(Ey),t=z3("useRouteError"),e=Ay("useRouteError");return r!==void 0?r:(n=t.errors)==null?void 0:n[e]}function U3(){let{router:r}=M3("useNavigate"),t=Ay("useNavigate"),e=W.useRef(!1);return EC(()=>{e.current=!0}),W.useCallback(async(a,i={})=>{Ta(e.current,SC),e.current&&(typeof a=="number"?r.navigate(a):await r.navigate(a,{fromRouteId:t,...i}))},[r,t])}var Y2={};function AC(r,t,e){!t&&!Y2[r]&&(Y2[r]=!0,Ta(!1,e))}W.memo(P3);function P3({routes:r,future:t,state:e}){return CC(r,void 0,e,t)}function Zl(r){qt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function V3({basename:r="/",children:t=null,location:e,navigationType:n="POP",navigator:a,static:i=!1}){qt(!Tc(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let s=r.replace(/^\/*/,"/"),l=W.useMemo(()=>({basename:s,navigator:a,static:i,future:{}}),[s,a,i]);typeof e=="string"&&(e=Du(e));let{pathname:c="/",search:f="",hash:d="",state:p=null,key:g="default"}=e,v=W.useMemo(()=>{let b=ui(c,s);return b==null?null:{location:{pathname:b,search:f,hash:d,state:p,key:g},navigationType:n}},[s,c,f,d,p,g,n]);return Ta(v!=null,`<Router basename="${s}"> is not able to match the URL "${c}${f}${d}" because it does not start with the basename, so the <Router> won't render anything.`),v==null?null:W.createElement(ka.Provider,{value:l},W.createElement(Ac.Provider,{children:t,value:v}))}function j3({children:r,location:t}){return R3(Cv(r),t)}function Cv(r,t=[]){let e=[];return W.Children.forEach(r,(n,a)=>{if(!W.isValidElement(n))return;let i=[...t,a];if(n.type===W.Fragment){e.push.apply(e,Cv(n.props.children,i));return}qt(n.type===Zl,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),qt(!n.props.index||!n.props.children,"An index route cannot have child routes.");let s={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(s.children=Cv(n.props.children,i)),e.push(s)}),e}var kh="get",Dh="application/x-www-form-urlencoded";function bd(r){return r!=null&&typeof r.tagName=="string"}function W3(r){return bd(r)&&r.tagName.toLowerCase()==="button"}function H3(r){return bd(r)&&r.tagName.toLowerCase()==="form"}function q3(r){return bd(r)&&r.tagName.toLowerCase()==="input"}function G3(r){return!!(r.metaKey||r.altKey||r.ctrlKey||r.shiftKey)}function X3(r,t){return r.button===0&&(!t||t==="_self")&&!G3(r)}var dh=null;function $3(){if(dh===null)try{new FormData(document.createElement("form"),0),dh=!1}catch{dh=!0}return dh}var K3=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Vg(r){return r!=null&&!K3.has(r)?(Ta(!1,`"${r}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Dh}"`),null):r}function Y3(r,t){let e,n,a,i,s;if(H3(r)){let l=r.getAttribute("action");n=l?ui(l,t):null,e=r.getAttribute("method")||kh,a=Vg(r.getAttribute("enctype"))||Dh,i=new FormData(r)}else if(W3(r)||q3(r)&&(r.type==="submit"||r.type==="image")){let l=r.form;if(l==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let c=r.getAttribute("formaction")||l.getAttribute("action");if(n=c?ui(c,t):null,e=r.getAttribute("formmethod")||l.getAttribute("method")||kh,a=Vg(r.getAttribute("formenctype"))||Vg(l.getAttribute("enctype"))||Dh,i=new FormData(l,r),!$3()){let{name:f,type:d,value:p}=r;if(d==="image"){let g=f?`${f}.`:"";i.append(`${g}x`,"0"),i.append(`${g}y`,"0")}else f&&i.append(f,p)}}else{if(bd(r))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');e=kh,n=null,a=Dh,s=r}return i&&a==="text/plain"&&(s=i,i=void 0),{action:n,method:e.toLowerCase(),encType:a,formData:i,body:s}}function Ty(r,t){if(r===!1||r===null||typeof r>"u")throw new Error(t)}async function Z3(r,t){if(r.id in t)return t[r.id];try{let e=await import(r.module);return t[r.id]=e,e}catch(e){return console.error(`Error loading route module \`${r.module}\`, reloading page...`),console.error(e),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Q3(r){return r==null?!1:r.href==null?r.rel==="preload"&&typeof r.imageSrcSet=="string"&&typeof r.imageSizes=="string":typeof r.rel=="string"&&typeof r.href=="string"}async function J3(r,t,e){let n=await Promise.all(r.map(async a=>{let i=t.routes[a.route.id];if(i){let s=await Z3(i,e);return s.links?s.links():[]}return[]}));return rz(n.flat(1).filter(Q3).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function Z2(r,t,e,n,a,i){let s=(c,f)=>e[f]?c.route.id!==e[f].route.id:!0,l=(c,f)=>{var d;return e[f].pathname!==c.pathname||((d=e[f].route.path)==null?void 0:d.endsWith("*"))&&e[f].params["*"]!==c.params["*"]};return i==="assets"?t.filter((c,f)=>s(c,f)||l(c,f)):i==="data"?t.filter((c,f)=>{var p;let d=n.routes[c.route.id];if(!d||!d.hasLoader)return!1;if(s(c,f)||l(c,f))return!0;if(c.route.shouldRevalidate){let g=c.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:((p=e[0])==null?void 0:p.params)||{},nextUrl:new URL(r,window.origin),nextParams:c.params,defaultShouldRevalidate:!0});if(typeof g=="boolean")return g}return!0}):[]}function ez(r,t,{includeHydrateFallback:e}={}){return tz(r.map(n=>{let a=t.routes[n.route.id];if(!a)return[];let i=[a.module];return a.clientActionModule&&(i=i.concat(a.clientActionModule)),a.clientLoaderModule&&(i=i.concat(a.clientLoaderModule)),e&&a.hydrateFallbackModule&&(i=i.concat(a.hydrateFallbackModule)),a.imports&&(i=i.concat(a.imports)),i}).flat(1))}function tz(r){return[...new Set(r)]}function nz(r){let t={},e=Object.keys(r).sort();for(let n of e)t[n]=r[n];return t}function rz(r,t){let e=new Set;return new Set(t),r.reduce((n,a)=>{let i=JSON.stringify(nz(a));return e.has(i)||(e.add(i),n.push({key:i,link:a})),n},[])}function az(r,t){let e=typeof r=="string"?new URL(r,typeof window>"u"?"server://singlefetch/":window.location.origin):r;return e.pathname==="/"?e.pathname="_root.data":t&&ui(e.pathname,t)==="/"?e.pathname=`${t.replace(/\/$/,"")}/_root.data`:e.pathname=`${e.pathname.replace(/\/$/,"")}.data`,e}function TC(){let r=W.useContext(Ou);return Ty(r,"You must render this element inside a <DataRouterContext.Provider> element"),r}function iz(){let r=W.useContext(yd);return Ty(r,"You must render this element inside a <DataRouterStateContext.Provider> element"),r}var Ny=W.createContext(void 0);Ny.displayName="FrameworkContext";function NC(){let r=W.useContext(Ny);return Ty(r,"You must render this element inside a <HydratedRouter> element"),r}function oz(r,t){let e=W.useContext(Ny),[n,a]=W.useState(!1),[i,s]=W.useState(!1),{onFocus:l,onBlur:c,onMouseEnter:f,onMouseLeave:d,onTouchStart:p}=t,g=W.useRef(null);W.useEffect(()=>{if(r==="render"&&s(!0),r==="viewport"){let w=x=>{x.forEach(C=>{s(C.isIntersecting)})},S=new IntersectionObserver(w,{threshold:.5});return g.current&&S.observe(g.current),()=>{S.disconnect()}}},[r]),W.useEffect(()=>{if(n){let w=setTimeout(()=>{s(!0)},100);return()=>{clearTimeout(w)}}},[n]);let v=()=>{a(!0)},b=()=>{a(!1),s(!1)};return e?r!=="intent"?[i,g,{}]:[i,g,{onFocus:Wl(l,v),onBlur:Wl(c,b),onMouseEnter:Wl(f,v),onMouseLeave:Wl(d,b),onTouchStart:Wl(p,v)}]:[!1,g,{}]}function Wl(r,t){return e=>{r&&r(e),e.defaultPrevented||t(e)}}function sz({page:r,...t}){let{router:e}=TC(),n=W.useMemo(()=>mC(e.routes,r,e.basename),[e.routes,r,e.basename]);return n?W.createElement(lz,{page:r,matches:n,...t}):null}function uz(r){let{manifest:t,routeModules:e}=NC(),[n,a]=W.useState([]);return W.useEffect(()=>{let i=!1;return J3(r,t,e).then(s=>{i||a(s)}),()=>{i=!0}},[r,t,e]),n}function lz({page:r,matches:t,...e}){let n=ss(),{manifest:a,routeModules:i}=NC(),{basename:s}=TC(),{loaderData:l,matches:c}=iz(),f=W.useMemo(()=>Z2(r,t,c,a,n,"data"),[r,t,c,a,n]),d=W.useMemo(()=>Z2(r,t,c,a,n,"assets"),[r,t,c,a,n]),p=W.useMemo(()=>{if(r===n.pathname+n.search+n.hash)return[];let b=new Set,w=!1;if(t.forEach(x=>{var A;let C=a.routes[x.route.id];!C||!C.hasLoader||(!f.some(T=>T.route.id===x.route.id)&&x.route.id in l&&((A=i[x.route.id])!=null&&A.shouldRevalidate)||C.hasClientLoader?w=!0:b.add(x.route.id))}),b.size===0)return[];let S=az(r,s);return w&&b.size>0&&S.searchParams.set("_routes",t.filter(x=>b.has(x.route.id)).map(x=>x.route.id).join(",")),[S.pathname+S.search]},[s,l,n,a,f,t,r,i]),g=W.useMemo(()=>ez(d,a),[d,a]),v=uz(d);return W.createElement(W.Fragment,null,p.map(b=>W.createElement("link",{key:b,rel:"prefetch",as:"fetch",href:b,...e})),g.map(b=>W.createElement("link",{key:b,rel:"modulepreload",href:b,...e})),v.map(({key:b,link:w})=>W.createElement("link",{key:b,...w})))}function cz(...r){return t=>{r.forEach(e=>{typeof e=="function"?e(t):e!=null&&(e.current=t)})}}var RC=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{RC&&(window.__reactRouterVersion="7.3.0")}catch{}function fz({basename:r,children:t,window:e}){let n=W.useRef();n.current==null&&(n.current=JM({window:e,v5Compat:!0}));let a=n.current,[i,s]=W.useState({action:a.action,location:a.location}),l=W.useCallback(c=>{W.startTransition(()=>s(c))},[s]);return W.useLayoutEffect(()=>a.listen(l),[a,l]),W.createElement(V3,{basename:r,children:t,location:i.location,navigationType:i.action,navigator:a})}var IC=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,kC=W.forwardRef(function({onClick:t,discover:e="render",prefetch:n="none",relative:a,reloadDocument:i,replace:s,state:l,target:c,to:f,preventScrollReset:d,viewTransition:p,...g},v){let{basename:b}=W.useContext(ka),w=typeof f=="string"&&IC.test(f),S,x=!1;if(typeof f=="string"&&w&&(S=f,RC))try{let I=new URL(window.location.href),_=f.startsWith("//")?new URL(I.protocol+f):new URL(f),F=ui(_.pathname,b);_.origin===I.origin&&F!=null?f=F+_.search+_.hash:x=!0}catch{Ta(!1,`<Link to="${f}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let C=A3(f,{relative:a}),[A,T,R]=oz(n,g),O=mz(f,{replace:s,state:l,target:c,preventScrollReset:d,relative:a,viewTransition:p});function N(I){t&&t(I),I.defaultPrevented||O(I)}let D=W.createElement("a",{...g,...R,href:S||C,onClick:x||i?t:N,ref:cz(v,T),target:c,"data-discover":!w&&e==="render"?"true":void 0});return A&&!w?W.createElement(W.Fragment,null,D,W.createElement(sz,{page:C})):D});kC.displayName="Link";var hz=W.forwardRef(function({"aria-current":t="page",caseSensitive:e=!1,className:n="",end:a=!1,style:i,to:s,viewTransition:l,children:c,...f},d){let p=Nc(s,{relative:f.relative}),g=ss(),v=W.useContext(yd),{navigator:b,basename:w}=W.useContext(ka),S=v!=null&&wz(p)&&l===!0,x=b.encodeLocation?b.encodeLocation(p).pathname:p.pathname,C=g.pathname,A=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;e||(C=C.toLowerCase(),A=A?A.toLowerCase():null,x=x.toLowerCase()),A&&w&&(A=ui(A,w)||A);const T=x!=="/"&&x.endsWith("/")?x.length-1:x.length;let R=C===x||!a&&C.startsWith(x)&&C.charAt(T)==="/",O=A!=null&&(A===x||!a&&A.startsWith(x)&&A.charAt(x.length)==="/"),N={isActive:R,isPending:O,isTransitioning:S},D=R?t:void 0,I;typeof n=="function"?I=n(N):I=[n,R?"active":null,O?"pending":null,S?"transitioning":null].filter(Boolean).join(" ");let _=typeof i=="function"?i(N):i;return W.createElement(kC,{...f,"aria-current":D,className:I,ref:d,style:_,to:s,viewTransition:l},typeof c=="function"?c(N):c)});hz.displayName="NavLink";var dz=W.forwardRef(({discover:r="render",fetcherKey:t,navigate:e,reloadDocument:n,replace:a,state:i,method:s=kh,action:l,onSubmit:c,relative:f,preventScrollReset:d,viewTransition:p,...g},v)=>{let b=yz(),w=bz(l,{relative:f}),S=s.toLowerCase()==="get"?"get":"post",x=typeof l=="string"&&IC.test(l),C=A=>{if(c&&c(A),A.defaultPrevented)return;A.preventDefault();let T=A.nativeEvent.submitter,R=(T==null?void 0:T.getAttribute("formmethod"))||s;b(T||A.currentTarget,{fetcherKey:t,method:R,navigate:e,replace:a,state:i,relative:f,preventScrollReset:d,viewTransition:p})};return W.createElement("form",{ref:v,method:S,action:w,onSubmit:n?c:C,...g,"data-discover":!x&&r==="render"?"true":void 0})});dz.displayName="Form";function pz(r){return`${r} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function DC(r){let t=W.useContext(Ou);return qt(t,pz(r)),t}function mz(r,{target:t,replace:e,state:n,preventScrollReset:a,relative:i,viewTransition:s}={}){let l=T3(),c=ss(),f=Nc(r,{relative:i});return W.useCallback(d=>{if(X3(d,t)){d.preventDefault();let p=e!==void 0?e:sc(c)===sc(f);l(r,{replace:p,state:n,preventScrollReset:a,relative:i,viewTransition:s})}},[c,l,f,e,n,t,r,a,i,s])}var gz=0,vz=()=>`__${String(++gz)}__`;function yz(){let{router:r}=DC("useSubmit"),{basename:t}=W.useContext(ka),e=F3();return W.useCallback(async(n,a={})=>{let{action:i,method:s,encType:l,formData:c,body:f}=Y3(n,t);if(a.navigate===!1){let d=a.fetcherKey||vz();await r.fetch(d,e,a.action||i,{preventScrollReset:a.preventScrollReset,formData:c,body:f,formMethod:a.method||s,formEncType:a.encType||l,flushSync:a.flushSync})}else await r.navigate(a.action||i,{preventScrollReset:a.preventScrollReset,formData:c,body:f,formMethod:a.method||s,formEncType:a.encType||l,replace:a.replace,state:a.state,fromRouteId:e,flushSync:a.flushSync,viewTransition:a.viewTransition})},[r,t,e])}function bz(r,{relative:t}={}){let{basename:e}=W.useContext(ka),n=W.useContext(di);qt(n,"useFormAction must be used inside a RouteContext");let[a]=n.matches.slice(-1),i={...Nc(r||".",{relative:t})},s=ss();if(r==null){i.search=s.search;let l=new URLSearchParams(i.search),c=l.getAll("index");if(c.some(d=>d==="")){l.delete("index"),c.filter(p=>p).forEach(p=>l.append("index",p));let d=l.toString();i.search=d?`?${d}`:""}}return(!r||r===".")&&a.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),e!=="/"&&(i.pathname=i.pathname==="/"?e:ri([e,i.pathname])),sc(i)}function wz(r,t={}){let e=W.useContext(xC);qt(e!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=DC("useViewTransitionState"),a=Nc(r,{relative:t.relative});if(!e.isTransitioning)return!1;let i=ui(e.currentLocation.pathname,n)||e.currentLocation.pathname,s=ui(e.nextLocation.pathname,n)||e.nextLocation.pathname;return Yh(a.pathname,s)!=null||Yh(a.pathname,i)!=null}new TextEncoder;const OC=({videoRef:r})=>(W.useEffect(()=>((async()=>{try{const e=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});r.current&&(r.current.srcObject=e)}catch(e){console.error("Error accessing camera:",e)}})(),()=>{var e;(e=r.current)!=null&&e.srcObject&&r.current.srcObject.getTracks().forEach(a=>a.stop())}),[]),ve.jsx("video",{ref:r,autoPlay:!0,playsInline:!0,style:{width:"100%",height:"100%",objectFit:"contain"}}));var jg={},_o={};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var _C=function(r,t){return(_C=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var a in n)n.hasOwnProperty(a)&&(e[a]=n[a])})(r,t)};function la(r,t){function e(){this.constructor=r}_C(r,t),r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}function De(r,t,e,n){return new(e||(e=Promise))(function(a,i){function s(f){try{c(n.next(f))}catch(d){i(d)}}function l(f){try{c(n.throw(f))}catch(d){i(d)}}function c(f){f.done?a(f.value):new e(function(d){d(f.value)}).then(s,l)}c((n=n.apply(r,[])).next())})}function Oe(r,t){var e,n,a,i,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function l(c){return function(f){return function(d){if(e)throw new TypeError("Generator is already executing.");for(;s;)try{if(e=1,n&&(a=2&d[0]?n.return:d[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,d[1])).done)return a;switch(n=0,a&&(d=[2&d[0],a.value]),d[0]){case 0:case 1:a=d;break;case 4:return s.label++,{value:d[1],done:!1};case 5:s.label++,n=d[1],d=[0];continue;case 7:d=s.ops.pop(),s.trys.pop();continue;default:if(!(a=(a=s.trys).length>0&&a[a.length-1])&&(d[0]===6||d[0]===2)){s=0;continue}if(d[0]===3&&(!a||d[1]>a[0]&&d[1]<a[3])){s.label=d[1];break}if(d[0]===6&&s.label<a[1]){s.label=a[1],a=d;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(d);break}a[2]&&s.ops.pop(),s.trys.pop();continue}d=t.call(r,s)}catch(p){d=[6,p],n=0}finally{e=a=0}if(5&d[0])throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}([c,f])}}}var MC=function(){function r(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return r.prototype.setPlatform=function(t,e){this.platform!=null&&console.warn("Platform "+this.platformName+" has already been set. Overwriting the platform with "+e+"."),this.platformName=t,this.platform=e},r.prototype.registerFlag=function(t,e,n){if(this.flagRegistry[t]={evaluationFn:e,setHook:n},this.urlFlags[t]!=null){var a=this.urlFlags[t];console.warn("Setting feature override from URL "+t+": "+a+"."),this.set(t,a)}},r.prototype.get=function(t){return t in this.flags?this.flags[t]:(this.flags[t]=this.evaluateFlag(t),this.flags[t])},r.prototype.getNumber=function(t){return this.get(t)},r.prototype.getBool=function(t){return this.get(t)},r.prototype.getFlags=function(){return this.flags},Object.defineProperty(r.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),r.prototype.set=function(t,e){if(this.flagRegistry[t]==null)throw new Error("Cannot set flag "+t+" as it has not been registered.");this.flags[t]=e,this.flagRegistry[t].setHook!=null&&this.flagRegistry[t].setHook(e)},r.prototype.evaluateFlag=function(t){if(this.flagRegistry[t]==null)throw new Error("Cannot evaluate flag '"+t+"': no evaluation function found.");return this.flagRegistry[t].evaluationFn()},r.prototype.setFlags=function(t){this.flags=Object.assign({},t)},r.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},r.prototype.populateURLFlags=function(){var t=this;if(this.global!==void 0&&this.global.location!==void 0&&this.global.location.search!==void 0){var e,n,a=(e=this.global.location.search,n={},e.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,function(i){for(var s=[],l=1;l<arguments.length;l++)s[l-1]=arguments[l];return function(c,f,d){c[decodeURIComponent(f)]=decodeURIComponent(d||"")}(n,s[0],s[1]),s.join("=")}),n);"tfjsflags"in a&&a.tfjsflags.split(",").forEach(function(i){var s=i.split(":"),l=s[0],c=s[1];t.urlFlags[l]=function(f,d){if((d=d.toLowerCase())==="true"||d==="false")return d==="true";if(""+ +d===d)return+d;throw new Error("Could not parse value flag value "+d+" for flag "+f+".")}(l,c)})}},r}();function se(){return Ry}var Ry=null,vu=new Map;function zC(r,t){var e=Iy(r,t);return vu.get(e)}function Av(r){for(var t=vu.entries(),e=[];;){var n=t.next(),a=n.done,i=n.value;if(a)break;var s=i[0],l=i[1];s.split("_")[0]===r&&e.push(l)}return e}function Tv(r){var t=r.kernelName,e=r.backendName,n=Iy(t,e);if(vu.has(n))throw new Error("The kernel '"+t+"' for backend '"+e+"' is already registered");vu.set(n,r)}function xz(r,t){var e=Iy(r,t);if(!vu.has(e))throw new Error("The kernel '"+r+"' for backend '"+t+"' is not registered");vu.delete(e)}function Iy(r,t){return t+"_"+r}function Q2(r){for(var t=r.length,e=0,n=0;t>0;)n=Math.random()*t|0,e=r[--t],r[t]=r[n],r[n]=e}function Zh(r,t,e){return Math.max(r,Math.min(t,e))}function ky(r){return r%2==0?r:r+1}function LC(r){for(var t=0,e=0;e<r.length;e++)t+=r[e];return t}function P(r,t){if(!r)throw new Error(typeof t=="string"?t:t())}function mt(r,t,e){e===void 0&&(e=""),P(kn(r,t),function(){return e+" Shapes "+r+" and "+t+" must match"})}function us(r){P(r!=null,function(){return"The input to the tensor constructor must be a non-null value."})}function li(r,t,e){if(t===void 0&&(t=[]),e===void 0&&(e=!1),t==null&&(t=[]),Array.isArray(r)||Fn(r)&&!e)for(var n=0;n<r.length;++n)li(r[n],t,e);else t.push(r);return t}function Me(r){if(r.length===0)return 1;for(var t=r[0],e=1;e<r.length;e++)t*=r[e];return t}function kn(r,t){if(r===t)return!0;if(r==null||t==null||r.length!==t.length)return!1;for(var e=0;e<r.length;e++)if(r[e]!==t[e])return!1;return!0}function Qt(r){return r%1==0}function FC(r){if(Math.tanh!=null)return Math.tanh(r);if(r===1/0)return 1;if(r===-1/0)return-1;var t=Math.exp(2*r);return(t-1)/(t+1)}function Qh(r){var t=Math.ceil(Math.sqrt(r));return[t,Math.ceil(r/t)]}function Xo(r,t){return t<=r.length?r:r+" ".repeat(t-r.length)}function Nv(r,t,e){return t===void 0&&(t=function(n){return 0}),new Promise(function(n,a){var i=0,s=function(){if(r())n();else{var l=t(++i);e!=null&&i>=e?a():setTimeout(s,l)}};s()})}function BC(r,t){for(var e=1,n=-1,a=0;a<r.length;++a)if(r[a]>=0)e*=r[a];else if(r[a]===-1){if(n!==-1)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+n+" and dim "+a);n=a}else if(r[a]<0)throw Error("Shapes can not be < 0. Found "+r[a]+" at dim "+a);if(n===-1){if(t>0&&t!==e)throw Error("Size("+t+") must match the product of shape "+r);return r}if(e===0)throw Error("Cannot infer the missing size in ["+r+"] when there are 0 elements");if(t%e!=0)throw Error("The implicit shape can't be a fractional number. Got "+t+" / "+e);var i=r.slice();return i[n]=t/e,i}function On(r,t){var e=t.length;return P((r=r==null?t.map(function(n,a){return a}):[].concat(r)).every(function(n){return n>=-e&&n<e}),function(){return"All values in axis param must be in range [-"+e+", "+e+") but got axis "+r}),P(r.every(function(n){return Qt(n)}),function(){return"All values in axis param must be integers but got axis "+r}),r.map(function(n){return n<0?e+n:n})}function qi(r,t){for(var e=[],n=[],a=t!=null&&Array.isArray(t)&&t.length===0,i=t==null||a?null:On(t,r).sort(),s=0,l=0;l<r.length;++l){if(i!=null){if(i[s]===l&&r[l]!==1)throw new Error("Can't squeeze axis "+l+" since its dim '"+r[l]+"' is not 1");(i[s]==null||i[s]>l)&&r[l]===1&&(e.push(r[l]),n.push(l)),i[s]<=l&&s++}r[l]!==1&&(e.push(r[l]),n.push(l))}return{newShape:e,keptDims:n}}function uc(r,t){var e=null;if(r==null||r==="float32")e=new Float32Array(t);else if(r==="int32")e=new Int32Array(t);else{if(r!=="bool")throw new Error("Unknown data type "+r);e=new Uint8Array(t)}return e}function lc(r,t){var e=null;if(r==null||r==="float32")e=new Float32Array(t);else if(r==="int32")e=new Int32Array(t);else if(r==="bool")e=new Uint8Array(t);else{if(r!=="string")throw new Error("Unknown data type "+r);e=new Array(t)}return e}function UC(r,t){for(var e=0;e<r.length;e++){var n=r[e];if(isNaN(n)||!isFinite(n))throw Error("A tensor of type "+t+" being uploaded contains "+n+".")}}function PC(r){return r==="bool"||r==="complex64"||r==="float32"||r==="int32"||r==="string"}function VC(r,t){return t!=="complex64"&&(t!=="float32"||r==="complex64")&&(t!=="int32"||r==="float32"||r==="complex64")&&(t!=="bool"||r!=="bool")}function Fn(r){return r instanceof Float32Array||r instanceof Int32Array||r instanceof Uint8Array}function Dy(r){if(r==="float32"||r==="int32")return 4;if(r==="complex64")return 8;if(r==="bool")return 1;throw new Error("Unknown dtype "+r)}function jC(r){if(r==null)return 0;var t=0;return r.forEach(function(e){return t+=e.length}),t}function Gi(r){return typeof r=="string"||r instanceof String}function WC(r){return typeof r=="boolean"}function HC(r){return typeof r=="number"}function _u(r){return Array.isArray(r)?_u(r[0]):r instanceof Float32Array?"float32":r instanceof Int32Array||r instanceof Uint8Array?"int32":HC(r)?"float32":Gi(r)?"string":WC(r)?"bool":"float32"}function eo(r){return!!(r&&r.constructor&&r.call&&r.apply)}function Jh(r,t){for(var e=t;e<r;++e)if(r%e==0)return e;return r}function io(r){var t=r.length;if(t<2)return[];var e=new Array(t-1);e[t-2]=r[t-1];for(var n=t-3;n>=0;--n)e[n]=e[n+1]*r[n+1];return e}function Oy(r,t,e){if(t==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(r)&&(r=li(r)),e&&UC(r,t),function(i,s){return i instanceof Float32Array&&s==="float32"||i instanceof Int32Array&&s==="int32"||i instanceof Uint8Array&&s==="bool"}(r,t))return r;if(t==null||t==="float32"||t==="complex64")return new Float32Array(r);if(t==="int32")return new Int32Array(r);if(t==="bool"){for(var n=new Uint8Array(r.length),a=0;a<n.length;++a)Math.round(r[a])!==0&&(n[a]=1);return n}throw new Error("Unknown data type "+t)}function Rv(r,t){if(r.length===0)return t[0];var e=r.reduce(function(n,a){return n*a});if(e===0)return[];if(e!==t.length)throw new Error("["+r+"] does not match the input size.");return function n(a,i,s){var l=new Array;if(i.length===1)for(var c=i[0],f=0;f<c;f++)l[f]=s[a+f];else{c=i[0];var d=i.slice(1),p=d.reduce(function(g,v){return g*v});for(f=0;f<c;f++)l[f]=n(a+f*p,d,s)}return l}(0,r,t)}function _y(r,t){for(var e=Mu(r,t),n=0;n<e.length;n++)e[n]=1;return e}function Mu(r,t){if(t==null||t==="float32"||t==="complex64")return new Float32Array(r);if(t==="int32")return new Int32Array(r);if(t==="bool")return new Uint8Array(r);throw new Error("Unknown data type "+t)}function ta(){return se().platform.now()}function My(r){r.forEach(function(t){P(Number.isInteger(t)&&t>=0,function(){return"Tensor must have a shape comprised of positive integers but got shape ["+r+"]."})})}function qC(r,t){return t===void 0&&(t="utf-8"),t=t||"utf-8",se().platform.encode(r,t)}function cc(r,t){return t===void 0&&(t="utf-8"),t=t||"utf-8",se().platform.decode(r,t)}var Be=Object.freeze({shuffle:Q2,clamp:Zh,nearestLargerEven:ky,sum:LC,randUniform:function(r,t){var e=Math.random();return t*e+(1-e)*r},distSquared:function(r,t){for(var e=0,n=0;n<r.length;n++){var a=Number(r[n])-Number(t[n]);e+=a*a}return e},assert:P,assertShapesMatch:mt,assertNonNull:us,flatten:li,sizeFromShape:Me,isScalarShape:function(r){return r.length===0},arraysEqual:kn,isInt:Qt,tanh:FC,sizeToSquarishShape:Qh,createShuffledIndices:function(r){for(var t=new Uint32Array(r),e=0;e<r;++e)t[e]=e;return Q2(t),t},rightPad:Xo,repeatedTry:Nv,inferFromImplicitShape:BC,parseAxisParam:On,squeezeShape:qi,getTypedArrayFromDType:uc,getArrayFromDType:lc,checkConversionForErrors:UC,isValidDtype:PC,hasEncodingLoss:VC,isTypedArray:Fn,bytesPerElement:Dy,bytesFromStringArray:jC,isString:Gi,isBoolean:WC,isNumber:HC,inferDtype:_u,isFunction:eo,nearestDivisor:Jh,computeStrides:io,toTypedArray:Oy,toNestedArray:Rv,makeOnesTypedArray:_y,makeZerosTypedArray:Mu,now:ta,assertNonNegativeIntegerDimensions:My,fetch:function(r,t){return se().platform.fetch(r,t)},encodeString:qC,decodeString:cc}),Sz=function(){function r(t,e){this.backendTimer=t,this.logger=e,e==null&&(this.logger=new Ez)}return r.prototype.profileKernel=function(t,e,n){var a,i=this,s=this.backendTimer.time(function(){a=n()});return a.forEach(function(l){l.data().then(function(c){(function(f,d,p){if(d!=="float32")return!1;for(var g=0;g<f.length;g++){var v=f[g];if(isNaN(v)||!isFinite(v))return console.warn("Found "+v+" in the result of '"+p+"'"),!0}})(c,l.dtype,t),s.then(function(f){var d="";f.getExtraProfileInfo!=null&&(d=f.getExtraProfileInfo()),i.logger.logKernelProfile(t,l,c,f.kernelMs,e,d)})})}),a},r}(),Ez=function(){function r(){}return r.prototype.logKernelProfile=function(t,e,n,a,i,s){var l=Xo(a+"ms",9),c=Xo(t,25),f=e.rank,d=e.size,p=Xo(e.shape.toString(),14),g="";for(var v in i){var b=i[v].shape,w=b.length;g+=v+": "+w+"D "+(w>0?b:"")+" "}console.log("%c"+c+"	%c"+l+"	%c"+f+"D "+p+"	%c"+d+"	%c"+g+"	%c"+s,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},r}(),J2=20,Hl=3,Wg=7;function Cz(r,t,e,n){var a=io(t),i=function(f,d,p,g){var v=Me(d),b=g[g.length-1],w=new Array(b).fill(0),S=d.length,x=p==="complex64"?Gl(f):f;if(S>1)for(var C=0;C<v/b;C++)for(var A=C*b,T=0;T<b;T++)w[T]=Math.max(w[T],ql(x[A+T],0,p).length);return w}(r,t,e,a),s=t.length,l=function f(d,p,g,v,b,w){w===void 0&&(w=!0);var S=g==="complex64"?2:1,x=p[0],C=p.length;if(C===0){if(g==="complex64"){var A=Gl(d);return[ql(A[0],0,g)]}return g==="bool"?[GC(d[0])]:[d[0].toString()]}if(C===1){if(x>J2){var T=Hl*S,R=Array.from(d.slice(0,T)),O=Array.from(d.slice(x-Hl*S,x));return g==="complex64"&&(R=Gl(R),O=Gl(O)),["["+R.map(function(G,q){return ql(G,b[q],g)}).join(", ")+", ..., "+O.map(function(G,q){return ql(G,b[x-Hl+q],g)}).join(", ")+"]"]}var N=g==="complex64"?Gl(d):Array.from(d);return["["+N.map(function(G,q){return ql(G,b[q],g)}).join(", ")+"]"]}var D=p.slice(1),I=v.slice(1),_=v[0]*S,F=[];if(x>J2){for(var B=0;B<Hl;B++){var V=B*_,X=V+_;F.push.apply(F,f(d.slice(V,X),D,g,I,b,!1))}F.push("...");for(var B=x-Hl;B<x;B++){var V=B*_,X=V+_;F.push.apply(F,f(d.slice(V,X),D,g,I,b,B===x-1))}}else for(var B=0;B<x;B++){var V=B*_,X=V+_;F.push.apply(F,f(d.slice(V,X),D,g,I,b,B===x-1))}var Y=C===2?",":"";F[0]="["+F[0]+Y;for(var B=1;B<F.length-1;B++)F[B]=" "+F[B]+Y;for(var j=`,
`,B=2;B<C;B++)j+=`
`;return F[F.length-1]=" "+F[F.length-1]+"]"+(w?"":j),F}(r,t,e,a,i),c=["Tensor"];return n&&(c.push("  dtype: "+e),c.push("  rank: "+s),c.push("  shape: ["+t+"]"),c.push("  values:")),c.push(l.map(function(f){return"    "+f}).join(`
`)),c.join(`
`)}function ql(r,t,e){return Xo(Array.isArray(r)?parseFloat(r[0].toFixed(Wg))+" + "+parseFloat(r[1].toFixed(Wg))+"j":Gi(r)?"'"+r+"'":e==="bool"?GC(r):parseFloat(r.toFixed(Wg)).toString(),t)}function GC(r){return r===0?"false":"true"}function Gl(r){for(var t=[],e=0;e<r.length;e+=2)t.push([r[e],r[e+1]]);return t}var yu=function(){function r(t,e,n){var a=this;if(this.dtype=e,this.shape=t.slice(),this.size=Me(t),n!=null){var i=n.length;P(i===this.size,function(){return"Length of values '"+i+"' does not match the size inferred by the shape '"+a.size+"'."})}if(e==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||lc(e,this.size),this.strides=io(t)}return r.prototype.set=function(t){for(var e=this,n=[],a=1;a<arguments.length;a++)n[a-1]=arguments[a];n.length===0&&(n=[0]),P(n.length===this.rank,function(){return"The number of provided coordinates ("+n.length+") must match the rank ("+e.rank+")"});var i=this.locToIndex(n);this.values[i]=t},r.prototype.get=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];t.length===0&&(t=[0]);for(var n=0,a=0,i=t;a<i.length;a++){var s=i[a];if(s<0||s>=this.shape[n]){var l="Requested out of range element at "+t+".   Buffer shape="+this.shape;throw new Error(l)}n++}for(var c=t[t.length-1],f=0;f<t.length-1;++f)c+=this.strides[f]*t[f];return this.values[c]},r.prototype.locToIndex=function(t){if(this.rank===0)return 0;if(this.rank===1)return t[0];for(var e=t[t.length-1],n=0;n<t.length-1;++n)e+=this.strides[n]*t[n];return e},r.prototype.indexToLoc=function(t){if(this.rank===0)return[];if(this.rank===1)return[t];for(var e=new Array(this.shape.length),n=0;n<e.length-1;++n)e[n]=Math.floor(t/this.strides[n]),t-=e[n]*this.strides[n];return e[e.length-1]=t,e},Object.defineProperty(r.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),r.prototype.toTensor=function(){return Ea().makeTensor(this.values,this.shape,this.dtype)},r}(),Ea=null,ue=null,XC=null,Ct=function(){function r(t,e,n,a){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=e||"float32",this.size=Me(t),this.strides=io(t),this.dataId=n,this.id=a,this.rankType=this.rank<5?this.rank.toString():"higher"}return r.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},r.prototype.asScalar=function(){return this.throwIfDisposed(),P(this.size===1,function(){return"The array must have only 1 element."}),this.reshape([])},r.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},r.prototype.as2D=function(t,e){return this.throwIfDisposed(),this.reshape([t,e])},r.prototype.as3D=function(t,e,n){return this.throwIfDisposed(),this.reshape([t,e,n])},r.prototype.as4D=function(t,e,n,a){return this.throwIfDisposed(),this.reshape([t,e,n,a])},r.prototype.as5D=function(t,e,n,a,i){return this.throwIfDisposed(),this.reshape([t,e,n,a,i])},r.prototype.asType=function(t){return this.throwIfDisposed(),ue.cast(this,t)},Object.defineProperty(r.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),r.prototype.buffer=function(){return De(this,void 0,void 0,function(){var t;return Oe(this,function(e){switch(e.label){case 0:return[4,this.data()];case 1:return t=e.sent(),[2,ue.buffer(this.shape,this.dtype,t)]}})})},r.prototype.bufferSync=function(){return ue.buffer(this.shape,this.dtype,this.dataSync())},r.prototype.array=function(){return De(this,void 0,void 0,function(){var t;return Oe(this,function(e){switch(e.label){case 0:return[4,this.data()];case 1:return t=e.sent(),[2,Rv(this.shape,t)]}})})},r.prototype.arraySync=function(){return Rv(this.shape,this.dataSync())},r.prototype.data=function(){return De(this,void 0,void 0,function(){var t,e;return Oe(this,function(n){switch(n.label){case 0:return this.throwIfDisposed(),t=Ea().read(this.dataId),this.dtype!=="string"?[3,2]:[4,t];case 1:e=n.sent();try{return[2,e.map(function(a){return cc(a)})]}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}n.label=2;case 2:return[2,t]}})})},r.prototype.dataSync=function(){this.throwIfDisposed();var t=Ea().readSync(this.dataId);if(this.dtype==="string")try{return t.map(function(e){return cc(e)})}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t},r.prototype.bytes=function(){return De(this,void 0,void 0,function(){var t;return Oe(this,function(e){switch(e.label){case 0:return this.throwIfDisposed(),[4,Ea().read(this.dataId)];case 1:return t=e.sent(),this.dtype==="string"?[2,t]:[2,new Uint8Array(t.buffer)]}})})},r.prototype.dispose=function(){this.isDisposed||(Ea().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(r.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),r.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},r.prototype.toFloat=function(){return this.asType("float32")},r.prototype.toInt=function(){return this.asType("int32")},r.prototype.toBool=function(){return this.asType("bool")},r.prototype.print=function(t){return t===void 0&&(t=!1),ue.print(this,t)},r.prototype.reshape=function(t){return this.throwIfDisposed(),ue.reshape(this,t)},r.prototype.reshapeAs=function(t){return this.throwIfDisposed(),this.reshape(t.shape)},r.prototype.expandDims=function(t){return t===void 0&&(t=0),ue.expandDims(this,t)},r.prototype.cumsum=function(t,e,n){return t===void 0&&(t=0),e===void 0&&(e=!1),n===void 0&&(n=!1),ue.cumsum(this,t,e,n)},r.prototype.squeeze=function(t){return this.throwIfDisposed(),ue.squeeze(this,t)},r.prototype.clone=function(){return this.throwIfDisposed(),ue.clone(this)},r.prototype.oneHot=function(t,e,n){return this.throwIfDisposed(),ue.oneHot(this,t,e,n)},r.prototype.toString=function(t){return t===void 0&&(t=!1),Cz(this.dataSync(),this.shape,this.dtype,t)},r.prototype.tile=function(t){return this.throwIfDisposed(),ue.tile(this,t)},r.prototype.gather=function(t,e){return e===void 0&&(e=0),this.throwIfDisposed(),ue.gather(this,t,e)},r.prototype.matMul=function(t,e,n){return e===void 0&&(e=!1),n===void 0&&(n=!1),this.throwIfDisposed(),ue.matMul(this,t,e,n)},r.prototype.dot=function(t){return this.throwIfDisposed(),ue.dot(this,t)},r.prototype.norm=function(t,e,n){return t===void 0&&(t="euclidean"),e===void 0&&(e=null),n===void 0&&(n=!1),this.throwIfDisposed(),ue.norm(this,t,e,n)},r.prototype.slice=function(t,e){return this.throwIfDisposed(),ue.slice(this,t,e)},r.prototype.reverse=function(t){return this.throwIfDisposed(),ue.reverse(this,t)},r.prototype.concat=function(t,e){return e===void 0&&(e=0),this.throwIfDisposed(),t instanceof r&&(t=[t]),ue.concat([this].concat(t),e)},r.prototype.split=function(t,e){return e===void 0&&(e=0),this.throwIfDisposed(),ue.split(this,t,e)},r.prototype.stack=function(t,e){return e===void 0&&(e=0),ue.stack([this,t],e)},r.prototype.unstack=function(t){return t===void 0&&(t=0),ue.unstack(this,t)},r.prototype.pad=function(t,e){return e===void 0&&(e=0),ue.pad(this,t,e)},r.prototype.batchNormalization=function(t,e,n,a,i){return n===void 0&&(n=.001),XC("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(t,e,i,a,n)},r.prototype.batchNorm=function(t,e,n,a,i){return i===void 0&&(i=.001),this.throwIfDisposed(),ue.batchNorm(this,t,e,n,a,i)},r.prototype.all=function(t,e){return t===void 0&&(t=null),e===void 0&&(e=!1),this.throwIfDisposed(),ue.all(this,t,e)},r.prototype.any=function(t,e){return t===void 0&&(t=null),e===void 0&&(e=!1),this.throwIfDisposed(),ue.any(this,t,e)},r.prototype.logSumExp=function(t,e){return t===void 0&&(t=null),e===void 0&&(e=!1),this.throwIfDisposed(),ue.logSumExp(this,t,e)},r.prototype.sum=function(t,e){return t===void 0&&(t=null),e===void 0&&(e=!1),this.throwIfDisposed(),ue.sum(this,t,e)},r.prototype.prod=function(t,e){return t===void 0&&(t=null),e===void 0&&(e=!1),this.throwIfDisposed(),ue.prod(this,t,e)},r.prototype.mean=function(t,e){return t===void 0&&(t=null),e===void 0&&(e=!1),this.throwIfDisposed(),ue.mean(this,t,e)},r.prototype.min=function(t,e){return t===void 0&&(t=null),e===void 0&&(e=!1),this.throwIfDisposed(),ue.min(this,t,e)},r.prototype.max=function(t,e){return t===void 0&&(t=null),e===void 0&&(e=!1),this.throwIfDisposed(),ue.max(this,t,e)},r.prototype.argMin=function(t){return t===void 0&&(t=null),this.throwIfDisposed(),ue.argMin(this,t)},r.prototype.argMax=function(t){return t===void 0&&(t=null),this.throwIfDisposed(),ue.argMax(this,t)},r.prototype.cast=function(t){return this.throwIfDisposed(),ue.cast(this,t)},r.prototype.add=function(t){return this.throwIfDisposed(),ue.add(this,t)},r.prototype.addStrict=function(t){return this.throwIfDisposed(),ue.addStrict(this,t)},r.prototype.atan2=function(t){return this.throwIfDisposed(),ue.atan2(this,t)},r.prototype.sub=function(t){return this.throwIfDisposed(),ue.sub(this,t)},r.prototype.subStrict=function(t){return this.throwIfDisposed(),ue.subStrict(this,t)},r.prototype.pow=function(t){return this.throwIfDisposed(),ue.pow(this,t)},r.prototype.powStrict=function(t){return this.throwIfDisposed(),ue.powStrict(this,t)},r.prototype.mul=function(t){return this.throwIfDisposed(),ue.mul(this,t)},r.prototype.mulStrict=function(t){return this.throwIfDisposed(),ue.mulStrict(this,t)},r.prototype.div=function(t){return this.throwIfDisposed(),ue.div(this,t)},r.prototype.floorDiv=function(t){return this.throwIfDisposed(),ue.floorDiv(this,t)},r.prototype.divStrict=function(t){return this.throwIfDisposed(),ue.divStrict(this,t)},r.prototype.minimum=function(t){return this.throwIfDisposed(),ue.minimum(this,t)},r.prototype.minimumStrict=function(t){return this.throwIfDisposed(),ue.minimumStrict(this,t)},r.prototype.maximum=function(t){return this.throwIfDisposed(),ue.maximum(this,t)},r.prototype.maximumStrict=function(t){return this.throwIfDisposed(),ue.maximumStrict(this,t)},r.prototype.mod=function(t){return this.throwIfDisposed(),ue.mod(this,t)},r.prototype.modStrict=function(t){return this.throwIfDisposed(),ue.modStrict(this,t)},r.prototype.squaredDifference=function(t){return this.throwIfDisposed(),ue.squaredDifference(this,t)},r.prototype.squaredDifferenceStrict=function(t){return this.throwIfDisposed(),ue.squaredDifferenceStrict(this,t)},r.prototype.transpose=function(t){return this.throwIfDisposed(),ue.transpose(this,t)},r.prototype.notEqual=function(t){return this.throwIfDisposed(),ue.notEqual(this,t)},r.prototype.notEqualStrict=function(t){return this.throwIfDisposed(),ue.notEqualStrict(this,t)},r.prototype.less=function(t){return this.throwIfDisposed(),ue.less(this,t)},r.prototype.lessStrict=function(t){return this.throwIfDisposed(),ue.lessStrict(this,t)},r.prototype.equal=function(t){return this.throwIfDisposed(),ue.equal(this,t)},r.prototype.equalStrict=function(t){return this.throwIfDisposed(),ue.equalStrict(this,t)},r.prototype.lessEqual=function(t){return this.throwIfDisposed(),ue.lessEqual(this,t)},r.prototype.lessEqualStrict=function(t){return this.throwIfDisposed(),ue.lessEqualStrict(this,t)},r.prototype.greater=function(t){return this.throwIfDisposed(),ue.greater(this,t)},r.prototype.greaterStrict=function(t){return this.throwIfDisposed(),ue.greaterStrict(this,t)},r.prototype.greaterEqual=function(t){return this.throwIfDisposed(),ue.greaterEqual(this,t)},r.prototype.greaterEqualStrict=function(t){return this.throwIfDisposed(),ue.greaterEqualStrict(this,t)},r.prototype.logicalAnd=function(t){return this.throwIfDisposed(),ue.logicalAnd(this,t)},r.prototype.logicalOr=function(t){return this.throwIfDisposed(),ue.logicalOr(this,t)},r.prototype.logicalNot=function(){return this.throwIfDisposed(),ue.logicalNot(this)},r.prototype.logicalXor=function(t){return this.throwIfDisposed(),ue.logicalXor(this,t)},r.prototype.where=function(t,e){return this.throwIfDisposed(),ue.where(t,this,e)},r.prototype.neg=function(){return this.throwIfDisposed(),ue.neg(this)},r.prototype.ceil=function(){return this.throwIfDisposed(),ue.ceil(this)},r.prototype.floor=function(){return this.throwIfDisposed(),ue.floor(this)},r.prototype.sign=function(){return this.throwIfDisposed(),ue.sign(this)},r.prototype.isNaN=function(){return this.throwIfDisposed(),ue.isNaN(this)},r.prototype.isInf=function(){return this.throwIfDisposed(),ue.isInf(this)},r.prototype.isFinite=function(){return this.throwIfDisposed(),ue.isFinite(this)},r.prototype.exp=function(){return this.throwIfDisposed(),ue.exp(this)},r.prototype.expm1=function(){return this.throwIfDisposed(),ue.expm1(this)},r.prototype.log=function(){return this.throwIfDisposed(),ue.log(this)},r.prototype.log1p=function(){return this.throwIfDisposed(),ue.log1p(this)},r.prototype.sqrt=function(){return this.throwIfDisposed(),ue.sqrt(this)},r.prototype.rsqrt=function(){return this.throwIfDisposed(),ue.rsqrt(this)},r.prototype.square=function(){return this.throwIfDisposed(),ue.square(this)},r.prototype.reciprocal=function(){return this.throwIfDisposed(),ue.reciprocal(this)},r.prototype.abs=function(){return this.throwIfDisposed(),ue.abs(this)},r.prototype.clipByValue=function(t,e){return this.throwIfDisposed(),ue.clipByValue(this,t,e)},r.prototype.relu=function(){return this.throwIfDisposed(),ue.relu(this)},r.prototype.relu6=function(){return this.throwIfDisposed(),ue.relu6(this)},r.prototype.elu=function(){return this.throwIfDisposed(),ue.elu(this)},r.prototype.selu=function(){return this.throwIfDisposed(),ue.selu(this)},r.prototype.leakyRelu=function(t){return t===void 0&&(t=.2),this.throwIfDisposed(),ue.leakyRelu(this,t)},r.prototype.prelu=function(t){return this.throwIfDisposed(),ue.prelu(this,t)},r.prototype.sigmoid=function(){return this.throwIfDisposed(),ue.sigmoid(this)},r.prototype.logSigmoid=function(){return this.throwIfDisposed(),ue.logSigmoid(this)},r.prototype.softplus=function(){return this.throwIfDisposed(),ue.softplus(this)},r.prototype.zerosLike=function(){return this.throwIfDisposed(),ue.zerosLike(this)},r.prototype.onesLike=function(){return this.throwIfDisposed(),ue.onesLike(this)},r.prototype.sin=function(){return this.throwIfDisposed(),ue.sin(this)},r.prototype.cos=function(){return this.throwIfDisposed(),ue.cos(this)},r.prototype.tan=function(){return this.throwIfDisposed(),ue.tan(this)},r.prototype.asin=function(){return this.throwIfDisposed(),ue.asin(this)},r.prototype.acos=function(){return this.throwIfDisposed(),ue.acos(this)},r.prototype.atan=function(){return this.throwIfDisposed(),ue.atan(this)},r.prototype.sinh=function(){return this.throwIfDisposed(),ue.sinh(this)},r.prototype.cosh=function(){return this.throwIfDisposed(),ue.cosh(this)},r.prototype.tanh=function(){return this.throwIfDisposed(),ue.tanh(this)},r.prototype.asinh=function(){return this.throwIfDisposed(),ue.asinh(this)},r.prototype.acosh=function(){return this.throwIfDisposed(),ue.acosh(this)},r.prototype.atanh=function(){return this.throwIfDisposed(),ue.atanh(this)},r.prototype.erf=function(){return this.throwIfDisposed(),ue.erf(this)},r.prototype.round=function(){return this.throwIfDisposed(),ue.round(this)},r.prototype.step=function(t){return t===void 0&&(t=0),this.throwIfDisposed(),ue.step(this,t)},r.prototype.softmax=function(t){return t===void 0&&(t=-1),this.throwIfDisposed(),ue.softmax(this,t)},r.prototype.logSoftmax=function(t){return t===void 0&&(t=-1),this.throwIfDisposed(),ue.logSoftmax(this,t)},r.prototype.resizeBilinear=function(t,e){return e===void 0&&(e=!1),this.throwIfDisposed(),ue.image.resizeBilinear(this,t,e)},r.prototype.resizeNearestNeighbor=function(t,e){return e===void 0&&(e=!1),this.throwIfDisposed(),ue.image.resizeNearestNeighbor(this,t,e)},r.prototype.conv1d=function(t,e,n,a,i,s){return a===void 0&&(a="NWC"),i===void 0&&(i=1),this.throwIfDisposed(),ue.conv1d(this,t,e,n,a,i,s)},r.prototype.conv2d=function(t,e,n,a,i,s){return a===void 0&&(a="NHWC"),i===void 0&&(i=[1,1]),this.throwIfDisposed(),ue.conv2d(this,t,e,n,a,i,s)},r.prototype.conv2dTranspose=function(t,e,n,a,i){return this.throwIfDisposed(),ue.conv2dTranspose(this,t,e,n,a,i)},r.prototype.depthwiseConv2D=function(t,e,n,a,i,s){return a===void 0&&(a="NHWC"),i===void 0&&(i=[1,1]),this.throwIfDisposed(),ue.depthwiseConv2d(this,t,e,n,a,i,s)},r.prototype.separableConv2d=function(t,e,n,a,i,s){return i===void 0&&(i=[1,1]),s===void 0&&(s="NHWC"),this.throwIfDisposed(),ue.separableConv2d(this,t,e,n,a,i,s)},r.prototype.avgPool=function(t,e,n,a){return this.throwIfDisposed(),ue.avgPool(this,t,e,n,a)},r.prototype.maxPool=function(t,e,n,a){return this.throwIfDisposed(),ue.maxPool(this,t,e,n,a)},r.prototype.localResponseNormalization=function(t,e,n,a){return t===void 0&&(t=5),e===void 0&&(e=1),n===void 0&&(n=1),a===void 0&&(a=.5),ue.localResponseNormalization(this,t,e,n,a)},r.prototype.pool=function(t,e,n,a,i){return this.throwIfDisposed(),ue.pool(this,t,e,n,a,i)},r.prototype.variable=function(t,e,n){return t===void 0&&(t=!0),this.throwIfDisposed(),Ea().makeVariable(this,t,e,n)},r.prototype.unsortedSegmentSum=function(t,e){return this.throwIfDisposed(),ue.unsortedSegmentSum(this,t,e)},r.prototype.batchToSpaceND=function(t,e){return this.throwIfDisposed(),ue.batchToSpaceND(this,t,e)},r.prototype.spaceToBatchND=function(t,e){return this.throwIfDisposed(),ue.spaceToBatchND(this,t,e)},r.prototype.topk=function(t,e){return t===void 0&&(t=1),e===void 0&&(e=!0),this.throwIfDisposed(),ue.topk(this,t,e)},r.prototype.stridedSlice=function(t,e,n,a,i,s,l,c){return a===void 0&&(a=0),i===void 0&&(i=0),s===void 0&&(s=0),l===void 0&&(l=0),c===void 0&&(c=0),this.throwIfDisposed(),ue.stridedSlice(this,t,e,n,a,i,s,l,c)},r.prototype.depthToSpace=function(t,e){return this.throwIfDisposed(),ue.depthToSpace(this,t,e)},r.prototype.fft=function(){return this.throwIfDisposed(),ue.spectral.fft(this)},r.prototype.ifft=function(){return this.throwIfDisposed(),ue.spectral.ifft(this)},r.prototype.rfft=function(){return this.throwIfDisposed(),ue.spectral.rfft(this)},r.prototype.irfft=function(){return this.throwIfDisposed(),ue.spectral.irfft(this)},r}();Object.defineProperty(Ct,Symbol.hasInstance,{value:function(r){return!!r&&r.dataId!=null&&r.shape!=null&&r.dtype!=null}});var Iv,kv,Dv,Ov,_v,fc=function(r){function t(e,n,a,i){var s=r.call(this,e.shape,e.dtype,e.dataId,i)||this;return s.trainable=n,s.name=a,s}return la(t,r),t.prototype.assign=function(e){if(e.dtype!==this.dtype)throw new Error("dtype of the new value ("+e.dtype+") and previous value ("+this.dtype+") must match");if(!kn(e.shape,this.shape))throw new Error("shape of the new value ("+e.shape+") and previous value ("+this.shape+") must match");Ea().disposeTensor(this),this.dataId=e.dataId,Ea().incRef(this,null)},t.prototype.dispose=function(){Ea().disposeVariable(this),this.isDisposedInternal=!0},t}(Ct);Object.defineProperty(fc,Symbol.hasInstance,{value:function(r){return r instanceof Ct&&r.assign!=null&&r.assign instanceof Function}}),function(r){r.R0="R0",r.R1="R1",r.R2="R2",r.R3="R3",r.R4="R4",r.R5="R5",r.R6="R6"}(Iv||(Iv={})),function(r){r.float32="float32",r.int32="int32",r.bool="int32",r.complex64="complex64"}(kv||(kv={})),function(r){r.float32="float32",r.int32="int32",r.bool="bool",r.complex64="complex64"}(Dv||(Dv={})),function(r){r.float32="float32",r.int32="float32",r.bool="float32",r.complex64="complex64"}(Ov||(Ov={})),function(r){r.float32="complex64",r.int32="complex64",r.bool="complex64",r.complex64="complex64"}(_v||(_v={}));var Az={float32:Ov,int32:kv,bool:Dv,complex64:_v};function cn(r,t){if(r==="string"||t==="string"){if(r==="string"&&t==="string")return"string";throw new Error("Can not upcast "+r+" with "+t)}return Az[r][t]}function Hg(r){return cn(r,"int32")}function Jt(r,t){if(r.dtype===t.dtype)return[r,t];var e=cn(r.dtype,t.dtype);return[r.cast(e),t.cast(e)]}function $C(r,t){P(r.dtype===t.dtype,function(){return"The dtypes of the first("+r.dtype+") and second("+t.dtype+") input must match"})}function zy(r){var t=[];return function e(n,a,i){if(n!=null){if(n instanceof Ct)return void a.push(n);if(s=n,!(!Array.isArray(s)&&typeof s!="object")){var s,l=n;for(var c in l){var f=l[c];i.has(f)||(i.add(f),e(f,a,i))}}}}(r,t,new Set),t}var qg,Aa=Object.freeze({makeTypesMatch:Jt,assertTypesMatch:$C,isTensorInList:function(r,t){for(var e=0;e<t.length;e++)if(t[e].id===r.id)return!0;return!1},getTensorsInContainer:zy}),eS=function(){function r(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return r.prototype.dispose=function(){for(var t in this.registeredVariables)this.registeredVariables[t].dispose()},r}(),Tz=function(){function r(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new eS}return r.prototype.ready=function(){return De(this,void 0,void 0,function(){var t,e,n;return Oe(this,function(a){switch(a.label){case 0:if(this.pendingBackendInit!=null)return[2,this.pendingBackendInit.then(function(){})];if(this.backendInstance!=null)return[2];t=this.getSortedBackends(),e=0,a.label=1;case 1:return e<t.length?(n=t[e],[4,this.initializeBackend(n).success]):[3,5];case 2:return a.sent()?[4,this.setBackend(n)]:[3,4];case 3:return a.sent(),[2];case 4:return e++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}})})},Object.defineProperty(r.prototype,"backend",{get:function(){if(this.pendingBackendInit!=null)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() before calling other methods");if(this.backendInstance==null){var t=this.initializeBackendsAndReturnBest(),e=t.name;if(t.asyncInit)throw new Error("The highest priority backend '"+e+"' has not yet been initialized. Make sure to await tf.ready() before calling other methods");this.setBackend(e)}return this.backendInstance},enumerable:!0,configurable:!0}),r.prototype.backendNames=function(){return Object.keys(this.registryFactory)},r.prototype.findBackend=function(t){return!(t in this.registry)&&(!(t in this.registryFactory)||this.initializeBackend(t).asyncInit)?null:this.registry[t]},r.prototype.findBackendFactory=function(t){return t in this.registryFactory?this.registryFactory[t].factory:null},r.prototype.registerBackend=function(t,e,n){return n===void 0&&(n=1),t in this.registryFactory?(console.warn(t+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[t]={factory:e,priority:n},!0)},r.prototype.setBackend=function(t){return De(this,void 0,void 0,function(){var e,n,a;return Oe(this,function(i){switch(i.label){case 0:if(this.registryFactory[t]==null)throw new Error("Backend name '"+t+"' not found in registry");return this.backendName=t,this.registry[t]!=null?[3,4]:(this.backendInstance=null,e=this.initializeBackend(t),n=e.success,e.asyncInit?[4,n]:[3,2]);case 1:return a=i.sent(),[3,3];case 2:a=n,i.label=3;case 3:if(!a)return[2,!1];i.label=4;case 4:return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new Sz(this.backendInstance),[2,!0]}})})},r.prototype.setupRegisteredKernels=function(){var t=this;Av(this.backendName).forEach(function(e){e.setupFunc!=null&&e.setupFunc(t.backendInstance)})},r.prototype.disposeRegisteredKernels=function(t){var e=this;Av(t).forEach(function(n){n.disposeFunc!=null&&n.disposeFunc(e.registry[t])})},r.prototype.initializeBackend=function(t){var e=this,n=this.registryFactory[t];if(n==null)throw new Error("Cannot initialize backend "+t+", no registration found.");try{var a=n.factory();if(Promise.resolve(a)===a){var i=++this.pendingBackendInitId,s=a.then(function(l){return!(i<e.pendingBackendInitId)&&(e.registry[t]=l,e.pendingBackendInit=null,!0)}).catch(function(l){return!(i<e.pendingBackendInitId)&&(e.pendingBackendInit=null,console.warn("Initialization of backend "+t+" failed"),console.warn(l.stack||l.message),!1)});return this.pendingBackendInit=s,{success:s,asyncInit:!0}}return this.registry[t]=a,{success:!0,asyncInit:!1}}catch(l){return console.warn("Initialization of backend "+t+" failed"),console.warn(l.stack||l.message),{success:!1,asyncInit:!1}}},r.prototype.removeBackend=function(t){if(!(t in this.registryFactory))throw new Error(t+" backend not found in registry");this.backendName===t&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},r.prototype.getSortedBackends=function(){var t=this;if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort(function(e,n){return t.registryFactory[n].priority-t.registryFactory[e].priority})},r.prototype.initializeBackendsAndReturnBest=function(){for(var t=this.getSortedBackends(),e=0;e<t.length;e++){var n=t[e],a=this.initializeBackend(n),i=a.success,s=a.asyncInit;if(s||i)return{name:n,asyncInit:s}}throw new Error("Could not initialize any backends, all backend initializations failed.")},r.prototype.moveData=function(t,e){var n=this.state.tensorInfo.get(e),a=n.backend,i=this.readSync(e);a.disposeData(e),n.backend=t,t.move(e,i,n.shape,n.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},r.prototype.tidy=function(t,e){var n,a=this,i=null;if(e==null){if(typeof t!="function")throw new Error("Please provide a function to tidy()");e=t}else{if(typeof t!="string"&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof e!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");i=t}return this.scopedRun(function(){return a.startScope(i)},function(){return a.endScope(n)},function(){return(n=e())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n})},r.prototype.scopedRun=function(t,e,n){t();try{var a=n();return e(),a}catch(i){throw e(),i}},r.prototype.nextTensorId=function(){return r.nextTensorId++},r.prototype.nextVariableId=function(){return r.nextVariableId++},r.prototype.clone=function(t){var e=this.makeTensorFromDataId(t.dataId,t.shape,t.dtype),n={x:t};return this.addTapeNode(this.state.activeScope.name,n,[e],function(a){return{x:function(){return a.toFloat()}}},[]),e},r.prototype.runKernel=function(t,e,n,a,i){return this.runKernelFunc(null,e,null,t,n,a,i)},r.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},r.prototype.checkKernelForMemLeak=function(t,e,n){var a=this.backend.numDataIds(),i=0;n.forEach(function(c){i+=c.dtype==="complex64"?3:1});var s=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],l=a-e-i-s;if(l>0)throw new Error("Backend '"+this.backendName+"' has an internal memory leak ("+l+" data ids) after running '"+t+"'")},r.prototype.runKernelFunc=function(t,e,n,a,i,s,l){var c,f=this;s===void 0&&(s=[]),l===void 0&&(l=[]);var d,p=[],g=this.isTapeOn(),v=this.state.activeScope!=null?this.state.activeScope.name:"",b=function(A){g&&(p=A.map(function(T){return f.keep(f.clone(T))}))},w=this.state.numBytes,S=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var x,C=zC(a,this.backendName);return d=C!=null?function(){var A=f.backend.numDataIds();x=C.kernelFunc({inputs:e,attrs:i,backend:f.backend});var T=Array.isArray(x)?x:[x];f.shouldCheckForMemLeaks()&&f.checkKernelForMemLeak(v,A,T);var R=T.map(function(N){var D=N.dataId,I=N.shape,_=N.dtype;return f.makeTensorFromDataId(D,I,_)}),O=R.filter(function(N,D){return l[D]});return b(s.slice().concat(O)),R}:function(){var A=f.backend.numDataIds();x=f.tidy(function(){return t(f.backend,b)});var T=Array.isArray(x)?x:[x];return f.shouldCheckForMemLeaks()&&f.checkKernelForMemLeak(v,A,T),T},this.scopedRun(function(){return f.state.kernelDepth++},function(){return f.state.kernelDepth--},function(){c=f.ENV.getBool("DEBUG")?f.profiler.profileKernel(v,e,function(){return d()}):d()}),g&&this.addTapeNode(v,e,c,n,p),this.state.profiling&&this.state.activeProfile.kernels.push({name:v,bytesAdded:this.state.numBytes-w,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-S,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(e).map(function(A){return e[A].shape}),outputShapes:c.map(function(A){return A.shape})}),Array.isArray(x)?c:c[0]},r.prototype.makeTensor=function(t,e,n,a){if(t==null)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",a=a||this.backend;var i=t;n==="string"&&Gi(t[0])&&(i=t.map(function(d){return qC(d)}));var s=a.write(i,e,n),l=new Ct(e,n,s,this.nextTensorId());if(this.incRef(l,a),n==="string"){var c=this.state.tensorInfo.get(s),f=jC(i);this.state.numBytes+=f-c.bytes,c.bytes=f}return l},r.prototype.makeTensorFromDataId=function(t,e,n,a){var i=new Ct(e,n=n||"float32",t,this.nextTensorId());return this.incRef(i,a),i},r.prototype.makeVariable=function(t,e,n,a){e===void 0&&(e=!0),n=n||this.nextVariableId().toString(),a!=null&&a!==t.dtype&&(t=t.asType(a));var i=new fc(t,e,n,this.nextTensorId());if(this.state.registeredVariables[i.name]!=null)throw new Error("Variable with name "+i.name+" was already registered");return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i},r.prototype.incRef=function(t,e){var n=this.state.tensorInfo.has(t.dataId)?this.state.tensorInfo.get(t.dataId).refCount:0;if(this.state.numTensors++,t.dtype==="string"&&this.state.numStringTensors++,n===0){this.state.numDataBuffers++;var a=0;t.dtype!=="complex64"&&t.dtype!=="string"&&(a=t.size*Dy(t.dtype)),this.state.tensorInfo.set(t.dataId,{backend:e||this.backend,dtype:t.dtype,shape:t.shape,bytes:a,refCount:0}),this.state.numBytes+=a}this.state.tensorInfo.get(t.dataId).refCount++,t instanceof fc||this.track(t)},r.prototype.disposeTensor=function(t){if(this.state.tensorInfo.has(t.dataId)){this.state.numTensors--,t.dtype==="string"&&this.state.numStringTensors--;var e=this.state.tensorInfo.get(t.dataId);e.refCount<=1?(t.dtype!=="complex64"&&(this.state.numBytes-=e.bytes),this.state.numDataBuffers--,e.backend.disposeData(t.dataId),this.state.tensorInfo.delete(t.dataId)):this.state.tensorInfo.get(t.dataId).refCount--}},r.prototype.disposeVariables=function(){for(var t in this.state.registeredVariables){var e=this.state.registeredVariables[t];this.disposeVariable(e)}},r.prototype.disposeVariable=function(t){this.disposeTensor(t),this.state.registeredVariables[t.name]!=null&&delete this.state.registeredVariables[t.name]},r.prototype.memory=function(){var t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,t.reasons==null&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t},r.prototype.profile=function(t){return De(this,void 0,void 0,function(){var e,n;return Oe(this,function(a){return this.state.profiling=!0,e=this.state.numBytes,n=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map(function(i){return i.totalBytesSnapshot})),this.state.activeProfile.newBytes=this.state.numBytes-e,this.state.activeProfile.newTensors=this.state.numTensors-n,[2,this.state.activeProfile]})})},r.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&this.state.kernelDepth===0},r.prototype.addTapeNode=function(t,e,n,a,i){var s=this,l={id:this.state.nextTapeNodeId++,name:t,inputs:e,outputs:n,saved:i};a!=null&&(l.gradient=function(c){return c=c.map(function(f,d){if(f==null){var p=n[d],g=Mu(p.size,p.dtype);return s.makeTensor(g,p.shape,p.dtype)}return f}),a(c.length>1?c:c[0],i)}),this.state.activeTape.push(l)},r.prototype.keep=function(t){return t.kept=!0,t},r.prototype.startTape=function(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++},r.prototype.endTape=function(){this.state.gradientDepth--},r.prototype.startScope=function(t){var e={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(e.name=t),this.state.scopeStack.push(e),this.state.activeScope=e},r.prototype.endScope=function(t){for(var e=this,n=zy(t),a=new Set(n.map(function(c){return c.id})),i=0;i<this.state.activeScope.track.length;i++){var s=this.state.activeScope.track[i];s.kept||a.has(s.id)||s.dispose()}var l=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach(function(c){c.kept||c.scopeId!==l.id||e.track(c)})},r.prototype.gradients=function(t,e,n,a){var i=this;if(a===void 0&&(a=!1),P(e.length>0,function(){return"gradients() received an empty list of xs."}),n!=null&&n.dtype!=="float32")throw new Error("dy must have 'float32' dtype, but has '"+n.dtype+"'");var s=this.scopedRun(function(){return i.startTape()},function(){return i.endTape()},function(){return i.tidy("forward",t)});P(s instanceof Ct,function(){return"The result y returned by f() must be a tensor."});var l=function(c,f,d){for(var p={},g={},v=0;v<f.length;v++)p[f[v].id]=!0;for(v=0;v<c.length;v++){var b=(O=c[v]).inputs;for(var w in b){for(var S=b[w],x=!1,C=0;C<f.length;C++)if(p[S.id]){O.outputs.forEach(function(_){return p[_.id]=!0}),x=!0,g[O.id]=!0;break}if(x)break}}var A={};A[d.id]=!0;var T={};for(v=c.length-1;v>=0;v--)for(b=(O=c[v]).inputs,C=0;C<O.outputs.length;C++)if(A[O.outputs[C].id]){for(var w in b)A[b[w].id]=!0,T[O.id]=!0;break}var R=[];for(v=0;v<c.length;v++){var O;if(g[(O=c[v]).id]&&T[O.id]){var N={};for(var w in O.inputs){var D=O.inputs[w];p[D.id]&&(N[w]=D)}var I=Object.assign({},O);I.inputs=N,I.outputs=O.outputs,R.push(I)}}return R}(this.state.activeTape,e,s);if(!a&&l.length===0&&e.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",function(){var c,f,d={};d[s.id]=n??(c=s.shape,f=_y(Me(c),"float32"),$.makeTensor(f,c,"float32")),function(g,v,b){for(var w=function(x){var C=v[x],A=[];if(C.outputs.forEach(function(N){var D=g[N.id];D!=null?A.push(D):A.push(null)}),C.gradient==null)throw new Error("Cannot compute gradient: gradient function not found for "+C.name+".");var T=C.gradient(A),R=function(N){if(!(N in T))throw new Error("Cannot backprop through input "+N+". Available gradients found: "+Object.keys(T)+".");var D=b(function(){return T[N]()});if(D.dtype!=="float32")throw new Error("Error in gradient for op "+C.name+". The gradient of input "+N+" must have 'float32' dtype, but has '"+D.dtype+"'");var I=C.inputs[N];if(!kn(D.shape,I.shape))throw new Error("Error in gradient for op "+C.name+". The gradient of input '"+N+"' has shape '"+D.shape+"', which does not match the shape of the input '"+I.shape+"'");if(g[I.id]==null)g[I.id]=D;else{var _=g[I.id];g[I.id]=_.add(D),_.dispose()}};for(var O in C.inputs)R(O)},S=v.length-1;S>=0;S--)w(S)}(d,l,function(g){return i.tidy(g)});var p=e.map(function(g){return d[g.id]});return i.state.gradientDepth===0&&(i.state.activeTape.forEach(function(g){for(var v in g.saved)g.saved[v].dispose()}),i.state.activeTape=null),{value:s,grads:p}})},r.prototype.customGrad=function(t){var e=this;return P(eo(t),function(){return"The f passed in customGrad(f) must be a function."}),function(){for(var n,a=[],i=0;i<arguments.length;i++)a[i]=arguments[i];P(a.every(function(l){return l instanceof Ct}),function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"});var s={};return a.forEach(function(l,c){s[c]=l}),e.runKernelFunc(function(l,c){return P((n=t.apply(void 0,a.concat([c]))).value instanceof Ct,function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"}),P(eo(n.gradFunc),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."}),n.value},s,function(l,c){var f=n.gradFunc(l,c),d=Array.isArray(f)?f:[f];P(d.length===a.length,function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."}),P(d.every(function(g){return g instanceof Ct}),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."});var p={};return d.forEach(function(g,v){p[v]=function(){return g}}),p})}},r.prototype.readSync=function(t){return this.state.tensorInfo.get(t).backend.readSync(t)},r.prototype.read=function(t){return this.state.tensorInfo.get(t).backend.read(t)},r.prototype.fromPixels=function(t,e){return this.backend.fromPixels(t,e)},r.prototype.time=function(t){return De(this,void 0,void 0,function(){var e,n;return Oe(this,function(a){switch(a.label){case 0:return e=ta(),[4,this.backend.time(t)];case 1:return(n=a.sent()).wallMs=ta()-e,[2,n]}})})},r.prototype.track=function(t){return this.state.activeScope!=null&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t},Object.defineProperty(r.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),r.prototype.reset=function(){for(var t in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new eS,this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},r.nextTensorId=0,r.nextVariableId=0,r}(),$=function(){var r=function(){if(qg==null){var e=void 0;if(typeof window<"u")e=window;else if(typeof global<"u")e=global;else if(typeof process<"u")e=process;else{if(typeof self>"u")throw new Error("Could not find a global object");e=self}qg=e}return qg}();if(r._tfengine==null){var t=new MC(r);r._tfengine=new Tz(t)}return function(e){Ry=e}(r._tfengine.ENV),Ea=function(){return r._tfengine},r._tfengine}();function KC(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}var Qa=se();Qa.registerFlag("DEBUG",function(){return!1},function(r){r&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),Qa.registerFlag("IS_BROWSER",function(){return KC()}),Qa.registerFlag("IS_NODE",function(){return typeof process<"u"&&process.versions!==void 0&&process.versions.node!==void 0}),Qa.registerFlag("IS_CHROME",function(){return typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}),Qa.registerFlag("PROD",function(){return!1}),Qa.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",function(){return Qa.getBool("DEBUG")}),Qa.registerFlag("DEPRECATION_WARNINGS_ENABLED",function(){return!0}),Qa.registerFlag("IS_TEST",function(){return!1});var hc,Er,xr,Fo={},Gg={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function YC(r,t){Fo[r]=t}function Da(r){r in Fo||(Fo[r]=function(e){if(e!==1&&e!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var n=ZC(e);return n.addEventListener("webglcontextlost",function(a){a.preventDefault(),delete Fo[e]},!1),e===1?n.getContext("webgl",Gg)||n.getContext("experimental-webgl",Gg):n.getContext("webgl2",Gg)}(r));var t=Fo[r];return t.isContextLost()?(delete Fo[r],Da(r)):(t.disable(t.DEPTH_TEST),t.disable(t.STENCIL_TEST),t.disable(t.BLEND),t.disable(t.DITHER),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SAMPLE_COVERAGE),t.enable(t.SCISSOR_TEST),t.enable(t.CULL_FACE),t.cullFace(t.BACK),Fo[r])}function ZC(r){if(typeof OffscreenCanvas<"u"&&r===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function wd(r,t){return[t,r]}function rc(r){var t=Me(r);return Qh(Math.ceil(t/4))}function Rc(r,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(r/2))]}function Ly(r,t){var e,n,a,i,s,l,c,f,d,p=r;return se().getNumber("WEBGL_VERSION")===2?(e=p.R32F,n=p.R16F,a=p.RGBA16F,i=p.RGBA32F,s=p.RED,l=4,c=1,f=p.HALF_FLOAT,d=p.FLOAT):(e=r.RGBA,n=r.RGBA,a=r.RGBA,i=p.RGBA,s=r.RGBA,l=4,c=4,f=t!=null?t.HALF_FLOAT_OES:null,d=r.FLOAT),{internalFormatFloat:e,internalFormatHalfFloat:n,internalFormatPackedHalfFloat:a,internalFormatPackedFloat:i,textureFormatFloat:s,downloadTextureFormat:r.RGBA,downloadUnpackNumChannels:l,defaultNumChannels:c,textureTypeHalfFloat:f,textureTypeFloat:d}}function Ne(r,t,e){var n=e();return t&&function(a){var i=a.getError();if(i!==a.NO_ERROR)throw new Error("WebGL Error: "+JC(a,i))}(r),n}(function(r){r[r.DENSE=0]="DENSE",r[r.SHARED_BATCH=1]="SHARED_BATCH"})(hc||(hc={})),function(r){r[r.RENDER=0]="RENDER",r[r.UPLOAD=1]="UPLOAD",r[r.PIXELS=2]="PIXELS",r[r.DOWNLOAD=3]="DOWNLOAD"}(Er||(Er={})),function(r){r[r.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",r[r.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",r[r.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",r[r.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",r[r.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(xr||(xr={}));var Nz=596e-10,Rz=65504;function QC(r){return!!(se().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||r===0||Nz<Math.abs(r)&&Math.abs(r)<Rz)}function JC(r,t){switch(t){case r.NO_ERROR:return"NO_ERROR";case r.INVALID_ENUM:return"INVALID_ENUM";case r.INVALID_VALUE:return"INVALID_VALUE";case r.INVALID_OPERATION:return"INVALID_OPERATION";case r.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case r.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case r.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+t}}function Oh(r,t,e){return pi(r,t,function(){return r.getExtension(e)},'Extension "'+e+'" not supported on this browser.')}function eA(r,t,e){var n=pi(r,t,function(){return r.createShader(r.VERTEX_SHADER)},"Unable to create vertex WebGLShader.");if(Ne(r,t,function(){return r.shaderSource(n,e)}),Ne(r,t,function(){return r.compileShader(n)}),r.getShaderParameter(n,r.COMPILE_STATUS)===!1)throw console.log(r.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function tA(r,t,e){var n=pi(r,t,function(){return r.createShader(r.FRAGMENT_SHADER)},"Unable to create fragment WebGLShader.");if(Ne(r,t,function(){return r.shaderSource(n,e)}),Ne(r,t,function(){return r.compileShader(n)}),r.getShaderParameter(n,r.COMPILE_STATUS)===!1)throw function(a,i){var s=Iz.exec(i);if(s==null)return console.log("Couldn't parse line number in error: "+i),void console.log(a);for(var l=+s[1],c=a.split(`
`),f=c.length.toString().length+2,d=c.map(function(S,x){return Xo((x+1).toString(),f)+S}),p=0,g=0;g<d.length;g++)p=Math.max(d[g].length,p);var v=d.slice(0,l-1),b=d.slice(l-1,l),w=d.slice(l);console.log(v.join(`
`)),console.log(i.split(`
`)[0]),console.log("%c "+Xo(b[0],p),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(w.join(`
`))}(e,r.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}var _h,Mh,Iz=/ERROR: [0-9]+:([0-9]+):/g;function nA(r,t){return pi(r,t,function(){return r.createProgram()},"Unable to create WebGLProgram.")}function rA(r,t,e){if(Ne(r,t,function(){return r.linkProgram(e)}),r.getProgramParameter(e,r.LINK_STATUS)===!1)throw console.log(r.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function zh(r,t,e){if(Ne(r,t,function(){return r.validateProgram(e)}),r.getProgramParameter(e,r.VALIDATE_STATUS)===!1)throw console.log(r.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function aA(r,t,e){var n=pi(r,t,function(){return r.createBuffer()},"Unable to create WebGLBuffer");return Ne(r,t,function(){return r.bindBuffer(r.ARRAY_BUFFER,n)}),Ne(r,t,function(){return r.bufferData(r.ARRAY_BUFFER,e,r.STATIC_DRAW)}),n}function iA(r,t,e){var n=pi(r,t,function(){return r.createBuffer()},"Unable to create WebGLBuffer");return Ne(r,t,function(){return r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,n)}),Ne(r,t,function(){return r.bufferData(r.ELEMENT_ARRAY_BUFFER,e,r.STATIC_DRAW)}),n}function oA(r,t){return pi(r,t,function(){return r.createTexture()},"Unable to create WebGLTexture.")}function sA(r,t){var e=se().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(r<=0||t<=0){var n="["+r+"x"+t+"]";throw new Error("Requested texture size "+n+" is invalid.")}if(r>e||t>e)throw n="["+r+"x"+t+"]",new Error("Requested texture size "+n+" greater than WebGL maximum on this browser / GPU "+("["+e+"x"+e+"]")+".")}function uA(r,t){return pi(r,t,function(){return r.createFramebuffer()},"Unable to create WebGLFramebuffer.")}function Mv(r,t,e,n,a,i,s,l){var c=r.getAttribLocation(e,n);return c!==-1&&(Ne(r,t,function(){return r.bindBuffer(r.ARRAY_BUFFER,a)}),Ne(r,t,function(){return r.vertexAttribPointer(c,i,r.FLOAT,!1,s,l)}),Ne(r,t,function(){return r.enableVertexAttribArray(c)}),!0)}function lA(r,t,e,n){pA(r,n),Ne(r,t,function(){return r.activeTexture(r.TEXTURE0+n)}),Ne(r,t,function(){return r.bindTexture(r.TEXTURE_2D,e)})}function cA(r,t,e,n){return pi(r,t,function(){return r.getUniformLocation(e,n)},'uniform "'+n+'" not present in program.')}function fA(r,t,e){return r.getUniformLocation(t,e)}function hA(r,t,e,n,a,i){Ne(r,t,function(){return lA(r,t,n,i)}),Ne(r,t,function(){return r.uniform1i(a,i)})}function Lh(r,t,e,n){Ne(r,t,function(){return r.bindFramebuffer(r.FRAMEBUFFER,n)}),Ne(r,t,function(){return r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,e,0)})}function zv(r,t,e){Ne(r,t,function(){return r.bindFramebuffer(r.FRAMEBUFFER,e)}),Ne(r,t,function(){return r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,null,0)})}function Ql(r){var t=r.checkFramebufferStatus(r.FRAMEBUFFER);if(t!==r.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+dA(r,t))}function dA(r,t){switch(t){case r.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case r.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case r.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case r.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+t}}function pi(r,t,e,n){var a=Ne(r,t,function(){return e()});if(a==null)throw new Error(n);return a}function pA(r,t){var e=r.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,n=t+r.TEXTURE0;if(n<r.TEXTURE0||n>e)throw new Error("textureUnit must be in "+("[gl.TEXTURE0, gl.TEXTURE"+e+"]")+".")}function dc(r,t){return t===void 0&&(t=2),Me(r.slice(0,r.length-t))}function pc(r){if(r.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[r.length>1?r[r.length-2]:1,r[r.length-1]]}function Fh(r){var t=[1,1,1];return r.length===0||r.length===1&&r[0]===1||(t=[dc(r)].concat(pc(r))),t}function mA(r,t){var e;t===void 0&&(t=!1);var n=se().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t&&(n*=2,(r=r.map(function(f,d){return d>=r.length-2?ky(r[d]):r[d]})).length===1&&(r=[2,r[0]])),r.length!==2){var a=qi(r);r=a.newShape}var i=Me(r);if(r.length<=1&&i<=n)return[1,i];if(r.length===2&&r[0]<=n&&r[1]<=n)return r;if(r.length===3&&r[0]*r[1]<=n&&r[2]<=n)return[r[0]*r[1],r[2]];if(r.length===3&&r[0]<=n&&r[1]*r[2]<=n)return[r[0],r[1]*r[2]];if(r.length===4&&r[0]*r[1]*r[2]<=n&&r[3]<=n)return[r[0]*r[1]*r[2],r[3]];if(r.length===4&&r[0]<=n&&r[1]*r[2]*r[3]<=n)return[r[0],r[1]*r[2]*r[3]];if(t){var s=dc(r),l=2,c=2;return r.length&&(l=(e=pc(r))[0],c=e[1]),Qh(i=s*(l/2)*(c/2)).map(function(f){return 2*f})}return Qh(i)}function ph(r){return r%2==0}function Jl(r,t){if(kn(r=r.slice(-2),t=t.slice(-2))||!r.length||!t.length||r[0]===0||r[1]===0||t[0]===0||t[1]===0)return!0;if(r.length!==t.length){var e=r.slice(-1)[0],n=t.slice(-1)[0];if(e===n||ph(e)&&ph(n)&&(r[0]===1||t[0]===1))return!0}return r[1]===t[1]&&ph(r[0])&&ph(t[0])}function gA(r){if(_h==null){var t=Da(r);_h=t.getParameter(t.MAX_TEXTURE_SIZE)}return _h}function vA(r){if(Mh==null){var t=Da(r);Mh=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,Mh)}function yA(r){if(r===0)return 0;var t=Da(r);return na(t,"EXT_disjoint_timer_query_webgl2")&&r===2?2:na(t,"EXT_disjoint_timer_query")?1:0}function na(r,t){return r.getExtension(t)!=null}function Lv(r){try{if(Da(r)!=null)return!0}catch{return!1}return!1}function bA(r){if(r===0)return!1;var t=Da(r);if(r===1){if(!na(t,"OES_texture_float"))return!1}else if(!na(t,"EXT_color_buffer_float"))return!1;return Fv(t)}function wA(r){if(r===0)return!1;var t=Da(r);if(r!==1){if(na(t,"EXT_color_buffer_float"))return Fv(t);if(na(t,"EXT_color_buffer_half_float")){var e=t.getExtension("EXT_color_buffer_half_float");return function(n,a){var i=Ly(n,a),s=n.createTexture();n.bindTexture(n.TEXTURE_2D,s),n.texImage2D(n.TEXTURE_2D,0,i.internalFormatHalfFloat,1,1,0,i.textureFormatFloat,i.textureTypeHalfFloat,null);var l=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,l),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,s,0);var c=n.checkFramebufferStatus(n.FRAMEBUFFER)===n.FRAMEBUFFER_COMPLETE;return n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,null),n.deleteTexture(s),n.deleteFramebuffer(l),c}(t,e)}return!1}return!!na(t,"OES_texture_float")&&!!na(t,"WEBGL_color_buffer_float")&&Fv(t)}function Fv(r){var t=Ly(r),e=r.createTexture();r.bindTexture(r.TEXTURE_2D,e),r.texImage2D(r.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);var n=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,n),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,e,0);var a=r.checkFramebufferStatus(r.FRAMEBUFFER)===r.FRAMEBUFFER_COMPLETE;return r.bindTexture(r.TEXTURE_2D,null),r.bindFramebuffer(r.FRAMEBUFFER,null),r.deleteTexture(e),r.deleteFramebuffer(n),a}function xA(r){return r===2&&Da(r).fenceSync!=null}var kz=Object.freeze({callAndCheck:Ne,canBeRepresented:QC,getWebGLErrorMessage:JC,getExtensionOrThrow:Oh,createVertexShader:eA,createFragmentShader:tA,createProgram:nA,linkProgram:rA,validateProgram:zh,createStaticVertexBuffer:aA,createStaticIndexBuffer:iA,getNumChannels:function(){return se().getNumber("WEBGL_VERSION")===2?1:4},createTexture:oA,validateTextureSize:sA,createFramebuffer:uA,bindVertexBufferToProgramAttribute:Mv,bindTextureUnit:lA,unbindTextureUnit:function(r,t,e){pA(r,e),Ne(r,t,function(){return r.activeTexture(r.TEXTURE0+e)}),Ne(r,t,function(){return r.bindTexture(r.TEXTURE_2D,null)})},getProgramUniformLocationOrThrow:cA,getProgramUniformLocation:fA,bindTextureToProgramUniformSampler:hA,bindCanvasToFramebuffer:function(r,t){Ne(r,t,function(){return r.bindFramebuffer(r.FRAMEBUFFER,null)}),Ne(r,t,function(){return r.viewport(0,0,r.canvas.width,r.canvas.height)}),Ne(r,t,function(){return r.scissor(0,0,r.canvas.width,r.canvas.height)})},bindColorTextureToFramebuffer:Lh,unbindColorTextureFromFramebuffer:zv,validateFramebuffer:Ql,getFramebufferErrorMessage:dA,getBatchDim:dc,getRowsCols:pc,getShapeAs3D:Fh,getTextureShapeFromLogicalShape:mA,isReshapeFree:Jl,getWebGLMaxTextureSize:gA,resetMaxTextureSize:function(){_h=null},resetMaxTexturesInShader:function(){Mh=null},getMaxTexturesInShader:vA,getWebGLDisjointQueryTimerVersion:yA,hasExtension:na,isWebGLVersionEnabled:Lv,isCapableOfRenderingToFloatTexture:bA,isDownloadFloatTextureEnabled:wA,isWebGLFenceEnabled:xA}),We=se();function Dz(){se().set("PROD",!0)}function Oz(){se().set("DEBUG",!0)}function _z(){se().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function xd(r){se().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(r+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function Mz(){$.disposeVariables()}function zz(){return $}function Bv(){return $.memory()}function Lz(r){return $.profile(r)}function ae(r,t){return $.tidy(r,t)}function et(r){zy(r).forEach(function(t){return t.dispose()})}function Na(r){return $.keep(r)}function Fz(r){return $.time(r)}function Bz(r){return $.setBackend(r)}function Uz(){return $.ready()}function Pz(){return $.backendName}function Vz(r){$.removeBackend(r)}function jz(r){return $.findBackend(r)}function Wz(r){return $.findBackendFactory(r)}function Hz(r,t,e){return e===void 0&&(e=1),$.registerBackend(r,t,e)}function SA(){return $.backend}function qz(r,t){se().setPlatform(r,t)}function Uv(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];se().getBool("IS_TEST")||console.warn.apply(console,r)}function Ra(r,t){var e=r;if(Fn(r))return t==="string"?[]:[r.length];if(!Array.isArray(r))return[];for(var n=[];Array.isArray(e)||Fn(e)&&t!=="string";)n.push(e.length),e=e[0];return Array.isArray(r)&&se().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function a(i,s,l){if(l=l||[],!Array.isArray(i)&&!Fn(i))return void P(s.length===0,function(){return"Element arr["+l.join("][")+"] is a primitive, but should be an array/TypedArray of "+s[0]+" elements"});P(s.length>0,function(){return"Element arr["+l.join("][")+"] should be a primitive, but is an array of "+i.length+" elements"}),P(i.length===s[0],function(){return"Element arr["+l.join("][")+"] should have "+s[0]+" elements, but has "+i.length+" elements"});for(var c=s.slice(1),f=0;f<i.length;++f)a(i[f],c,l.concat(f))}(r,n,[]),n}function tS(r,t,e,n){if(r!=null&&(r!=="numeric"&&r!==t||r==="numeric"&&t==="string"))throw new Error("Argument '"+e+"' passed to '"+n+"' must be "+r+" tensor, but got "+t+" tensor")}function U(r,t,e,n){if(n===void 0&&(n="numeric"),r instanceof Ct)return tS(n,r.dtype,t,e),r;var a=_u(r);if(a!=="string"&&["bool","int32","float32"].indexOf(n)>=0&&(a=n),tS(n,a,t,e),r==null||!Fn(r)&&!Array.isArray(r)&&typeof r!="number"&&typeof r!="boolean"&&typeof r!="string"){var i=r==null?"null":r.constructor.name;throw new Error("Argument '"+t+"' passed to '"+e+"' must be a Tensor or TensorLike, but got '"+i+"'")}var s=Ra(r,a);Fn(r)||Array.isArray(r)||(r=[r]);var l=a!=="string"?Oy(r,a,se().getBool("DEBUG")):li(r,[],!0);return $.makeTensor(l,s,a)}function mc(r,t,e,n){if(n===void 0&&(n="numeric"),!Array.isArray(r))throw new Error("Argument "+t+" passed to "+e+" must be a `Tensor[]` or `TensorLike[]`");return r.map(function(a,i){return U(a,t+"["+i+"]",e)},n)}function Fy(r,t){for(var e=0;e<r.length;++e)if(r[r.length-e-1]!==t-1-e)return!1;return!0}function EA(r,t,e){for(var n=r.length+t.length,a=[],i=0,s=0,l=0;l<n;l++)e.indexOf(l)===-1?a.push(r[i++]):a.push(t[s++]);return a}function Ln(r,t){for(var e=[],n=r.length,a=0;a<n;a++)t.indexOf(a)===-1&&e.push(r[a]);return[e,t.map(function(i){return r[i]})]}function Tr(r,t){return EA(r,t.map(function(e){return 1}),t)}function ur(r,t,e){P(Fy(t,e),function(){return r+" supports only inner-most axes for now. Got axes "+t+" and rank-"+e+" input."})}function ca(r,t){if(Fy(r,t))return null;for(var e=[],n=0;n<t;++n)r.indexOf(n)===-1&&e.push(n);return r.forEach(function(a){return e.push(a)}),e}function Sd(r){return r.map(function(t,e){return[e,t]}).sort(function(t,e){return t[1]-e[1]}).map(function(t){return t[0]})}function fa(r,t){for(var e=[],n=t-r;n<t;++n)e.push(n);return e}function CA(r,t){var e=r[0].length;r.forEach(function(a,i){P(a.length===e,function(){return"Error in concat"+e+"D: rank of tensors["+i+"] must be the same as the rank of the rest ("+e+")"})}),P(t>=0&&t<e,function(){return"Error in concat"+e+"D: axis must be between 0 and "+(e-1)+"."});var n=r[0];r.forEach(function(a,i){for(var s=0;s<e;s++)P(s===t||a[s]===n[s],function(){return"Error in concat"+e+"D: Shape of tensors["+i+"] ("+a+") does not match the shape of the rest ("+n+") along the non-concatenated axis "+i+"."})})}function es(r,t){for(var e=r[0].slice(),n=1;n<r.length;n++)e[t]+=r[n][t];return e}function K(r){var t=Object.keys(r);if(t.length!==1)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+t.length+" keys.");var e=t[0],n=r[e];e.endsWith("_")&&(e=e.substring(0,e.length-1));var a=function(){for(var i=[],s=0;s<arguments.length;s++)i[s]=arguments[s];$.startScope(e);try{var l=n.apply(void 0,i);return l instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),$.endScope(l),l}catch(c){throw $.endScope(null),c}};return Object.defineProperty(a,"name",{value:e,configurable:!0}),a}We.registerFlag("HAS_WEBGL",function(){return We.getNumber("WEBGL_VERSION")>0}),We.registerFlag("WEBGL_VERSION",function(){return Lv(2)?2:Lv(1)?1:0}),We.registerFlag("WEBGL_BUFFER_SUPPORTED",function(){return We.get("WEBGL_VERSION")===2}),We.registerFlag("WEBGL_CPU_FORWARD",function(){return!0}),We.registerFlag("WEBGL_FORCE_F16_TEXTURES",function(){return!1}),We.registerFlag("WEBGL_PACK",function(){return We.getBool("HAS_WEBGL")}),We.registerFlag("WEBGL_PACK_NORMALIZATION",function(){return We.getBool("WEBGL_PACK")}),We.registerFlag("WEBGL_PACK_CLIP",function(){return We.getBool("WEBGL_PACK")}),We.registerFlag("WEBGL_PACK_DEPTHWISECONV",function(){return!1}),We.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",function(){return We.getBool("WEBGL_PACK")}),We.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",function(){return We.getBool("WEBGL_PACK")}),We.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",function(){return We.getBool("WEBGL_PACK")}),We.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",function(){return We.getBool("WEBGL_PACK")}),We.registerFlag("WEBGL_PACK_REDUCE",function(){return We.getBool("WEBGL_PACK")}),We.registerFlag("WEBGL_LAZILY_UNPACK",function(){return We.getBool("WEBGL_PACK")}),We.registerFlag("WEBGL_CONV_IM2COL",function(){return We.getBool("WEBGL_PACK")}),We.registerFlag("WEBGL_MAX_TEXTURE_SIZE",function(){return gA(We.getNumber("WEBGL_VERSION"))}),We.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",function(){return vA(We.getNumber("WEBGL_VERSION"))}),We.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",function(){var r=We.getNumber("WEBGL_VERSION");return r===0?0:yA(r)}),We.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",function(){return We.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&(r=navigator.userAgent||navigator.vendor||window.opera,!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(r)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(r.substr(0,4))));var r}),We.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",function(){return bA(We.getNumber("WEBGL_VERSION"))}),We.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",function(){return!We.getBool("WEBGL_FORCE_F16_TEXTURES")&&We.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")}),We.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",function(){return wA(We.getNumber("WEBGL_VERSION"))}),We.registerFlag("WEBGL_FENCE_API_ENABLED",function(){return xA(We.getNumber("WEBGL_VERSION"))}),We.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",function(){return We.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0}),XC=xd;var Sn=K({complex_:function(r,t){var e=U(r,"real","complex"),n=U(t,"imag","complex");return mt(e.shape,n.shape,"real and imag shapes, "+e.shape+" and "+n.shape+", must match in call to tf.complex()."),$.runKernelFunc(function(a){return a.complex(e,n)},{$real:e,$imag:n})}}),lr=K({real_:function(r){var t=U(r,"input","real");return $.runKernelFunc(function(e){return e.real(t)},{$input:t})}}),Gr=K({imag_:function(r){var t=U(r,"input","imag");return $.runKernelFunc(function(e){return e.imag(t)},{$input:t})}});function rn(r,t,e){return oo(r,t,Ra(r,e),e)}function oo(r,t,e,n){if(n==null&&(n=_u(r)),n==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!Fn(r)&&!Array.isArray(r)&&typeof r!="number"&&typeof r!="boolean"&&typeof r!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(t!=null){My(t);var a=Me(t),i=Me(e);P(a===i,function(){return"Based on the provided shape, ["+t+"], the tensor should have "+a+" values but has "+i});for(var s=0;s<e.length;++s){var l=e[s],c=s!==e.length-1||l!==Me(t.slice(s));P(e[s]===t[s]||!c,function(){return"Error creating a new Tensor. Inferred shape ("+e+") does not match the provided shape ("+t+"). "})}}return Fn(r)||Array.isArray(r)||(r=[r]),t=t||e,r=n!=="string"?Oy(r,n,se().getBool("DEBUG")):li(r,[],!0),$.makeTensor(r,t,n)}function Re(r,t){if((Fn(r)&&t!=="string"||Array.isArray(r))&&t!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(t==="string"&&Fn(r)&&!(r instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return oo(r,[],[],t)}function fr(r,t){us(r);var e=Ra(r,t);if(e.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return oo(r,null,e,t)}function ai(r,t,e){if(us(r),t!=null&&t.length!==2)throw new Error("tensor2d() requires shape to have two numbers");var n=Ra(r,e);if(n.length!==2&&n.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(n.length===1&&t==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return oo(r,t,n,e)}function By(r,t,e){if(us(r),t!=null&&t.length!==3)throw new Error("tensor3d() requires shape to have three numbers");var n=Ra(r,e);if(n.length!==3&&n.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(n.length===1&&t==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return oo(r,t,n,e)}function Hi(r,t,e){if(us(r),t!=null&&t.length!==4)throw new Error("tensor4d() requires shape to have four numbers");var n=Ra(r,e);if(n.length!==4&&n.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(n.length===1&&t==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return oo(r,t,n,e)}function AA(r,t,e){if(us(r),t!=null&&t.length!==5)throw new Error("tensor5d() requires shape to have five numbers");var n=Ra(r,e);if(n.length!==5&&n.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(n.length===1&&t==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return oo(r,t,n,e)}function TA(r,t,e){if(us(r),t!=null&&t.length!==6)throw new Error("tensor6d() requires shape to have six numbers");var n=Ra(r,e);if(n.length!==6&&n.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(n.length===1&&t==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return oo(r,t=t||n,n,e)}function Uy(r,t,e,n){return t===void 0&&(t=!0),$.makeVariable(r,t,e,n)}function Oa(r,t){if(t===void 0&&(t="float32"),t==="complex64"){var e=Oa(r,"float32"),n=St(r,"float32");return Sn(e,n)}var a=_y(Me(r),t);return $.makeTensor(a,r,t)}function St(r,t){if(t===void 0&&(t="float32"),t==="complex64"){var e=St(r,"float32"),n=St(r,"float32");return Sn(e,n)}var a=Mu(Me(r),t);return $.makeTensor(a,r,t)}function zu(r,t,e){return $.runKernelFunc(function(n){return n.fill(r,t,e)},{})}function Py(r,t,e){if(e<=0)throw new Error("The number of values should be positive.");return $.runKernelFunc(function(n){return n.linspace(r,t,e)},{})}function Ed(r,t,e,n){if(e===void 0&&(e=1),n===void 0&&(n="float32"),e===0)throw new Error("Cannot have a step of zero");if(r===t||r<t&&e<0||t<r&&e>1)return St([0],n);var a=Mu(Math.abs(Math.ceil((t-r)/e)),n);t<r&&e===1&&(e=-1),a[0]=r;for(var i=1;i<a.length;i++)a[i]=a[i-1]+e;return fr(a,n)}var Nr=K({onesLike_:function(r){var t=U(r,"x","onesLike");if(t.dtype==="complex64"){var e=Nr(lr(t)),n=ct(Gr(t));return Sn(e,n)}return $.runKernelFunc(function(a){return a.onesLike(t)},{$x:t},function(a,i){return{$x:function(){return ct(a)}}})}}),ct=K({zerosLike_:function(r){var t=U(r,"x","zerosLike");return $.runKernelFunc(function(e){return e.zerosLike(t)},{$x:t},function(e,n){return{$x:function(){return ct(e)}}})}}),Gn=K({concat_:function(r,t){t===void 0&&(t=0),P(r.length>=1,function(){return"Pass at least one tensor to concat"});var e=mc(r,"tensors","concat");e[0].dtype==="complex64"&&e.forEach(function(s){if(s.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype `+s.dtype+". ")}),t=On(t,e[0].shape)[0];var n=es(e.map(function(s){return s.shape}),t);if(Me(n)===0)return rn([],n);if((e=e.filter(function(s){return s.size>0})).length===1)return e[0];var a=e.map(function(s){return s.shape});CA(a,t);var i=e;return $.runKernelFunc(function(s){return s.concat(e,t)},i,function(s){var l=a.map(function(c){return c[t]});return ii(s,l,t).map(function(c){return function(){return c}})})}}),Vy=K({concat1d_:function(r){return Gn(r,0)}}),jy=K({concat2d_:function(r,t){return Gn(r,t)}}),Wy=K({concat3d_:function(r,t){return Gn(r,t)}}),Hy=K({concat4d_:function(r,t){return Gn(r,t)}}),ii=K({split_:function(r,t,e){e===void 0&&(e=0);var n,a=U(r,"x","split");return e=On(e,a.shape)[0],typeof t=="number"?(P(a.shape[e]%t==0,function(){return"Number of splits must evenly divide the axis."}),n=new Array(t).fill(a.shape[e]/t)):(P(a.shape[e]===t.reduce(function(i,s){return i+s}),function(){return"The sum of sizes must match the size of the axis dimension."}),n=t),$.runKernelFunc(function(i){return i.split(a,n,e)},{$x:a},function(i){return{$x:function(){return Gn(i,e)}}})}});function ls(r,t){return r(t={exports:{}},t.exports),t.exports}var Gz=ls(function(r){(function(t,e,n){function a(l){var c,f=this,d=(c=4022871197,function(p){p=p.toString();for(var g=0;g<p.length;g++){var v=.02519603282416938*(c+=p.charCodeAt(g));v-=c=v>>>0,c=(v*=c)>>>0,c+=4294967296*(v-=c)}return 23283064365386963e-26*(c>>>0)});f.next=function(){var p=2091639*f.s0+23283064365386963e-26*f.c;return f.s0=f.s1,f.s1=f.s2,f.s2=p-(f.c=0|p)},f.c=1,f.s0=d(" "),f.s1=d(" "),f.s2=d(" "),f.s0-=d(l),f.s0<0&&(f.s0+=1),f.s1-=d(l),f.s1<0&&(f.s1+=1),f.s2-=d(l),f.s2<0&&(f.s2+=1),d=null}function i(l,c){return c.c=l.c,c.s0=l.s0,c.s1=l.s1,c.s2=l.s2,c}function s(l,c){var f=new a(l),d=c&&c.state,p=f.next;return p.int32=function(){return 4294967296*f.next()|0},p.double=function(){return p()+11102230246251565e-32*(2097152*p()|0)},p.quick=p,d&&(typeof d=="object"&&i(d,f),p.state=function(){return i(f,{})}),p}e&&e.exports?e.exports=s:this.alea=s})(0,r)}),Xz=ls(function(r){(function(t,e,n){function a(l){var c=this,f="";c.x=0,c.y=0,c.z=0,c.w=0,c.next=function(){var p=c.x^c.x<<11;return c.x=c.y,c.y=c.z,c.z=c.w,c.w^=c.w>>>19^p^p>>>8},l===(0|l)?c.x=l:f+=l;for(var d=0;d<f.length+64;d++)c.x^=0|f.charCodeAt(d),c.next()}function i(l,c){return c.x=l.x,c.y=l.y,c.z=l.z,c.w=l.w,c}function s(l,c){var f=new a(l),d=c&&c.state,p=function(){return(f.next()>>>0)/4294967296};return p.double=function(){do var g=((f.next()>>>11)+(f.next()>>>0)/4294967296)/2097152;while(g===0);return g},p.int32=f.next,p.quick=p,d&&(typeof d=="object"&&i(d,f),p.state=function(){return i(f,{})}),p}e&&e.exports?e.exports=s:this.xor128=s})(0,r)}),$z=ls(function(r){(function(t,e,n){function a(l){var c=this,f="";c.next=function(){var p=c.x^c.x>>>2;return c.x=c.y,c.y=c.z,c.z=c.w,c.w=c.v,(c.d=c.d+362437|0)+(c.v=c.v^c.v<<4^p^p<<1)|0},c.x=0,c.y=0,c.z=0,c.w=0,c.v=0,l===(0|l)?c.x=l:f+=l;for(var d=0;d<f.length+64;d++)c.x^=0|f.charCodeAt(d),d==f.length&&(c.d=c.x<<10^c.x>>>4),c.next()}function i(l,c){return c.x=l.x,c.y=l.y,c.z=l.z,c.w=l.w,c.v=l.v,c.d=l.d,c}function s(l,c){var f=new a(l),d=c&&c.state,p=function(){return(f.next()>>>0)/4294967296};return p.double=function(){do var g=((f.next()>>>11)+(f.next()>>>0)/4294967296)/2097152;while(g===0);return g},p.int32=f.next,p.quick=p,d&&(typeof d=="object"&&i(d,f),p.state=function(){return i(f,{})}),p}e&&e.exports?e.exports=s:this.xorwow=s})(0,r)}),Kz=ls(function(r){(function(t,e,n){function a(l){var c=this;c.next=function(){var f,d,p=c.x,g=c.i;return f=p[g],d=(f^=f>>>7)^f<<24,d^=(f=p[g+1&7])^f>>>10,d^=(f=p[g+3&7])^f>>>3,d^=(f=p[g+4&7])^f<<7,f=p[g+7&7],d^=(f^=f<<13)^f<<9,p[g]=d,c.i=g+1&7,d},function(f,d){var p,g=[];if(d===(0|d))g[0]=d;else for(d=""+d,p=0;p<d.length;++p)g[7&p]=g[7&p]<<15^d.charCodeAt(p)+g[p+1&7]<<13;for(;g.length<8;)g.push(0);for(p=0;p<8&&g[p]===0;++p);for(p==8?g[7]=-1:g[p],f.x=g,f.i=0,p=256;p>0;--p)f.next()}(c,l)}function i(l,c){return c.x=l.x.slice(),c.i=l.i,c}function s(l,c){l==null&&(l=+new Date);var f=new a(l),d=c&&c.state,p=function(){return(f.next()>>>0)/4294967296};return p.double=function(){do var g=((f.next()>>>11)+(f.next()>>>0)/4294967296)/2097152;while(g===0);return g},p.int32=f.next,p.quick=p,d&&(d.x&&i(d,f),p.state=function(){return i(f,{})}),p}e&&e.exports?e.exports=s:this.xorshift7=s})(0,r)}),Yz=ls(function(r){(function(t,e,n){function a(l){var c=this;c.next=function(){var f,d,p=c.w,g=c.X,v=c.i;return c.w=p=p+1640531527|0,d=g[v+34&127],f=g[v=v+1&127],d^=d<<13,f^=f<<17,d^=d>>>15,f^=f>>>12,d=g[v]=d^f,c.i=v,d+(p^p>>>16)|0},function(f,d){var p,g,v,b,w,S=[],x=128;for(d===(0|d)?(g=d,d=null):(d+="\0",g=0,x=Math.max(x,d.length)),v=0,b=-32;b<x;++b)d&&(g^=d.charCodeAt((b+32)%d.length)),b===0&&(w=g),g^=g<<10,g^=g>>>15,g^=g<<4,g^=g>>>13,b>=0&&(w=w+1640531527|0,v=(p=S[127&b]^=g+w)==0?v+1:0);for(v>=128&&(S[127&(d&&d.length||0)]=-1),v=127,b=512;b>0;--b)g=S[v+34&127],p=S[v=v+1&127],g^=g<<13,p^=p<<17,g^=g>>>15,p^=p>>>12,S[v]=g^p;f.w=w,f.X=S,f.i=v}(c,l)}function i(l,c){return c.i=l.i,c.w=l.w,c.X=l.X.slice(),c}function s(l,c){l==null&&(l=+new Date);var f=new a(l),d=c&&c.state,p=function(){return(f.next()>>>0)/4294967296};return p.double=function(){do var g=((f.next()>>>11)+(f.next()>>>0)/4294967296)/2097152;while(g===0);return g},p.int32=f.next,p.quick=p,d&&(d.X&&i(d,f),p.state=function(){return i(f,{})}),p}e&&e.exports?e.exports=s:this.xor4096=s})(0,r)}),Zz=ls(function(r){(function(t,e,n){function a(l){var c=this,f="";c.next=function(){var p=c.b,g=c.c,v=c.d,b=c.a;return p=p<<25^p>>>7^g,g=g-v|0,v=v<<24^v>>>8^b,b=b-p|0,c.b=p=p<<20^p>>>12^g,c.c=g=g-v|0,c.d=v<<16^g>>>16^b,c.a=b-p|0},c.a=0,c.b=0,c.c=-1640531527,c.d=1367130551,l===Math.floor(l)?(c.a=l/4294967296|0,c.b=0|l):f+=l;for(var d=0;d<f.length+20;d++)c.b^=0|f.charCodeAt(d),c.next()}function i(l,c){return c.a=l.a,c.b=l.b,c.c=l.c,c.d=l.d,c}function s(l,c){var f=new a(l),d=c&&c.state,p=function(){return(f.next()>>>0)/4294967296};return p.double=function(){do var g=((f.next()>>>11)+(f.next()>>>0)/4294967296)/2097152;while(g===0);return g},p.int32=f.next,p.quick=p,d&&(typeof d=="object"&&i(d,f),p.state=function(){return i(f,{})}),p}e&&e.exports?e.exports=s:this.tychei=s})(0,r)}),Bo=ls(function(r){(function(t,e){var n,a=this,i=256,s=6,l="random",c=e.pow(i,s),f=e.pow(2,52),d=2*f,p=i-1;function g(x,C,A){var T=[],R=w(function D(I,_){var F,B=[],V=typeof I;if(_&&V=="object")for(F in I)try{B.push(D(I[F],_-1))}catch{}return B.length?B:V=="string"?I:I+"\0"}((C=C==1?{entropy:!0}:C||{}).entropy?[x,S(t)]:x??function(){try{var D;return n&&(D=n.randomBytes)?D=D(i):(D=new Uint8Array(i),(a.crypto||a.msCrypto).getRandomValues(D)),S(D)}catch{var I=a.navigator,_=I&&I.plugins;return[+new Date,a,_,a.screen,S(t)]}}(),3),T),O=new v(T),N=function(){for(var D=O.g(s),I=c,_=0;D<f;)D=(D+_)*i,I*=i,_=O.g(1);for(;D>=d;)D/=2,I/=2,_>>>=1;return(D+_)/I};return N.int32=function(){return 0|O.g(4)},N.quick=function(){return O.g(4)/4294967296},N.double=N,w(S(O.S),t),(C.pass||A||function(D,I,_,F){return F&&(F.S&&b(F,O),D.state=function(){return b(O,{})}),_?(e[l]=D,I):D})(N,R,"global"in C?C.global:this==e,C.state)}function v(x){var C,A=x.length,T=this,R=0,O=T.i=T.j=0,N=T.S=[];for(A||(x=[A++]);R<i;)N[R]=R++;for(R=0;R<i;R++)N[R]=N[O=p&O+x[R%A]+(C=N[R])],N[O]=C;(T.g=function(D){for(var I,_=0,F=T.i,B=T.j,V=T.S;D--;)I=V[F=p&F+1],_=_*i+V[p&(V[F]=V[B=p&B+I])+(V[B]=I)];return T.i=F,T.j=B,_})(i)}function b(x,C){return C.i=x.i,C.j=x.j,C.S=x.S.slice(),C}function w(x,C){for(var A,T=x+"",R=0;R<T.length;)C[p&R]=p&(A^=19*C[p&R])+T.charCodeAt(R++);return S(C)}function S(x){return String.fromCharCode.apply(0,x)}if(e["seed"+l]=g,w(e.random(),t),r.exports){r.exports=g;try{n=require("crypto")}catch{}}})([],Math)});Bo.alea=Gz,Bo.xor128=Xz,Bo.xorwow=$z,Bo.xorshift7=Kz,Bo.xor4096=Yz,Bo.tychei=Zz;var Cd=Bo.alea,qy=function(){function r(t,e,n,a,i){this.mean=t,this.stdDev=e,this.dtype=n,this.nextVal=NaN,this.truncated=a,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var s=i||Math.random();this.random=Cd(s.toString())}return r.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var t=this.nextVal;return this.nextVal=NaN,t}for(var e,n,a=!1;!a;){var i=void 0,s=void 0,l=void 0;do l=(i=2*this.random()-1)*i+(s=2*this.random()-1)*s;while(l>=1||l===0);var c=Math.sqrt(-2*Math.log(l)/l);e=this.mean+this.stdDev*i*c,n=this.mean+this.stdDev*s*c,this.truncated&&!this.isValidTruncated(e)||(a=!0)}return this.truncated&&!this.isValidTruncated(n)||(this.nextVal=this.convertValue(n)),this.convertValue(e)},r.prototype.convertValue=function(t){return this.dtype==null||this.dtype==="float32"?t:Math.round(t)},r.prototype.isValidTruncated=function(t){return t<=this.upper&&t>=this.lower},r}(),Qz=function(){function r(t,e,n,a){this.alpha=t,this.beta=1/e,this.dtype=n;var i=a||Math.random();this.randu=Cd(i.toString()),this.randn=new qy(0,1,n,!1,this.randu()),this.d=t<1?t+2/3:t-1/3,this.c=1/Math.sqrt(9*this.d)}return r.prototype.nextValue=function(){for(var t,e,n,a,i,s;;){do a=this.randn.nextValue(),s=1+this.c*a;while(s<=0);if(s*=s*s,e=1-.331*(t=a*a)*t,n=.5*t+this.d*(1-s+Math.log(s)),(i=this.randu())<e||Math.log(i)<n)break}return s=1/this.beta*this.d*s,this.alpha<1&&(s*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(s)},r.prototype.convertValue=function(t){return this.dtype==="float32"?t:Math.round(t)},r}(),Jz=function(){function r(t,e,n,a){var i=this;if(t===void 0&&(t=0),e===void 0&&(e=1),this.canReturnFloat=function(){return i.dtype==null||i.dtype==="float32"},this.min=t,this.range=e-t,this.dtype=n,a==null&&(a=Math.random()),typeof a=="number"&&(a=a.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between "+t+" - "+e+" <= 1 and dtype is not float");this.random=Cd(a)}return r.prototype.convertValue=function(t){return this.canReturnFloat()?t:Math.round(t)},r.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},r}();function $e(r,t,e){return t===void 0&&(t="float32"),t=t||"float32",My(r),new yu(r,t,e)}function NA(r,t){t===void 0&&(t=!1),console.log(r.toString(t))}var Ad=K({batchToSpaceND_:function(r,t,e){var n=U(r,"x","batchToSpaceND"),a=t.reduce(function(i,s){return i*s});return P(n.rank>=1+t.length,function(){return"input rank is "+n.rank+" but should be > than blockShape.length "+t.length}),P(e.length===t.length,function(){return"crops.length is "+e.length+" but should be equal to blockShape.length  "+t.length}),P(n.shape[0]%a==0,function(){return"input tensor batch is "+n.shape[0]+" but is not divisible by the product of the elements of blockShape "+t.join(" * ")+" === "+a}),$.runKernelFunc(function(i){return i.batchToSpaceND(n,t,e)},{$x:n},function(i){return{$x:function(){return i.spaceToBatchND(t,e)}}})}}),Td=K({cast_:function(r,t){var e=U(r,"x","cast");if(!PC(t))throw new Error("Failed to cast to unknown dtype "+t);if(t==="string"&&e.dtype!=="string"||t!=="string"&&e.dtype==="string")throw new Error("Only strings can be casted to strings");var n={dtype:t};return $.runKernelFunc(function(a){return a.cast(e,t)},{x:e},function(a){return{x:function(){return a.clone()}}},"Cast",n)}}),RA=K({clone_:function(r){var t=U(r,"x","clone",null);return $.runKernelFunc(function(){return $.makeTensorFromDataId(t.dataId,t.shape,t.dtype)},{$x:t},function(e){return{$x:function(){return e.toFloat()}}})}}),IA=K({cumsum_:function(r,t,e,n){t===void 0&&(t=0),e===void 0&&(e=!1),n===void 0&&(n=!1);var a=U(r,"x","cumsum"),i=ca([t|=0],a.rank),s=a;i!=null&&(s=a.transpose(i));var l=fa(1,a.rank)[0],c=$.runKernelFunc(function(f){return f.cumsum(s,l,e,n)},{permutedX:s},function(f){return{permutedX:function(){return f.cumsum(t,e,!n)}}});return i!=null&&(c=c.transpose(i)),c}}),Gy=K({depthToSpace_:function(r,t,e){e===void 0&&(e="NHWC");var n=U(r,"x","depthToSpace"),a=e==="NHWC"?n.shape[1]:n.shape[2],i=e==="NHWC"?n.shape[2]:n.shape[3],s=e==="NHWC"?n.shape[3]:n.shape[1];return P(a*t>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+a+" and "+t+`  for depthToSpace with input shape
      `+n.shape}),P(i*t>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+i+" and "+t+` for depthToSpace with input shape
          `+n.shape}),P(s%(t*t)==0,function(){return"Dimension size must be evenly divisible by "+t*t+" but is "+s+" for depthToSpace with input shape "+n.shape}),$.runKernelFunc(function(l){return l.depthToSpace(n,t,e)},{$x:n})}}),Sr=K({expandDims_:function(r,t){t===void 0&&(t=0);var e=U(r,"x","expandDims",null);P(t<=e.rank,function(){return"Axis must be <= rank of the tensor"});var n=e.shape.slice();return t<0&&(P(-(e.rank+1)<=t,function(){return"Axis must be in the interval ["+-(e.rank+1)+", "+e.rank+"]"}),t=e.rank+t+1),n.splice(t,0,1),Ic(e,n)}}),Nd=K({eye_:function(r,t,e,n){n===void 0&&(n="float32"),t==null&&(t=r);for(var a=$e([r,t],n),i=r<=t?r:t,s=0;s<i;++s)a.set(1,s,s);var l=a.toTensor().as2D(r,t);if(e==null)return l;if(e.length===1)return Yi(Sr(l,0),[e[0],1,1]);if(e.length===2)return Yi(Sr(Sr(l,0),0),[e[0],e[1],1,1]);if(e.length===3)return Yi(Sr(Sr(Sr(l,0),0),0),[e[0],e[1],e[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+e.length+"D.")}}),Xy=K({multinomial_:function(r,t,e,n){n===void 0&&(n=!1);var a=U(r,"logits","multinomial"),i=a.size,s=a.rank;if(i<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+i+".");if(s>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+s);e=e||Math.random();var l=s===1?a.as2D(1,-1):a,c=$.runKernelFunc(function(f){return f.multinomial(l,n,t,e)},{logits2D:l});return s===1?c.as1D():c}}),bu=K({oneHot_:function(r,t,e,n){if(e===void 0&&(e=1),n===void 0&&(n=0),t<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+t);var a=U(r,"indices","oneHot","int32"),i=a.shape.concat([t]);return a=a.flatten(),$.runKernelFunc(function(s){return s.oneHot(a,t,e,n)},{$indices:a},function(s){return{$indices:function(){return St(a.shape,"float32")}}}).reshape(i)}}),so=K({pad_:function(r,t,e){e===void 0&&(e=0);var n=U(r,"x","pad");if(n.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var a=t.map(function(i){return i[0]});return $.runKernelFunc(function(i){return i.pad(n,t,e)},{$x:n},function(i){return{$x:function(){return i.slice(a,n.shape)}}})}}),kA=K({pad1d_:function(r,t,e){return e===void 0&&(e=0),P(t.length===2,function(){return"Invalid number of paddings. Must be length of 2."}),so(r,[t],e)}}),DA=K({pad2d_:function(r,t,e){return e===void 0&&(e=0),P(t.length===2&&t[0].length===2&&t[1].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),so(r,t,e)}}),OA=K({pad3d_:function(r,t,e){return e===void 0&&(e=0),P(t.length===3&&t[0].length===2&&t[1].length===2&&t[2].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),so(r,t,e)}}),_A=K({pad4d_:function(r,t,e){return e===void 0&&(e=0),P(t.length===4&&t[0].length===2&&t[1].length===2&&t[2].length===2&&t[3].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),so(r,t,e)}}),MA=K({rand_:function(r,t,e){var n=Me(r),a=null;if(e==null||e==="float32")a=new Float32Array(n);else if(e==="int32")a=new Int32Array(n);else{if(e!=="bool")throw new Error("Unknown data type "+e);a=new Uint8Array(n)}for(var i=0;i<n;i++)a[i]=t();return $.makeTensor(a,r,e)}}),$y=K({randomNormal_:function(r,t,e,n,a){if(t===void 0&&(t=0),e===void 0&&(e=1),n!=null&&n==="bool")throw new Error("Unsupported data type "+n);for(var i=new qy(t,e,n,!1,a),s=$e(r,n),l=0;l<s.values.length;l++)s.values[l]=i.nextValue();return s.toTensor()}}),zA=K({randomGamma_:function(r,t,e,n,a){if(e===void 0&&(e=1),n===void 0&&(n="float32"),e==null&&(e=1),n==null&&(n="float32"),n!=="float32"&&n!=="int32")throw new Error("Unsupported data type "+n);for(var i=new Qz(t,e,n,a),s=$e(r,n),l=0;l<s.values.length;l++)s.values[l]=i.nextValue();return s.toTensor()}}),cs=K({randomUniform_:function(r,t,e,n,a){t===void 0&&(t=0),e===void 0&&(e=1),n===void 0&&(n="float32");for(var i=$e(r,n),s=new Jz(t,e,null,a),l=0;l<i.values.length;l++)i.values[l]=s.nextValue();return i.toTensor()}}),Ic=K({reshape_:function(r,t){var e=U(r,"x","reshape",null);t=BC(t,e.size),P(e.size===Me(t),function(){return"new shape and old shape must have the same number of elements."});var n={shape:t};return $.runKernelFunc(function(a){return a.reshape(e,t)},{x:e},function(a){return{x:function(){return a.reshape(e.shape)}}},"Reshape",n)}}),Rd=K({spaceToBatchND_:function(r,t,e){var n=U(r,"x","spaceToBatchND");return P(n.rank>=1+t.length,function(){return"input rank "+n.rank+" should be > than [blockShape] "+t.length}),P(e.length===t.length,function(){return"paddings.shape[0] "+e.length+" must be equal to [blockShape] "+t.length}),P(n.shape.reduce(function(a,i,s){return s>0&&s<=t.length?a&&(i+e[s-1][0]+e[s-1][1])%t[s-1]==0:a},!0),function(){return"input spatial dimensions "+n.shape.slice(1)+" with paddings "+e.toString()+" must be divisible by blockShapes "+t.toString()}),$.runKernelFunc(function(a){return a.spaceToBatchND(n,t,e)},{$x:n},function(a){return{$x:function(){return a.batchToSpaceND(t,e)}}})}}),kc=K({squeeze_:function(r,t){var e=U(r,"x","squeeze");return Ic(e,qi(e.shape,t).newShape)}}),ia=K({stack_:function(r,t){t===void 0&&(t=0);var e=mc(r,"tensors","stack");if(P(e.length>=1,function(){return"Pass at least one tensor to tf.stack"}),e.length===1)return e[0].expandDims(t);var n=e[0].rank,a=e[0].shape,i=e[0].dtype;P(t<=n,function(){return"Axis must be <= rank of the tensor"}),e.forEach(function(l){mt(a,l.shape,"All tensors passed to stack must have matching shapes")}),e.forEach(function(l){P(i===l.dtype,function(){return"All tensors passed to stack must have matching dtypes"})});var s=e.map(function(l){return l.expandDims(t)});return Gn(s,t)}}),Yi=K({tile_:function(r,t){var e=U(r,"x","tile",null);return P(e.rank===t.length,function(){return"Error in transpose: rank of input "+e.rank+" must match length of reps "+t+"."}),$.runKernelFunc(function(n,a){var i=n.tile(e,t);return a([e]),i},{$x:e},function(n,a){var i=a[0];return{$x:function(){var s=ct(i);if(i.rank===1)for(var l=0;l<t[0];++l)s=s.add(n.slice([l*i.shape[0]],[i.shape[0]]));else if(i.rank===2)for(l=0;l<t[0];++l)for(var c=0;c<t[1];++c)s=s.add(n.slice([l*i.shape[0],c*i.shape[1]],[i.shape[0],i.shape[1]]));else if(i.rank===3)for(l=0;l<t[0];++l)for(c=0;c<t[1];++c)for(var f=0;f<t[2];++f)s=s.add(n.slice([l*i.shape[0],c*i.shape[1],f*i.shape[2]],[i.shape[0],i.shape[1],i.shape[2]]));else{if(i.rank!==4)throw new Error("Gradient for tile operation is not implemented for rank-"+i.rank+" tensors yet.");for(l=0;l<t[0];++l)for(c=0;c<t[1];++c)for(f=0;f<t[2];++f)for(var d=0;d<t[3];++d)s=s.add(n.slice([l*i.shape[0],c*i.shape[1],f*i.shape[2],d*i.shape[3]],[i.shape[0],i.shape[1],i.shape[2],i.shape[3]]))}return s}}})}}),Dc=K({truncatedNormal_:function(r,t,e,n,a){if(t===void 0&&(t=0),e===void 0&&(e=1),n!=null&&n==="bool")throw new Error("Unsupported data type "+n);for(var i=new qy(t,e,n,!0,a),s=$e(r,n),l=0;l<s.values.length;l++)s.values[l]=i.nextValue();return s.toTensor()}}),ts=K({unstack_:function(r,t){t===void 0&&(t=0),t=t||0;var e=U(r,"x","unstack");return P(t>=-e.shape.length&&t<e.shape.length,function(){return"Axis = "+t+" is not in [-"+e.shape.length+", "+e.shape.length+")"}),t<0&&(t+=e.shape.length),$.runKernelFunc(function(n){return n.unstack(e,t)},{$x:e},function(n){return{$x:function(){return ia(n,t)}}})}}),Ky=function(r,t){return De(this,void 0,void 0,function(){var e,n,a,i,s,l,c,f,d,p;return Oe(this,function(g){switch(g.label){case 0:return e=U(r,"x","setdiff1d"),n=U(t,"y","setdiff1d"),P(e.dtype===n.dtype,function(){return"x and y should have the same dtype, but got x ("+e.dtype+") and y ("+n.dtype+")."}),P(e.rank===1,function(){return"x should be 1D tensor, but got x ("+e.shape+")."}),P(n.rank===1,function(){return"y should be 1D tensor, but got y ("+n.shape+")."}),[4,e.data()];case 1:return a=g.sent(),[4,n.data()];case 2:for(i=g.sent(),s=new Set(i),l=0,d=0;d<a.length;d++)s.has(a[d])||l++;for(c=new yu([l],e.dtype),f=new yu([l],"int32"),d=0,p=0;d<a.length;d++)s.has(a[d])||(c.values[p]=a[d],f.values[p]=d,p++);return[2,[c.toTensor(),f.toTensor()]]}})})};function ed(r,t,e,n){n===void 0&&(n=!0);var a=[];if(n)(a=a.concat(t.slice(0))).push(r[0]/e),a=a.concat(r.slice(1));else{a=a.concat(r[0]);for(var i=t.length,s=0;s<i;++s)a=a.concat([r[s+1]/t[s],t[s]]);a=a.concat(r.slice(i+1))}return a}function td(r,t,e){e===void 0&&(e=!0);var n=[];if(e){n.push(t);for(var a=t+1;a<r;++a)a<=2*t?(n.push(a),n.push(a-(t+1))):n.push(a)}else{var i=[],s=[];for(a=1;a<r;++a)a>=2*t+1||a%2==1?s.push(a):i.push(a);n.push.apply(n,i),n.push(0),n.push.apply(n,s)}return n}function nd(r,t,e,n){n===void 0&&(n=!0);var a=[];n?a.push(r[0]/e):a.push(r[0]*e);for(var i=1;i<r.length;++i)i<=t.length?n?a.push(t[i-1]*r[i]):a.push(r[i]/t[i-1]):a.push(r[i]);return a}function LA(r,t){for(var e=[0],n=0;n<t;++n)e.push(r[n][0]);return e}function FA(r,t,e){for(var n=r.slice(0,1),a=0;a<e;++a)n.push(r[a+1]-t[a][0]-t[a][1]);return n}function BA(r,t){if(r.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was "+r.rank+".");if(t.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if(t.dtype!=="int32")throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was "+t.dtype+".");if(t.shape[t.rank-1]>r.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+t.shape[t.rank-1]+" vs. "+r.rank);if(r.size===0)throw new Error("Requested more than 0 entries, but input is empty. Input shape: "+r.shape+".");for(var e=t.shape,n=e[e.length-1],a=1,i=0;i<e.length-1;++i)a*=e[i];var s=r.shape,l=e.slice();l.pop();var c=1;for(i=n;i<r.rank;++i)c*=s[i],l.push(s[i]);var f=io(r.shape).map(function(d){return d/c}).concat([1]).slice(0,n);return[l,a,c,f]}var UA=30;function Xg(r){return r<=UA?r:Jh(r,Math.floor(Math.sqrt(r)))}function e4(r,t,e){if(t.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if(r.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was "+r.rank+".");if(t.dtype!=="int32")throw new Error("The dtype of 'indices' should be int32, but got dtype: "+t.dtype);if(e.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+e);if(e.length===0){if(t.size===0)throw new Error("Indices specified for empty output. indices shape: "+t.shape);if(r.size===0)throw new Error("Updates specified for empty output. updates shape: "+r.shape)}(function(n,a,i){var s=a.rank>1?a.shape[a.rank-1]:1,l=a.rank>1?a.rank-1:1,c="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+i.shape+", indices.shape: "+a.shape+", shape: "+n+", sliceDim: "+s+", and batchDim: "+l+".";if(i.rank<l)throw new Error(c+" update.rank < "+l+". ");if(n.length<s+(i.rank-l))throw new Error(c+" Output shape length < "+(s+(i.rank-l)));if(i.rank!==l+n.length-s)throw new Error(c+" update.rank != "+(l+n.length-s));for(var f=0;f<l;++f)if(i.shape[f]!==a.shape[f])throw new Error(c+" updates.shape["+f+"] ("+i.shape[f]+") != indices.shape["+f+"] ("+a.shape[f]+").");for(f=0;f<i.rank-l;++f)if(i.shape[f+l]!==n[f+s])throw new Error(c+" updates.shape["+(f+l)+"] ("+i.shape[f+l]+") != shape["+(f+l)+"] ("+n[f+l]+")")})(e,t,r)}function rd(r,t,e){for(var n=t.rank>1?t.shape[t.rank-1]:1,a=e.length,i=1,s=n;s<a;++s)i*=e[s];var l=n<1?1:n;return{sliceRank:n,numUpdates:t.size/l,sliceSize:i,strides:io(e.slice(0,n)).concat([1]),outputSize:Me(e)}}function PA(r,t,e){P(r.rank===t.length,function(){return"Error in slice"+r.rank+"D: Length of begin "+t+" must match the rank of the array ("+r.rank+")."}),P(r.rank===e.length,function(){return"Error in slice"+r.rank+"D: Length of size "+e+" must match the rank of the array ("+r.rank+")."});for(var n=function(i){P(t[i]+e[i]<=r.shape[i],function(){return"Error in slice"+r.rank+"D: begin["+i+"] + size["+i+"] ("+(t[i]+e[i])+") would overflow input.shape["+i+"] ("+r.shape[i]+")"})},a=0;a<r.rank;++a)n(a)}function Pv(r){for(var t=[],e=0;r>0;)1&r&&t.push(e),r/=2,e++;return t}function Id(r,t,e){for(var n=[],a=0;a<r.length;a++)n[a]=Math.ceil((t[a]-r[a])/e[a]);return n}function VA(r,t,e,n,a){var i=t[a],s=e[a]||1;(r&1<<a||i==null)&&(i=s>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var l=n[a];return i<0&&(i+=l),i=Zh(0,i,l-1)}function jA(r,t,e,n,a){var i=t[a],s=e[a]||1;(r&1<<a||i==null)&&(i=s>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var l=n[a];return i<0&&(i+=l),i=s>0?Zh(0,i,l):Zh(-1,i,l-1)}function Yy(r,t,e){for(var n=e.length,a=0;a<e.length;a++)if(e[a]>1){n=a;break}for(a=n+1;a<e.length;a++)if(t[a]>0||e[a]!==r[a])return!1;return!0}function Zy(r,t){for(var e=r.length>0?r[r.length-1]:1,n=0;n<r.length-1;n++)e+=r[n]*t[n];return e}var t4=Object.freeze({assertParamsValid:PA,maskToAxes:Pv,computeOutShape:Id,startForAxis:VA,stopForAxis:jA,isSliceContinous:Yy,computeFlatOffset:Zy});function n4(r){return P(eo(r),function(){return"The f passed in grad(f) must be a function"}),function(t,e){var n=U(t,"x","tf.grad",null),a=e!=null?U(e,"dy","tf.grad"):null;return $.tidy(function(){var i=$.gradients(function(){return r(n)},[n],a),s=i.value,l=i.grads;return a!=null&&mt(s.shape,a.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),kd(l),l[0]})}}function r4(r){return P(eo(r),function(){return"The f passed in grads(f) must be a function"}),function(t,e){P(Array.isArray(t),function(){return"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s"});var n=mc(t,"args","tf.grads",null),a=e!=null?U(e,"dy","tf.grads"):null;return $.tidy(function(){var i=$.gradients(function(){return r.apply(void 0,n)},n,a),s=i.value,l=i.grads;return a!=null&&mt(s.shape,a.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),kd(l),l})}}function a4(r){return P(eo(r),function(){return"The f passed in valueAndGrad(f) must be a function"}),function(t,e){P(t instanceof Ct,function(){return"The x passed in valueAndGrad(f)(x) must be a tensor"}),P(e==null||e instanceof Ct,function(){return"The dy passed in valueAndGrad(f)(x, dy) must be a tensor"});var n=$.gradients(function(){return r(t)},[t],e),a=n.grads,i=n.value;return kd(a),{grad:a[0],value:i}}}function i4(r){return P(eo(r),function(){return"The f passed in valueAndGrads(f) must be a function"}),function(t,e){P(Array.isArray(t)&&t.every(function(a){return a instanceof Ct}),function(){return"The args passed in valueAndGrads(f)(args) must be array of tensors"}),P(e==null||e instanceof Ct,function(){return"The dy passed in valueAndGrads(f)(args, dy) must be a tensor"});var n=$.gradients(function(){return r.apply(void 0,t)},t,e);return e!=null&&mt(n.value.shape,e.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),kd(n.grads),n}}function WA(r,t){P(eo(r),function(){return"The f passed in variableGrads(f) must be a function"}),P(t==null||Array.isArray(t)&&t.every(function(d){return d instanceof fc}),function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"});var e=t!=null;if(!e)for(var n in t=[],$.registeredVariables)t.push($.registeredVariables[n]);var a=e?t.filter(function(d){return!d.trainable}):null,i=t.length;P((t=t.filter(function(d){return d.trainable})).length>0,function(){return"variableGrads() expects at least one of the input variables to be trainable, but none of the "+i+" variables is trainable."});var s=$.gradients(r,t,null,!0),l=s.value,c=s.grads;P(c.some(function(d){return d!=null}),function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."}),P(l.rank===0,function(){return"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+l.rank+" tensor"});var f={};return t.forEach(function(d,p){c[p]!=null&&(f[d.name]=c[p])}),a!=null&&a.forEach(function(d){return f[d.name]=null}),{value:l,grads:f}}function Lu(r){return $.customGrad(r)}function kd(r){if(r.filter(function(t){return t==null}).length>0)throw new Error(`Cannot compute gradient of y=f(x) with respect to x. Make sure that
    the f you passed encloses all operations that lead from x to y.`)}var fs=K({softmax_:function(r,t){t===void 0&&(t=-1);var e=U(r,"logits","softmax");if(t===-1&&(t=e.rank-1),t!==e.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+e.rank+" and dim was "+t);return Lu(function(n,a){var i=n.logSumExp([t],!0),s=n.toFloat().sub(i).exp();return a([s]),{value:s,gradFunc:function(l,c){var f=c[0],d=l.mul(f);return d.sub(d.sum([t],!0).mul(f))}}})(e)}}),Dd=K({logSoftmax_:function(r,t){t===void 0&&(t=-1);var e=U(r,"logits","logSoftmax");if(t===-1&&(t=e.rank-1),t!==e.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank "+e.rank+" and axis was "+t);return Lu(function(n,a){var i=n.max(t,!0),s=n.sub(i),l=s.toFloat().sub(s.exp().sum(t,!0).log());return a([l]),{value:l,gradFunc:function(c,f){var d=f[0].exp();return c.sub(c.sum(t,!0).mul(d))}}})(e)}}),Qy=function(){function r(t,e){this.backend=t,this.dataMover=e,this.data=new WeakMap,this.dataIdsCount=0}return r.prototype.get=function(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)},r.prototype.set=function(t,e){this.dataIdsCount++,this.data.set(t,e)},r.prototype.has=function(t){return this.data.has(t)},r.prototype.delete=function(t){return this.dataIdsCount--,this.data.delete(t)},r.prototype.numDataIds=function(){return this.dataIdsCount},r}(),Jy=function(){function r(){}return r.prototype.time=function(t){return oe()},r.prototype.read=function(t){return oe()},r.prototype.readSync=function(t){return oe()},r.prototype.numDataIds=function(){return oe()},r.prototype.disposeData=function(t){return oe()},r.prototype.fromPixels=function(t,e){return oe()},r.prototype.write=function(t,e,n){return oe()},r.prototype.move=function(t,e,n,a){return oe()},r.prototype.memory=function(){return oe()},r.prototype.floatPrecision=function(){return oe()},r.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},r.prototype.batchMatMul=function(t,e,n,a){return oe()},r.prototype.fusedBatchMatMul=function(t){return t.a,t.b,t.transposeA,t.transposeB,t.bias,t.activation,t.preluActivationWeights,oe()},r.prototype.slice=function(t,e,n){return oe()},r.prototype.stridedSlice=function(t,e,n,a){return oe()},r.prototype.unstack=function(t,e){return oe()},r.prototype.reverse=function(t,e){return oe()},r.prototype.concat=function(t,e){return oe()},r.prototype.neg=function(t){return oe()},r.prototype.add=function(t,e){return oe()},r.prototype.addN=function(t){return oe()},r.prototype.subtract=function(t,e){return oe()},r.prototype.multiply=function(t,e){return oe()},r.prototype.realDivide=function(t,e){return oe()},r.prototype.floorDiv=function(t,e){return oe()},r.prototype.sum=function(t,e){return oe()},r.prototype.prod=function(t,e){return oe()},r.prototype.unsortedSegmentSum=function(t,e,n){return oe()},r.prototype.argMin=function(t,e){return oe()},r.prototype.argMax=function(t,e){return oe()},r.prototype.equal=function(t,e){return oe()},r.prototype.notEqual=function(t,e){return oe()},r.prototype.less=function(t,e){return oe()},r.prototype.lessEqual=function(t,e){return oe()},r.prototype.greater=function(t,e){return oe()},r.prototype.greaterEqual=function(t,e){return oe()},r.prototype.logicalNot=function(t){return oe()},r.prototype.logicalAnd=function(t,e){return oe()},r.prototype.logicalOr=function(t,e){return oe()},r.prototype.where=function(t){return oe()},r.prototype.select=function(t,e,n){return oe()},r.prototype.topk=function(t,e,n){return oe()},r.prototype.min=function(t,e){return oe()},r.prototype.minimum=function(t,e){return oe()},r.prototype.mod=function(t,e){return oe()},r.prototype.max=function(t,e){return oe()},r.prototype.maximum=function(t,e){return oe()},r.prototype.all=function(t,e){return oe()},r.prototype.any=function(t,e){return oe()},r.prototype.squaredDifference=function(t,e){return oe()},r.prototype.ceil=function(t){return oe()},r.prototype.floor=function(t){return oe()},r.prototype.round=function(t){return oe()},r.prototype.sign=function(t){return oe()},r.prototype.isNaN=function(t){return oe()},r.prototype.isInf=function(t){return oe()},r.prototype.isFinite=function(t){return oe()},r.prototype.pow=function(t,e){return oe()},r.prototype.exp=function(t){return oe()},r.prototype.expm1=function(t){return oe()},r.prototype.log=function(t){return oe()},r.prototype.log1p=function(t){return oe()},r.prototype.sqrt=function(t){return oe()},r.prototype.rsqrt=function(t){return oe()},r.prototype.square=function(t){return oe()},r.prototype.reciprocal=function(t){return oe()},r.prototype.relu=function(t){return oe()},r.prototype.relu6=function(t){return oe()},r.prototype.prelu=function(t,e){return oe()},r.prototype.elu=function(t){return oe()},r.prototype.eluDer=function(t,e){return oe()},r.prototype.selu=function(t){return oe()},r.prototype.int=function(t){return oe()},r.prototype.clip=function(t,e,n){return oe()},r.prototype.abs=function(t){return oe()},r.prototype.complexAbs=function(t){return oe()},r.prototype.sigmoid=function(t){return oe()},r.prototype.softplus=function(t){return oe()},r.prototype.sin=function(t){return oe()},r.prototype.cos=function(t){return oe()},r.prototype.tan=function(t){return oe()},r.prototype.asin=function(t){return oe()},r.prototype.acos=function(t){return oe()},r.prototype.atan=function(t){return oe()},r.prototype.atan2=function(t,e){return oe()},r.prototype.sinh=function(t){return oe()},r.prototype.cosh=function(t){return oe()},r.prototype.tanh=function(t){return oe()},r.prototype.asinh=function(t){return oe()},r.prototype.acosh=function(t){return oe()},r.prototype.atanh=function(t){return oe()},r.prototype.erf=function(t){return oe()},r.prototype.step=function(t,e){return oe()},r.prototype.fusedConv2d=function(t){return t.input,t.filter,t.convInfo,t.bias,t.activation,t.preluActivationWeights,oe()},r.prototype.conv2d=function(t,e,n){return oe()},r.prototype.conv2dDerInput=function(t,e,n){return oe()},r.prototype.conv2dDerFilter=function(t,e,n){return oe()},r.prototype.fusedDepthwiseConv2D=function(t){return t.input,t.filter,t.convInfo,t.bias,t.activation,t.preluActivationWeights,oe()},r.prototype.depthwiseConv2D=function(t,e,n){return oe()},r.prototype.depthwiseConv2DDerInput=function(t,e,n){return oe()},r.prototype.depthwiseConv2DDerFilter=function(t,e,n){return oe()},r.prototype.conv3d=function(t,e,n){return oe()},r.prototype.conv3dDerInput=function(t,e,n){return oe()},r.prototype.conv3dDerFilter=function(t,e,n){return oe()},r.prototype.maxPool=function(t,e){return oe()},r.prototype.maxPoolBackprop=function(t,e,n,a){return oe()},r.prototype.avgPool=function(t,e){return oe()},r.prototype.avgPoolBackprop=function(t,e,n){return oe()},r.prototype.avgPool3d=function(t,e){return oe()},r.prototype.avgPool3dBackprop=function(t,e,n){return oe()},r.prototype.maxPool3d=function(t,e){return oe()},r.prototype.maxPool3dBackprop=function(t,e,n,a){return oe()},r.prototype.reshape=function(t,e){return oe()},r.prototype.cast=function(t,e){return oe()},r.prototype.tile=function(t,e){return oe()},r.prototype.pad=function(t,e,n){return oe()},r.prototype.transpose=function(t,e){return oe()},r.prototype.gather=function(t,e,n){return oe()},r.prototype.gatherND=function(t,e){return oe()},r.prototype.scatterND=function(t,e,n){return oe()},r.prototype.batchToSpaceND=function(t,e,n){return oe()},r.prototype.spaceToBatchND=function(t,e,n){return oe()},r.prototype.resizeBilinear=function(t,e,n,a){return oe()},r.prototype.resizeBilinearBackprop=function(t,e,n){return oe()},r.prototype.resizeNearestNeighbor=function(t,e,n,a){return oe()},r.prototype.resizeNearestNeighborBackprop=function(t,e,n){return oe()},r.prototype.batchNormalization=function(t,e,n,a,i,s){return oe()},r.prototype.localResponseNormalization4D=function(t,e,n,a,i){return oe()},r.prototype.LRNGrad=function(t,e,n,a,i,s,l){return oe()},r.prototype.multinomial=function(t,e,n,a){return oe()},r.prototype.oneHot=function(t,e,n,a){return oe()},r.prototype.cumsum=function(t,e,n,a){return oe()},r.prototype.nonMaxSuppression=function(t,e,n,a,i){return oe()},r.prototype.fft=function(t){return oe()},r.prototype.ifft=function(t){return oe()},r.prototype.complex=function(t,e){return oe()},r.prototype.real=function(t){return oe()},r.prototype.imag=function(t){return oe()},r.prototype.cropAndResize=function(t,e,n,a,i,s){return oe()},r.prototype.depthToSpace=function(t,e,n){return oe()},r.prototype.split=function(t,e,n){return oe()},r.prototype.sparseToDense=function(t,e,n,a){return oe()},r.prototype.diag=function(t){return oe()},r.prototype.fill=function(t,e,n){throw new Error("Not yet implemented.")},r.prototype.onesLike=function(t){return oe()},r.prototype.zerosLike=function(t){return oe()},r.prototype.linspace=function(t,e,n){return oe()},r.prototype.dispose=function(){return oe()},r}();function oe(){throw new Error("Not yet implemented or not found in the registry. Did you forget to import the kernel?")}function Wo(r,t){for(var e=r.length,n=[],a=0;a<e;a++){var i=e-1-a,s=r[i]||1;(t[t.length-1-a]||1)>1&&s===1&&n.unshift(i)}return n}function dn(r,t){for(var e=[],n=0;n<t.length;n++){var a=r[r.length-n-1],i=t.length-n-1,s=t[i];(a==null||a===1&&s>1)&&e.unshift(i)}return e}function lt(r,t){for(var e=[],n=Math.max(r.length,t.length),a=0;a<n;a++){var i=r[r.length-a-1];i==null&&(i=1);var s=t[t.length-a-1];if(s==null&&(s=1),i===1)e.unshift(s);else if(s===1)e.unshift(i);else{if(i!==s)throw Error("Operands could not be broadcast together with shapes "+r+" and "+t+".");e.unshift(i)}}return e}function wu(r,t,e,n,a,i,s){s===void 0&&(s="channelsLast");var l,c=ad(t),f=c[0],d=c[1];if(s==="channelsLast")l=[f,d,r[3],r[3]];else{if(s!=="channelsFirst")throw new Error("Unknown dataFormat "+s);l=[f,d,r[1],r[1]]}return uo(r,l,e,n,a,i,!1,s)}function gc(r,t,e,n,a,i,s){s===void 0&&(s="NDHWC");var l,c,f=Vv(t),d=f[0],p=f[1],g=f[2];if(s==="NDHWC")c="channelsLast",l=[d,p,g,r[4],r[4]];else{if(s!=="NCDHW")throw new Error("Unknown dataFormat "+s);c="channelsFirst",l=[d,p,g,r[1],r[1]]}return vc(r,l,e,n,a,!1,c,i)}function uo(r,t,e,n,a,i,s,l){s===void 0&&(s=!1),l===void 0&&(l="channelsLast");var c=[-1,-1,-1,-1],f=c[0],d=c[1],p=c[2],g=c[3];if(l==="channelsLast")f=r[0],d=r[1],p=r[2],g=r[3];else{if(l!=="channelsFirst")throw new Error("Unknown dataFormat "+l);f=r[0],g=r[1],d=r[2],p=r[3]}var v,b=t[0],w=t[1],S=t[3],x=ad(e),C=x[0],A=x[1],T=ad(n),R=T[0],O=T[1],N=du(b,R),D=du(w,O),I=function(X,Y,j,G,q,ne,L,Z){var ce,le,de;if(typeof X=="number"){var xe=X===0?"VALID":"NUMBER";ce={top:X,bottom:X,left:X,right:X,type:xe};var we=function(qe,Se,dt,Je,Pt){Je==null&&(Je=eb(qe,Se,dt));var Cn=qe[0],en=qe[1],Ft=ac((Cn-Se+2*Je)/dt+1,Pt);P(Qt(Ft),function(){return"The output # of rows ("+Ft+") must be an integer. Change the stride and/or zero pad parameters"});var Vt=ac((en-Se+2*Je)/dt+1,Pt);return P(Qt(Vt),function(){return"The output # of columns ("+Vt+") must be an integer. Change the stride and/or zero pad parameters"}),[Ft,Vt]}([Y,j],ne,G,X,Z);le=we[0],de=we[1]}else if(X==="same"){le=Math.ceil(Y/G),de=Math.ceil(j/q);var _e=Math.max(0,(le-1)*G+ne-Y),Ee=Math.max(0,(de-1)*q+L-j),ke=Math.floor(_e/2),Ue=_e-ke,Fe=Math.floor(Ee/2),rt=Ee-Fe;ce={top:ke,bottom:Ue,left:Fe,right:rt,type:"SAME"}}else{if(X!=="valid")throw Error("Unknown padding parameter: "+X);ce={top:0,bottom:0,left:0,right:0,type:"VALID"},le=Math.ceil((Y-ne+1)/G),de=Math.ceil((j-L+1)/q)}return{padInfo:ce,outHeight:le,outWidth:de}}(a,d,p,C,A,N,D,i),_=I.padInfo,F=I.outHeight,B=I.outWidth,V=s?S*g:S;return l==="channelsFirst"?v=[f,V,F,B]:l==="channelsLast"&&(v=[f,F,B,V]),{batchSize:f,dataFormat:l,inHeight:d,inWidth:p,inChannels:g,outHeight:F,outWidth:B,outChannels:V,padInfo:_,strideHeight:C,strideWidth:A,filterHeight:b,filterWidth:w,effectiveFilterHeight:N,effectiveFilterWidth:D,dilationHeight:R,dilationWidth:O,inShape:r,outShape:v,filterShape:t}}function vc(r,t,e,n,a,i,s,l){i===void 0&&(i=!1),s===void 0&&(s="channelsLast");var c=[-1,-1,-1,-1,-1],f=c[0],d=c[1],p=c[2],g=c[3],v=c[4];if(s==="channelsLast")f=r[0],d=r[1],p=r[2],g=r[3],v=r[4];else{if(s!=="channelsFirst")throw new Error("Unknown dataFormat "+s);f=r[0],v=r[1],d=r[2],p=r[3],g=r[4]}var b,w=t[0],S=t[1],x=t[2],C=t[4],A=Vv(e),T=A[0],R=A[1],O=A[2],N=Vv(n),D=N[0],I=N[1],_=N[2],F=du(w,D),B=du(S,I),V=du(x,_),X=function(L,Z,ce,le,de,xe,we,_e,Ee,ke,Ue){var Fe,rt,qe,Se;if(typeof L=="number"){var dt=L===0?"VALID":"NUMBER";Fe={top:L,bottom:L,left:L,right:L,front:L,back:L,type:dt};var Je=function(Gt,Pn,mn,Xt,pr,tr){pr==null&&(pr=eb(Gt,Pn,Xt));var $r=Gt[0],Dr=Gt[1],gn=Gt[2],Ma=ac(($r-Pn+2*pr)/Xt+1,tr);P(Qt(Ma),function(){return"The output # of depths ("+Ma+") must be an integer. Change the stride and/or zero pad parameters"});var nr=ac((Dr-Pn+2*pr)/Xt+1,tr);P(Qt(nr),function(){return"The output # of rows ("+nr+") must be an integer. Change the stride and/or zero pad parameters"});var vn=ac((gn-Pn+2*pr)/Xt+1,tr);return P(Qt(vn),function(){return"The output # of columns ("+vn+") must be an integer. Change the stride and/or zero pad parameters"}),[Ma,nr,vn,mn]}([Z,ce,le,1],_e,1,de,L,Ue);rt=Je[0],qe=Je[1],Se=Je[2]}else if(L==="same"){rt=Math.ceil(Z/de),qe=Math.ceil(ce/xe),Se=Math.ceil(le/we);var Pt=(rt-1)*de+_e-Z,Cn=(qe-1)*xe+Ee-ce,en=(Se-1)*we+ke-le,Ft=Math.floor(Pt/2),Vt=Pt-Ft,Un=Math.floor(Cn/2),Ge=Cn-Un,kt=Math.floor(en/2),Bt=en-kt;Fe={top:Un,bottom:Ge,left:kt,right:Bt,front:Ft,back:Vt,type:"SAME"}}else{if(L!=="valid")throw Error("Unknown padding parameter: "+L);Fe={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},rt=Math.ceil((Z-_e+1)/de),qe=Math.ceil((ce-Ee+1)/xe),Se=Math.ceil((le-ke+1)/we)}return{padInfo:Fe,outDepth:rt,outHeight:qe,outWidth:Se}}(a,d,p,g,T,R,O,F,B,V,l),Y=X.padInfo,j=X.outDepth,G=X.outHeight,q=X.outWidth,ne=i?C*v:C;return s==="channelsFirst"?b=[f,ne,j,G,q]:s==="channelsLast"&&(b=[f,j,G,q,ne]),{batchSize:f,dataFormat:s,inDepth:d,inHeight:p,inWidth:g,inChannels:v,outDepth:j,outHeight:G,outWidth:q,outChannels:ne,padInfo:Y,strideDepth:T,strideHeight:R,strideWidth:O,filterDepth:w,filterHeight:S,filterWidth:x,effectiveFilterDepth:F,effectiveFilterHeight:B,effectiveFilterWidth:V,dilationDepth:D,dilationHeight:I,dilationWidth:_,inShape:r,outShape:b,filterShape:t}}function eb(r,t,e,n){n===void 0&&(n=1);var a=du(t,n);return Math.floor((r[0]*(e-1)-e+a)/2)}function ad(r){return typeof r=="number"?[r,r,r]:r.length===2?[r[0],r[1],1]:r}function Vv(r){return typeof r=="number"?[r,r,r]:r}function du(r,t){return t<=1?r:r+(r-1)*(t-1)}function ac(r,t){if(!t)return r;switch(t){case"round":return Math.round(r);case"ceil":return Math.ceil(r);case"floor":return Math.floor(r);default:throw new Error("Unknown roundingMode "+t)}}function ns(r){var t=ad(r),e=t[0],n=t[1],a=t[2];return e===1&&n===1&&a===1}function Qn(r,t){return ns(r)||ns(t)}function Od(r){if(r==="NHWC")return"channelsLast";if(r==="NCHW")return"channelsFirst";throw new Error("Unknown dataFormat "+r)}function tb(r,t,e){if(t==="complex64"){if(r.dtype==="complex64")return r.clone();var n=St(r.shape),a=r.toFloat(),i=e.complex(a,n);return n.dispose(),a.dispose(),i}if(!VC(r.dtype,t))return $.makeTensorFromDataId(r.dataId,r.shape,t);if(r.dtype==="complex64"){var s=e.real(r);return i=s.cast(t),s.dispose(),i}if(t==="int32")return e.int(r);if(t==="bool"){var l=Re(0,r.dtype);return i=e.notEqual(r,l),l.dispose(),i}throw new Error("Error in Cast: failed to cast "+r.dtype+" to "+t)}function id(r,t){return $.makeTensorFromDataId(r.dataId,t,r.dtype)}function nb(r,t,e){var n=(t-r)/(e-1),a=Mu(e,"float32");a[0]=r;for(var i=1;i<a.length;i++)a[i]=a[i-1]+n;return fr(a,"float32")}var o4=Object.freeze({castTensor:tb,reshapeTensor:id,linspaceImpl:nb,upcastType:cn,axesAreInnerMostDims:Fy,combineLocations:EA,computeOutAndReduceShapes:Ln,expandShapeToKeepDim:Tr,assertAxesAreInnerMostDims:ur,getAxesPermutation:ca,getUndoAxesPermutation:Sd,getInnerMostAxes:fa,getBroadcastDims:Wo,getReductionAxes:dn,assertAndGetBroadcastShape:lt,assertParamsConsistent:CA,computeOutShape:es,computePool2DInfo:wu,computePool3DInfo:gc,computeConv2DInfo:uo,computeConv3DInfo:vc,computeDefaultPad:eb,tupleValuesAreOne:ns,eitherStridesOrDilationsAreOne:Qn,convertConv2DDataFormat:Od});function jv(r,t){if(r.length!==t.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+r.length+", imag: "+t.length+".");for(var e=new Float32Array(2*r.length),n=0;n<e.length;n+=2)e[n]=r[n/2],e[n+1]=t[n/2];return e}function nS(r,t){return{real:r[2*t],imag:r[2*t+1]}}function s4(r,t,e,n){r[2*n]=t,r[2*n+1]=e}function u4(r,t,e){var n=(e?2:-2)*Math.PI*(r/t);return{real:Math.cos(n),imag:Math.sin(n)}}function rb(r,t,e,n,a){for(var i=Array.from(t).map(function(v,b){return{score:v,boxIndex:b}}).filter(function(v){return v.score>a}).sort(function(v,b){return b.score-v.score}),s=[],l=0;l<i.length;l++){var c=i[l],f=c.score,d=c.boxIndex;if(f<a)break;for(var p=!1,g=s.length-1;g>=0;--g)if(l4(r,d,s[g])>=n){p=!0;break}if(!p&&(s.push(d),s.length>=e))break}return fr(s,"int32")}function l4(r,t,e){var n=r.subarray(4*t,4*t+4),a=r.subarray(4*e,4*e+4),i=Math.min(n[0],n[2]),s=Math.min(n[1],n[3]),l=Math.max(n[0],n[2]),c=Math.max(n[1],n[3]),f=Math.min(a[0],a[2]),d=Math.min(a[1],a[3]),p=Math.max(a[0],a[2]),g=Math.max(a[1],a[3]),v=(l-i)*(c-s),b=(p-f)*(g-d);if(v<=0||b<=0)return 0;var w=Math.max(i,f),S=Math.max(s,d),x=Math.min(l,p),C=Math.min(c,g),A=Math.max(x-w,0)*Math.max(C-S,0);return A/(v+b-A)}function HA(r,t,e){var n=new Array(r.rank).fill(0),a=r.shape.slice();return t.map(function(i){a[e]=i;var s=r.slice(n,a);return n[e]+=i,s})}function qA(r,t){for(var e=new Array(r.rank),n=0;n<e.length;n++)e[n]=r.shape[n]*t[n];var a=$e(e,r.dtype);for(n=0;n<a.values.length;++n){for(var i=a.indexToLoc(n),s=new Array(r.rank),l=0;l<s.length;l++)s[l]=i[l]%r.shape[l];var c=r.locToIndex(s);a.values[n]=r.values[c]}return a.toTensor()}function GA(r,t,e,n,a){for(var i=t[t.length-1],s=[r.length/i,i],l=s[0],c=s[1],f=uc(e,l*n),d=uc("int32",l*n),p=0;p<l;p++){for(var g=p*c,v=r.subarray(g,g+c),b=[],w=0;w<v.length;w++)b.push({value:v[w],index:w});b.sort(function(T,R){return R.value-T.value});var S=p*n,x=f.subarray(S,S+n),C=d.subarray(S,S+n);for(w=0;w<n;w++)x[w]=b[w].value,C[w]=b[w].index}var A=t.slice();return A[A.length-1]=n,[rn(f,A,e),rn(d,A,"int32")]}function ab(r,t){for(var e=[],n=0;n<t.length;n++)t[n]&&e.push(n);var a=$e(r,"int32"),i=$e([e.length,r.length],"int32");for(n=0;n<e.length;n++){var s=a.indexToLoc(e[n]),l=n*r.length;i.values.set(s,l)}return i.toTensor()}var c4=function(){return function(r,t){this.outputShape=[],this.outputShape=r,this.variableNames=t.map(function(a,i){return"T"+i});var e=[];this.variableNames.forEach(function(a){e.push("float v"+a+" = get"+a+"AtOutCoords();")});var n=this.variableNames.map(function(a){return"v"+a}).join(" + ");this.userCode=`
      void main() {
        `+e.join(`
        `)+`

        float result = `+n+`;
        setOutput(result);
      }
    `}}(),f4=function(){return function(r,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r,this.variableNames=t.map(function(a,i){return"T"+i});var e=[];this.variableNames.forEach(function(a){e.push("vec4 v"+a+" = get"+a+"AtOutCoords();")});var n=this.variableNames.map(function(a){return"v"+a}).join(" + ");this.userCode=`
      void main() {
        `+e.join(`
        `)+`

        vec4 result = `+n+`;
        setOutput(result);
      }
    `}}(),h4=function(){return function(r,t,e){this.variableNames=["A"];var n=r.windowSize,a=r.batchSize,i=r.inSize,s=Math.ceil(i/n);e||this.variableNames.push("bestIndicesA"),this.outputShape=[a,s];var l=t==="max"?">":"<",c=e?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+n+`;

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < `+n+`; i++) {
          int inIdx = `+c+`;
          float candidate = getA(batch, inIdx);
          if (candidate `+l+` bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}();function XA(r,t){return["x","y","z","w","u","v"].slice(0,t).map(function(e){return r+"."+e})}function cr(r,t){return t===1?[r]:XA(r,t)}function qn(){var r,t,e,n,a,i,s,l,c,f;return se().getNumber("WEBGL_VERSION")===2?(r="#version 300 es",t="in",e="out",n="in",a="texture",i="outputColor",s="out vec4 outputColor;",l=`
      bool isnan_custom(float val) {
        return (val > 0.0 || val < 0.0) ? false : val != 0.0;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `,c="",f=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(r="",t="attribute",e="varying",n="varying",a="texture2D",i="gl_FragColor",s="",l=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,c=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,f=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:r,attribute:t,varyingVs:e,varyingFs:n,texture2D:a,output:i,defineOutput:s,defineSpecialNaN:l,defineSpecialInf:c,defineRound:f}}function Ho(r,t,e){e===void 0&&(e="index");var n=io(t);return n.map(function(a,i){return"int "+r[i]+" = "+e+" / "+a+"; "+(i===n.length-1?"int "+r[i+1]+" = "+e+" - "+r[i]+" * "+a:"index -= "+r[i]+" * "+a)+";"}).join("")}function ib(r){var t=io(r).map(function(e){return e.toString()});return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * `+t[0]+" + coords.y * "+t[1]+` + coords.z;
  }
`}var $A=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;function d4(r,t,e,n){var a=[];r.forEach(function(v){var b=Me(v.shapeInfo.logicalShape);v.shapeInfo.isUniform?a.push("uniform float "+v.name+(b>1?"["+b+"]":"")+";"):(a.push("uniform sampler2D "+v.name+";"),a.push("uniform int offset"+v.name+";"))});var i,s,l=a.join(`
`),c=r.map(function(v){return function(b,w,S){S===void 0&&(S=!1);var x="";x+=S?KA(b):su(b);var C=b.shapeInfo.logicalShape,A=w.logicalShape;return C.length<=A.length&&(x+=S?function(T,R){var O,N=T.name,D=N.charAt(0).toUpperCase()+N.slice(1),I="get"+D+"AtOutCoords",_=T.shapeInfo.logicalShape.length,F=R.logicalShape.length,B=Wo(T.shapeInfo.logicalShape,R.logicalShape),V=Mt(F),X=F-_,Y=["x","y","z","w","u","v"];O=_===0?"":F<2&&B.length>=1?"coords = 0;":B.map(function(ce){return"coords."+Y[ce+X]+" = 0;"}).join(`
`);var j="";j=F<2&&_>0?"coords":T.shapeInfo.logicalShape.map(function(ce,le){return"coords."+Y[le+X]}).join(", ");var G="return outputValue;",q=Me(T.shapeInfo.logicalShape)===1,ne=Me(R.logicalShape)===1;if(_!==1||q||ne){if(q&&!ne)G=F===1?`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:`
        return vec4(outputValue.x);
      `;else if(B.length){var L=_-2,Z=_-1;B.indexOf(L)>-1&&B.indexOf(Z)>-1?G="return vec4(outputValue.x);":B.indexOf(L)>-1?G="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":B.indexOf(Z)>-1&&(G="return vec4(outputValue.xx, outputValue.zz);")}}else G=`
      return vec4(outputValue.xy, outputValue.xy);
    `;return`
    vec4 `+I+`() {
      `+V+` coords = getOutputCoords();
      `+O+`
      vec4 outputValue = get`+D+"("+j+`);
      `+G+`
    }
  `}(b,w):function(T,R){var O=T.name,N=O.charAt(0).toUpperCase()+O.slice(1),D="get"+N+"AtOutCoords",I=R.texShape,_=T.shapeInfo.texShape,F=T.shapeInfo.logicalShape.length,B=R.logicalShape.length;if(!T.shapeInfo.isUniform&&F===B&&T.shapeInfo.flatOffset==null&&kn(_,I))return`
      float `+D+`() {
        return sampleTexture(`+O+`, resultUV);
      }
    `;var V,X=Mt(B),Y=Wo(T.shapeInfo.logicalShape,R.logicalShape),j=B-F,G=["x","y","z","w","u","v"];V=F===0?"":B<2&&Y.length>=1?"coords = 0;":Y.map(function(ne){return"coords."+G[ne+j]+" = 0;"}).join(`
`);var q="";return q=B<2&&F>0?"coords":T.shapeInfo.logicalShape.map(function(ne,L){return"coords."+G[L+j]}).join(", "),`
    float `+D+`() {
      `+X+` coords = getOutputCoords();
      `+V+`
      return get`+N+"("+q+`);
    }
  `}(b,w)),x}(v,t,n)}).join(`
`),f=t.texShape,d=qn(),p=function(v){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return `+v.texture2D+`(textureSampler, uv).r;
    }
  `}(d),g=function(v){return v.version+`
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    `+v.varyingFs+` vec2 resultUV;
    `+v.defineOutput+`
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    `+v.defineSpecialNaN+`
    `+v.defineSpecialInf+`
    `+v.defineRound+`

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    `+p4+`
    `+m4+`
    `+g4+`
  `}(d);return t.isPacked?(i=function(v,b){switch(v.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return function(T,R){var O=[Math.ceil(R[0]/2),Math.ceil(R[1]/2)];return O[0]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * `+O[1]+`.0);
      }
    `:O[1]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * `+O[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+O[0]+", "+O[1]+`));
      return 2 * (resTexRC.x * `+O[1]+` + resTexRC.y);
    }
  `}(0,b);case 2:return function(T,R){var O=[Math.ceil(R[0]/2),Math.ceil(R[1]/2)];if(kn(T,R))return`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(`+O[0]+", "+O[1]+`));
      }
    `;var N=Math.ceil(T[1]/2);return`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+O[0]+", "+O[1]+`));

      int index = resTexRC.x * `+O[1]+` + resTexRC.y;
      int r = 2 * (index / `+N+`);
      int c = imod(index, `+N+`) * 2;

      return ivec2(r, c);
    }
  `}(v,b);case 3:return w=v,S=b,x=[Math.ceil(S[0]/2),Math.ceil(S[1]/2)],C=Math.ceil(w[2]/2),A=C*Math.ceil(w[1]/2),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+x[0]+", "+x[1]+`));
      int index = resTexRC.x * `+x[1]+` + resTexRC.y;

      int b = index / `+A+`;
      index -= b * `+A+`;

      int r = 2 * (index / `+C+`);
      int c = imod(index, `+C+`) * 2;

      return ivec3(b, r, c);
    }
  `;default:return function(T,R){for(var O=[Math.ceil(R[0]/2),Math.ceil(R[1]/2)],N=Math.ceil(T[T.length-1]/2),D=N*Math.ceil(T[T.length-2]/2),I=D,_="",F="b, r, c",B=2;B<T.length-1;B++)I*=T[T.length-B-1],_=`
      int b`+B+" = index / "+I+`;
      index -= b`+B+" * "+I+`;
    `+_,F="b"+B+", "+F;return`
    ivec`+T.length+` getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+O[0]+", "+O[1]+`));
      int index = resTexRC.x * `+O[1]+` + resTexRC.y;

      `+_+`

      int b = index / `+D+`;
      index -= b * `+D+`;

      int r = 2 * (index / `+N+`);
      int c = imod(index, `+N+`) * 2;

      return ivec`+T.length+"("+F+`);
    }
  `}(v,b)}var w,S,x,C,A}(t.logicalShape,f),s=function(v){return`
    void setOutput(vec4 val) {
      `+v.output+` = val;
    }
  `}(d)):(i=function(v,b){switch(v.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return function(x,C){return C[0]===1?`
      int getOutputCoords() {
        return int(resultUV.x * `+C[1]+`.0);
      }
    `:C[1]===1?`
      int getOutputCoords() {
        return int(resultUV.y * `+C[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+C[0]+", "+C[1]+`));
      return resTexRC.x * `+C[1]+` + resTexRC.y;
    }
  `}(0,b);case 2:return function(x,C){return kn(x,C)?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(`+C[0]+", "+C[1]+`));
      }
    `:x[1]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+C[0]+", "+C[1]+`));
        int index = resTexRC.x * `+C[1]+` + resTexRC.y;
        return ivec2(index, 0);
      }
    `:x[0]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+C[0]+", "+C[1]+`));
        int index = resTexRC.x * `+C[1]+` + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+C[0]+", "+C[1]+`));
      int index = resTexRC.x * `+C[1]+` + resTexRC.y;
      int r = index / `+x[1]+`;
      int c = index - r * `+x[1]+`;
      return ivec2(r, c);
    }
  `}(v,b);case 3:return w=b,S=Ho(["r","c","d"],v),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+w[0]+", "+w[1]+`));
      int index = resTexRC.x * `+w[1]+` + resTexRC.y;
      `+S+`
      return ivec3(r, c, d);
    }
  `;case 4:return function(x,C){var A=Ho(["r","c","d","d2"],x);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+C[0]+", "+C[1]+`));
      int index = resTexRC.x * `+C[1]+` + resTexRC.y;
      `+A+`
      return ivec4(r, c, d, d2);
    }
  `}(v,b);case 5:return function(x,C){var A=Ho(["r","c","d","d2","d3"],x);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(`+C[0]+`,
                             `+C[1]+`));

      int index = resTexRC.x * `+C[1]+` + resTexRC.y;

      `+A+`

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}(v,b);case 6:return function(x,C){var A=Ho(["r","c","d","d2","d3","d4"],x);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+C[0]+", "+C[1]+`));
      int index = resTexRC.x * `+C[1]+` + resTexRC.y;

      `+A+`

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}(v,b);default:throw new Error(v.length+"-D output sampling is not yet supported")}var w,S}(t.logicalShape,f),s=function(v){return`
    void setOutput(float val) {
      `+v.output+` = vec4(val, 0, 0, 0);
    }
  `}(d)),n&&(g+=v4),[g,p,s,l,i,c,e].join(`
`)}function su(r){var t=r.shapeInfo.logicalShape;switch(t.length){case 0:return function(e){var n=e.name,a="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return"float "+a+"() {return "+n+";}";var i=e.shapeInfo.texShape,s=i[0],l=i[1];if(s===1&&l===1)return`
      float `+a+`() {
        return sampleTexture(`+n+`, halfCR);
      }
    `;var c=e.shapeInfo.texShape,f=c[0],d=c[1],p=Mo(n);return`
    float `+a+`() {
      vec2 uv = uvFromFlat(`+f+", "+d+", "+p+`);
      return sampleTexture(`+n+`, uv);
    }
  `}(r);case 1:return function(e){var n=e.name,a="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return`
      float `+a+`(int index) {
        `+au(e)+`
      }
    `;var i=e.shapeInfo.texShape,s=i[0],l=i[1];if(l===1&&s===1)return`
      float `+a+`(int index) {
        return sampleTexture(`+n+`, halfCR);
      }
    `;var c=Mo(n);return l===1?`
      float `+a+`(int index) {
        vec2 uv = vec2(0.5, (float(index + `+c+") + 0.5) / "+s+`.0);
        return sampleTexture(`+n+`, uv);
      }
    `:s===1?`
      float `+a+`(int index) {
        vec2 uv = vec2((float(index + `+c+") + 0.5) / "+l+`.0, 0.5);
        return sampleTexture(`+n+`, uv);
      }
    `:`
    float `+a+`(int index) {
      vec2 uv = uvFromFlat(`+s+", "+l+", index + "+c+`);
      return sampleTexture(`+n+`, uv);
    }
  `}(r);case 2:return function(e){var n=e.shapeInfo.logicalShape,a=e.name,i="get"+a.charAt(0).toUpperCase()+a.slice(1),s=e.shapeInfo.texShape;if(s!=null&&kn(n,s)){var l=s[0],c=s[1];return`
    float `+i+`(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(`+c+".0, "+l+`.0);
      return sampleTexture(`+a+`, uv);
    }
  `}var f=qi(n),d=f.newShape,p=f.keptDims,g=d;if(g.length<n.length){var v=uu(e,g);return`
      `+su(v)+`
      float `+i+`(int row, int col) {
        return `+i+"("+lu(["row","col"],p)+`);
      }
    `}if(e.shapeInfo.isUniform)return`
      float `+i+`(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(`+n[1]+`, 1)));
        `+au(e)+`
      }
    `;var b=s[0],w=s[1],S=Mo(a);return w===1?`
    float `+i+`(int row, int col) {
      float index = dot(vec3(row, col, `+S+"), vec3("+n[1]+`, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / `+b+`.0);
      return sampleTexture(`+a+`, uv);
    }
  `:b===1?`
    float `+i+`(int row, int col) {
      float index = dot(vec3(row, col, `+S+"), vec3("+n[1]+`, 1, 1));
      vec2 uv = vec2((index + 0.5) / `+w+`.0, 0.5);
      return sampleTexture(`+a+`, uv);
    }
  `:`
  float `+i+`(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * `+n[1]+" + col + "+S+`;
    vec2 uv = uvFromFlat(`+b+", "+w+`, index);
    return sampleTexture(`+a+`, uv);
  }
`}(r);case 3:return function(e){var n=e.shapeInfo.logicalShape,a=e.name,i="get"+a.charAt(0).toUpperCase()+a.slice(1),s=n[1]*n[2],l=n[2],c=qi(n),f=c.newShape,d=c.keptDims,p=f;if(p.length<n.length){var g=uu(e,p);return`
        `+su(g)+`
        float `+i+`(int row, int col, int depth) {
          return `+i+"("+lu(["row","col","depth"],d)+`);
        }
      `}if(e.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(`+s+", "+l+`, 1)));
        `+au(e)+`
      }
    `;var v=e.shapeInfo.texShape,b=v[0],w=v[1],S=e.shapeInfo.flatOffset;if(w===s&&S==null)return`
        float `+i+`(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(`+l+`, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(`+w+".0, "+b+`.0);
          return sampleTexture(`+a+`, uv);
        }
      `;if(w===l&&S==null)return`
    float `+i+`(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(`+n[1]+`, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+w+".0, "+b+`.0);
      return sampleTexture(`+a+`, uv);
    }
  `;var x=Mo(a);return`
      float `+i+`(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * `+s+" + col * "+l+" + depth + "+x+`;
        vec2 uv = uvFromFlat(`+b+", "+w+`, index);
        return sampleTexture(`+a+`, uv);
      }
  `}(r);case 4:return function(e){var n=e.shapeInfo.logicalShape,a=e.name,i="get"+a.charAt(0).toUpperCase()+a.slice(1),s=n[3],l=n[2]*s,c=n[1]*l,f=qi(n),d=f.newShape,p=f.keptDims;if(d.length<n.length){var g=uu(e,d);return`
      `+su(g)+`
      float `+i+`(int row, int col, int depth, int depth2) {
        return `+i+"("+lu(["row","col","depth","depth2"],p)+`);
      }
    `}if(e.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(`+c+", "+l+", "+s+`, 1)));
        `+au(e)+`
      }
    `;var v=e.shapeInfo.flatOffset,b=e.shapeInfo.texShape,w=b[0],S=b[1];if(S===c&&v==null)return`
      float `+i+`(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(`+l+", "+s+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+S+".0, "+w+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;if(S===s&&v==null)return`
      float `+i+`(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(`+n[1]*n[2]+", "+n[2]+`, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+S+".0, "+w+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;var x=Mo(a);return`
    float `+i+`(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+c+" + col * "+l+` +
          depth * `+s+` + depth2;
      vec2 uv = uvFromFlat(`+w+", "+S+", index + "+x+`);
      return sampleTexture(`+a+`, uv);
    }
  `}(r);case 5:return function(e){var n=e.shapeInfo.logicalShape,a=e.name,i="get"+a.charAt(0).toUpperCase()+a.slice(1),s=n[4],l=n[3]*s,c=n[2]*l,f=n[1]*c,d=qi(n),p=d.newShape,g=d.keptDims;if(p.length<n.length){var v=uu(e,p);return`
      `+su(v)+`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        return `+i+"("+lu(["row","col","depth","depth2","depth3"],g)+`);
      }
    `}if(e.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(`+f+", "+c+", "+l+", "+s+`)) +
          depth3;
        `+au(e)+`
      }
    `;var b=e.shapeInfo.flatOffset,w=e.shapeInfo.texShape,S=w[0],x=w[1];if(x===f&&b==null)return`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(`+c+", "+l+", "+s+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+x+".0, "+S+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;if(x===s&&b==null)return`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(`+n[1]*n[2]*n[3]+`,
               `+n[2]*n[3]+", "+n[3]+`, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+x+".0, "+S+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;var C=Mo(a);return`
    float `+i+`(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+f+" + col * "+c+" + depth * "+l+` +
          depth2 * `+s+" + depth3 + "+C+`;
      vec2 uv = uvFromFlat(`+S+", "+x+`, index);
      return sampleTexture(`+a+`, uv);
    }
  `}(r);case 6:return function(e){var n=e.shapeInfo.logicalShape,a=e.name,i="get"+a.charAt(0).toUpperCase()+a.slice(1),s=qi(n),l=s.newShape,c=s.keptDims;if(l.length<n.length){var f=uu(e,l);return`
      `+su(f)+`
      float `+i+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return `+i+"("+lu(["row","col","depth","depth2","depth3","depth4"],c)+`);
      }
    `}var d=n[5],p=n[4]*d,g=n[3]*p,v=n[2]*g,b=n[1]*v;if(e.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(`+b+", "+v+", "+g+", "+p+`)) +
          dot(
            vec2(depth3, depth4),
            vec2(`+d+`, 1)));
        `+au(e)+`
      }
    `;var w=e.shapeInfo.flatOffset,S=e.shapeInfo.texShape,x=S[0],C=S[1];if(C===b&&w==null)return`
      float `+i+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(`+v+", "+g+", "+p+", "+d+`)) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+C+".0, "+x+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;if(C===d&&w==null)return`
      float `+i+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(`+n[1]*n[2]*n[3]*n[4]+`,
               `+n[2]*n[3]*n[4]+`,
               `+n[3]*n[4]+`,
               `+n[4]+`)) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+C+".0, "+x+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;var A=Mo(a);return`
    float `+i+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+b+" + col * "+v+" + depth * "+g+` +
          depth2 * `+p+" + depth3 * "+d+" + depth4 + "+A+`;
      vec2 uv = uvFromFlat(`+x+", "+C+`, index);
      return sampleTexture(`+a+`, uv);
    }
  `}(r);default:throw new Error(t.length+"-D input sampling is not yet supported")}}function KA(r){var t,e,n;switch(r.shapeInfo.logicalShape.length){case 0:return t=r.name,e="get"+t.charAt(0).toUpperCase()+t.slice(1),n=qn(),`
    vec4 `+e+`() {
      return `+n.texture2D+"("+t+`, halfCR);
    }
  `;case 1:return function(a){var i=a.name,s="get"+i.charAt(0).toUpperCase()+i.slice(1),l=a.shapeInfo.texShape,c=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)],f=qn();return`
    vec4 `+s+`(int index) {
      vec2 uv = packedUVfrom1D(
        `+c[0]+", "+c[1]+`, index);
      return `+f.texture2D+"("+i+`, uv);
    }
  `}(r);case 2:return function(a){var i=a.shapeInfo.logicalShape,s=a.name,l="get"+s.charAt(0).toUpperCase()+s.slice(1),c=a.shapeInfo.texShape,f=c[0],d=c[1],p=qn();if(c!=null&&kn(i,c))return`
      vec4 `+l+`(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(`+d+".0, "+f+`.0);

        return `+p.texture2D+"("+s+`, uv);
      }
    `;var g=[Math.ceil(c[0]/2),Math.ceil(c[1]/2)],v=Math.ceil(i[1]/2);return`
    vec4 `+l+`(int row, int col) {
      vec2 uv = packedUVfrom2D(`+v+", "+g[0]+", "+g[1]+`, row, col);
      return `+p.texture2D+"("+s+`, uv);
    }
  `}(r);case 3:return function(a){var i=a.shapeInfo.logicalShape,s=a.name,l="get"+s.charAt(0).toUpperCase()+s.slice(1),c=a.shapeInfo.texShape,f=[Math.ceil(c[0]/2),Math.ceil(c[1]/2)];if(i[0]===1){var d=i.slice(1),p=uu(a,d);return`
        `+KA(p)+`
        vec4 `+l+`(int b, int row, int col) {
          return `+l+"("+lu(["b","row","col"],[1,2])+`);
        }
      `}var g=f[0],v=f[1],b=Math.ceil(i[2]/2),w=b*Math.ceil(i[1]/2),S=qn();return`
    vec4 `+l+`(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        `+g+", "+v+", "+w+", "+b+`, b, row, col);
      return `+S.texture2D+"("+s+`, uv);
    }
  `}(r);default:return function(a){for(var i=a.shapeInfo.logicalShape,s=i.length,l=a.name,c="get"+l.charAt(0).toUpperCase()+l.slice(1),f=a.shapeInfo.texShape,d=[Math.ceil(f[0]/2),Math.ceil(f[1]/2)],p=d[0],g=d[1],v=Math.ceil(i[s-1]/2),b=v*Math.ceil(i[s-2]/2),w="int b, int row, int col",S="b * "+b+" + (row / 2) * "+v+" + (col / 2)",x=2;x<s-1;x++)w="int b"+x+", "+w,b*=i[s-x-1],S="b"+x+" * "+b+" + "+S;var C=qn();return`
    vec4 `+c+"("+w+`) {
      int index = `+S+`;
      int texR = index / `+g+`;
      int texC = index - texR * `+g+`;
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+g+", "+p+`);
      return `+C.texture2D+"("+l+`, uv);
    }
  `}(r)}}var p4=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,m4=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,g4=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,v4=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function Mo(r){return"offset"+r}function au(r){var t=r.name,e=Me(r.shapeInfo.logicalShape);return e<2?"return "+t+";":`
    for (int i = 0; i < `+e+`; i++) {
      if (i == index) {
        return `+t+`[i];
      }
    }
  `}function Mt(r){if(r<=1)return"int";if(r===2)return"ivec2";if(r===3)return"ivec3";if(r===4)return"ivec4";if(r===5)return"ivec5";if(r===6)return"ivec6";throw Error("GPU for rank "+r+" is not yet supported")}function uu(r,t){var e=JSON.parse(JSON.stringify(r));return e.shapeInfo.logicalShape=t,e}function lu(r,t){return t.map(function(e){return r[e]}).join(", ")}var y4=function(){return function(r,t,e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,P(r.length>2,function(){return"Packed arg"+(e.charAt(0).toUpperCase()+e.slice(1))+" supports only inputs with rank above 2."});var a=r[r.length-1],i=Math.ceil(a/t);this.outputShape=r.slice(0,-1),i>1&&this.outputShape.push(i),n||this.variableNames.push("bestIndicesA");var s,l,c=this.outputShape,f=c.length,d=Mt(f),p=cr("coords",f);if(i===1){var g=Mt(l=f+1);s=`
        `+g+" sourceLocR = "+g+"("+p.join()+`, 0);
        ++`+p[f-1]+`;
        `+g+" sourceLocG = "+g+"("+p.join()+`, 0);
        ++`+p[f-2]+`;
        `+g+" sourceLocA = "+g+"("+p.join()+`, 0);
        --`+p[f-1]+`;
        `+g+" sourceLocB = "+g+"("+p.join()+`, 0);
        --`+p[f-2]+";"}else l=f,s=`
        `+d+` sourceLocR = coords;
        ++`+p[f-1]+`;
        `+d+` sourceLocG = coords;
        ++`+p[f-2]+`;
        `+d+` sourceLocA = coords;
        --`+p[f-1]+`;
        `+d+` sourceLocB = coords;
        --`+p[f-2]+";";var v=["x","y","z","w","u","v"].slice(0,l),b="."+v[l-1],w=v.map(function(D){return"int "+D}),S=cr("sourceLocR",l-1).concat("inIdx.r"),x=cr("sourceLocG",l-1).concat("inIdx.g"),C=cr("sourceLocB",l-1).concat("inIdx.b"),A=cr("sourceLocA",l-1).concat("inIdx.a"),T=e==="max"?"greaterThan":"lessThan",R=n?"":`
          inIdx = round(vec4(getBestIndicesAChannel(`+S.join()+`),
                             getBestIndicesAChannel(`+x.join()+`),
                             getBestIndicesAChannel(`+C.join()+`),
                             getBestIndicesAChannel(`+A.join()+")));",O=`vec4(
            getAChannel(`+S.join()+`),
            hasNextCol ? getAChannel(`+x.join()+`) : 0.,
            hasNextRow ? getAChannel(`+C.join()+`) : 0.,
            hasNextRow && hasNextCol ? getAChannel(`+A.join()+") : 0.)",N=n?"":`
      float getBestIndicesAChannel(`+w.join()+`) {
        return getChannel(getBestIndicesA(`+v.join()+`),
                                          vec2(`+v.slice(-2).join()+`));
      }`;this.userCode=`
      float getAChannel(`+w.join()+`) {
        return getChannel(getA(`+v.join()+`),
                               vec2(`+v.slice(-2).join()+`));
      }
      `+N+`
      void main() {
        `+d+` coords = getOutputCoords();
        bool hasNextCol = `+p[f-1]+" < "+(c[f-1]-1)+`;
        bool hasNextRow = `+p[f-2]+" < "+(c[f-2]-1)+`;
        `+s+`
        ivec4 srcIdx = ivec4(sourceLocR`+b+", sourceLocG"+b+`,
          sourceLocB`+b+", sourceLocA"+b+") * "+t+`;
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = `+O+`;

        for (int i = 0; i < `+t+`; i++) {
          inIdx = srcIdx;
          `+R+`
          vec4 candidate = `+O+`;
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(`+T+`(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}(),b4=function(){return function(r){this.variableNames=["dy"],this.outputShape=r.inShape;var t=r.filterHeight,e=r.filterWidth,n=r.strideHeight,a=r.strideWidth,i=r.dilationHeight,s=r.dilationWidth,l=r.effectiveFilterHeight,c=r.effectiveFilterWidth,f=l-1-r.padInfo.top,d=c-1-r.padInfo.left,p=1/(t*e);this.userCode=`
      const ivec2 pads = ivec2(`+f+", "+d+`);
      const float avgMultiplier = float(`+p+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+l+`;
            wR += `+i+`) {
          float dyR = float(dyRCorner + wR) / `+n+`.0;

          if (dyR < 0.0 || dyR >= `+r.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+c+`;
            wC+= `+s+`) {
            float dyC = float(dyCCorner + wC) / `+a+`.0;

            if (dyC < 0.0 || dyC >= `+r.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}(),w4=function(){return function(r){this.variableNames=["dy"],this.outputShape=r.inShape;var t=r.filterDepth,e=r.filterHeight,n=r.filterWidth,a=r.strideDepth,i=r.strideHeight,s=r.strideWidth,l=r.dilationDepth,c=r.dilationHeight,f=r.dilationWidth,d=r.effectiveFilterDepth,p=r.effectiveFilterHeight,g=r.effectiveFilterWidth,v=d-1-r.padInfo.front,b=p-1-r.padInfo.top,w=g-1-r.padInfo.left,S=1/(t*e*n);this.userCode=`
      const ivec3 pads = ivec3(`+v+", "+b+", "+w+`);
      const float avgMultiplier = float(`+S+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+d+`;
            wD += `+l+`) {
          float dyD = float(dyDCorner + wD) / `+a+`.0;

          if (dyD < 0.0 || dyD >= `+r.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+p+`;
              wR += `+c+`) {
            float dyR = float(dyRCorner + wR) / `+i+`.0;

            if (dyR < 0.0 || dyR >= `+r.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+g+`;
                wC += `+f+`) {
              float dyC = float(dyCCorner + wC) / `+s+`.0;

              if (dyC < 0.0 || dyC >= `+r.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}(),x4=function(){return function(r,t,e,n,a,i){this.outputShape=[],this.variableNames=["x","mean","variance"],lt(r,t),lt(r,e);var s="0.0";n!=null&&(lt(r,n),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");var l="1.0";a!=null&&(lt(r,a),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=r,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = `+s+`;
        float scale = `+l+`;
        float inv = scale * inversesqrt(variance + float(`+i+`));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}(),S4=function(){return function(r,t,e,n,a,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],lt(r,t),lt(r,e);var s="vec4(0.0)";n!=null&&(lt(r,n),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");var l="vec4(1.0)";a!=null&&(lt(r,a),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=r,this.userCode=`
      void main() {
        vec4 offset = `+s+`;
        vec4 scale = `+l+`;

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(`+i+`));

        setOutput((x - mean) * inv + offset);
      }
    `}}(),E4="return areal * breal - aimag * bimag;",C4="return areal * bimag + aimag * breal;",rS=function(){return function(r,t,e){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=lt(t,e),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        `+r+`
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}(),$g="return a + b;",Kg="return a - b;",aS="return a * b;",YA="return (a < 0.) ? b * a : a;",Zt=function(){return function(r,t,e){this.variableNames=["A","B"],this.outputShape=lt(t,e),this.userCode=`
      float binaryOperation(float a, float b) {
        `+r+`
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}(),ZA=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`,Ja=function(){return function(r,t,e,n){n===void 0&&(n=!1),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=lt(t,e);var a=this.outputShape.length,i="";if(n)if(a===0||Me(this.outputShape)===1)i=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(i=`
          `+Mt(a)+` coords = getOutputCoords();
        `,a===1)i+=`
            result.y = (coords + 1) >= `+this.outputShape[0]+` ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{var s=cr("coords",a);i+=`
            bool nextRowOutOfBounds =
              (`+s[a-2]+" + 1) >= "+this.outputShape[a-2]+`;
            bool nextColOutOfBounds =
              (`+s[a-1]+" + 1) >= "+this.outputShape[a-1]+`;
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        `+r+`
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        `+i+`

        setOutput(result);
      }
    `}}(),A4=function(){function r(t){this.variableNames=["A"],this.outputShape=t,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}return r.prototype.getCustomSetupFunc=function(t,e){var n=this;return function(a,i){n.minLoc==null&&(n.minLoc=a.getUniformLocationNoThrow(i,"minVal"),n.maxLoc=a.getUniformLocationNoThrow(i,"maxVal")),a.gl.uniform1f(n.minLoc,t),a.gl.uniform1f(n.maxLoc,e)}},r}(),T4=function(){function r(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}return r.prototype.getCustomSetupFunc=function(t,e){var n=this;return function(a,i){n.minLoc==null&&(n.minLoc=a.getUniformLocationNoThrow(i,"minVal"),n.maxLoc=a.getUniformLocationNoThrow(i,"maxVal")),a.gl.uniform1f(n.minLoc,t),a.gl.uniform1f(n.maxLoc,e)}},r}(),N4=function(){return function(r){this.variableNames=["real","imag"],this.outputShape=r,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}(),R4=function(){return function(r){this.outputShape=[],this.outputShape=es(r,1),this.variableNames=r.map(function(l,c){return"T"+c});var t=new Array(r.length-1);t[0]=r[0][1];for(var e=1;e<t.length;e++)t[e]=t[e-1]+r[e][1];var n=["if (yC < "+t[0]+") setOutput(getT0(yR, yC));"];for(e=1;e<t.length;e++){var a=t[e-1];n.push("else if (yC < "+t[e]+") setOutput(getT"+e+"(yR, yC-"+a+"));")}var i=t.length,s=t[t.length-1];n.push("else setOutput(getT"+i+"(yR, yC-"+s+"));"),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        `+n.join(`
        `)+`
      }
    `}}(),I4=function(){return function(r,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=es(r,t);var e=this.outputShape,n=e.length,a=Mt(n),i=cr("coords",n),s=["x","y","z","w","u","v"].slice(0,n);this.variableNames=r.map(function(S,x){return"T"+x});var l=new Array(r.length-1);l[0]=r[0][t];for(var c=1;c<l.length;c++)l[c]=l[c-1]+r[c][t];var f=s[t],d=s.slice(-2),p=s.join(),g="if ("+f+" < "+l[0]+`) {
        return getChannel(
            getT0(`+p+"), vec2("+d.join()+`));
        }`;for(c=1;c<l.length;c++){var v=l[c-1];g+=`
        if (`+f+" < "+l[c]+"  && "+f+" >= "+l[c-1]+`) {
          return getChannel(
            getT`+c+"("+mh(s,f,v)+`),
            vec2(`+mh(d,f,v)+`));
        }`}var b=l.length,w=l[l.length-1];g+=`
        return getChannel(
          getT`+b+"("+mh(s,f,w)+`),
          vec2(`+mh(d,f,w)+"));",this.userCode=`
      float getValue(`+s.map(function(S){return"int "+S})+`) {
        `+g+`
      }

      void main() {
        `+a+` coords = getOutputCoords();
        vec4 result = vec4(getValue(`+i+`), 0., 0., 0.);

        `+i[n-1]+" = "+i[n-1]+` + 1;
        if (`+i[n-1]+" < "+e[n-1]+`) {
          result.g = getValue(`+i+`);
        }

        `+i[n-2]+" = "+i[n-2]+` + 1;
        if (`+i[n-2]+" < "+e[n-2]+`) {
          result.a = getValue(`+i+`);
        }

        `+i[n-1]+" = "+i[n-1]+` - 1;
        if (`+i[n-2]+" < "+e[n-2]+` &&
            `+i[n-1]+" < "+e[n-1]+`) {
          result.b = getValue(`+i+`);
        }
        setOutput(result);
      }
    `}}();function mh(r,t,e){var n=r.indexOf(t);return r.map(function(a,i){return i===n?a+" - "+e:a}).join()}var k4=function(){return function(r){this.variableNames=["x","dy"],this.outputShape=r.filterShape;var t=r.strideHeight,e=r.strideWidth,n=r.padInfo.top,a=r.padInfo.left,i=r.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < `+r.batchSize+`; b++) {
          for (int yR = 0; yR < `+r.outHeight+`; yR++) {
            int xR = wR + yR * `+t+" - "+n+`;

            if (xR < 0 || xR >= `+r.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+r.outWidth+`; yC++) {
              int xC = wC + yC * `+e+" - "+a+`;

              if (xC < 0 || xC >= `+r.inWidth+`) {
                continue;
              }

              if (`+i+`) {
                float dyValue = getDy(b, yR, yC, d2);
                float xValue = getX(b, xR, xC, d1);
                dotProd += (xValue * dyValue);
              } else {
                float dyValue = getDy(b, d2, yR, yC);
                float xValue = getX(b, d1, xR, xC);
                dotProd += (xValue * dyValue);
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}(),D4=function(){return function(r){this.variableNames=["dy","W"],this.outputShape=r.inShape;var t=r.filterHeight,e=r.filterWidth,n=r.strideHeight,a=r.strideWidth,i=r.dataFormat==="channelsLast",s=t-1-r.padInfo.top,l=e-1-r.padInfo.left,c=i?1:2,f=i?2:3,d=i?3:1;this.userCode=`
      const ivec2 pads = ivec2(`+s+", "+l+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[`+d+`];

        ivec2 dyCorner = ivec2(coords[`+c+"], coords["+f+`]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+t+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+n+`.0;

          if (dyR < 0.0 || dyR >= `+r.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+t+` - 1 - wR;

          for (int wC = 0; wC < `+e+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+a+`.0;

            if (dyC < 0.0 || dyC >= `+r.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+e+` - 1 - wC;

            for (int d2 = 0; d2 < `+r.outChannels+`; d2++) {

              if (`+i+`) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}(),O4=function(){return function(r){this.variableNames=["x","dy"],this.outputShape=r.filterShape;var t=r.strideDepth,e=r.strideHeight,n=r.strideWidth,a=r.padInfo.front,i=r.padInfo.top,s=r.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < `+r.batchSize+`; b++) {
          for (int yF = 0; yF < `+r.outDepth+`; yF++) {
            int xF = wF + yF * `+t+" - "+a+`;

            if (xF < 0 || xF >= `+r.inDepth+`) {
              continue;
            }

            for (int yR = 0; yR < `+r.outHeight+`; yR++) {
              int xR = wR + yR * `+e+" - "+i+`;

              if (xR < 0 || xR >= `+r.inHeight+`) {
                continue;
              }

              for (int yC = 0; yC < `+r.outWidth+`; yC++) {
                int xC = wC + yC * `+n+" - "+s+`;

                if (xC < 0 || xC >= `+r.inWidth+`) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}(),_4=function(){return function(r){this.variableNames=["dy","W"],this.outputShape=r.inShape;var t=r.filterDepth,e=r.filterHeight,n=r.filterWidth,a=r.strideDepth,i=r.strideHeight,s=r.strideWidth,l=t-1-r.padInfo.front,c=e-1-r.padInfo.top,f=n-1-r.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(`+l+", "+c+", "+f+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < `+t+`; wF++) {
          float dyF = float(dyFCorner + wF) / `+a+`.0;

          if (dyF < 0.0 || dyF >= `+r.outDepth+`.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = `+t+` - 1 - wF;

          for (int wR = 0; wR < `+e+`; wR++) {
            float dyR = float(dyRCorner + wR) / `+i+`.0;

            if (dyR < 0.0 || dyR >= `+r.outHeight+`.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = `+e+` - 1 - wR;

            for (int wC = 0; wC < `+n+`; wC++) {
              float dyC = float(dyCCorner + wC) / `+s+`.0;

              if (dyC < 0.0 || dyC >= `+r.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = `+n+` - 1 - wC;

              for (int d2 = 0; d2 < `+r.outChannels+`; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}(),M4=function(){return function(r){this.variableNames=["x","dy"],this.outputShape=r.filterShape;var t=r.strideHeight,e=r.strideWidth,n=r.padInfo.top,a=r.padInfo.left,i=r.outChannels/r.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * `+i+` + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < `+r.batchSize+`; b++) {
          for (int yR = 0; yR < `+r.outHeight+`; yR++) {
            int xR = wR + yR * `+t+" - "+n+`;

            if (xR < 0 || xR >= `+r.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+r.outWidth+`; yC++) {
              int xC = wC + yC * `+e+" - "+a+`;

              if (xC < 0 || xC >= `+r.inWidth+`) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}(),z4=function(){return function(r){this.variableNames=["dy","W"],this.outputShape=r.inShape;var t=r.filterHeight,e=r.filterWidth,n=r.strideHeight,a=r.strideWidth,i=t-1-r.padInfo.top,s=e-1-r.padInfo.left,l=r.outChannels/r.inChannels;this.userCode=`
      const ivec2 pads = ivec2(`+i+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < `+t+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+n+`.0;

          if (dyR < 0.0 || dyR >= `+r.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+t+` - 1 - wR;

          for (int wC = 0; wC < `+e+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+a+`.0;

            if (dyC < 0.0 || dyC >= `+r.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+e+` - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < `+l+`; dm++) {
              int d2 = d1 * `+l+` + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}(),iS=function(){return function(r,t,e,n){t===void 0&&(t=!1),e===void 0&&(e=null),n===void 0&&(n=!1),this.variableNames=["x","W"],this.outputShape=r.outShape;var a=r.padInfo.top,i=r.padInfo.left,s=r.strideHeight,l=r.strideWidth,c=r.dilationHeight,f=r.dilationWidth,d=r.filterHeight,p=r.filterWidth,g=4*Math.floor(r.inChannels/4),v=r.inChannels%4,b=r.dataFormat==="channelsLast",w=b?1:2,S=b?2:3,x=b?3:1,C="",A="";e&&(C=n?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+e+`
        }`:`
          float activation(float x) {
            `+e+`
          }
        `,A="result = activation(result);");var T=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),n&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+C+`

      const ivec2 strides = ivec2(`+s+", "+l+`);
      const ivec2 pads = ivec2(`+a+", "+i+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[`+x+`];

        ivec2 xRCCorner =
            ivec2(coords[`+w+"], coords["+S+`]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+d+`; wR++) {
          int xR = xRCorner + wR * `+c+`;

          if (xR < 0 || xR >= `+r.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+p+`; wC++) {
            int xC = xCCorner + wC * `+f+`;

            if (xC < 0 || xC >= `+r.inWidth+`) {
              continue;
            }

            for (int d1 = 0; d1 < `+g+`; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (`+b+`) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (`+(v===1)+`) {

              if (`+b+`) {
                dotProd +=
                    getX(batch, xR, xC, `+g+`) *
                    getW(wR, wC, `+g+`, d2);
              } else {
                dotProd +=
                    getX(batch, `+g+`, xR, xC) *
                    getW(wR, wC, `+g+`, d2);
              }

            } else if (`+(v===2)+`) {
              vec2 wValues = vec2(
                getW(wR, wC, `+g+`, d2),
                getW(wR, wC, `+g+` + 1, d2)
              );

              if (`+b+`) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, `+g+`),
                  getX(batch, xR, xC, `+g+` + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, `+g+`, xR, xC),
                  getX(batch, `+g+` + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (`+(v===3)+`) {
              vec3 wValues = vec3(
                getW(wR, wC, `+g+`, d2),
                getW(wR, wC, `+g+` + 1, d2),
                getW(wR, wC, `+g+` + 2, d2)
              );

              if (`+b+`) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, `+g+`),
                  getX(batch, xR, xC, `+g+` + 1),
                  getX(batch, xR, xC, `+g+` + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, `+g+`, xR, xC),
                  getX(batch, `+g+` + 1, xR, xC),
                  getX(batch, `+g+` + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        `+T+`
        `+A+`
        setOutput(result);
      }
    `}}(),L4=function(){return function(r){this.variableNames=["x","W"],this.outputShape=r.outShape;var t=r.padInfo.front,e=r.padInfo.top,n=r.padInfo.left,a=r.strideDepth,i=r.strideHeight,s=r.strideWidth,l=r.dilationDepth,c=r.dilationHeight,f=r.dilationWidth,d=r.filterDepth,p=r.filterHeight,g=r.filterWidth,v=4*Math.floor(r.inChannels/4),b=r.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(`+a+", "+i+", "+s+`);
      const ivec3 pads = ivec3(`+t+", "+e+", "+n+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < `+d+`; wF++) {
          int xF = xFCorner + wF * `+l+`;

          if (xF < 0 || xF >= `+r.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+p+`; wR++) {
            int xR = xRCorner + wR * `+c+`;

            if (xR < 0 || xR >= `+r.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+g+`; wC++) {
              int xC = xCCorner + wC * `+f+`;

              if (xC < 0 || xC >= `+r.inWidth+`) {
                continue;
              }

              for (int d1 = 0; d1 < `+v+`; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (`+(b===1)+`) {
                dotProd +=
                  getX(batch, xF, xR, xC, `+v+`) *
                  getW(wF, wR, wC, `+v+`, d2);
              } else if (`+(b===2)+`) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, `+v+`),
                  getX(batch, xF, xR, xC, `+v+` + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, `+v+`, d2),
                  getW(wF, wR, wC, `+v+` + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (`+(b===3)+`) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, `+v+`),
                  getX(batch, xF, xR, xC, `+v+` + 1),
                  getX(batch, xF, xR, xC, `+v+` + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, `+v+`, d2),
                  getW(wF, wR, wC, `+v+` + 1, d2),
                  getW(wF, wR, wC, `+v+` + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}(),oS=function(){return function(r,t,e,n){t===void 0&&(t=!1),e===void 0&&(e=null),n===void 0&&(n=!1),this.variableNames=["x","W"],this.outputShape=r.outShape;var a=r.inHeight,i=r.inWidth,s=r.padInfo.top,l=r.padInfo.left,c=r.strideHeight,f=r.strideWidth,d=r.dilationHeight,p=r.dilationWidth,g=r.filterHeight,v=r.filterWidth,b=r.outChannels/r.inChannels,w="",S="";e&&(w=n?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+e+`
        }`:`
          float activation(float x) {
            `+e+`
          }
        `,S="result = activation(result);");var x=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),n&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+w+`

      const ivec2 strides = ivec2(`+c+", "+f+`);
      const ivec2 pads = ivec2(`+s+", "+l+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / `+b+`;
        int q = d2 - d1 * `+b+`;

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < `+g+`; wR++) {
          int xR = xRCorner + wR * `+d+`;

          if (xR < 0 || xR >= `+a+`) {
            continue;
          }

          for (int wC = 0; wC < `+v+`; wC++) {
            int xC = xCCorner + wC * `+p+`;

            if (xC < 0 || xC >= `+i+`) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        `+x+`
        `+S+`
        setOutput(result);
      }
    `}}(),sS=function(){return function(r,t,e,n){t===void 0&&(t=!1),e===void 0&&(e=null),n===void 0&&(n=!1),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r.outShape;for(var a=r.inHeight,i=r.inWidth,s=r.padInfo.top,l=r.padInfo.left,c=r.strideHeight,f=r.strideWidth,d=r.dilationHeight,p=r.dilationWidth,g=r.filterHeight,v=r.filterWidth,b=v,w="int xR; int xC; int xCOffset;",S=0;S<g;S++)for(var x=0;x<v;x++)w+=`
          vec4 xTexelR`+S+"C"+2*x+` = vec4(0.);
          vec4 wR`+S+"C"+x+` = vec4(0.);
          vec4 xR`+S+"C"+x+" = vec4(0.);";for(S=0;S<g;S++)for(var C=0;C<b;C++){if(w+=`
          xR = xRCorner + `+S*d+`;
          xC = xCCorner + `+(x=2*C)*p+`;
        `,f===1){if(x<v&&(w+=l%2==1?`
                xCOffset = xC + 1;
                if(xR >= 0 && xR < `+a+" && xCOffset >= 0 && xCOffset < "+i+`) {
                  xTexelR`+S+"C"+x+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+S+"C"+x+` = vec4(0.);
                }

                xCOffset = xC + 1 - 2;
                if(xR >= 0 && xR < `+a+" && xCOffset >= 0 && xCOffset < "+i+`) {
                  vec4 previous = getX(batch, xR, xCOffset, d1);
                  xR`+S+"C"+x+" = vec4(previous.zw, xTexelR"+S+"C"+x+`.xy);
                } else {
                  xR`+S+"C"+x+" = vec4(0, 0, xTexelR"+S+"C"+x+`.xy);
                }
              `:`
                if(xR >= 0 && xR < `+a+" && xC >= 0 && xC < "+i+`) {
                  xTexelR`+S+"C"+x+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+S+"C"+x+` = vec4(0.);
                }

                xR`+S+"C"+x+" = xTexelR"+S+"C"+x+`;
              `,x+1<v)){var A=l%2==0?ky(p):p;p%2==0&&l%2==1||p%2!=0&&l%2!=1?(w+=`
                  xCOffset = xC + `+l%2+" + "+A+`;

                  if(xR >= 0 && xR < `+a+` &&
                    xCOffset >= 0 && xCOffset < `+i+`) {
                    xTexelR`+S+"C"+(x+2)+` = getX(batch, xR, xCOffset, d1);
                  }
                `,p>1&&(w+=`
                    xCOffset -= 2;
                    if(xR >= 0 && xR < `+a+` &&
                      xCOffset >= 0 && xCOffset < `+i+`) {
                      xTexelR`+S+"C"+x+` = getX(batch, xR, xCOffset, d1);
                    } else {
                      xTexelR`+S+"C"+x+` = vec4(0.);
                    }
                  `),w+=`
                  xR`+S+"C"+(x+1)+` = vec4(
                    xTexelR`+S+"C"+x+".zw, xTexelR"+S+"C"+(x+2)+`.xy);
                `):w+=`
                  xCOffset = xC + `+A+`;

                  if(xR >= 0 && xR < `+a+` &&
                    xCOffset >= 0 && xCOffset < `+i+`) {
                    xTexelR`+S+"C"+(x+2)+` = getX(batch, xR, xCOffset, d1);
                  }

                  xR`+S+"C"+(x+1)+" = xTexelR"+S+"C"+(x+2)+`;
                `}}else x<v&&(w+=`
              if(xR >= 0 && xR < `+a+`) {
            `,l%2==1?(w+=`
                xCOffset = xC + 1 - `+f+`;
                if(xCOffset >= 0 && xCOffset < `+i+`) {
                  xTexelR`+S+"C"+x+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+S+"C"+x+` = vec4(0.);
                }

                if(xC + 1 >= 0 && xC + 1 < `+i+`) {
                  xTexelR`+S+"C"+(x+2)+` = getX(batch, xR, xC + 1, d1);
                } else {
                  xTexelR`+S+"C"+(x+2)+` = vec4(0.);
                }

                xR`+S+"C"+x+` = vec4(
                  xTexelR`+S+"C"+x+".zw, xTexelR"+S+"C"+(x+2)+`.zw);
              `,x+1<v&&(w+=`
                  vec4 final = vec4(0.);
                  xCOffset = xC + 1 + `+f+`;
                  if(xCOffset >= 0 && xCOffset < `+i+`) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xR`+S+"C"+(x+1)+" = vec4(xTexelR"+S+"C"+(x+2)+`.xy, final.xy);
                `)):(w+=`
                if(xC >= 0 && xC < `+i+`) {
                  xTexelR`+S+"C"+x+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+S+"C"+x+` = vec4(0.);
                }

                xCOffset = xC + `+f+`;
                if(xCOffset >= 0 && xCOffset < `+i+`) {
                  xTexelR`+S+"C"+(x+2)+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+S+"C"+(x+2)+` = vec4(0.);
                }

                xR`+S+"C"+x+` = vec4(
                  xTexelR`+S+"C"+x+".xy, xTexelR"+S+"C"+(x+2)+`.xy);
              `,x+1<v&&(w+=`
                  xR`+S+"C"+(x+1)+` = vec4(
                    xTexelR`+S+"C"+x+".zw, xTexelR"+S+"C"+(x+2)+`.zw);
                `)),w+="}");x<v&&(w+=`
            vec4 wTexelR`+S+"C"+x+" = getW("+S+", "+x+`, d1, q);
            wR`+S+"C"+x+" = vec4(wTexelR"+S+"C"+x+".xz, wTexelR"+S+"C"+x+`.xz);
          `,x+1<v&&(w+=`
              vec4 wTexelR`+S+"C"+(x+1)+" = getW("+S+", "+(x+1)+`, d1, q);
              wR`+S+"C"+(x+1)+` =
                vec4(wTexelR`+S+"C"+(x+1)+".xz, wTexelR"+S+"C"+(x+1)+".xz);"))}for(S=0;S<g;S++)for(x=0;x<v;x++)w+="dotProd += xR"+S+"C"+x+" * wR"+S+"C"+x+";";var T="",R="";e&&(T=n?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+e+`
        }`:`vec4 activation(vec4 x) {
          `+e+`
        }`,R="result = activation(result);");var O=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),n&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+T+`

      const ivec2 strides = ivec2(`+c+", "+f+`);
      const ivec2 pads = ivec2(`+s+", "+l+`);

      void main() {

        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2;
        int q = 0;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        vec4 dotProd = vec4(0.);

        `+w+`

        vec4 result = dotProd;
        `+O+`
        `+R+`
        setOutput(result);
      }
    `}}(),F4=function(){return function(r,t,e,n,a){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var i=r[0],s=r[1],l=r[2],c=r[3],f=t[0],d=e[0],p=e[1];this.outputShape=[f,d,p,c];var g=n==="bilinear"?1:0,v=[s-1+".0",l-1+".0"],b=v[0],w=v[1],S=d>1?[""+(s-1)/(d-1),"(y2-y1) * height_ratio","y1*"+b+" + float(y)*(height_scale)"]:["0.0","0.0","0.5 * (y1+y2) * "+b],x=S[0],C=S[1],A=S[2],T=p>1?[""+(l-1)/(p-1),"(x2-x1) * width_ratio","x1*"+w+" + float(x)*(width_scale)"]:["0.0","0.0","0.5 * (x1+x2) * "+w],R=T[0],O=T[1],N=T[2];this.userCode=`
      const float height_ratio = float(`+x+`);
      const float width_ratio = float(`+R+`);
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= `+i+`) {
          return;
        }

        float height_scale = `+C+`;
        float width_scale = `+O+`;

        float in_y = `+A+`;
        if( in_y < 0.0 || in_y > `+b+` ) {
          setOutput(float(`+a+`));
          return;
        }
        float in_x = `+N+`;
        if( in_x < 0.0 || in_x > `+w+` ) {
          setOutput(float(`+a+`));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(`+g+` == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}(),B4=function(){return function(r,t,e){this.variableNames=["x"],this.outputShape=r;var n=r.length,a=r[r.length-1],i=e?"<":">";this.userCode=`
      int getIndex(int i) {
        `+(e?"return "+a+" -i - 1;":"return i;")+`
      }

      void main() {
        `+Mt(n)+` coords = getOutputCoords();
        int end = `+uS(n,"coords")+`;
        float val = 0.0;
        for (int i = `+a+` - 1; i >= 0; i -= 1) {
          int idx = getIndex(i);
          if (idx `+i+` end) {
            continue;
          }
          if (idx == end && `+t+`) {
            continue;
          }
          `+uS(n,"coords")+` = idx;
          val += getX(`+function(s,l){if(s===1)return""+l;if(s===2)return l+".x, "+l+".y";if(s===3)return l+".x, "+l+".y, "+l+".z";if(s===4)return l+".x, "+l+".y, "+l+".z, "+l+".w";throw Error("Cumulative sum for rank "+s+" is not yet supported")}(n,"coords")+`);
        }
        setOutput(val);
      }
    `}}();function uS(r,t){if(r===1)return""+t;if(r===2)return t+".y";if(r===3)return t+".z";if(r===4)return t+".w";throw Error("Cumulative sum for rank "+r+" is not yet supported")}var U4=function(){return function(r){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=hc.DENSE;var t=rc(r),e=qn();this.outputShape=r,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+Ho(["r","c","d"],r)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+t[0]+", "+t[1]+`));
        int index = 4 * (resTexRC.x * `+t[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        `+e.output+` = result;
      }
    `}}(),P4=function(){return function(r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=hc.DENSE;var t=rc(r),e=qn();this.outputShape=r,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+Ho(["r","c","d"],r)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+t[0]+", "+t[1]+`));
        int index = 4 * (resTexRC.x * `+t[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        `+e.output+` = result;
      }
    `}}(),V4=function(){function r(t,e,n){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=e,this.dataFormat=n,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = `+this.getHeightCoordString()+`;
      int w = `+this.getWidthCoordString()+`;
      int d = `+this.getDepthCoordString()+`;

      int in_h = h / `+e+`;
      int offset_h = imod(h, `+e+`);
      int in_w = w / `+e+`;
      int offset_w = imod(w, `+e+`);
      int offset_d = (offset_h * `+e+` + offset_w) *
        `+this.getOutputDepthSize()+`;
      int in_d = d + offset_d;

      float result = `+this.getInputSamplingString()+`;
      setOutput(result);
    }
  `}return r.prototype.getHeightCoordString=function(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"},r.prototype.getWidthCoordString=function(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"},r.prototype.getDepthCoordString=function(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"},r.prototype.getOutputDepthSize=function(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]},r.prototype.getInputSamplingString=function(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"},r}(),j4=function(){return function(r){this.variableNames=["X"],this.outputShape=[r,r],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}(),W4=function(){return function(r){this.variableNames=["A"],this.outTexUsage=Er.DOWNLOAD;var t=qn();this.outputShape=r,this.userCode=`
      `+$A+`

      void main() {
        float x = getAAtOutCoords();
        `+t.output+` = encode_float(x);
      }
    `}}(),H4=function(){return function(r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Er.DOWNLOAD;var t=qn();this.outputShape=r,this.userCode=`
      `+$A+`

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        `+t.output+` = encode_float(x);
      }
    `}}(),q4=function(){return function(r,t,e){e===void 0&&(e=!1),this.variableNames=["A"];var n=qn(),a=t[0],i=t[1];this.outputShape=r;var s="result";e&&(s="floor(result * 255. + 0.5)"),this.userCode=`
      `+ib(r)+`

      void main() {
        ivec3 coords = getOutputCoords();

        int flatIndex = getFlatIndex(coords);
        int offset = imod(flatIndex, 4);

        flatIndex = idiv(flatIndex, 4, 1.);
        
        int r = flatIndex / `+i+`;
        int c = imod(flatIndex, `+i+`);
        vec2 uv = (vec2(c, r) + halfCR) / vec2(`+i+".0, "+a+`.0);
        vec4 values = `+n.texture2D+`(A, uv);

        float result;

        if(offset == 0) {
          result = values[0];
        } else if(offset == 1) {
          result = values[1];
        } else if(offset == 2) {
          result = values[2];
        } else {
          result = values[3];
        }

        `+n.output+" = vec4("+s+`, 0., 0., 0.);
      }
    `}}(),G4=function(){return function(r,t,e){e===void 0&&(e=!1),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var n=qn(),a=t[0],i=t[1];this.outputShape=r;var s="",l="result";e&&(l="floor(result * 255. + 0.5)");for(var c=0;c<=1;c++)for(var f=0;f<=1;f++){var d=2*c+f;s+=`
          localCoords = coords;
          if(localCoords[2] + `+f+" < "+r[2]+`) {
            localCoords[2] += `+f+`;
            if(localCoords[1] + `+c+" < "+r[1]+`) {
              localCoords[1] += `+c+`;

              flatIndex = getFlatIndex(localCoords);
              offset = imod(flatIndex, 4);

              flatIndex = idiv(flatIndex, 4, 1.);

              r = flatIndex / `+i+`;
              c = imod(flatIndex, `+i+`);
              uv = (vec2(c, r) + halfCR) / vec2(`+i+".0, "+a+`.0);
              values = `+n.texture2D+`(A, uv);

              if(offset == 0) {
                result[`+d+`] = values[0];
              } else if(offset == 1) {
                result[`+d+`] = values[1];
              } else if(offset == 2) {
                result[`+d+`] = values[2];
              } else {
                result[`+d+`] = values[3];
              }
            }
          }
        `}this.userCode=`
      `+ib(r)+`

      void main() {
        ivec3 coords = getOutputCoords();

        vec4 result = vec4(0.);
        int flatIndex, r, c, offset;
        ivec3 localCoords;
        vec2 uv;
        vec4 values;

        `+s+`

        `+n.output+" = "+l+`;
      }
    `}}(),X4="return real * expR - imag * expI;",$4="return real * expI + imag * expR;",lS=function(){return function(r,t,e){this.variableNames=["real","imag"];var n=t[1];this.outputShape=t;var a=e?"2.0 * "+Math.PI:"-2.0 * "+Math.PI,i=e?n+".0":"1.0";this.userCode=`
      const float exponentMultiplier = `+a+`;

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        `+r+`
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(`+n+`);
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < `+n+`; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / `+i+`;
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}(),K4=function(){function r(t,e){this.outputShape=[],this.variableNames=["x"],this.outputShape=t,this.userCode=`
      uniform float value;
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}return r.prototype.getCustomSetupFunc=function(t){var e=this;return function(n,a){e.valueLoc==null&&(e.valueLoc=n.getUniformLocationNoThrow(a,"value")),n.gl.uniform1f(e.valueLoc,t)}},r}(),Y4=function(){return function(r){this.variableNames=["A"];var t=qn(),e=r[0],n=r[1];this.outputShape=r,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+n+".0, "+e+`.0);

        vec4 values = `+t.texture2D+`(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}(),Z4=function(){return function(r){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var t=qn(),e=r[0],n=r[1];this.outputShape=r,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(`+n+".0, "+e+`.0);
            vec4 values = `+t.texture2D+`(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        `+t.output+` = result;
      }
    `}}(),Q4=function(){return function(r,t,e){this.variableNames=["A","indices"];var n=r.slice();n[e]=t,this.outputShape=n,this.rank=n.length;var a=Mt(this.rank),i=function(s,l){var c=s.length;if(c>4)throw Error("Gather for rank "+c+" is not yet supported");if(c===1)return"int(getIndices(resRC))";for(var f=["resRC.x","resRC.y","resRC.z","resRC.w"],d=[],p=0;p<s.length;p++)p===l?d.push("int(getIndices("+f[p]+"))"):d.push(""+f[p]);return d.join()}(r,e);this.userCode=`
      void main() {
        `+a+` resRC = getOutputCoords();
        setOutput(getA(`+i+`));
      }
    `}}(),J4=function(){return function(r,t,e){this.sliceDim=r,this.strides=t,this.variableNames=["x","indices"],this.outputShape=e;var n=Mt(t.length),a=Mt(e.length),i=this.sliceDim>1?"strides[j]":"strides";this.userCode=`
        `+n+" strides = "+n+"("+this.strides+`);
         void main() {
          `+a+` coords = getOutputCoords();
          int flattenIndex = 0;
          for (int j = 0; j < `+this.sliceDim+`; j++) {
            int index = round(getIndices(coords[0], j));
            flattenIndex += index * `+i+`;
          }
          setOutput(getX(flattenIndex, coords[1]));
        }
      `}}();function QA(r,t){var e=qn();return eA(r,t,e.version+`
    precision highp float;
    `+e.attribute+` vec3 clipSpacePos;
    `+e.attribute+` vec2 uv;
    `+e.varyingVs+` vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`)}function JA(r,t){return aA(r,t,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function eT(r,t){return iA(r,t,new Uint16Array([0,1,2,2,1,3]))}function Oc(r,t,e,n,a,i,s){sA(e,n);var l=oA(r,t),c=r.TEXTURE_2D;return Ne(r,t,function(){return r.bindTexture(c,l)}),Ne(r,t,function(){return r.texParameteri(c,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE)}),Ne(r,t,function(){return r.texParameteri(c,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE)}),Ne(r,t,function(){return r.texParameteri(c,r.TEXTURE_MIN_FILTER,r.NEAREST)}),Ne(r,t,function(){return r.texParameteri(c,r.TEXTURE_MAG_FILTER,r.NEAREST)}),Ne(r,t,function(){return r.texImage2D(c,0,a,e,n,0,i,s,null)}),Ne(r,t,function(){return r.bindTexture(r.TEXTURE_2D,null)}),l}function tT(r,t,e,n,a){var i=wd(e,n);return Oc(r,t,i[0],i[1],a.internalFormatFloat,a.textureFormatFloat,r.FLOAT)}function nT(r,t,e,n,a){var i=wd(e,n);return Oc(r,t,i[0],i[1],a.internalFormatHalfFloat,a.textureFormatFloat,a.textureTypeHalfFloat)}function rT(r,t,e,n,a){var i=wd(e,n);return Oc(r,t,i[0],i[1],r.RGBA,r.RGBA,r.UNSIGNED_BYTE)}function aT(r,t,e,n,a){var i=Rc(e,n);return Oc(r,t,i[0],i[1],a.internalFormatPackedFloat,r.RGBA,r.FLOAT)}function iT(r,t,e,n,a){var i=Rc(e,n);return Oc(r,t,i[0],i[1],a.internalFormatPackedHalfFloat,r.RGBA,a.textureTypeHalfFloat)}function oT(r,t,e,n){return Ne(r,t,function(){return r.bindBuffer(r.ARRAY_BUFFER,n)}),Mv(r,t,e,"clipSpacePos",n,3,20,0)&&Mv(r,t,e,"uv",n,2,20,12)}function sT(r,t,e,n,a,i,s){var l,c,f;Ne(r,t,function(){return r.bindTexture(r.TEXTURE_2D,e)}),i instanceof Uint8Array?(l=new Uint8Array(n*a*4),c=r.UNSIGNED_BYTE,f=r.RGBA):(l=new Float32Array(n*a*4),c=r.FLOAT,f=s.internalFormatPackedFloat),l.set(i),Ne(r,t,function(){return r.texImage2D(r.TEXTURE_2D,0,f,n,a,0,r.RGBA,c,l)}),Ne(r,t,function(){return r.bindTexture(r.TEXTURE_2D,null)})}function uT(r,t,e,n){Ne(r,t,function(){return r.bindTexture(r.TEXTURE_2D,e)}),n.data instanceof Uint8Array?Ne(r,t,function(){return r.texImage2D(r.TEXTURE_2D,0,r.RGBA,n.width,n.height,0,r.RGBA,r.UNSIGNED_BYTE,n.data)}):Ne(r,t,function(){return r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,n)}),Ne(r,t,function(){return r.bindTexture(r.TEXTURE_2D,null)})}function lT(r,t,e,n,a){var i=r.createBuffer();Ne(r,t,function(){return r.bindBuffer(r.PIXEL_PACK_BUFFER,i)});var s=16*e*n;return Ne(r,t,function(){return r.bufferData(r.PIXEL_PACK_BUFFER,s,r.STREAM_READ)}),Ne(r,t,function(){return r.readPixels(0,0,n,e,r.RGBA,r.FLOAT,0)}),Ne(r,t,function(){return r.bindBuffer(r.PIXEL_PACK_BUFFER,null)}),i}function cT(r,t,e){var n=r,a=new Float32Array(e);return n.bindBuffer(n.PIXEL_PACK_BUFFER,t),n.getBufferSubData(n.PIXEL_PACK_BUFFER,0,a),n.bindBuffer(n.PIXEL_PACK_BUFFER,null),a}function fT(r,t,e,n,a){var i=wd(e,n),s=i[0],l=i[1],c=new Uint8Array(e*n*4);return Ne(r,t,function(){return r.readPixels(0,0,s,l,a.downloadTextureFormat,r.UNSIGNED_BYTE,c)}),new Float32Array(c.buffer)}function hT(r,t,e,n,a,i,s,l){var c=r,f=new Float32Array(function(d,p){var g=Rc(d,p);return g[0]*g[1]*4}(i,s));return c.bindBuffer(c.PIXEL_PACK_BUFFER,t),c.getBufferSubData(c.PIXEL_PACK_BUFFER,0,f),c.bindBuffer(c.PIXEL_PACK_BUFFER,null),f}function dT(r,t,e,n){var a=new Float32Array(e*n*4);return Ne(r,t,function(){return r.readPixels(0,0,n,e,r.RGBA,r.FLOAT,a)}),a}var eL=Object.freeze({createVertexShader:QA,createVertexBuffer:JA,createIndexBuffer:eT,createFloat32MatrixTexture:tT,createFloat16MatrixTexture:nT,createUnsignedBytesMatrixTexture:rT,createPackedMatrixTexture:aT,createFloat16PackedMatrixTexture:iT,bindVertexProgramAttributeStreams:oT,uploadDenseMatrixToTexture:sT,uploadPixelDataToTexture:uT,createBufferFromOutputTexture:lT,downloadFloat32MatrixFromBuffer:cT,downloadByteEncodedFloatMatrixFromOutputTexture:fT,downloadPackedMatrixFromBuffer:hT,downloadMatrixFromPackedOutputTexture:dT}),pT=function(){function r(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var e=se().getNumber("WEBGL_VERSION");if(t!=null?(this.gl=t,YC(e,t)):this.gl=Da(e),se().getNumber("WEBGL_VERSION")===1)this.textureFloatExtension=Oh(this.gl,this.debug,"OES_texture_float"),this.colorBufferFloatExtension=this.gl.getExtension("WEBGL_color_buffer_float"),this.textureHalfFloatExtension=Oh(this.gl,this.debug,"OES_texture_half_float"),this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float");else if(na(this.gl,"EXT_color_buffer_float"))this.colorBufferFloatExtension=this.gl.getExtension("EXT_color_buffer_float");else{if(!na(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=JA(this.gl,this.debug),this.indexBuffer=eT(this.gl,this.debug),this.framebuffer=uA(this.gl,this.debug),this.textureConfig=Ly(this.gl,this.textureHalfFloatExtension)}return Object.defineProperty(r.prototype,"debug",{get:function(){return se().getBool("DEBUG")},enumerable:!0,configurable:!0}),r.prototype.dispose=function(){var t=this;if(!this.disposed){this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var e=this.gl;Ne(e,this.debug,function(){return e.finish()}),Ne(e,this.debug,function(){return e.bindFramebuffer(e.FRAMEBUFFER,null)}),Ne(e,this.debug,function(){return e.deleteFramebuffer(t.framebuffer)}),Ne(e,this.debug,function(){return e.bindBuffer(e.ARRAY_BUFFER,null)}),Ne(e,this.debug,function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)}),Ne(e,this.debug,function(){return e.deleteBuffer(t.indexBuffer)}),this.disposed=!0}},r.prototype.createFloat32MatrixTexture=function(t,e){return this.throwIfDisposed(),tT(this.gl,this.debug,t,e,this.textureConfig)},r.prototype.createFloat16MatrixTexture=function(t,e){return this.throwIfDisposed(),nT(this.gl,this.debug,t,e,this.textureConfig)},r.prototype.createUnsignedBytesMatrixTexture=function(t,e){return this.throwIfDisposed(),rT(this.gl,this.debug,t,e,this.textureConfig)},r.prototype.uploadPixelDataToTexture=function(t,e){this.throwIfDisposed(),uT(this.gl,this.debug,t,e)},r.prototype.uploadDenseMatrixToTexture=function(t,e,n,a){this.throwIfDisposed(),sT(this.gl,this.debug,t,e,n,a,this.textureConfig)},r.prototype.createFloat16PackedMatrixTexture=function(t,e){return this.throwIfDisposed(),iT(this.gl,this.debug,t,e,this.textureConfig)},r.prototype.createPackedMatrixTexture=function(t,e){return this.throwIfDisposed(),aT(this.gl,this.debug,t,e,this.textureConfig)},r.prototype.deleteMatrixTexture=function(t){var e=this;this.throwIfDisposed(),this.outputTexture===t&&(zv(this.gl,this.debug,this.framebuffer),this.outputTexture=null),Ne(this.gl,this.debug,function(){return e.gl.deleteTexture(t)})},r.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(t,e,n){var a=this;return this.downloadMatrixDriver(t,function(){return fT(a.gl,a.debug,e,n,a.textureConfig)})},r.prototype.downloadPackedMatrixFromBuffer=function(t,e,n,a,i,s){return hT(this.gl,t,0,0,0,i,s,this.textureConfig)},r.prototype.downloadFloat32MatrixFromBuffer=function(t,e){return cT(this.gl,t,e)},r.prototype.createBufferFromTexture=function(t,e,n){this.bindTextureToFrameBuffer(t);var a=lT(this.gl,this.debug,e,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),a},r.prototype.createAndWaitForFence=function(){var t=this.createFence(this.gl);return this.pollFence(t)},r.prototype.createFence=function(t){var e,n,a=this;if(se().getBool("WEBGL_FENCE_API_ENABLED")){var i=t,s=i.fenceSync(i.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),n=function(){var l=i.clientWaitSync(s,0,0);return l===i.ALREADY_SIGNALED||l===i.CONDITION_SATISFIED},e=s}else se().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(e=this.beginQuery(),this.endQuery(),n=function(){return a.isQueryAvailable(e,se().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):n=function(){return!0};return{query:e,isFencePassed:n}},r.prototype.downloadMatrixFromPackedTexture=function(t,e,n){var a=this;return this.downloadMatrixDriver(t,function(){return dT(a.gl,a.debug,e,n)})},r.prototype.createProgram=function(t){this.throwIfDisposed();var e=this.gl,n=tA(e,this.debug,t),a=QA(e,this.debug),i=nA(e,this.debug);return Ne(e,this.debug,function(){return e.attachShader(i,a)}),Ne(e,this.debug,function(){return e.attachShader(i,n)}),rA(e,this.debug,i),this.debug&&zh(e,this.debug,i),this.vertexAttrsAreBound||(this.setProgram(i),this.vertexAttrsAreBound=oT(e,this.debug,this.program,this.vertexBuffer)),i},r.prototype.deleteProgram=function(t){var e=this;this.throwIfDisposed(),t===this.program&&(this.program=null),t!=null&&Ne(this.gl,this.debug,function(){return e.gl.deleteProgram(t)})},r.prototype.setProgram=function(t){var e=this;this.throwIfDisposed(),this.program=t,this.program!=null&&this.debug&&zh(this.gl,this.debug,this.program),Ne(this.gl,this.debug,function(){return e.gl.useProgram(t)})},r.prototype.getUniformLocation=function(t,e,n){return n===void 0&&(n=!0),this.throwIfDisposed(),n?cA(this.gl,this.debug,t,e):fA(this.gl,t,e)},r.prototype.getAttributeLocation=function(t,e){var n=this;return this.throwIfDisposed(),Ne(this.gl,this.debug,function(){return n.gl.getAttribLocation(t,e)})},r.prototype.getUniformLocationNoThrow=function(t,e){return this.throwIfDisposed(),this.gl.getUniformLocation(t,e)},r.prototype.setInputMatrixTexture=function(t,e,n){this.throwIfDisposed(),this.throwIfNoProgram(),hA(this.gl,this.debug,this.program,t,e,n)},r.prototype.setOutputMatrixTexture=function(t,e,n){this.setOutputMatrixTextureDriver(t,n,e)},r.prototype.setOutputPackedMatrixTexture=function(t,e,n){this.throwIfDisposed();var a=Rc(e,n),i=a[0],s=a[1];this.setOutputMatrixTextureDriver(t,i,s)},r.prototype.setOutputMatrixWriteRegion=function(t,e,n,a){this.setOutputMatrixWriteRegionDriver(n,t,a,e)},r.prototype.setOutputPackedMatrixWriteRegion=function(t,e,n,a){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},r.prototype.debugValidate=function(){this.program!=null&&zh(this.gl,this.debug,this.program),Ql(this.gl)},r.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var t=this.gl;this.debug&&this.debugValidate(),Ne(t,this.debug,function(){return t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0)})},r.prototype.blockUntilAllProgramsCompleted=function(){var t=this;this.throwIfDisposed(),Ne(this.gl,this.debug,function(){return t.gl.finish()})},r.prototype.getQueryTimerExtension=function(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=Oh(this.gl,this.debug,se().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},r.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},r.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},r.prototype.beginQuery=function(){if(se().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){var t=this.gl,e=this.getQueryTimerExtensionWebGL2(),n=t.createQuery();return t.beginQuery(e.TIME_ELAPSED_EXT,n),n}var a=this.getQueryTimerExtensionWebGL1(),i=a.createQueryEXT();return a.beginQueryEXT(a.TIME_ELAPSED_EXT,i),i},r.prototype.endQuery=function(){if(se().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")!==2){var t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}else{var e=this.gl,n=this.getQueryTimerExtensionWebGL2();e.endQuery(n.TIME_ELAPSED_EXT)}},r.prototype.waitForQueryAndGetTime=function(t){return De(this,void 0,void 0,function(){var e=this;return Oe(this,function(n){switch(n.label){case 0:return[4,Nv(function(){return e.disposed||e.isQueryAvailable(t,se().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))})];case 1:return n.sent(),[2,this.getQueryTime(t,se().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))]}})})},r.prototype.getQueryTime=function(t,e){if(e===0)return null;if(e===2){var n=this.gl;return n.getQueryParameter(t,n.QUERY_RESULT)/1e6}var a=this.getQueryTimerExtensionWebGL1();return a.getQueryObjectEXT(t,a.QUERY_RESULT_EXT)/1e6},r.prototype.isQueryAvailable=function(t,e){if(e===0)return!0;if(e===2){var n=this.gl,a=this.getQueryTimerExtensionWebGL2(),i=n.getQueryParameter(t,n.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(a.GPU_DISJOINT_EXT)),i&&!this.disjoint}return i=(a=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(t,a.QUERY_RESULT_AVAILABLE_EXT),this.disjoint==null&&(this.disjoint=this.gl.getParameter(a.GPU_DISJOINT_EXT)),i&&!this.disjoint},r.prototype.pollFence=function(t){var e=this;return new Promise(function(n){e.addItemToPoll(function(){return t.isFencePassed()},function(){return n()})})},r.prototype.pollItems=function(){for(var t=function(n){for(var a=0;a<n.length;++a){var i=n[a]();if(!i)break}return a-1}(this.itemsToPoll.map(function(n){return n.isDoneFn})),e=0;e<=t;++e)(0,this.itemsToPoll[e].resolveFn)();this.itemsToPoll=this.itemsToPoll.slice(t+1)},r.prototype.addItemToPoll=function(t,e){var n=this;this.itemsToPoll.push({isDoneFn:t,resolveFn:e}),this.itemsToPoll.length>1||Nv(function(){return n.pollItems(),n.itemsToPoll.length===0})},r.prototype.bindTextureToFrameBuffer=function(t){this.throwIfDisposed(),Lh(this.gl,this.debug,t,this.framebuffer),this.debug&&Ql(this.gl)},r.prototype.unbindTextureToFrameBuffer=function(){this.outputTexture!=null?(Lh(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&Ql(this.gl)):zv(this.gl,this.debug,this.framebuffer)},r.prototype.downloadMatrixDriver=function(t,e){this.bindTextureToFrameBuffer(t);var n=e();return this.unbindTextureToFrameBuffer(),n},r.prototype.setOutputMatrixTextureDriver=function(t,e,n){this.throwIfDisposed();var a=this.gl;Lh(a,this.debug,t,this.framebuffer),this.debug&&Ql(a),this.outputTexture=t,Ne(a,this.debug,function(){return a.viewport(0,0,e,n)}),Ne(a,this.debug,function(){return a.scissor(0,0,e,n)})},r.prototype.setOutputMatrixWriteRegionDriver=function(t,e,n,a){var i=this;this.throwIfDisposed(),Ne(this.gl,this.debug,function(){return i.gl.scissor(t,e,n,a)})},r.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},r.prototype.throwIfNoProgram=function(){if(this.program==null)throw new Error("No GPU program is currently set.")},r}();function cS(r,t){if(r.length!==t.length)throw Error("Binary was compiled with "+r.length+" inputs, but was executed with "+t.length+" inputs");r.forEach(function(e,n){var a=e.logicalShape,i=t[n],s=i.shape;if(!kn(a,s))throw Error("Binary was compiled with different shapes than the current args. Shapes "+a+" and "+s+" must match");if(!e.isUniform||!i.isUniform){var l=e.texShape,c=i.isUniform?null:i.texData.texShape;if(!kn(l,c))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+l+" and "+c+" must match")}})}var tL=function(){return function(r,t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r;for(var n=e.filterWidth,a=e.inChannels,i=e.strideWidth,s=e.strideHeight,l=e.padInfo,c=e.outWidth,f=e.dilationWidth,d=e.dilationHeight,p=e.dataFormat,g=l.left,v=l.top,b=a*n,w=qn(),S=p==="channelsLast",x=S?0:1,C=S?1:2,A="",T=0;T<=1;T++)for(var R=0;R<=1;R++)A+=`
          blockIndex = rc.y + `+R+`;
          pos = rc.x + `+T+`;

          if(blockIndex < `+r[1]+" && pos < "+r[0]+`) {
            offsetY = int(blockIndex / (`+c+")) * "+s+" - "+v+`;
            d0 = offsetY + `+d+" * (pos / "+b+`);

            if(d0 < `+t[x]+` && d0 >= 0) {

              offsetX = int(mod(float(blockIndex), `+c+".) * "+i+". - "+g+`.);
              d1 = offsetX + `+f+" * (int(mod(float(pos), "+b+".) / "+a+`.));

              if(d1 < `+t[C]+` && d1 >= 0) {

                ch = int(mod(float(pos), `+a+`.));

                if (`+S+`) {
                  innerDims = vec2(d1, ch);
                  result[`+(2*T+R)+`] = getChannel(
                    getA(d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[`+(2*T+R)+`] = getChannel(
                    getA(ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec2 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        `+A+`

        `+w.output+` = result;
      }
    `}}(),nL=function(){return function(r,t,e,n,a){this.variableNames=["x"],this.outputShape=[];var i,s=t,l=r[3]-1;this.outputShape=r;var c="float("+e+") + float("+n+") * sum";i=a===.5?"inversesqrt("+c+")":a===1?"1.0/("+c+")":"exp(log("+c+") * float(-"+a+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -`+s+"; j <= "+s+`; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  `+l+`) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * `+i+`;
        setOutput(val);
      }
    `}}(),rL=function(){return function(r,t,e,n,a){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=r,this.depth=r[3],this.depthRadius=t,this.bias=e,this.alpha=n,this.beta=a,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < `+this.depth+`; ++d) {
          int depthBegin = int(max(0.0, float(d - `+t+`)));
          int depthEnd = int(min(float(`+this.depth+`),
              float(d + `+t+` + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = `+this.depth+`;

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(`+n+") * norm + float("+e+`);

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(`+n+`)
                * float(`+a+`)
                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * `+a+`);
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}(),aL=function(){return function(r,t,e,n,a){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var i,s=t,l=r[3]-1;this.outputShape=r;var c="float("+e+") + float("+n+") * sum";i=a===.5?"inversesqrt("+c+")":a===1?"1.0/("+c+")":"exp(log("+c+") * float(-"+a+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < `+this.outputShape[3]+`;
        bool hasNextRow = c < `+this.outputShape[2]+`;

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - `+s+`;
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - `+s+"; j <= "+s+`; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(`+l+`));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * `+i+`;
        setOutput(result);
      }
    `}}(),iL=function(){return function(r){this.variableNames=["dy","maxPos"],this.outputShape=r.inShape;var t=r.strideHeight,e=r.strideWidth,n=r.dilationHeight,a=r.effectiveFilterHeight,i=r.effectiveFilterWidth,s=a-1-r.padInfo.top,l=i-1-r.padInfo.left,c=a*i-1;this.userCode=`
      const ivec2 pads = ivec2(`+s+", "+l+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+a+`;
          wR += `+n+`) {
          float dyR = float(dyRCorner + wR) / `+t+`.0;

          if (dyR < 0.0 || dyR >= `+r.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+i+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+e+`.0;

            if (dyC < 0.0 || dyC >= `+r.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = `+c+` - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * `+i+` + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}(),oL=function(){return function(r){this.variableNames=["dy","maxPos"],this.outputShape=r.inShape;var t=r.strideDepth,e=r.strideHeight,n=r.strideWidth,a=r.dilationDepth,i=r.dilationHeight,s=r.dilationWidth,l=r.effectiveFilterDepth,c=r.effectiveFilterHeight,f=r.effectiveFilterWidth,d=l-1-r.padInfo.front,p=c-1-r.padInfo.top,g=f-1-r.padInfo.left,v=l*c*f-1;this.userCode=`
      const ivec3 pads = ivec3(`+d+", "+p+", "+g+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+l+`;
           wD += `+a+`) {
          float dyD = float(dyDCorner + wD) / `+t+`.0;

          if (dyD < 0.0 || dyD >= `+r.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+c+`;
              wR += `+i+`) {
            float dyR = float(dyRCorner + wR) / `+e+`.0;

            if (dyR < 0.0 || dyR >= `+r.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+f+`;
                wC += `+s+`) {
              float dyC = float(dyCCorner + wC) / `+n+`.0;

              if (dyC < 0.0 || dyC >= `+r.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = `+v+` -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * `+c+" * "+f+` +
                  wR * `+f+` + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}(),Yg=function(){return function(r,t,e,n,a,i,s){e===void 0&&(e=!1),n===void 0&&(n=!1),a===void 0&&(a=!1),i===void 0&&(i=null),s===void 0&&(s=!1),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;var l=e?r[1]:r[2],c=Math.ceil(l/2),f=e?"i * 2, rc.y":"rc.y, i * 2",d=n?"rc.z, i * 2":"i * 2, rc.z",p=e?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],g=n?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],v="",b="";i&&(v=s?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+i+`
        }`:`vec4 activation(vec4 x) {
          `+i+`
        }`,b="result = activation(result);");var w=a?"result += getBiasAtOutCoords();":"";a&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+v+`

      const float sharedDimension = `+c+`.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        for (int i = 0; i < `+c+`; i++) {
          vec4 a = getMatrixA(rc.x, `+f+`);
          vec4 b = getMatrixB(rc.x, `+d+`);

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (`+p[0]+" * "+g[0]+`);
          result += (`+p[1]+" * "+g[1]+`);
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        `+w+`

        `+b+`

        setOutput(result);
      }
    `}}(),sL=function(){function r(t,e,n){this.variableNames=["probs"],this.outputShape=[t,n],this.userCode=`
      uniform float seed;

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < `+(e-1)+`; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(`+(e-1)+`));
      }
    `}return r.prototype.getCustomSetupFunc=function(t){var e=this;return function(n,a){e.seedLoc==null&&(e.seedLoc=n.getUniformLocation(a,"seed")),n.gl.uniform1f(e.seedLoc,t)}},r}(),uL=function(){return function(r,t,e,n){this.variableNames=["indices"],this.outputShape=[r,t],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(`+n+"), float("+e+`),
                      float(index == coords.y)));
      }
    `}}(),lL=function(){return function(r){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=r;var t=r.length;if(t===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{var e=cr("rc",t),n=Mt(t),a=function(l,c,f){if(l===1)return"rc > "+c[0];for(var d="",p=l-2;p<l;p++)d+=f[p]+" >= "+c[p],p<l-1&&(d+="||");return d}(t,r,e),i=function(l,c,f,d){if(l===1)return"";var p=d.slice(-2);return`
    int r = `+p[0]+`;
    int c = `+p[1]+`;
    int rp1 = r + 1;
    int cp1 = c + 1;

    bool cEdge = cp1 >= `+c+`;
    bool rEdge = rp1 >= `+f+`;
  `}(t,r[r.length-1],r[r.length-2],e),s=function(l,c){var f=l.length,d=function(p,g){for(var v=[],b=0;b<=1;b++)for(var w=0;w<=1;w++){for(var S=(b===0?"r":"rp1")+", "+(w===0?"c":"cp1"),x=2;x<p;x++)S=g[g.length-1-x]+","+S;v.push(S)}return v}(f,c);return f===1?`getA(rc),
            rc + 1 >= `+l[0]+` ? 0. : getA(rc + 1),
            0, 0`:"getA("+d[0]+`),
          cEdge ? 0. : getA(`+d[1]+`),
          rEdge ? 0. : getA(`+d[2]+`),
          rEdge || cEdge ? 0. : getA(`+d[3]+")"}(r,e);this.userCode=`
        void main() {
          `+n+` rc = getOutputCoords();

          if(`+a+`) {
            setOutput(vec4(0));
          } else {
            `+i+`

            setOutput(vec4(`+s+`));
          }
        }
      `}}}(),cL=function(){return function(r,t,e){this.variableNames=["x"],this.outputShape=t.map(function(c,f){return c[0]+r[f]+c[1]});var n=r.length,a=Mt(n),i=t.map(function(c){return c[0]}).join(","),s=t.map(function(c,f){return c[0]+r[f]}).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,n);this.userCode=n!==1?`
      `+a+" start = "+a+"("+i+`);
      `+a+" end = "+a+"("+s+`);

      void main() {
        `+a+` outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(float(`+e+`));
        } else {
          `+a+` coords = outC - start;
          setOutput(getX(`+l+`));
        }
      }
    `:`
        int start = `+i+`;
        int end = `+s+`;

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(float(`+e+`));
          } else {
            setOutput(getX(outC - start));
          }
        }
      `}}(),fL=function(){return function(r,t,e){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map(function(S,x){return S[0]+r[x]+S[1]});for(var n=r.length,a=Mt(n),i=t.map(function(S){return S[0]}).join(","),s=t.map(function(S,x){return S[0]+r[x]}).join(","),l=cr("rc",n),c=cr("source",n),f=l[n-1]+" < "+this.outputShape[n-1],d=n===1?"source":"vec2("+c.slice(-2).join()+")",p=[a+" rc = outputLoc;",l[n-1]+` += 1;
       if(`+f+`) {
      `,n===1?"":`}
       rc = outputLoc;
       `+l[n-2]+` += 1;
       if(`+l[n-2]+" < "+this.outputShape[n-2]+") {",n===1?"":"  "+l[n-1]+` += 1;
         if(`+f+") {"],g=n===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",v="",b=0,w=n===1?2:4;b<w;b++)v+=`
        `+p[b]+`
        if (`+g+`) {
          result[`+b+"] = float("+e+`);
        } else {
          `+a+` source = rc - start;
          result[`+b+"] = getChannel(getX("+c.join()+"), "+d+`);
        }
      `;v+=n===1?"} ":"}}",this.userCode=`
      const `+a+" start = "+a+"("+i+`);
      const `+a+" end = "+a+"("+s+`);

      void main() {
        `+a+` outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        `+v+`
        setOutput(result);
      }
    `}}(),Zg=function(){return function(r,t,e){if(this.variableNames=["x"],t==="avg"&&e)throw new Error("Cannot compute positions for average pool.");var n=r.filterWidth,a=r.strideHeight,i=r.strideWidth,s=r.dilationHeight,l=r.dilationWidth,c=r.effectiveFilterHeight,f=r.effectiveFilterWidth,d=r.padInfo.top,p=r.padInfo.left;this.outputShape=r.outShape;var g=t==="avg",v="0.0";if(g||(v="-1.0 / 1e-20"),e)this.userCode=`
        const ivec2 strides = ivec2(`+a+", "+i+`);
        const ivec2 pads = ivec2(`+d+", "+p+`);

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < `+c+`;
              wR += `+s+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+r.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+f+`;
                wC += `+l+`) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= `+r.inWidth+`) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value >= currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = wR * `+f+` + wC;
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var b=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="avg"&&(b="avgValue / count");var w=4*Math.floor(n/4),S=n%4,x=`
      if (`+g+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(`+a+", "+i+`);
      const ivec2 pads = ivec2(`+d+", "+p+`);
      const float initializationValue = `+v+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= `+r.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+v+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < `+c+`;
            wR += `+s+`) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= `+r.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+w+`; wC += 4) {
            int xC = xCCorner + wC * `+l+`;

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+l+`, d),
              getValue(batch, xR, xC + 2 * `+l+`, d),
              getValue(batch, xR, xC + 3 * `+l+`, d)
            );

            `+x+`
          }

          int xC = xCCorner + `+w+`;
          if (`+(S===1)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            `+x+`
          } else if (`+(S===2)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+l+`, d),
              initializationValue,
              initializationValue
            );

            `+x+`
          } else if (`+(S===3)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+l+`, d),
              getValue(batch, xR, xC + 2 * `+l+`, d),
              initializationValue
            );

            `+x+`
          }
        }
        setOutput(`+b+`);
      }
    `}}}(),Qg=function(){return function(r,t,e){if(this.variableNames=["x"],t==="avg"&&e)throw new Error("Cannot compute positions for average pool.");var n=r.filterWidth,a=r.strideDepth,i=r.strideHeight,s=r.strideWidth,l=r.dilationDepth,c=r.dilationHeight,f=r.dilationWidth,d=r.effectiveFilterDepth,p=r.effectiveFilterHeight,g=r.effectiveFilterWidth,v=r.padInfo.front,b=r.padInfo.top,w=r.padInfo.left;this.outputShape=r.outShape;var S=t==="avg",x="0.0";if(S||(x="-1.0 / 1e-20"),e)this.userCode=`
        const ivec3 strides =
            ivec3(`+a+", "+i+", "+s+`);
        const ivec3 pads = ivec3(`+v+", "+b+", "+w+`);

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < `+d+`;
              wD += `+l+`) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= `+r.inDepth+`) {
              continue;
            }

            for (int wR = 0; wR < `+p+`;
                wR += `+c+`) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= `+r.inHeight+`) {
                continue;
              }

              for (int wC = 0; wC < `+g+`;
                  wC += `+f+`) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= `+r.inWidth+`) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value >= currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition =
                      wD * `+p+" * "+g+` +
                      wR * `+g+` + wC;;
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var C=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="avg"&&(C="avgValue / count");var A=4*Math.floor(n/4),T=n%4,R=`
      if (`+S+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(`+a+", "+i+", "+s+`);
      const ivec3 pads = ivec3(`+v+", "+b+", "+w+`);
      const float initializationValue = `+x+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= `+r.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+x+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < `+d+`;
            wD += `+l+`) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= `+r.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+p+`;
            wR += `+c+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+r.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+A+`; wC += 4) {
              int xC = xCCorner + wC * `+f+`;

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+f+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+f+`, ch),
                getValue(batch, xD, xR, xC + 3 * `+f+`, ch)
              );

              `+R+`
            }

            int xC = xCCorner + `+A+`;
            if (`+(T===1)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              `+R+`
            } else if (`+(T===2)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+f+`, ch),
                initializationValue,
                initializationValue
              );

              `+R+`
            } else if (`+(T===3)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+f+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+f+`, ch),
                initializationValue
              );

              `+R+`
            }
          }
          setOutput(`+C+`);
        }
      }
    `}}}(),hL=function(){return function(r,t){this.variableNames=["x"];var e=r.windowSize,n=r.batchSize,a=r.inSize,i=Math.ceil(a/e);this.outputShape=[n,i];var s="0.0",l="";t==="prod"?s="1.0":t==="min"?(s="1.0 / 1e-20",l="min"):t==="max"&&(s="-1.0 / 1e-20",l="max");var c=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="sum"?c="sumValue":t==="prod"?c="prodValue":t==="all"?c="allValue":t==="any"&&(c="anyValue");var f=4*Math.floor(e/4),d=e%4,p=`
      if (`+(t==="sum")+`) {
        sumValue += dot(values, ones);
      } else if (`+(t==="prod")+`) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = `+l+`(values, minMaxValue);
      }
    `,g="vec4";t==="all"?(s="1.0",p=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,g="bvec4"):t==="any"&&(s="0.0",p=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,g="bvec4");var v="";a%e>0&&(v=`
        if (inIdx < 0 || inIdx >= `+a+`) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = `+s+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        `+v+`
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+e+`;

        vec4 minMaxValue = vec4(`+s+`);
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < `+f+`; i += 4) {
          int inIdx = inOffset + i;
          `+g+" values = "+g+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          `+p+`
        }

        int inIdx = inOffset + `+f+`;
        if (`+(d===1)+`) {
          `+g+" values = "+g+`(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          `+p+`
        } else if (`+(d===2)+`) {
          `+g+" values = "+g+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          `+p+`
        } else if (`+(d===3)+`) {
          `+g+" values = "+g+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          `+p+`
        }
        setOutput(`+c+`);
      }
    `}}(),dL=function(){return function(r,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r;for(var e="",n=0;n<4;n++){var a="thisRC = rc;";n%2==1&&(a+="thisRC.z += 1;"),n>1&&(a+="thisRC.y += 1;"),e+=`
        `+a+`
        `+(n>0?"if(thisRC.y < rows && thisRC.z < cols){":"")+`
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[`+n+`] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        `+(n>0?"}":"")+`
      `}this.userCode=`
      
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      `+Ho(["r","c","d"],t)+`
      return ivec3(r, c, d);
    }
  
      `+ib(r)+`

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = `+r[1]+`;
        int cols = `+r[2]+`;

        `+e+`

        setOutput(result);
      }
    `}}(),pL=function(){return function(r,t,e){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var n=t.shape,a=n[1],i=n[2],s=r.shape,l=s[1],c=s[2],f=[e&&l>1?a-1:a,e&&c>1?i-1:i],d=[e&&l>1?l-1:l,e&&c>1?c-1:c],p=f[0]/d[0],g=f[1]/d[1],v=1/p,b=1/g,w=2*Math.ceil(v)+2,S=2*Math.ceil(b)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+p+`);
        const float widthScale = float(`+g+`);

        const float invHeightScale = float(`+v+`);
        const float invWidthScale = float(`+b+`);

        const int winHeight = int(`+w+`);
        const int winWidth = int(`+S+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+l+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+c+`) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), `+(a-1)+`.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), `+(i-1)+`.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}(),mL=function(){return function(r,t,e,n){this.variableNames=["A"],this.outputShape=[];var a=r[0],i=r[1],s=r[2],l=r[3];this.outputShape=[a,t,e,l];var c=[n&&t>1?i-1:i,n&&e>1?s-1:s],f=[n&&t>1?t-1:t,n&&e>1?e-1:e];this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+c[0]/f[0]+`,
          `+c[1]/f[1]+`);
      const vec2 inputShapeRC = vec2(`+i+".0, "+s+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}(),gL=function(){return function(r,t,e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var a=r[0],i=r[1],s=r[2],l=r[3];this.outputShape=[a,t,e,l];var c=[n&&t>1?i-1:i,n&&e>1?s-1:s],f=[n&&t>1?t-1:t,n&&e>1?e-1:e];this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          `+c[0]/f[0]+`,
          `+c[1]/f[1]+`,
          `+c[1]/f[1]+`);
      const vec3 inputShapeRC = vec3(`+i+".0, "+s+`.0,
                                     `+s+`.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < `+(l-1)+`;
        bool hasNextRow = coords.z < `+(e-1)+`;

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}(),vL=function(){return function(r,t,e){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var n=t.shape,a=n[1],i=n[2],s=r.shape,l=s[1],c=s[2],f=[e&&l>1?a-1:a,e&&c>1?i-1:i],d=[e&&l>1?l-1:l,e&&c>1?c-1:c],p=f[0]/d[0],g=f[1]/d[1],v=1/p,b=1/g,w=2*Math.ceil(v)+2,S=2*Math.ceil(b)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+p+`);
        const float widthScale = float(`+g+`);

        const float invHeightScale = float(`+v+`);
        const float invWidthScale = float(`+b+`);

        const int winHeight = int(`+w+`);
        const int winWidth = int(`+S+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+l+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+c+`) {
              continue;
            }

            float sourceFracRow =
              float(`+f[0]+`) *
                (float(dyR) / float(`+d[0]+`));

            float sourceFracCol =
                float(`+f[1]+`) *
                  (float(dyC) / float(`+d[1]+`));

            int sourceNearestRow = int(min(
                float(int(`+a+`) - 1),
                `+e+` ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(`+i+`) - 1),
                `+e+` ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}(),yL=function(){return function(r,t,e,n){this.variableNames=["A"],this.outputShape=[];var a=r[0],i=r[1],s=r[2],l=r[3];this.outputShape=[a,t,e,l];var c=[n&&t>1?i-1:i,n&&e>1?s-1:s],f=[n&&t>1?t-1:t,n&&e>1?e-1:e],d=n?"0.5":"0.0";this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+c[0]/f[0]+`,
          `+c[1]/f[1]+`);
      const vec2 inputShapeRC = vec2(`+i+".0, "+s+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + `+d+`)));

        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}(),bL=function(){return function(r,t){this.variableNames=["x"];var e=r.length;if(e>4)throw new Error("WebGL backend: Reverse of rank-"+e+" tensor is not yet supported");if(this.outputShape=r,e!==1){var n=r.map(function(i,s){return function(l){return t.indexOf(l)!==-1&&r[l]!==1?r[l]+" - coords["+l+"] - 1":"coords["+l+"]"}(s)}).join(","),a=Mt(e);this.userCode=`
      void main() {
        `+a+` coords = getOutputCoords();
        setOutput(getX(`+n+`));
      }
    `}else this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(`+r[0]+` - coord - 1));
        }
      `}}(),wL=function(){return function(r,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var e=r.length;if(e>4)throw new Error("WebGL backend: Reverse of rank-"+e+" tensor is not yet supported");this.outputShape=r;var n=cr("rc",e),a=n[e-1]+" + 1 < "+this.outputShape[e-1],i=n[e-2]+" + 1 < "+this.outputShape[e-2],s=Mt(e);function l(c){var f=r.map(function(d,p){return function(g,v){return t.indexOf(g)!==-1&&r[g]!==1?r[g]+" - "+v[g]+" - 1":""+v[g]}(p,c)});return"getChannel(getX("+f.join(",")+"), vec2("+f.slice(-2).join(",")+"))"}this.userCode=e===1?`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(`+r[0]+` - rc - 1),
            `+r[0]+` - rc - 1);
          if(`+a+`){
              result.g = getChannel(getX(`+r[0]+` - (rc  + 1) - 1),
                `+r[0]+` - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:`
        void main() {
          `+s+` rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = `+function(c){return l(c)}(n.slice())+`;
          if(`+a+`){
            result.g = `+function(c){return c[e-1]="("+c[e-1]+" + 1)",l(c)}(n.slice())+`;
          }
          if(`+i+`) {
            result.b = `+function(c){return c[e-2]="("+c[e-2]+" + 1)",l(c)}(n.slice())+`;
            if(`+a+`) {
              result.a = `+function(c){return c[e-1]="("+c[e-1]+" + 1)",c[e-2]="("+c[e-2]+" + 1)",l(c)}(n.slice())+`;
            }
          }
          setOutput(result);
        }
    `}}(),fS=function(){return function(r,t,e,n,a,i,s){this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;var l=Mt(a.length),c=Mt(i.length),f="";e===1?f="i":e===2&&(f="i, j");var d="getIndices("+f+")",p="";n===1?p="i":n===2&&(p="i, coords[1]");var g="getUpdates("+p+")",v=t>1?"strides[j]":"strides";this.userCode=`
        `+l+" strides = "+l+"("+a+`);

        void main() {
          `+c+` coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < `+r+`; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < `+t+`; j++) {
              int index = round(`+d+`);
              flattenedIndex += index * `+v+`;
            }
            if (flattenedIndex == coords[0]) {
              sum += `+g+`;
              found = true;
            }
          }
          setOutput(mix(getDefaultValue(), sum, float(found)));
        }
      `}}(),xL=function(){return function(r,t){this.variableNames=["x","segmentIds"];var e=r.windowSize,n=r.batchSize,a=r.inSize,i=r.numSegments,s=i*Math.ceil(a/e);this.outputShape=[n,s];var l=4*Math.floor(e/4),c=e%4,f=`
        sumValue += dot(values, segFilter);
    `,d="";a%e>0&&(d=`
        if (inIdx < 0 || inIdx >= `+a+`) {
          return initializationValue;
        }
      `);var p="";a%e>0&&(p=`
        if (inIdx < 0 || inIdx >= `+a+`) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = 0.0;

      float getValue(int batch, int inIdx) {
        `+d+`
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        `+p+`
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          `+i+")) * float("+e+`));
        int currentSeg = int(mod(float(outIdx), float(`+i+`)));

        float sumValue = 0.0;

        for (int i = 0; i < `+l+`; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          `+f+`
        }

        int inIdx = inOffset + `+l+`;
        if (`+(c===1)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          `+f+`
        } else if (`+(c===2)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          `+f+`
        } else if (`+(c===3)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          `+f+`
        }
        setOutput(sumValue);
      }
    `}}(),SL=function(){return function(r,t,e){var n,a;if(this.variableNames=["c","a","b"],this.outputShape=t,e>4)throw Error("Where for rank "+e+" is not yet supported");if(e===1)a="resRC",n="resRC";else{for(var i=["resRC.x","resRC.y","resRC.z","resRC.w"],s=[],l=[],c=0;c<t.length;c++)l.push(""+i[c]),c<r&&s.push(""+i[c]);n=s.join(),a=l.join()}var f=Mt(e);this.userCode=`
      void main() {
        `+f+` resRC = getOutputCoords();
        float cVal = getC(`+n+`);
        if (cVal >= 1.0) {
          setOutput(getA(`+a+`));
        } else {
          setOutput(getB(`+a+`));
        }
      }
    `}}(),EL=function(){function r(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;var e,n=Mt(this.rank),a="uniform int start["+this.rank+"];",i=function(s){if(s===1)return"sourceLoc";if(s<=6)return Jg.slice(0,s).map(function(l){return"sourceLoc."+l}).join(",");throw Error("Slicing for rank "+s+" is not yet supported")}(this.rank);e=`
        `+n+` sourceLoc;
        `+n+` coords = getOutputCoords();
        `+t.map(function(s,l){return"sourceLoc."+Jg[l]+" = start["+l+"] + coords."+Jg[l]+";"}).join(`
`)+`
      `,this.userCode=`
      `+a+`
      void main() {
        `+e+`
        setOutput(getSource(`+i+`));
      }
    `}return r.prototype.getCustomSetupFunc=function(t){var e=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(n,a){e.startLoc==null&&(e.startLoc=n.getUniformLocationNoThrow(a,"start"),e.startLoc==null)||n.gl.uniform1iv(e.startLoc,t)}},r}(),Jg=["x","y","z","w","u","v"],CL=function(){function r(t){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length;var e=Mt(this.rank),n=cr("coords",this.rank),a=cr("sourceLoc",this.rank),i=this.rank===1?"sourceLoc":"vec2("+a.slice(-2).join()+")",s="getChannel(getSource("+a.join()+"), "+i+")",l=`
      result.x = `+s+`;
      if (++`+n[this.rank-1]+" < "+t[this.rank-1]+`) {
        ++`+a[this.rank-1]+`;
        result.y = `+s+`;
        --`+a[this.rank-1]+`;
      }
    `,c=this.rank===1?"":`
      --`+n[this.rank-1]+`;
      if (++`+n[this.rank-2]+" < "+t[this.rank-2]+`) {
        ++`+a[this.rank-2]+`;
        result.z = `+s+`;
        if (++`+n[this.rank-1]+" < "+t[this.rank-1]+`) {
          ++`+a[this.rank-1]+`;
          result.w = `+s+`;
        }
      }
    `,f=this.rank<=4?`sourceLoc = coords +
            `+e+"("+t.map(function(d,p){return"start["+p+"]"}).join()+");":t.map(function(d,p){return a[p]+" = "+n[p]+" + start["+p+"];"}).join(`
`);this.userCode=`
      uniform int start[`+this.rank+`];
      void main() {
        `+e+` coords = getOutputCoords();
        `+e+` sourceLoc;
        `+f+`
        vec4 result = vec4(0.);
        `+l+`
        `+c+`
        setOutput(result);
      }
    `}return r.prototype.getCustomSetupFunc=function(t){var e=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(n,a){e.startLoc==null&&(e.startLoc=n.getUniformLocationNoThrow(a,"start"),e.startLoc==null)||n.gl.uniform1iv(e.startLoc,t)}},r}(),AL=function(){return function(r,t,e){this.variableNames=["x"],this.outputShape=e;var n=e.length,a=Mt(e.length),i=Mt(e.length),s="";if(n===1)s="coords * strides + begin";else{var l=0;s=e.map(function(c,f){return l++,e.length===1?"coords * strides["+f+"] + begin["+f+"]":"coords["+(l-1)+"] * strides["+f+"] + begin["+f+"]"}).join(",")}this.userCode=`
      `+a+" begin = "+a+"("+r+`);
      `+a+" strides = "+a+"("+t+`);

      void main() {
        `+i+` coords = getOutputCoords();
        setOutput(getX(`+s+`));
      }
    `}}(),TL=function(){function r(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return r.prototype.acquireTexture=function(t,e,n){var a,i=hS(e,n),s=dS(t,i,n);if(s in this.freeTextures||(this.freeTextures[s]=[]),s in this.usedTextures||(this.usedTextures[s]=[]),this.freeTextures[s].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var l=this.freeTextures[s].shift();return this.usedTextures[s].push(l),l}return this.numUsedTextures++,this.log(),i===xr.PACKED_2X2_FLOAT32?a=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):i===xr.PACKED_2X2_FLOAT16?a=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):i===xr.UNPACKED_FLOAT32?a=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):i===xr.UNPACKED_FLOAT16?a=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):i===xr.PACKED_4X1_UNSIGNED_BYTE&&(a=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[s].push(a),a},r.prototype.releaseTexture=function(t,e,n,a){if(this.freeTextures!=null){var i=dS(e,hS(n,a),a);i in this.freeTextures||(this.freeTextures[i]=[]),this.freeTextures[i].push(t),this.numFreeTextures++,this.numUsedTextures--;var s=this.usedTextures[i],l=s.indexOf(t);if(l<0)throw new Error("Cannot release a texture that was never provided by this texture manager");s.splice(l,1),this.log()}},r.prototype.log=function(){if(this.logEnabled){var t=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+t+")")}},r.prototype.getNumUsedTextures=function(){return this.numUsedTextures},r.prototype.getNumFreeTextures=function(){return this.numFreeTextures},r.prototype.dispose=function(){var t=this;if(this.freeTextures!=null){for(var e in this.freeTextures)this.freeTextures[e].forEach(function(n){t.gpgpu.deleteMatrixTexture(n)});for(var e in this.usedTextures)this.usedTextures[e].forEach(function(a){t.gpgpu.deleteMatrixTexture(a)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},r}();function hS(r,t){if(r===Er.UPLOAD)return xr.PACKED_2X2_FLOAT32;if(r===Er.RENDER||r==null)return function(e){return se().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?e?xr.PACKED_2X2_FLOAT32:xr.UNPACKED_FLOAT32:e?xr.PACKED_2X2_FLOAT16:xr.UNPACKED_FLOAT16}(t);if(r===Er.DOWNLOAD||r===Er.PIXELS)return xr.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+r)}function dS(r,t,e){return r[0]+"_"+r[1]+"_"+t+"_"+e}var NL=function(){return function(r,t){this.variableNames=["A"];for(var e=new Array(r.length),n=0;n<e.length;n++)e[n]=r[n]*t[n];this.outputShape=e,this.rank=e.length;var a=Mt(this.rank),i=function(s){var l=s.length;if(l>5)throw Error("Tile for rank "+l+" is not yet supported");if(l===1)return"imod(resRC, "+s[0]+")";for(var c=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],f=[],d=0;d<s.length;d++)f.push("imod("+c[d]+", "+s[d]+")");return f.join()}(r);this.userCode=`
      void main() {
        `+a+` resRC = getOutputCoords();
        setOutput(getA(`+i+`));
      }
    `}}(),RL=function(){return function(r,t){this.variableNames=["A"];for(var e=new Array(r.length),n=0;n<e.length;n++)e[n]=r[t[n]];this.outputShape=e,this.rank=e.length;var a=Mt(this.rank),i=function(s){var l=s.length;if(l>6)throw Error("Transpose for rank "+l+" is not yet supported");for(var c=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],f=new Array(l),d=0;d<s.length;d++)f[s[d]]=c[d];return f.join()}(t);this.userCode=`
    void main() {
      `+a+` resRC = getOutputCoords();
      setOutput(getA(`+i+`));
    }
    `}}(),IL=function(){return function(r,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var e=new Array(r.length),n=0;n<e.length;n++)e[n]=r[t[n]];if(this.outputShape=e,this.rank=e.length,this.rank>6)throw Error("Packed transpose for rank "+this.rank+" is not yet supported.");var a=Mt(this.rank),i=XA("rc",this.rank),s=new Array(this.rank);for(n=0;n<t.length;n++)s[t[n]]=i[n];var l="vec2("+s.slice(-2).join()+")",c="++"+i[this.rank-1]+" < "+e[this.rank-1],f="getChannel(getA("+s.join()+"), "+l+")";this.userCode=`
    void main() {
      `+a+` rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = `+f+`;
      if(`+c+`) {
        result[1] = `+f+`;
      }
      --`+i[this.rank-1]+`;
      if(++`+i[this.rank-2]+" < "+e[this.rank-2]+`) {
        result[2] = `+f+`;
        if(`+c+`) {
          result[3] = `+f+`;
        }
      }
      setOutput(result);
    }
    `}}(),ob=1.7580993408473768,sb=1.0507009873554805,Qe=function(){return function(r,t){this.variableNames=["A"],this.outputShape=r,this.userCode=`
      float unaryOperation(float x) {
        `+t+`
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}(),ha="if (isnan(x)) return x;",kL="return x;",pS="return abs(x);",mT=ha+`
  return (x < 0.0) ? 0.0 : x;
`,gT=ha+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,vT="return (x >= 0.0) ? x : (exp(x) - 1.0);",DL=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = `+ob+`;
  float scale = `+sb+`;
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,mS="return -x;",gS="return ceil(x);",vS="return floor(x);",yS="return exp(x);",bS="return exp(x) - 1.0;",OL=ha+`
  return sin(x);
`,_L=ha+`
  return cos(x);
`,ML=ha+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,zL=ha+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,LL=ha+`
  return atan(x);
`,FL=ha+"return log(x + sqrt(x * x + 1.0));",BL=ha+`
  if (x < 1.0) return NAN;
  return log(x + sqrt(x * x - 1.0));`,UL=ha+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
  return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,gh="return x;",PL="return x;",yT=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,bT=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,wT=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,Xl=function(){return function(r,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r,this.userCode=`
      vec4 unaryOperation(vec4 x) {
        `+t+`
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}(),VL=function(){return function(r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=r;var t=r.length,e=cr("rc",t),n=Mt(t),a=function(l,c){if(l===1)return"rc";for(var f="",d=0;d<l;d++)f+=c[d],d<l-1&&(f+=",");return f}(t,e),i=e.slice(-2),s=t<=1?"rc":"vec2("+i.join(",")+")";this.userCode=`
      void main() {
        `+n+` rc = getOutputCoords();
        vec4 packedInput = getA(`+a+`);

        setOutput(getChannel(packedInput, `+s+`));
      }
    `}}(),vh={};function yh(r,t){if(t===void 0&&(t=!1),r==="linear")return t?PL:kL;if(r==="relu")return t?yT:mT;if(r==="elu")return t?wT:vT;if(r==="relu6")return t?bT:gT;if(r==="prelu")return t?ZA:YA;throw new Error("Activation "+r+" has not been implemented for the WebGL backend.")}var jL=600,xT=function(r){function t(e){var n,a=r.call(this)||this;if(a.gpgpu=e,a.pendingRead=new WeakMap,a.pendingDisposal=new WeakSet,a.dataRefCount=new WeakMap,a.numBytesInGPU=0,a.uploadWaitMs=0,a.downloadWaitMs=0,a.warnedAboutMemory=!1,a.pendingDeletes=0,a.disposed=!1,!se().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(e==null){var i=Da(se().getNumber("WEBGL_VERSION"));a.binaryCache=((n=se().getNumber("WEBGL_VERSION"))in vh||(vh[n]={}),vh[n]),a.gpgpu=new pT(i),a.canvas=i.canvas,a.gpgpuCreatedLocally=!0}else a.binaryCache={},a.gpgpuCreatedLocally=!1,a.canvas=e.gl.canvas;return a.textureManager=new TL(a.gpgpu),a.numMBBeforeWarning=se().global.screen==null?1024:se().global.screen.height*se().global.screen.width*window.devicePixelRatio*jL/1024/1024,a.texData=new Qy(a,$),a}return la(t,r),t.prototype.numDataIds=function(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes},t.prototype.fromPixels=function(e,n){if(e==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var a=typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement,i=e.data instanceof Uint8Array,s=typeof ImageData<"u"&&e instanceof ImageData,l=typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement,c=typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement,f=l?[e.videoWidth,e.videoHeight]:[e.width,e.height],d=f[0],p=f[1],g=[p,d],v=[p,d,n];if(!(a||i||s||l||c))throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+e.constructor.name);(c||l)&&(this.fromPixels2DContext==null&&(this.fromPixels2DContext=ZC(se().getNumber("WEBGL_VERSION")).getContext("2d")),this.fromPixels2DContext.canvas.width=d,this.fromPixels2DContext.canvas.height=p,this.fromPixels2DContext.drawImage(e,0,0,d,p),e=this.fromPixels2DContext.canvas);var b,w,S=this.makeTensorInfo(g,"int32");return this.texData.get(S.dataId).usage=Er.PIXELS,this.gpgpu.uploadPixelDataToTexture(this.getTexture(S.dataId),e),se().getBool("WEBGL_PACK")?(b=new Z4(v),w=this.compileAndRun(b,[S])):(b=new Y4(v),w=this.compileAndRun(b,[S])),this.disposeData(S.dataId),w},t.prototype.write=function(e,n,a){if(se().getBool("DEBUG")&&this.checkNumericalProblems(e),a==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var i={};return this.texData.set(i,{shape:n,dtype:a,values:e,usage:Er.UPLOAD}),i},t.prototype.move=function(e,n,a,i){if(se().getBool("DEBUG")&&this.checkNumericalProblems(n),i==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:a,dtype:i,values:n,usage:Er.UPLOAD})},t.prototype.readSync=function(e){var n=this.texData.get(e),a=n.values,i=n.dtype,s=n.complexTensors,l=n.slice,c=n.shape,f=n.isPacked;if(l!=null){var d=void 0;d=f?new Xl(c,gh):new Qe(c,gh);var p=this.runWebGLProgram(d,[{dataId:e,shape:c,dtype:i}],i),g=this.readSync(p.dataId);return this.disposeData(p.dataId),g}if(a!=null)return this.convertAndCacheOnCPU(e);if(i==="string")return a;var v,b,w=this.activeTimers!=null;return w&&(v=ta()),i==="complex64"?b=jv(s.real.dataSync(),s.imag.dataSync()):b=this.getValuesFromTexture(e),w&&(this.downloadWaitMs+=ta()-v),this.convertAndCacheOnCPU(e,b)},t.prototype.read=function(e){return De(this,void 0,void 0,function(){var n,a,i,s,l,c,f,d,p,g,v,b,w,S,x,C,A,T,R,O,N,D;return Oe(this,function(I){switch(I.label){case 0:if(this.pendingRead.has(e))return n=this.pendingRead.get(e),[2,new Promise(function(_){return n.push(_)})];if(a=this.texData.get(e),i=a.values,s=a.shape,l=a.slice,c=a.dtype,f=a.complexTensors,d=a.isPacked,l!=null)return p=void 0,p=d?new Xl(s,gh):new Qe(s,gh),g=this.runWebGLProgram(p,[{dataId:e,shape:s,dtype:c}],c),v=this.read(g.dataId),this.disposeData(g.dataId),[2,v];if(i!=null)return[2,this.convertAndCacheOnCPU(e)];if(!se().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&se().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");return b=null,c!=="complex64"&&se().get("WEBGL_BUFFER_SUPPORTED")&&(w=this.decode(e),S=this.texData.get(w.dataId),b=(D=this.gpgpu).createBufferFromTexture.apply(D,[S.texture].concat(rc(s)))),this.pendingRead.set(e,[]),c==="complex64"?[3,2]:[4,this.gpgpu.createAndWaitForFence()];case 1:I.sent(),I.label=2;case 2:return c!=="complex64"?[3,4]:[4,Promise.all([f.real.data(),f.imag.data()])];case 3:return C=I.sent(),A=C[0],T=C[1],x=jv(A,T),[3,5];case 4:b==null?x=this.getValuesFromTexture(e):(R=Me(s),x=this.gpgpu.downloadFloat32MatrixFromBuffer(b,R)),I.label=5;case 5:return w!=null&&this.disposeData(w.dataId),O=this.convertAndCacheOnCPU(e,x),N=this.pendingRead.get(e),this.pendingRead.delete(e),N.forEach(function(_){return _(O)}),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e),this.pendingDeletes--),[2,O]}})})},t.prototype.checkNumericalProblems=function(e){if(e!=null)for(var n=0;n<e.length;n++){var a=e[n];if(!QC(a))throw se().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error("The value "+a+" cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'"):Error("The value "+a+" cannot be represented on this device.")}},t.prototype.getValuesFromTexture=function(e){var n,a=this.texData.get(e),i=a.shape,s=a.dtype,l=a.isPacked,c=Me(i);if(se().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var f=this.decode(e),d=this.texData.get(f.dataId),p=(n=this.gpgpu).downloadMatrixFromPackedTexture.apply(n,[d.texture].concat(rc(i))).subarray(0,c);return this.disposeData(f.dataId),p}var g=se().getBool("WEBGL_PACK")&&l===!0,v=g?Fh(i):i,b=g?new H4(v):new W4(v),w=this.runWebGLProgram(b,[{shape:v,dtype:s,dataId:e}],"float32"),S=this.texData.get(w.dataId),x=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(S.texture,S.texShape[0],S.texShape[1]).subarray(0,c);return this.disposeData(w.dataId),x},t.prototype.time=function(e){return De(this,void 0,void 0,function(){var n,a,i,s,l,c,f;return Oe(this,function(d){switch(d.label){case 0:return n=this.activeTimers,a=[],i=!1,this.programTimersStack==null?(this.programTimersStack=a,i=!0):this.activeTimers.push(a),this.activeTimers=a,e(),s=li(this.activeTimers.map(function(p){return p.query})).filter(function(p){return p!=null}),l=li(this.activeTimers.map(function(p){return p.name})).filter(function(p){return p!=null}),this.activeTimers=n,i&&(this.programTimersStack=null),[4,Promise.all(s)];case 1:return c=d.sent(),f={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:LC(c),getExtraProfileInfo:function(){return c.map(function(p,g){return{name:l[g],ms:p}}).map(function(p){return p.name+": "+p.ms}).join(", ")},wallMs:null},this.uploadWaitMs=0,this.downloadWaitMs=0,[2,f]}})})},t.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},t.prototype.startTimer=function(){return se().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?this.gpgpu.beginQuery():{startMs:ta(),endMs:null}},t.prototype.endTimer=function(e){return se().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(this.gpgpu.endQuery(),e):(e.endMs=ta(),e)},t.prototype.getQueryTime=function(e){return De(this,void 0,void 0,function(){var n;return Oe(this,function(a){return se().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?[2,this.gpgpu.waitForQueryAndGetTime(e)]:[2,(n=e).endMs-n.startMs]})})},t.prototype.disposeData=function(e){if(!this.pendingDisposal.has(e)){if(this.pendingRead.has(e))return this.pendingDisposal.add(e),void this.pendingDeletes++;if(this.texData.has(e)){this.releaseGPUData(e);var n=this.texData.get(e).complexTensors;n!=null&&(n.real.dispose(),n.imag.dispose()),this.texData.delete(e)}}},t.prototype.releaseGPUData=function(e){var n=this.texData.get(e),a=n.texture,i=n.dtype,s=n.texShape,l=n.usage,c=n.isPacked,f=n.slice,d=f&&f.origDataId||e,p=this.dataRefCount.get(d);p>1?this.dataRefCount.set(d,p-1):(this.dataRefCount.delete(d),a!=null&&(this.numBytesInGPU-=this.computeBytes(s,i),this.textureManager.releaseTexture(a,s,l,c)));var g=this.texData.get(e);g.texture=null,g.texShape=null,g.isPacked=!1,g.slice=null},t.prototype.getTexture=function(e){return this.uploadToGPU(e),this.texData.get(e).texture},t.prototype.getDataInfo=function(e){return this.texData.get(e)},t.prototype.getCPUBackend=function(){return se().getBool("WEBGL_CPU_FORWARD")?(this.cpuBackend==null&&(this.cpuBackend=$.findBackend("cpu")),this.cpuBackend):null},t.prototype.shouldExecuteOnCPU=function(e,n){var a=this;return n===void 0&&(n=128),this.getCPUBackend()!=null&&e.every(function(i){return a.texData.get(i.dataId).texture==null&&i.size<n})},t.prototype.getGPGPUContext=function(){return this.gpgpu},t.prototype.complex=function(e,n){var a=this.makeOutput(e.shape,"complex64");return this.texData.get(a.dataId).complexTensors={real:$.keep(e.clone()),imag:$.keep(n.clone())},a},t.prototype.real=function(e){return this.texData.get(e.dataId).complexTensors.real.clone()},t.prototype.imag=function(e){return this.texData.get(e.dataId).complexTensors.imag.clone()},t.prototype.slice=function(e,n,a){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.slice(e,n,a);if(Me(a)===0)return rn([],a,e.dtype);var i=this.texData.get(e.dataId).isPacked,s=Yy(e.shape,n,a);if(i||!s){var l=se().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new CL(a):new EL(a),c=l.getCustomSetupFunc(n);return this.compileAndRun(l,[e],null,c)}return this.uploadToGPU(e.dataId),this.shallowSlice(e,n,a)},t.prototype.shallowSlice=function(e,n,a){var i=this.texData.get(e.dataId),s=this.makeOutput(a,e.dtype),l=this.texData.get(s.dataId);Object.assign(l,i),l.shape=a,l.dtype=e.dtype;var c=Zy(n,e.strides);i.slice&&(c+=i.slice.flatOffset),l.slice={flatOffset:c,origDataId:i.slice&&i.slice.origDataId||e.dataId};var f=this.dataRefCount.get(l.slice.origDataId)||1;return this.dataRefCount.set(l.slice.origDataId,f+1),s},t.prototype.stridedSlice=function(e,n,a,i){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.stridedSlice(e,n,a,i);var s=Id(n,a,i);if(s.some(function(c){return c===0}))return rn([],s);var l=new AL(n,i,s);return this.compileAndRun(l,[e])},t.prototype.reverse=function(e,n){var a=se().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new wL(e.shape,n):new bL(e.shape,n);return this.compileAndRun(a,[e])},t.prototype.concat=function(e,n){if(e[0].dtype==="complex64"){var a=e.map(function(v){return lr(v)}),i=e.map(function(v){return Gr(v)});return Sn(this.concat(a,n),this.concat(i,n))}if(this.shouldExecuteOnCPU(e))return this.cpuBackend.concat(e,n);if(e.length===1)return e[0];if(e.length>se().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var s=Math.floor(e.length/2),l=this.concat(e.slice(0,s),n),c=this.concat(e.slice(s),n);return this.concat([l,c],n)}if(se().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&e[0].rank>1){var f=new I4(e.map(function(v){return v.shape}),n);return this.compileAndRun(f,e)}var d=es(e.map(function(v){return v.shape}),n),p=e.map(function(v){return v.as2D(-1,Me(v.shape.slice(n)))}),g=new R4(p.map(function(v){return v.shape}));return this.compileAndRun(g,p).reshape(d)},t.prototype.neg=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.neg(e);if(se().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,mS,e.dtype);var n=new Qe(e.shape,mS);return this.compileAndRun(n,[e])},t.prototype.batchMatMul=function(e,n,a,i){var s=a?e.shape[2]:e.shape[1],l=i?n.shape[1]:n.shape[2],c=a?e.shape[1]:e.shape[2],f=e.shape[0];if((s===1||l===1)&&c>1e3){a&&(e=e.transpose([0,2,1])),i&&(n=n.transpose([0,2,1]));var d=l===1?e:e.as3D(f,c,1),p=l===1?2:1,g=l===1?n.as3D(f,1,c):n;return this.multiply(d,g).sum(p,!0)}var v=cn(e.dtype,n.dtype),b=new Yg(e.shape,[f,s,l],a,i);return this.compileAndRun(b,[e,n],v)},t.prototype.fusedBatchMatMul=function(e){var n=e.a,a=e.b,i=e.transposeA,s=e.transposeB,l=e.bias,c=e.activation,f=e.preluActivationWeights,d=i?n.shape[2]:n.shape[1],p=s?a.shape[1]:a.shape[2],g=n.shape[0],v=cn(n.dtype,a.dtype),b=l!=null,w=f!=null,S=c?yh(c,!0):null,x=new Yg(n.shape,[g,d,p],i,s,b,S,w),C=[n,a];return l&&C.push(l),f&&C.push(f),this.compileAndRun(x,C,v)},t.prototype.multiply=function(e,n){if(e.dtype==="complex64"){var a=this.texData.get(e.dataId),i=this.texData.get(n.dataId),s=new rS(E4,e.shape,n.shape),l=new rS(C4,e.shape,n.shape),c=[this.makeComplexComponentTensorInfo(e,a.complexTensors.real),this.makeComplexComponentTensorInfo(e,a.complexTensors.imag),this.makeComplexComponentTensorInfo(n,i.complexTensors.real),this.makeComplexComponentTensorInfo(n,i.complexTensors.imag)],f=this.compileAndRun(s,c),d=this.compileAndRun(l,c),p=this.complex(f,d);return f.dispose(),d.dispose(),p}if(this.shouldExecuteOnCPU([e,n]))return this.cpuBackend.multiply(e,n);if(se().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,n,aS,e.dtype);var g=new Zt(aS,e.shape,n.shape);return this.compileAndRun(g,[e,n],e.dtype)},t.prototype.batchNormalization=function(e,n,a,i,s,l){var c=[e,n,a],f=null;l!=null&&(f=l.shape,c.push(l));var d=null;if(s!=null&&(d=s.shape,c.push(s)),se().getBool("WEBGL_PACK_NORMALIZATION")){var p=new S4(e.shape,n.shape,a.shape,f,d,i);return this.compileAndRun(p,c)}var g=new x4(e.shape,n.shape,a.shape,f,d,i);return this.compileAndRun(g,c)},t.prototype.localResponseNormalization4D=function(e,n,a,i,s){var l=se().getBool("WEBGL_PACK_NORMALIZATION")?new aL(e.shape,n,a,i,s):new nL(e.shape,n,a,i,s);return this.compileAndRun(l,[e])},t.prototype.LRNGrad=function(e,n,a,i,s,l,c){var f=new rL(n.shape,i,s,l,c);return this.compileAndRun(f,[n,a,e])},t.prototype.tile=function(e,n){if(e.dtype==="string"){var a=this.readSync(e.dataId).map(function(s){return cc(s)});return qA($e(e.shape,e.dtype,a),n)}var i=new NL(e.shape,n);return this.compileAndRun(i,[e])},t.prototype.pad=function(e,n,a){var i=se().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new fL(e.shape,n,a):new cL(e.shape,n,a);return this.compileAndRun(i,[e])},t.prototype.transpose=function(e,n){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.transpose(e,n);var a=se().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new IL(e.shape,n):new RL(e.shape,n);return this.compileAndRun(a,[e])},t.prototype.gather=function(e,n,a){if(this.shouldExecuteOnCPU([e,n]))return this.cpuBackend.gather(e,n,a);var i=new Q4(e.shape,n.size,a);return this.compileAndRun(i,[e,n])},t.prototype.batchToSpaceND=function(e,n,a){P(e.rank<=4,function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"});var i=n.reduce(function(p,g){return p*g}),s=ed(e.shape,n,i),l=td(s.length,n.length),c=nd(e.shape,n,i),f=LA(a,n.length),d=FA(c,a,n.length);return e.reshape(s).transpose(l).reshape(c).slice(f,d)},t.prototype.spaceToBatchND=function(e,n,a){P(e.rank<=4,function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"});var i=n.reduce(function(g,v){return g*v}),s=[[0,0]];s.push.apply(s,a);for(var l=1+n.length;l<e.shape.length;++l)s.push([0,0]);var c=e.pad(s),f=ed(c.shape,n,i,!1),d=td(f.length,n.length,!1),p=nd(c.shape,n,i,!1);return c.reshape(f).transpose(d).reshape(p)},t.prototype.reduce=function(e,n,a){var i=e.shape[0],s=e.shape[1],l=Xg(s),c=new hL({windowSize:l,inSize:s,batchSize:i},n),f=this.compileAndRun(c,[e],a);return f.shape[1]===1?f:this.reduce(f,n,a)},t.prototype.argReduce=function(e,n,a){a===void 0&&(a=null);var i=e.shape[0],s=e.shape[1];a!=null&&(i=a.shape[0],s=a.shape[1]);var l=Xg(s),c=new h4({windowSize:l,inSize:s,batchSize:i},n,a==null),f=[e];a!=null&&f.push(a);var d=this.compileAndRun(c,f,"int32");return d.shape[1]===1?d:this.argReduce(e,n,d)},t.prototype.argReducePacked=function(e,n,a){a===void 0&&(a=null);var i=a!=null?a.shape:e.shape,s=Xg(i[i.length-1]),l=new y4(i,s,n,a==null),c=a==null?[e]:[e,a],f=this.compileAndRun(l,c,"int32");return f.rank===e.rank?this.argReducePacked(e,n,f):f},t.prototype.sum=function(e,n){ur("sum",n,e.rank);var a=Ln(e.shape,n),i=a[0],s=Me(a[1]),l=e.as2D(-1,s),c=Hg(e.dtype);return this.reduce(l,"sum",c).reshape(i)},t.prototype.prod=function(e,n){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.prod(e,n);var a=Ln(e.shape,n),i=a[0],s=Me(a[1]),l=e.as2D(-1,s),c=Hg(e.dtype);return this.reduce(l,"prod",c).reshape(i)},t.prototype.unsortedSegmentSum=function(e,n,a){var i=0,s=ca([i],e.rank),l=e;s!=null&&(l=e.transpose(s),i=fa(1,e.rank)[0]);var c=function(v,b,w){for(var S=[],x=v.length,C=0;C<x;C++)C!==b?S.push(v[C]):S.push(w);return S}(l.shape,i,a),f=Me([l.shape[i]]),d=l.as2D(-1,f),p=Hg(e.dtype),g=this.segOpCompute(d,"unsortedSegmentSum",n,p,a).reshape(c);return s!=null&&(g=g.transpose(Sd(s))),g},t.prototype.segOpCompute=function(e,n,a,i,s){var l=e.shape[0],c=e.shape[1],f=function(g,v){var b,w=!1;for(g<=UA?(b=g,w=!0):b=Jh(g,Math.floor(Math.sqrt(g)));!w;)b>v||b===g?w=!0:b=Jh(g,b+1);return b}(c,s),d=new xL({windowSize:f,inSize:c,batchSize:l,numSegments:s},n),p=this.compileAndRun(d,[e,a],i);return p.shape[1]===s?p:(a=Ed(0,s).tile([c/f]),this.segOpCompute(p,n,a,i,s))},t.prototype.argMinMaxReduce=function(e,n,a){var i=[n];if(ur("arg"+a.charAt(0).toUpperCase()+a.slice(1),i,e.rank),!se().getBool("WEBGL_PACK_REDUCE")||e.rank<=2){var s=Ln(e.shape,i),l=s[0],c=Me(s[1]),f=e.as2D(-1,c);return this.argReduce(f,a).reshape(l)}return this.argReducePacked(e,a)},t.prototype.argMin=function(e,n){return this.argMinMaxReduce(e,n,"min")},t.prototype.argMax=function(e,n){return this.argMinMaxReduce(e,n,"max")},t.prototype.cumsum=function(e,n,a,i){if(n!==e.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+(e.rank-1)+" but got axis="+n);var s=new B4(e.shape,a,i);return this.compileAndRun(s,[e])},t.prototype.equal=function(e,n){if(se().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,n,`
  return vec4(equal(a, b));
`,"bool");var a=new Zt("return float(a == b);",e.shape,n.shape);return this.compileAndRun(a,[e,n],"bool")},t.prototype.notEqual=function(e,n){if(se().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,n,`
  return vec4(notEqual(a, b));
`,"bool");var a=new Zt("return float(a != b);",e.shape,n.shape);return this.compileAndRun(a,[e,n],"bool")},t.prototype.less=function(e,n){if(this.shouldExecuteOnCPU([e,n]))return this.cpuBackend.less(e,n);if(se().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,n,`
  return vec4(lessThan(a, b));
`,"bool");var a=new Zt("return float(a < b);",e.shape,n.shape);return this.compileAndRun(a,[e,n],"bool")},t.prototype.lessEqual=function(e,n){if(se().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,n,`
  return vec4(lessThanEqual(a, b));
`,"bool");var a=new Zt("return float(a <= b);",e.shape,n.shape);return this.compileAndRun(a,[e,n],"bool")},t.prototype.greater=function(e,n){if(this.shouldExecuteOnCPU([e,n]))return this.cpuBackend.greater(e,n);if(se().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,n,`
  return vec4(greaterThan(a, b));
`,"bool");var a=new Zt("return float(a > b);",e.shape,n.shape);return this.compileAndRun(a,[e,n],"bool")},t.prototype.greaterEqual=function(e,n){if(se().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,n,`
  return vec4(greaterThanEqual(a, b));
`,"bool");var a=new Zt("return float(a >= b);",e.shape,n.shape);return this.compileAndRun(a,[e,n],"bool")},t.prototype.logicalNot=function(e){var n=new Qe(e.shape,"return float(!(x >= 1.0));");return this.compileAndRun(n,[e])},t.prototype.logicalAnd=function(e,n){if(se().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,n,`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,"bool");var a=new Zt("return float(a >= 1.0 && b >= 1.0);",e.shape,n.shape);return this.compileAndRun(a,[e,n],"bool")},t.prototype.logicalOr=function(e,n){if(se().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,n,`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,"bool");var a=new Zt("return float(a >= 1.0 || b >= 1.0);",e.shape,n.shape);return this.compileAndRun(a,[e,n],"bool")},t.prototype.select=function(e,n,a){var i=new SL(e.rank,n.shape,n.rank);return this.compileAndRun(i,[e,n,a],cn(n.dtype,a.dtype))},t.prototype.where=function(e){Uv("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var n=e.dataSync();return ab(e.shape,n)},t.prototype.topk=function(e,n,a){return GA(e.dataSync(),e.shape,e.dtype,n)},t.prototype.min=function(e,n){ur("min",n,e.rank);var a=Ln(e.shape,n),i=a[0],s=Me(a[1]),l=e.as2D(-1,s);return this.reduce(l,"min",l.dtype).reshape(i)},t.prototype.minimum=function(e,n){if(this.shouldExecuteOnCPU([e,n]))return this.cpuBackend.minimum(e,n);var a=se().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ja(`
  vec4 result = vec4(min(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,e.shape,n.shape):new Zt(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return min(a, b);
`,e.shape,n.shape);return this.compileAndRun(a,[e,n])},t.prototype.mod=function(e,n){var a=se().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ja(`
  vec4 result = mod(a, b);
  vec4 isNaN = vec4(equal(b, vec4(0.0)));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,e.shape,n.shape):new Zt(`if (b == 0.0) return NAN;
  return mod(a, b);`,e.shape,n.shape);return this.compileAndRun(a,[e,n])},t.prototype.max=function(e,n){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.max(e,n);ur("max",n,e.rank);var a=Ln(e.shape,n),i=a[0],s=Me(a[1]),l=e.as2D(-1,s);return this.reduce(l,"max",l.dtype).reshape(i)},t.prototype.maximum=function(e,n){if(this.shouldExecuteOnCPU([e,n]))return this.cpuBackend.maximum(e,n);var a=se().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ja(`
  vec4 result = vec4(max(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,e.shape,n.shape):new Zt(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return max(a, b);
`,e.shape,n.shape);return this.compileAndRun(a,[e,n])},t.prototype.all=function(e,n){ur("all",n,e.rank);var a=Ln(e.shape,n),i=a[0],s=Me(a[1]),l=e.as2D(-1,s);return this.reduce(l,"all",l.dtype).reshape(i)},t.prototype.any=function(e,n){ur("any",n,e.rank);var a=Ln(e.shape,n),i=a[0],s=Me(a[1]),l=e.as2D(-1,s);return this.reduce(l,"any",l.dtype).reshape(i)},t.prototype.squaredDifference=function(e,n){var a=se().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ja("return (a - b) * (a - b);",e.shape,n.shape):new Zt("return (a - b) * (a - b);",e.shape,n.shape);return this.compileAndRun(a,[e,n])},t.prototype.realDivide=function(e,n){if(se().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,n,`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,"float32",!0);var a=new Zt(`
if (a == b) {
  return 1.0;
};
return a / b;`,e.shape,n.shape);return this.compileAndRun(a,[e,n],"float32")},t.prototype.floorDiv=function(e,n){if(se().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,n,`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,"int32");var a=new Zt(`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,e.shape,n.shape);return this.compileAndRun(a,[e,n],"int32")},t.prototype.add=function(e,n){if(e.dtype==="complex64"&&n.dtype==="complex64")return this.complexSeparableBinaryOp(e,n,$g);if(this.shouldExecuteOnCPU([e,n]))return this.cpuBackend.add(e,n);var a=cn(e.dtype,n.dtype);if(se().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,n,$g,a);var i=new Zt($g,e.shape,n.shape);return this.compileAndRun(i,[e,n],a)},t.prototype.packedUnaryOp=function(e,n,a){var i=new Xl(e.shape,n);return this.compileAndRun(i,[e],a)},t.prototype.packedBinaryOp=function(e,n,a,i,s){s===void 0&&(s=!1);var l=new Ja(a,e.shape,n.shape,s);return this.compileAndRun(l,[e,n],i)},t.prototype.complexSeparableBinaryOp=function(e,n,a){var i=this,s=this.texData.get(e.dataId),l=this.texData.get(n.dataId),c=[[s.complexTensors.real,l.complexTensors.real],[s.complexTensors.imag,l.complexTensors.imag]].map(function(g){var v=g[0],b=g[1],w=i.makeComplexComponentTensorInfo(e,v),S=i.makeComplexComponentTensorInfo(n,b),x=new Zt(a,e.shape,n.shape);return i.compileAndRun(x,[w,S],cn(v.dtype,b.dtype))}),f=c[0],d=c[1],p=this.complex(f,d);return f.dispose(),d.dispose(),p},t.prototype.makeComplexComponentTensorInfo=function(e,n){return{dataId:n.dataId,dtype:n.dtype,shape:e.shape}},t.prototype.addN=function(e){if(e.length===1)return e[0];if(e.length>se().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var n=Math.floor(e.length/2),a=this.addN(e.slice(0,n)),i=this.addN(e.slice(n));return this.addN([a,i])}var s=e.map(function(f){return f.dtype}).reduce(function(f,d){return cn(f,d)}),l=e.map(function(f){return f.shape}),c=se().getBool("WEBGL_PACK")?new f4(e[0].shape,l):new c4(e[0].shape,l);return this.compileAndRun(c,e,s)},t.prototype.subtract=function(e,n){if(e.dtype==="complex64"&&n.dtype==="complex64")return this.complexSeparableBinaryOp(e,n,Kg);if(this.shouldExecuteOnCPU([e,n]))return this.cpuBackend.subtract(e,n);var a=cn(e.dtype,n.dtype);if(se().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,n,Kg,e.dtype);var i=new Zt(Kg,e.shape,n.shape);return this.compileAndRun(i,[e,n],a)},t.prototype.pow=function(e,n){var a=se().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ja(`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,e.shape,n.shape):new Zt(`
if(a < 0.0 && floor(b) < b){
  return NAN;
}
if (b == 0.0) {
  return 1.0;
}
return (round(mod(b, 2.0)) != 1) ?
    pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,e.shape,n.shape),i=cn(e.dtype,n.dtype);return this.compileAndRun(a,[e,n],i)},t.prototype.ceil=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.ceil(e);if(se().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,gS,e.dtype);var n=new Qe(e.shape,gS);return this.compileAndRun(n,[e])},t.prototype.floor=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.floor(e);if(se().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,vS,e.dtype);var n=new Qe(e.shape,vS);return this.compileAndRun(n,[e])},t.prototype.sign=function(e){var n=new Qe(e.shape,`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`);return this.compileAndRun(n,[e])},t.prototype.isNaN=function(e){var n=new Qe(e.shape,"return float(isnan(x));");return this.compileAndRun(n,[e],"bool")},t.prototype.isInf=function(e){var n=new Qe(e.shape,"return float(isinf(x));");return this.compileAndRun(n,[e],"bool")},t.prototype.isFinite=function(e){var n=new Qe(e.shape,"return float(!isnan(x) && !isinf(x));");return this.compileAndRun(n,[e],"bool")},t.prototype.round=function(e){var n=new Qe(e.shape,`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`);return this.compileAndRun(n,[e])},t.prototype.exp=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.exp(e);if(se().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,yS,e.dtype);var n=new Qe(e.shape,yS);return this.compileAndRun(n,[e])},t.prototype.expm1=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.expm1(e);if(se().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,bS,e.dtype);var n=new Qe(e.shape,bS);return this.compileAndRun(n,[e])},t.prototype.log=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.log(e);if(se().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,`
  vec4 result = log(x);
  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));
  result.r = isNaN.r == 1.0 ? NAN : result.r;
  result.g = isNaN.g == 1.0 ? NAN : result.g;
  result.b = isNaN.b == 1.0 ? NAN : result.b;
  result.a = isNaN.a == 1.0 ? NAN : result.a;

  return result;
`,e.dtype);var n=new Qe(e.shape,`if (x < 0.0) return NAN;
  return log(x);`);return this.compileAndRun(n,[e])},t.prototype.log1p=function(e){var n=new Qe(e.shape,"return log(1.0 + x);");return this.compileAndRun(n,[e])},t.prototype.sqrt=function(e){var n=new Qe(e.shape,"return sqrt(x);");return this.compileAndRun(n,[e])},t.prototype.rsqrt=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.rsqrt(e);var n=new Qe(e.shape,"return inversesqrt(x);");return this.compileAndRun(n,[e])},t.prototype.reciprocal=function(e){var n=new Qe(e.shape,"return 1.0 / x;");return this.compileAndRun(n,[e])},t.prototype.relu=function(e){var n;return n=se().getBool("WEBGL_PACK")?new Xl(e.shape,yT):new Qe(e.shape,mT),this.compileAndRun(n,[e])},t.prototype.relu6=function(e){var n;return n=se().getBool("WEBGL_PACK")?new Xl(e.shape,bT):new Qe(e.shape,gT),this.compileAndRun(n,[e])},t.prototype.prelu=function(e,n){var a=se().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ja(ZA,e.shape,n.shape):new Zt(YA,e.shape,n.shape);return this.compileAndRun(a,[e,n])},t.prototype.elu=function(e){if(se().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,wT,e.dtype);var n=new Qe(e.shape,vT);return this.compileAndRun(n,[e])},t.prototype.eluDer=function(e,n){var a=se().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ja(`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,e.shape,n.shape):new Zt("return (b >= 1.0) ? a : a * (b + 1.0);",e.shape,n.shape);return this.compileAndRun(a,[e,n])},t.prototype.selu=function(e){var n=new Qe(e.shape,DL);return this.compileAndRun(n,[e])},t.prototype.int=function(e){var n=new Qe(e.shape,"return float(int(x));");return this.compileAndRun(n,[e],"int32")},t.prototype.clip=function(e,n,a){var i,s=(i=se().getBool("WEBGL_PACK_CLIP")?new T4(e.shape):new A4(e.shape)).getCustomSetupFunc(n,a);return this.compileAndRun(i,[e],null,s)},t.prototype.abs=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.abs(e);if(se().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,pS,e.dtype);var n=new Qe(e.shape,pS);return this.compileAndRun(n,[e])},t.prototype.complexAbs=function(e){var n=this.texData.get(e.dataId),a=new N4(e.shape),i=[this.makeComplexComponentTensorInfo(e,n.complexTensors.real),this.makeComplexComponentTensorInfo(e,n.complexTensors.imag)];return this.compileAndRun(a,i)},t.prototype.sigmoid=function(e){var n=new Qe(e.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(n,[e])},t.prototype.softplus=function(e){var n=new Qe(e.shape,`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`);return this.compileAndRun(n,[e])},t.prototype.sin=function(e){var n=new Qe(e.shape,OL);return this.compileAndRun(n,[e])},t.prototype.cos=function(e){var n=new Qe(e.shape,_L);return this.compileAndRun(n,[e])},t.prototype.tan=function(e){var n=new Qe(e.shape,"return tan(x);");return this.compileAndRun(n,[e])},t.prototype.asin=function(e){var n=new Qe(e.shape,ML);return this.compileAndRun(n,[e])},t.prototype.acos=function(e){var n=new Qe(e.shape,zL);return this.compileAndRun(n,[e])},t.prototype.atan=function(e){var n=new Qe(e.shape,LL);return this.compileAndRun(n,[e])},t.prototype.atan2=function(e,n){var a=se().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ja(`
  vec4 result = atan(a, b);
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,e.shape,n.shape):new Zt(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return atan(a, b);
`,e.shape,n.shape);return this.compileAndRun(a,[e,n])},t.prototype.sinh=function(e){var n=new Qe(e.shape,`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`);return this.compileAndRun(n,[e])},t.prototype.cosh=function(e){var n=new Qe(e.shape,`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`);return this.compileAndRun(n,[e])},t.prototype.tanh=function(e){var n=new Qe(e.shape,`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`);return this.compileAndRun(n,[e])},t.prototype.asinh=function(e){var n=new Qe(e.shape,FL);return this.compileAndRun(n,[e])},t.prototype.acosh=function(e){var n=new Qe(e.shape,BL);return this.compileAndRun(n,[e])},t.prototype.atanh=function(e){var n=new Qe(e.shape,UL);return this.compileAndRun(n,[e])},t.prototype.erf=function(e){var n=new Qe(e.shape,`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = 0.3275911;
  float a1 = 0.254829592;
  float a2 = -0.284496736;
  float a3 = 1.421413741;
  float a4 = -1.453152027;
  float a5 = 1.061405429;

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`);return this.compileAndRun(n,[e])},t.prototype.step=function(e,n){var a=new Qe(e.shape,function(i){return i===void 0&&(i=0),ha+`
    return x > 0.0 ? 1.0 : float(`+i+`);
  `}(n));return this.compileAndRun(a,[e])},t.prototype.conv2dByMatMul=function(e,n,a,i,s,l){var c=e.shape,f=this.texData.get(e.dataId),d=a.inChannels,p=c[0]*c[1]*c[2],g=a.outChannels,v=a.dataFormat==="channelsLast",b=(p===1||g===1)&&d>1e3,w=c[2]%2!=0&&!!f.isPacked;if(b||!se().getBool("WEBGL_LAZILY_UNPACK")||!se().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!w){var S=v?c[0]*c[1]*c[2]:c[0]*c[2]*c[3],x=this.reshape(e,[1,S,a.inChannels]),C=this.reshape(n,[1,a.inChannels,a.outChannels]);return this.reshape(this.fusedBatchMatMul({a:x,b:C,transposeA:!1,transposeB:!1,bias:i,activation:s,preluActivationWeights:l}),a.outShape)}var A=v?c[0]*c[1]*(c[2]+1):c[0]*c[2]*(c[3]+1),T={dataId:e.dataId,shape:[1,A,a.inChannels],dtype:e.dtype},R=f.shape;f.shape=f.shape.slice(),f.shape[f.shape.length-2]++,P(Jl(f.shape,T.shape),function(){return"packed reshape "+f.shape+" to "+T.shape+" isn't free"});var O=this.reshape(n,[1,a.inChannels,a.outChannels]),N=this.fusedBatchMatMul({a:T,b:O,transposeA:!1,transposeB:!1,bias:i,activation:s,preluActivationWeights:l}),D=this.texData.get(N.dataId);return P(D.isPacked,function(){return"batchMatMul result is expected to be packed"}),f.shape=R,D.shape=a.outShape,$.makeTensorFromDataId(N.dataId,a.outShape,N.dtype)},t.prototype.conv2dWithIm2Row=function(e,n,a,i,s,l){var c=a.filterWidth,f=a.filterHeight,d=a.inChannels,p=a.outWidth,g=a.outHeight,v=a.dataFormat==="channelsLast",b=c*f*d,w=g*p,S=[b,w],x=e.squeeze([0]),C=n.reshape([1,b,-1]),A=new tL(S,x.shape,a),T=this.compileAndRun(A,[x]).reshape([1,S[0],S[1]]),R=i!=null,O=l!=null,N=s?yh(s,!0):null,D=new Yg(T.shape,[1,w,a.outChannels],!0,!1,R,N,O),I=[T,C];i&&I.push(i),O&&I.push(l);var _=this.compileAndRun(D,I);return v?_.reshape([1,g,p,a.outChannels]):_.reshape([1,a.outChannels,g,p])},t.prototype.fusedConv2d=function(e){var n=e.input,a=e.filter,i=e.convInfo,s=e.bias,l=e.activation,c=e.preluActivationWeights;if(i.filterHeight===1&&i.filterWidth===1&&i.dilationHeight===1&&i.dilationWidth===1&&i.strideHeight===1&&i.strideWidth===1&&(i.padInfo.type==="SAME"||i.padInfo.type==="VALID"))return this.conv2dByMatMul(n,a,i,s,l,c);if(se().getBool("WEBGL_CONV_IM2COL")&&n.shape[0]===1)return this.conv2dWithIm2Row(n,a,i,s,l,c);var f=s!=null,d=c!=null,p=l?yh(l,!1):null,g=new iS(i,f,p,d),v=[n,a];return s&&v.push(s),c&&v.push(c),this.compileAndRun(g,v)},t.prototype.conv2d=function(e,n,a){if(a.filterHeight===1&&a.filterWidth===1&&a.dilationHeight===1&&a.dilationWidth===1&&a.strideHeight===1&&a.strideWidth===1&&(a.padInfo.type==="SAME"||a.padInfo.type==="VALID"))return this.conv2dByMatMul(e,n,a);if(se().getBool("WEBGL_CONV_IM2COL")&&e.shape[0]===1)return this.conv2dWithIm2Row(e,n,a);var i=new iS(a);return this.compileAndRun(i,[e,n])},t.prototype.conv2dDerInput=function(e,n,a){var i=new D4(a);return this.compileAndRun(i,[e,n])},t.prototype.conv2dDerFilter=function(e,n,a){var i=new k4(a);return this.compileAndRun(i,[e,n])},t.prototype.fusedDepthwiseConv2D=function(e){var n,a=e.input,i=e.filter,s=e.convInfo,l=e.bias,c=e.activation,f=e.preluActivationWeights,d=se().getBool("WEBGL_PACK_DEPTHWISECONV")&&s.strideWidth<=2&&s.outChannels/s.inChannels==1,p=c?yh(c,d):null,g=[a,i],v=l!=null,b=f!=null;return v&&g.push(l),b&&g.push(f),d?(n=new sS(s,v,p,b),this.compileAndRun(n,g)):(n=new oS(s,v,p,b),this.compileAndRun(n,g))},t.prototype.depthwiseConv2D=function(e,n,a){var i;return se().getBool("WEBGL_PACK_DEPTHWISECONV")&&a.strideWidth<=2&&a.outChannels/a.inChannels==1?(i=new sS(a),this.compileAndRun(i,[e,n])):(i=new oS(a),this.compileAndRun(i,[e,n]))},t.prototype.depthwiseConv2DDerInput=function(e,n,a){var i=new z4(a);return this.compileAndRun(i,[e,n])},t.prototype.depthwiseConv2DDerFilter=function(e,n,a){var i=new M4(a);return this.compileAndRun(i,[e,n])},t.prototype.conv3d=function(e,n,a){var i=new L4(a);return this.compileAndRun(i,[e,n])},t.prototype.conv3dDerInput=function(e,n,a){var i=new _4(a);return this.compileAndRun(i,[e,n])},t.prototype.conv3dDerFilter=function(e,n,a){var i=new O4(a);return this.compileAndRun(i,[e,n])},t.prototype.maxPool=function(e,n){var a=new Zg(n,"max",!1);return this.compileAndRun(a,[e])},t.prototype.avgPool=function(e,n){var a=new Zg(n,"avg",!1);return this.compileAndRun(a,[e],"float32")},t.prototype.maxPoolBackprop=function(e,n,a,i){var s=new Zg(i,"max",!0),l=this.compileAndRun(s,[n]),c=new iL(i),f=this.compileAndRun(c,[e,l],n.dtype);return l.dispose(),f},t.prototype.avgPoolBackprop=function(e,n,a){var i=new b4(a);return this.compileAndRun(i,[e],n.dtype)},t.prototype.cast=function(e,n){return tb(e,n,this)},t.prototype.unstack=function(e,n){for(var a=e.shape[n],i=new Array(e.rank-1),s=0,l=0;l<e.rank;l++)l!==n&&(i[s++]=e.shape[l]);var c=new Array(e.rank).fill(0),f=e.shape.slice();f[n]=1;var d=new Array(a);for(l=0;l<d.length;l++)c[n]=l,d[l]=this.slice(e,c,f).reshape(i);return d},t.prototype.avgPool3d=function(e,n){var a=new Qg(n,"avg",!1);return this.compileAndRun(a,[e],"float32")},t.prototype.avgPool3dBackprop=function(e,n,a){var i=new w4(a);return this.compileAndRun(i,[e],n.dtype)},t.prototype.maxPool3d=function(e,n){var a=new Qg(n,"max",!1);return this.compileAndRun(a,[e],"float32")},t.prototype.maxPool3dBackprop=function(e,n,a,i){var s=new Qg(i,"max",!0),l=this.compileAndRun(s,[n]),c=new oL(i),f=this.compileAndRun(c,[e,l],n.dtype);return l.dispose(),f},t.prototype.reshape=function(e,n){var a=this.texData.get(e.dataId);if(a.isPacked&&!Jl(e.shape,n)&&(a.texture===null||!Jl(a.shape,n))){var i=this.packedReshape(e,n);return $.makeTensorFromDataId(i.dataId,i.shape,i.dtype)}return id(e,n)},t.prototype.resizeBilinear=function(e,n,a,i){var s=se().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new gL(e.shape,n,a,i):new mL(e.shape,n,a,i);return this.compileAndRun(s,[e])},t.prototype.resizeBilinearBackprop=function(e,n,a){var i=new pL(e,n,a);return this.compileAndRun(i,[e])},t.prototype.resizeNearestNeighbor=function(e,n,a,i){var s=new yL(e.shape,n,a,i);return this.compileAndRun(s,[e])},t.prototype.resizeNearestNeighborBackprop=function(e,n,a){var i=new vL(e,n,a);return this.compileAndRun(i,[e])},t.prototype.multinomial=function(e,n,a,i){var s=n?e:fs(e),l=s.shape[0],c=s.shape[1],f=new sL(l,c,a),d=f.getCustomSetupFunc(i);return this.compileAndRun(f,[s],"int32",d)},t.prototype.oneHot=function(e,n,a,i){var s=new uL(e.size,n,a,i);return this.compileAndRun(s,[e])},t.prototype.diag=function(e){var n=new j4(e.size);return this.compileAndRun(n,[e])},t.prototype.nonMaxSuppression=function(e,n,a,i,s){return Uv("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead"),rb(e.dataSync(),n.dataSync(),a,i,s)},t.prototype.cropAndResize=function(e,n,a,i,s,l){var c=new F4(e.shape,n.shape,i,s,l);return this.compileAndRun(c,[e,n,a])},t.prototype.depthToSpace=function(e,n,a){P(n>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+n});var i=e.shape[0],s=a==="NHWC"?e.shape[1]:e.shape[2],l=a==="NHWC"?e.shape[2]:e.shape[3],c=a==="NHWC"?e.shape[3]:e.shape[1],f=s*n,d=l*n,p=c/(n*n),g=new V4(a==="NHWC"?[i,f,d,p]:[i,p,f,d],n,a);return this.compileAndRun(g,[e])},t.prototype.split=function(e,n,a){return HA(e,n,a)},t.prototype.scatterND=function(e,n,a){var i=rd(0,e,a),s=i.sliceRank,l=i.numUpdates,c=i.sliceSize,f=i.strides,d=i.outputSize,p=[d/c,c],g=e.reshape([l,s]),v=n.reshape([l,c]);if(d===0)return id(rn([]),a);var b=Re(0),w=new fS(l,s,g.rank,v.rank,f,p);return this.compileAndRun(w,[v,g,b]).reshape(a)},t.prototype.sparseToDense=function(e,n,a,i){var s=rd(0,e,a),l=s.sliceRank,c=s.numUpdates,f=s.strides,d=s.outputSize,p=new fS(c,l,e.rank,n.rank,f,[d,1],!1);return this.compileAndRun(p,[n,e,i]).reshape(a)},t.prototype.fft=function(e){return this.fftImpl(e,!1)},t.prototype.ifft=function(e){return this.fftImpl(e,!0)},t.prototype.fftImpl=function(e,n){var a=this.texData.get(e.dataId),i=new lS(X4,e.shape,n),s=new lS($4,e.shape,n),l=[this.makeComplexComponentTensorInfo(e,a.complexTensors.real),this.makeComplexComponentTensorInfo(e,a.complexTensors.imag)],c=this.compileAndRun(i,l),f=this.compileAndRun(s,l),d=this.complex(c,f).as2D(e.shape[0],e.shape[1]);return c.dispose(),f.dispose(),d},t.prototype.gatherND=function(e,n){var a=n.shape,i=a[a.length-1],s=BA(e,n),l=s[0],c=s[1],f=s[2],d=s[3],p=n.reshape([c,i]),g=e.reshape([e.size/f,f]),v=new J4(i,d,[c,f]);return this.compileAndRun(v,[g,p]).reshape(l)},t.prototype.fill=function(e,n,a){if((a=a||_u(n))==="string"){var i=lc(a,Me(e));return i.fill(n),$.makeTensor(i,e,a,this)}var s=new K4(e,n),l=s.getCustomSetupFunc(n);return this.compileAndRun(s,[],a,l)},t.prototype.onesLike=function(e){if(e.dtype==="string")throw new Error("onesLike is not supported under string dtype");return this.fill(e.shape,1,e.dtype)},t.prototype.zerosLike=function(e){return this.fill(e.shape,e.dtype==="string"?"":0,e.dtype)},t.prototype.linspace=function(e,n,a){return nb(e,n,a)},t.prototype.makeTensorInfo=function(e,n){var a=this.write(null,e,n);return this.texData.get(a).usage=null,{dataId:a,shape:e,dtype:n}},t.prototype.makeOutput=function(e,n){var a=this.makeTensorInfo(e,n).dataId;return $.makeTensorFromDataId(a,e,n,this)},t.prototype.unpackTensor=function(e){var n=new VL(e.shape);return this.runWebGLProgram(n,[e],e.dtype)},t.prototype.packTensor=function(e){var n=new lL(e.shape);return this.runWebGLProgram(n,[e],e.dtype,null,!0)},t.prototype.packedReshape=function(e,n){var a=[dc(e.shape)].concat(pc(e.shape)),i={dtype:e.dtype,shape:a,dataId:e.dataId},s=[dc(n)].concat(pc(n)),l=new dL(s,a),c=this.runWebGLProgram(l,[i],e.dtype,null,!0);return{dataId:c.dataId,shape:n,dtype:c.dtype}},t.prototype.decode=function(e){var n,a=this.texData.get(e),i=a.isPacked,s=a.shape,l=a.dtype,c=Fh(s);return n=i?new P4(c):new U4(c),{dtype:l,shape:s,dataId:this.runWebGLProgram(n,[{shape:c,dtype:l,dataId:e}],l,null,!0).dataId}},t.prototype.runWebGLProgram=function(e,n,a,i,s){var l=this;s===void 0&&(s=!1);var c=this.makeTensorInfo(e.outputShape,a),f=this.texData.get(c.dataId);if(e.packedOutput&&(f.isPacked=!0),e.outPackingScheme===hc.DENSE){var d=rc(e.outputShape);f.texShape=d.map(function(A){return 2*A})}if(e.outTexUsage!=null&&(f.usage=e.outTexUsage),Me(c.shape)===0)return f.values=uc(c.dtype,0),c;var p=[],g=n.map(function(A){if(A.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var T=l.texData.get(A.dataId);if(T.texture==null){if(!e.packedInputs&&Me(A.shape)<=se().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:A.shape,texData:null,isUniform:!0,uniformValues:T.values};e.packedInputs&&(T.isPacked=!0,T.shape=A.shape)}else if(!!T.isPacked!=!!e.packedInputs)A=T.isPacked?l.unpackTensor(A):l.packTensor(A),p.push(A),T=l.texData.get(A.dataId);else if(T.isPacked&&!Jl(T.shape,A.shape)){var R=A,O=A.shape;A.shape=T.shape,A=l.packedReshape(A,O),p.push(A),T=l.texData.get(A.dataId),R.shape=O}return l.uploadToGPU(A.dataId),{shape:A.shape,texData:T,isUniform:!1}});this.uploadToGPU(c.dataId);var v,b={shape:c.shape,texData:f,isUniform:!1},w=function(A,T,R){var O="";T.concat(R).forEach(function(I){var _=I.texData!=null&&I.texData.slice!=null&&I.texData.slice.flatOffset>0,F=I.isUniform?"uniform":I.texData.texShape;O+=I.shape+"_"+F+"_"+_});var N=A.userCode,D=A.constructor.name;return D+="_"+O+"_"+N}(e,g,b),S=this.getAndSaveBinary(w,function(){return function(A,T,R,O){var N=T.userCode,D=R.map(function(q,ne){var L={logicalShape:q.shape,texShape:q.isUniform?null:q.texData.texShape,isUniform:q.isUniform,isPacked:!q.isUniform&&q.texData.isPacked,flatOffset:null};return q.texData!=null&&q.texData.slice!=null&&q.texData.slice.flatOffset>0&&(L.flatOffset=q.texData.slice.flatOffset),{name:T.variableNames[ne],shapeInfo:L}}),I=D.map(function(q){return q.shapeInfo}),_={logicalShape:O.shape,texShape:O.texData.texShape,isUniform:!1,isPacked:O.texData.isPacked,flatOffset:null},F=d4(D,_,N,T.packedInputs),B=A.createProgram(F),V=null,X=A.getUniformLocation(B,"NAN",!1);se().getNumber("WEBGL_VERSION")===1&&(V=A.getUniformLocation(B,"INFINITY",!1));for(var Y={},j=0;j<T.variableNames.length;j++){var G=T.variableNames[j];Y[G]=A.getUniformLocation(B,G,!1),Y["offset"+G]=A.getUniformLocation(B,"offset"+G,!1)}return{program:T,source:F,webGLProgram:B,uniformLocations:Y,inShapeInfos:I,outShapeInfo:_,infLoc:V,nanLoc:X}}(l.gpgpu,e,g,b)}),x=this.activeTimers!=null;if(x&&(v=this.startTimer()),function(A,T,R,O,N){cS(T.inShapeInfos,R),cS([T.outShapeInfo],[O]);var D=O.texData.texture,I=O.texData.texShape;O.texData.isPacked?A.setOutputPackedMatrixTexture(D,I[0],I[1]):A.setOutputMatrixTexture(D,I[0],I[1]),A.setProgram(T.webGLProgram),se().getNumber("WEBGL_VERSION")===1&&T.infLoc!==null&&A.gl.uniform1f(T.infLoc,1/0),T.nanLoc!==null&&A.gl.uniform1f(T.nanLoc,NaN),R.forEach(function(_,F){var B=T.program.variableNames[F],V=T.uniformLocations[B],X=T.uniformLocations["offset"+B];if(V!=null)if(_.isUniform)if(Me(_.shape)<2)A.gl.uniform1f(V,_.uniformValues[0]);else{var Y=_.uniformValues;Y instanceof Float32Array||(Y=new Float32Array(Y)),A.gl.uniform1fv(V,Y)}else _.texData.slice!=null&&X!=null&&A.gl.uniform1i(X,_.texData.slice.flatOffset),A.setInputMatrixTexture(_.texData.texture,V,F)}),N!=null&&N(A,T.webGLProgram),A.executeProgram()}(this.gpgpu,S,g,b,i),p.forEach(function(A){return l.disposeData(A.dataId)}),x&&(v=this.endTimer(v),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(v)})),!se().getBool("WEBGL_LAZILY_UNPACK")&&f.isPacked&&s===!1){var C=this.unpackTensor(c);return this.disposeData(c.dataId),C}return c},t.prototype.compileAndRun=function(e,n,a,i,s){s===void 0&&(s=!1),a=a||n[0].dtype;var l=this.runWebGLProgram(e,n,a,i,s);return $.makeTensorFromDataId(l.dataId,l.shape,l.dtype)},t.prototype.getAndSaveBinary=function(e,n){return e in this.binaryCache||(this.binaryCache[e]=n()),this.binaryCache[e]},t.prototype.getTextureManager=function(){return this.textureManager},t.prototype.dispose=function(){this.disposed||(this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.fromPixels2DContext!=null&&this.fromPixels2DContext.canvas.remove&&this.fromPixels2DContext.canvas.remove(),this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)},t.prototype.floatPrecision=function(){var e=this;return this.floatPrecisionValue==null&&(this.floatPrecisionValue=ae(function(){if(!se().get("WEBGL_RENDER_FLOAT32_ENABLED")){var n=se().getBool("DEBUG");se().set("DEBUG",!1);var a=e.abs(Re(1e-8)).dataSync()[0];if(se().set("DEBUG",n),a>0)return 32}return 16})),this.floatPrecisionValue},t.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},t.prototype.uploadToGPU=function(e){var n,a=this.texData.get(e),i=a.shape,s=a.dtype,l=a.values,c=a.texture,f=a.usage,d=a.isPacked;if(c==null){var p,g=this.activeTimers!=null;g&&(p=ta());var v=a.texShape;if(v==null&&(v=mA(i,d),a.texShape=v),l!=null){var b=Fh(i),w=void 0,S=v[1],x=v[0],C=l instanceof Uint8Array;d?(S=(n=Rc(v[0],v[1]))[0],x=n[1],w=new G4(b,[x,S],C)):w=new q4(b,[x,S],C);var A=this.makeTensorInfo([x,S],s);this.texData.get(A.dataId).usage=C?Er.PIXELS:Er.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(A.dataId),S,x,l);var T=this.runWebGLProgram(w,[A],s,null,!0),R=this.texData.get(T.dataId);a.texture=R.texture,a.texShape=R.texShape,a.isPacked=R.isPacked,a.usage=R.usage,this.disposeData(A.dataId),this.texData.delete(T.dataId),a.values=null,g&&(this.uploadWaitMs+=ta()-p)}else{var O=this.acquireTexture(v,f,s,d);a.texture=O}}},t.prototype.convertAndCacheOnCPU=function(e,n){var a=this.texData.get(e),i=a.dtype;return this.releaseGPUData(e),n!=null&&(a.values=function(s,l){if(l==="float32"||l==="complex64")return s;if(l==="int32"||l==="bool"){for(var c=l==="int32"?new Int32Array(s.length):new Uint8Array(s.length),f=0;f<c.length;++f)c[f]=Math.round(s[f]);return c}throw new Error("Unknown dtype "+l)}(n,i)),a.values},t.prototype.acquireTexture=function(e,n,a,i){if(this.numBytesInGPU+=this.computeBytes(e,a),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var s=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: "+s+" MB, most likely due to a memory leak")}return this.textureManager.acquireTexture(e,n,i)},t.prototype.computeBytes=function(e,n){return e[0]*e[1]*Dy(n)},t}(Jy);KC()&&$.registerBackend("webgl",function(){return new xT},2);var ub=K({square_:function(r){var t=U(r,"x","square"),e=[t];return $.runKernelFunc(function(n,a){return a([t]),n.square(t)},{x:t},function(n,a){var i=a[0];return{x:function(){return n.mul(i.toFloat().mul(2))}}},"Square",{},e,[])}}),to=K({abs_:function(r){var t=U(r,"x","abs");return t.dtype==="complex64"?$.runKernelFunc(function(e){return e.complexAbs(t)},{$x:t}):$.runKernelFunc(function(e,n){var a=e.abs(t);return n([t]),a},{x:t},function(e,n){var a=n[0];return{x:function(){return e.mul(a.toFloat().step(-1))}}},"Abs")}}),lb=K({acos_:function(r){var t=U(r,"x","acos");return $.runKernelFunc(function(e,n){var a=e.acos(t);return n([t]),a},{$x:t},function(e,n){var a=n[0];return{$x:function(){return e.divStrict(Re(1).sub(a.toFloat().square()).sqrt()).neg()}}})}}),cb=K({acosh_:function(r){var t=U(r,"x","acosh");return $.runKernelFunc(function(e,n){var a=e.acosh(t);return n([t]),a},{$x:t},function(e,n){var a=n[0];return{$x:function(){return e.divStrict(a.toFloat().square().sub(1).sqrt())}}})}}),fb=K({asin_:function(r){var t=U(r,"x","asin");return $.runKernelFunc(function(e,n){var a=e.asin(t);return n([t]),a},{$x:t},function(e,n){var a=n[0];return{$x:function(){return e.divStrict(Re(1).sub(a.toFloat().square()).sqrt())}}})}}),hb=K({asinh_:function(r){var t=U(r,"x","asinh");return $.runKernelFunc(function(e,n){var a=e.asinh(t);return n([t]),a},{$x:t},function(e,n){var a=n[0];return{$x:function(){return e.divStrict(Re(1).add(a.toFloat().square()).sqrt())}}})}}),db=K({atan_:function(r){var t=U(r,"x","atan");return $.runKernelFunc(function(e,n){var a=e.atan(t);return n([t]),a},{$x:t},function(e,n){var a=n[0];return{$x:function(){return e.div(a.toFloat().square().add(1))}}})}}),pb=K({atanh_:function(r){var t=U(r,"x","atanh");return $.runKernelFunc(function(e,n){var a=e.atanh(t);return n([t]),a},{$x:t},function(e,n){var a=n[0];return{$x:function(){return e.div(Re(1).sub(a.toFloat().square()))}}})}}),mb=K({ceil_:function(r){var t=U(r,"x","ceil");return $.runKernelFunc(function(e){return e.ceil(t)},{$x:t},function(e){return{$x:function(){return ct(e)}}})}}),Jn=K({clipByValue_:function(r,t,e){var n=U(r,"x","clipByValue");return P(t<=e,function(){return"Error in clip: min ("+t+") must be less than or equal to max ("+e+")."}),$.runKernelFunc(function(a,i){var s=a.clip(n,t,e);return i([n]),s},{$x:n},function(a,i){var s=i[0];return{$x:function(){return a.where(s.greaterEqual(t).logicalAnd(s.lessEqual(e)),ct(a))}}})}}),gb=K({cos_:function(r){var t=U(r,"x","cos");return $.runKernelFunc(function(e,n){var a=e.cos(t);return n([t]),a},{$x:t},function(e,n){var a=n[0];return{$x:function(){return a.toFloat().sin().neg().mul(e)}}})}}),vb=K({cosh_:function(r){var t=U(r,"x","cosh");return $.runKernelFunc(function(e,n){var a=e.cosh(t);return n([t]),a},{$x:t},function(e,n){var a=n[0];return{$x:function(){return a.toFloat().sinh().mulStrict(e)}}})}}),yb=K({erf_:function(r){var t=U(r,"x","erf");return P(t.dtype==="int32"||t.dtype==="float32",function(){return"Input dtype must be `int32` or `float32`."}),t.dtype==="int32"&&(t=t.toFloat()),$.runKernelFunc(function(e,n){var a=e.erf(t);return n([t]),a},{$x:t},function(e,n){var a=n[0];return{$x:function(){return e.mul(a.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}})}}),bb=K({exp_:function(r){var t=U(r,"x","exp");return $.runKernelFunc(function(e,n){var a=e.exp(t);return n([a]),a},{$x:t},function(e,n){return{$x:function(){return e.mulStrict(n[0])}}})}}),wb=K({expm1_:function(r){var t=U(r,"x","expm1");return $.runKernelFunc(function(e,n){var a=e.expm1(t);return n([t]),a},{$x:t},function(e,n){var a=n[0];return{$x:function(){return e.mul(a.exp())}}})}}),_d=K({floor_:function(r){var t=U(r,"x","floor");return $.runKernelFunc(function(e){return e.floor(t)},{$x:t},function(e){return{$x:function(){return ct(e)}}})}}),ci=K({log_:function(r){var t=U(r,"x","log");return $.runKernelFunc(function(e,n){var a=e.log(t);return n([t]),a},{$x:t},function(e,n){var a=n[0];return{$x:function(){return e.div(a.toFloat())}}})}}),xb=K({log1p_:function(r){var t=U(r,"x","log1p");return $.runKernelFunc(function(e,n){var a=e.log1p(t);return n([t]),a},{$x:t},function(e,n){var a=n[0];return{$x:function(){return e.div(a.add(1))}}})}}),ST=K({logSigmoid_:function(r){var t=U(r,"x","logSigmoid");return $.runKernelFunc(function(e,n){var a=e.softplus(t.neg()).neg();return n([t]),a},{$x:t},function(e,n){var a=n[0];return{$x:function(){return e.mul(a.neg().sigmoid())}}})}}),hs=K({neg_:function(r){var t=U(r,"x","neg");return $.runKernelFunc(function(e){return e.neg(t)},{$x:t},function(e){return{$x:function(){return e.neg()}}})}}),Sb=K({reciprocal_:function(r){var t=U(r,"x","reciprocal");return $.runKernelFunc(function(e,n){var a=e.reciprocal(t);return n([t]),a},{$x:t},function(e,n){var a=n[0];return{$x:function(){return e.div(a.square().neg())}}})}}),Eb=K({round_:function(r){var t=U(r,"x","round");return $.runKernelFunc(function(e){return e.round(t)},{$x:t},function(e){return{$x:function(){return ct(e)}}})}}),Md=K({rsqrt_:function(r){var t=U(r,"x","rsqrt");return $.runKernelFunc(function(e,n){var a=e.rsqrt(t);return n([t]),a},{$x:t},function(e,n){var a=n[0];return{$x:function(){return e.div(a.pow(1.5).mul(2)).neg()}}})}}),zd=K({sigmoid_:function(r){var t=U(r,"x","sigmoid");return $.runKernelFunc(function(e,n){var a=e.sigmoid(t);return n([a]),a},{x:t},function(e,n){var a=n[0];return{x:function(){return e.mul(a.mul(Re(1).sub(a)))}}},"Sigmoid")}}),Cb=K({sign_:function(r){var t=U(r,"x","sign");return $.runKernelFunc(function(e){return e.sign(t)},{$x:t},function(e){return{$x:function(){return ct(e)}}})}}),ET=K({isNaN_:function(r){var t=U(r,"x","isNaN");return $.runKernelFunc(function(e){return e.isNaN(t)},{$x:t},function(e){return{$x:function(){return ct(e)}}})}}),CT=K({isInf_:function(r){var t=U(r,"x","isInf");return $.runKernelFunc(function(e){return e.isInf(t)},{$x:t},function(e){return{$x:function(){return ct(e)}}})}}),AT=K({isFinite_:function(r){var t=U(r,"x","isFinite");return $.runKernelFunc(function(e){return e.isFinite(t)},{$x:t},function(e){return{$x:function(){return ct(e)}}})}}),Ab=K({sin_:function(r){var t=U(r,"x","sin");return $.runKernelFunc(function(e,n){var a=e.sin(t);return n([t]),a},{$x:t},function(e,n){var a=n[0];return{$x:function(){return a.toFloat().cos().mul(e)}}})}}),Tb=K({sinh_:function(r){var t=U(r,"x","sinh");return $.runKernelFunc(function(e,n){var a=e.sinh(t);return n([t]),a},{$x:t},function(e,n){var a=n[0];return{$x:function(){return a.toFloat().cosh().mulStrict(e)}}})}}),_c=K({softplus_:function(r){var t=U(r,"x","softplus");return $.runKernelFunc(function(e,n){var a=e.softplus(t);return n([t]),a},{$x:t},function(e,n){var a=n[0];return{$x:function(){return e.mul(a.sigmoid())}}})}}),Mc=K({sqrt_:function(r){var t=U(r,"x","sqrt");return $.runKernelFunc(function(e,n){var a=e.sqrt(t);return n([t]),a},{$x:t},function(e,n){var a=n[0];return{$x:function(){return e.div(a.toFloat().sqrt().mul(2))}}})}}),TT=K({step_:function(r,t){t===void 0&&(t=0);var e=U(r,"x","step");return $.runKernelFunc(function(n){return n.step(e,t)},{$x:e},function(n){return{$x:function(){return ct(n)}}})}}),Nb=K({tan_:function(r){var t=U(r,"x","tan");return $.runKernelFunc(function(e,n){var a=e.tan(t);return n([t]),a},{$x:t},function(e,n){var a=n[0];return{$x:function(){return e.div(a.cos().square())}}})}}),Ld=K({tanh_:function(r){var t=U(r,"x","tanh");return $.runKernelFunc(function(e,n){var a=e.tanh(t);return n([a]),a},{$x:t},function(e,n){var a=n[0];return{$x:function(){return Re(1).sub(a.square()).mulStrict(e)}}})}});function NT(r,t,e,n,a,i){var s,l,c=U(r,"x","batchNorm"),f=U(t,"mean","batchNorm"),d=U(e,"variance","batchNorm");return a!=null&&(s=U(a,"scale","batchNorm")),n!=null&&(l=U(n,"offset","batchNorm")),P(c.rank===2,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+c.rank+"."}),P(f.rank===2||f.rank===1,function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank "+f.rank+"."}),P(d.rank===2||d.rank===1,function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank "+d.rank+"."}),s!=null&&P(s.rank===2||s.rank===1,function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank "+s.rank+"."}),l!=null&&P(l.rank===2||l.rank===1,function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank "+l.rank+"."}),zc(c,f,d,l,s,i)}function RT(r,t,e,n,a,i){var s,l,c=U(r,"x","batchNorm"),f=U(t,"mean","batchNorm"),d=U(e,"variance","batchNorm");return a!=null&&(s=U(a,"scale","batchNorm")),n!=null&&(l=U(n,"offset","batchNorm")),P(c.rank===3,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+c.rank+"."}),P(f.rank===3||f.rank===1,function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank "+f.rank+"."}),P(d.rank===3||d.rank===1,function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank "+d.rank+"."}),s!=null&&P(s.rank===3||s.rank===1,function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank "+s.rank+"."}),l!=null&&P(l.rank===3||l.rank===1,function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank "+l.rank+"."}),zc(c,f,d,l,s,i)}function IT(r,t,e,n,a,i){var s,l,c=U(r,"x","batchNorm"),f=U(t,"mean","batchNorm"),d=U(e,"variance","batchNorm");return a!=null&&(s=U(a,"scale","batchNorm")),n!=null&&(l=U(n,"offset","batchNorm")),P(c.rank===4,function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+c.rank+"."}),P(f.rank===4||f.rank===1,function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank "+f.rank+"."}),P(d.rank===4||d.rank===1,function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank "+d.rank+"."}),s!=null&&P(s.rank===4||s.rank===1,function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank "+s.rank+"."}),l!=null&&P(l.rank===4||l.rank===1,function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank "+l.rank+"."}),zc(c,f,d,l,s,i)}function zc(r,t,e,n,a,i){i==null&&(i=.001);var s,l,c,f=U(r,"x","batchNorm"),d=U(t,"mean","batchNorm"),p=U(e,"variance","batchNorm");a!=null&&(s=U(a,"scale","batchNorm")),n!=null&&(l=U(n,"offset","batchNorm")),P(d.rank===p.rank,function(){return"Batch normalization gradient requires mean and variance to have equal ranks."}),P(l==null||d.rank===l.rank,function(){return"Batch normalization gradient requires mean and offset to have equal ranks."}),P(s==null||d.rank===s.rank,function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}),c=f.rank===0||f.rank===1?f.as4D(1,1,1,f.size):f.rank===2?f.as4D(1,1,f.shape[0],f.shape[1]):f.rank===3?f.as4D(1,f.shape[0],f.shape[1],f.shape[2]):f;var g=[f,d,p,s];return $.runKernelFunc(function(v,b){var w=v.batchNormalization(c,bh(d),bh(p),i,bh(s),bh(l));return b([f,d,p,s]),w},{x:f,mean:d,variance:p,scale:s,offset:l},function(v,b){var w=b,S=w[0],x=w[1],C=w[2],A=w[3],T=A??Re(1),R=dn(x.shape,c.shape),O=[];if(x.rank===1){for(var N=0;N<c.shape.length-1;++N)O.push(c.shape[N]);O.push(1)}var D=S.sub(x),I=v.mul(T),_=Md(C.add(Re(i))),F=_.mul(_).mul(_).mul(Re(-.5));return{x:function(){return x.rank===1?v.mul(Yi(_.as4D(1,1,1,x.shape[0]),O)).mul(T).reshape(S.shape):v.mul(_).mul(T).reshape(S.shape)},mean:function(){var B=_.mul(Re(-1)).mul(I);return x.rank===1&&(B=B.sum(R)),B.reshape(x.shape)},variance:function(){var B=F.mul(D).mul(I);return x.rank===1&&(B=B.sum(R)),B.reshape(x.shape)},scale:function(){var B=D.mul(_),V=v.mul(B);return x.rank===1&&(V=V.sum(R)),V.reshape(x.shape)},offset:function(){var B=v;return x.rank===1&&(B=B.sum(R)),B.reshape(x.shape)}}},"BatchNormalization",{varianceEpsilon:i},g).reshape(f.shape)}function bh(r){return r==null?null:r.rank===0?r.as1D():r.rank===1?r:r.rank===2?r.as4D(1,1,r.shape[0],r.shape[1]):r.rank===3?r.as4D(1,r.shape[0],r.shape[1],r.shape[2]):r}function Fd(){xd("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}var kT=K({batchNormalization2d_:function(r,t,e,n,a,i){return n===void 0&&(n=.001),Fd(),NT(r,t,e,i,a,n)}}),DT=K({batchNormalization3d_:function(r,t,e,n,a,i){return n===void 0&&(n=.001),Fd(),RT(r,t,e,i,a,n)}}),OT=K({batchNormalization4d_:function(r,t,e,n,a,i){return n===void 0&&(n=.001),Fd(),IT(r,t,e,i,a,n)}}),_T=K({batchNormalization_:function(r,t,e,n,a,i){return n===void 0&&(n=.001),Fd(),zc(r,t,e,i,a,n)}}),Rb=K({batchNorm_:zc}),Ib=K({batchNorm2d_:NT}),kb=K({batchNorm3d_:RT}),Db=K({batchNorm4d_:IT}),mi=K({logicalAnd_:function(r,t){var e=U(r,"a","logicalAnd","bool"),n=U(t,"b","logicalAnd","bool");return lt(e.shape,n.shape),$.runKernelFunc(function(a){return a.logicalAnd(e,n)},{$a:e,$b:n})}}),Ob=K({logicalNot_:function(r){var t=U(r,"x","logicalNot","bool");return $.runKernelFunc(function(e){return e.logicalNot(t)},{$x:t})}}),Bd=K({logicalOr_:function(r,t){var e=U(r,"a","logicalOr","bool"),n=U(t,"b","logicalOr","bool");return lt(e.shape,n.shape),$.runKernelFunc(function(a){return a.logicalOr(e,n)},{$a:e,$b:n})}}),MT=K({logicalXor_:function(r,t){var e=U(r,"a","logicalXor","bool"),n=U(t,"b","logicalXor","bool");return lt(e.shape,n.shape),Bd(r,t).logicalAnd(mi(r,t).logicalNot())}}),fi=K({where_:function(r,t,e){var n=U(t,"a","where"),a=U(e,"b","where"),i=U(r,"condition","where","bool");return mt(n.shape,a.shape,"Error in where: "),i.rank===1?P(i.shape[0]===n.shape[0],function(){return"The first dimension of `a` must match the size of `condition`."}):mt(i.shape,a.shape,"Error in where: "),$.runKernelFunc(function(s,l){var c=s.select(i,n,a);return l([i]),c},{$condition:i,$a:n,$b:a},function(s,l){var c=l[0];return{$condition:function(){return ct(c).toFloat()},$a:function(){return s.mul(c.cast(s.dtype))},$b:function(){return s.mul(c.logicalNot().cast(s.dtype))}}})}}),Ud=function(r){return De(this,void 0,void 0,function(){var t,e,n;return Oe(this,function(a){switch(a.label){case 0:return[4,(t=U(r,"condition","whereAsync","bool")).data()];case 1:return e=a.sent(),n=ab(t.shape,e),r!==t&&t.dispose(),[2,n]}})})},ot=K({add_:function(r,t){var e,n=U(r,"a","add"),a=U(t,"b","add");e=Jt(n,a),n=e[0],a=e[1];var i=lt(n.shape,a.shape);return $.runKernelFunc(function(s){return s.add(n,a)},{a:n,b:a},function(s){return{a:function(){var l=s,c=dn(n.shape,i);return c.length>0&&(l=l.sum(c)),l.reshape(n.shape)},b:function(){var l=s,c=dn(a.shape,i);return c.length>0&&(l=l.sum(c)),l.reshape(a.shape)}}},"Add")}}),_b=K({addN_:function(r){P(Array.isArray(r),function(){return"The argument passed to tf.addN() must be a list of tensors"}),P(r.length>=1,function(){return"Must pass at least one tensor to tf.addN(), but got "+r.length});var t=r.map(function(a,i){return U(a,"tensors"+i,"addN")}),e=t[0];t.forEach(function(a){if(a.dtype!==e.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),t.forEach(function(a){if(!kn(a.shape,e.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});var n=t;return $.runKernelFunc(function(a){return a.addN(t)},n,function(a){var i={};return t.forEach(function(s,l){i[l]=function(){return a.clone()}}),i})}}),zT=K({addStrict_:function(r,t){var e=U(r,"a","addStrict"),n=U(t,"b","addStrict");return mt(e.shape,n.shape,"Error in addStrict: "),e.add(n)}}),Mb=K({atan2_:function(r,t){var e,n=U(r,"a","atan2"),a=U(t,"b","atan2");e=Jt(n,a),n=e[0],a=e[1];var i=lt(n.shape,a.shape);return $.runKernelFunc(function(s,l){var c=s.atan2(n,a);return l([n,a]),c},{$a:n,$b:a},function(s,l){var c=l[0],f=l[1];return{$a:function(){var d=ot(c.square(),f.square()),p=s.mul(f.div(d)),g=dn(c.shape,i);return g.length>0&&(p=p.sum(g)),p.reshape(c.shape)},$b:function(){var d=ot(c.square(),f.square()),p=hs(s.mul(c.div(d))),g=dn(f.shape,i);return g.length>0&&(p=p.sum(g)),p.reshape(f.shape)}}})}}),Xn=K({div_:function(r,t){var e,n=U(r,"a","div"),a=U(t,"b","div");if(e=Jt(n,a),n=e[0],a=e[1],n.dtype==="int32"&&a.dtype==="int32")return Pd(n,a);var i=lt(n.shape,a.shape);return $.runKernelFunc(function(s,l){var c=s.realDivide(n,a);return l([n,a]),c},{a:n,b:a},function(s,l){var c=l[0],f=l[1];return{a:function(){var d=s.div(f.toFloat()),p=dn(c.shape,i);return p.length>0?d.sum(p).reshape(c.shape):d},b:function(){var d=s.mul(c.toFloat()),p=dn(f.shape,i);p.length>0&&(d=d.sum(p).reshape(f.shape));var g=f.square();return d.div(g.toFloat()).neg()}}},"Div")}}),LT=K({divStrict_:function(r,t){var e=U(r,"a","div"),n=U(t,"b","div");return mt(e.shape,n.shape,"Error in divideStrict: "),e.div(n)}}),Pd=K({floorDiv_:function(r,t){var e,n=U(r,"a","floorDiv"),a=U(t,"b","floorDiv");e=Jt(n,a),n=e[0],a=e[1];var i=lt(n.shape,a.shape);return $.runKernelFunc(function(s,l){var c=s.floorDiv(n,a);return l([n,a]),c},{$a:n,$b:a},function(s,l){var c=l[0],f=l[1];return{$a:function(){var d=s.div(f.toFloat()),p=dn(c.shape,i);return p.length>0?d.sum(p).reshape(c.shape):d},$b:function(){var d=s.mul(c.toFloat()),p=dn(f.shape,i);p.length>0&&(d=d.sum(p).reshape(f.shape));var g=f.square();return d.div(g.toFloat()).neg()}}})}}),_a=K({maximum_:function(r,t){var e,n=U(r,"a","maximum"),a=U(t,"b","maximum");return e=Jt(n,a),n=e[0],a=e[1],n.dtype==="bool"&&(n=n.toInt(),a=a.toInt()),lt(n.shape,a.shape),$.runKernelFunc(function(i,s){var l=i.maximum(n,a);return s([n,a]),l},{$a:n,$b:a},function(i,s){var l=s[0],c=s[1];return{$a:function(){return i.mul(l.greaterEqual(c).toFloat())},$b:function(){return i.mul(l.less(c).toFloat())}}})}}),FT=K({maximumStrict_:function(r,t){var e=U(r,"a","maximumStrict"),n=U(t,"b","maximumStrict");return mt(e.shape,n.shape,"Error in maximumStrict: "),e.maximum(n)}}),Fu=K({minimum_:function(r,t){var e,n=U(r,"a","minimum"),a=U(t,"b","minimum");return e=Jt(n,a),n=e[0],a=e[1],n.dtype==="bool"&&(n=n.toInt(),a=a.toInt()),lt(n.shape,a.shape),$.runKernelFunc(function(i,s){var l=i.minimum(n,a);return s([n,a]),l},{$a:n,$b:a},function(i,s){var l=s[0],c=s[1];return{$a:function(){return i.mul(l.lessEqual(c).toFloat())},$b:function(){return i.mul(l.greater(c).toFloat())}}})}}),BT=K({minimumStrict_:function(r,t){var e=U(r,"a","minimumStrict"),n=U(t,"b","minimumStrict");return mt(e.shape,n.shape,"Error in minimumStrict: "),e.minimum(n)}}),zb=K({mod_:function(r,t){var e,n=U(r,"a","mod"),a=U(t,"b","mod");e=Jt(n,a),n=e[0],a=e[1];var i=lt(n.shape,a.shape);return $.runKernelFunc(function(s,l){var c=s.mod(n,a);return l([n,a]),c},{$a:n,$b:a},function(s,l){var c=l[0],f=l[1];return{$a:function(){var d=dn(c.shape,i);return d.length>0?s.sum(d).reshape(c.shape):s},$b:function(){var d=s.mul(c.div(f).floor().neg()),p=dn(f.shape,i);return p.length>0?d.sum(p).reshape(f.shape):d}}})}}),UT=K({modStrict_:function(r,t){var e=U(r,"a","modStrict"),n=U(t,"b","modStrict");return mt(e.shape,n.shape,"Error in modStrict: "),e.mod(n)}}),Xe=K({mul_:function(r,t){var e,n=U(r,"a","mul"),a=U(t,"b","mul");e=Jt(n,a),n=e[0],a=e[1];var i=lt(n.shape,a.shape);return $.runKernelFunc(function(s,l){var c=s.multiply(n,a);return l([n,a]),c},{a:n,b:a},function(s,l){var c=l[0],f=l[1];return{a:function(){var d=s.mul(f.toFloat()),p=dn(c.shape,i);return p.length>0?d.sum(p).reshape(c.shape):d},b:function(){var d=s.mul(c.toFloat()),p=dn(f.shape,i);return p.length>0?d.sum(p).reshape(f.shape):d}}},"Mul")}}),Vd=K({mulStrict_:function(r,t){var e=U(r,"a","mul"),n=U(t,"b","mul");return mt(e.shape,n.shape,"Error in multiplyStrict: "),e.mul(n)}}),xu=K({pow_:function(r,t){var e=U(r,"base","pow"),n=U(t,"exp","pow"),a=lt(e.shape,n.shape);return r=e.cast(cn(e.dtype,n.dtype)),t=n.cast(cn(e.dtype,n.dtype)),$.runKernelFunc(function(i,s){var l=i.pow(e,n);return s([e,n,l]),l},{$base:e,$exp:n},function(i,s){var l=s[0],c=s[1],f=s[2];return{$base:function(){var d=c.toFloat(),p=i.mul(d.mul(l.pow(d.sub(Re(1))))),g=dn(l.shape,a);return g.length>0&&(p=p.sum(g)),p.reshape(l.shape)},$exp:function(){var d=l.greater(0),p=l.log().where(d,ct(l)),g=i.mul(f.mul(p)),v=dn(c.shape,a);return v.length>0&&(g=g.sum(v)),g.reshape(c.shape)}}})}}),PT=K({powStrict_:function(r,t){return mt(r.shape,t.shape,"Error in powStrict: "),r.pow(t)}}),Lb=K({squaredDifference_:function(r,t){var e,n=U(r,"a","squaredDifference"),a=U(t,"b","squaredDifference");return e=Jt(n,a),n=e[0],a=e[1],lt(n.shape,a.shape),$.runKernelFunc(function(i,s){var l=i.squaredDifference(n,a);return s([n,a]),l},{$a:n,$b:a},function(i,s){var l=s[0],c=s[1],f=Re(2);return{$a:function(){return i.mul(l.sub(c).mul(f))},$b:function(){return i.mul(c.sub(l).mul(f))}}})}}),VT=K({squaredDifferenceStrict_:function(r,t){var e=U(r,"a","squaredDifferenceStrict"),n=U(t,"b","squaredDifferenceStrict");return mt(e.shape,n.shape,"Error in squaredDifferenceStrict: "),e.squaredDifference(n)}}),Dn=K({sub_:function(r,t){var e,n=U(r,"a","sub"),a=U(t,"b","sub");e=Jt(n,a),n=e[0],a=e[1];var i=lt(n.shape,a.shape);return $.runKernelFunc(function(s){return s.subtract(n,a)},{a:n,b:a},function(s){return{a:function(){var l=s,c=dn(n.shape,i);return c.length>0&&(l=l.sum(c)),l.reshape(n.shape)},b:function(){var l=s,c=dn(a.shape,i);return c.length>0&&(l=l.sum(c)),l.neg().reshape(a.shape)}}},"Sub")}}),jT=K({subStrict_:function(r,t){var e=U(r,"a","subStrict"),n=U(t,"b","subStrict");return mt(e.shape,n.shape,"Error in subStrict: "),e.sub(n)}}),ds=K({equal_:function(r,t){var e,n=U(r,"a","equal"),a=U(t,"b","equal");return e=Jt(n,a),n=e[0],a=e[1],lt(n.shape,a.shape),$.runKernelFunc(function(i){return i.equal(n,a)},{$a:n,$b:a})}}),WT=K({equalStrict_:function(r,t){var e=U(r,"a","equalStrict"),n=U(t,"b","equalStrict");return mt(e.shape,n.shape,"Error in equalStrict: "),e.equal(n)}}),Bu=K({greater_:function(r,t){var e,n=U(r,"a","greater"),a=U(t,"b","greater");return e=Jt(n,a),n=e[0],a=e[1],lt(n.shape,a.shape),$.runKernelFunc(function(i){return i.greater(n,a)},{$a:n,$b:a})}}),Lc=K({greaterEqual_:function(r,t){var e,n=U(r,"a","greaterEqual"),a=U(t,"b","greaterEqual");return e=Jt(n,a),n=e[0],a=e[1],lt(n.shape,a.shape),$.runKernelFunc(function(i,s){var l=i.greaterEqual(n,a);return s([n,a]),l},{$a:n,$b:a},function(i,s){var l=s[0],c=s[1];return{$a:function(){return ct(l)},$b:function(){return ct(c)}}})}}),HT=K({greaterEqualStrict_:function(r,t){var e=U(r,"a","greaterEqualStrict"),n=U(t,"b","greaterEqualStrict");return mt(e.shape,n.shape,"Error in greaterEqualStrict: "),e.greaterEqual(n)}}),qT=K({greaterStrict_:function(r,t){var e=U(r,"a","greaterStrict"),n=U(t,"b","greaterStrict");return mt(e.shape,n.shape,"Error in greaterStrict: "),e.greater(n)}}),Fb=K({less_:function(r,t){var e,n=U(r,"a","less"),a=U(t,"b","less");return e=Jt(n,a),n=e[0],a=e[1],lt(n.shape,a.shape),$.runKernelFunc(function(i){return i.less(n,a)},{$a:n,$b:a})}}),Bb=K({lessEqual_:function(r,t){var e,n=U(r,"a","lessEqual"),a=U(t,"b","lessEqual");return e=Jt(n,a),n=e[0],a=e[1],lt(n.shape,a.shape),$.runKernelFunc(function(i){return i.lessEqual(n,a)},{$a:n,$b:a})}}),GT=K({lessEqualStrict_:function(r,t){var e=U(r,"a","lessEqualStrict"),n=U(t,"b","lessEqualStrict");return mt(e.shape,n.shape,"Error in lessEqualStrict: "),e.lessEqual(n)}}),XT=K({lessStrict_:function(r,t){var e=U(r,"a","lessStrict"),n=U(t,"b","lessStrict");return mt(e.shape,n.shape,"Error in lessStrict: "),e.less(n)}}),Su=K({notEqual_:function(r,t){var e,n=U(r,"a","notEqual"),a=U(t,"b","notEqual");return e=Jt(n,a),n=e[0],a=e[1],lt(n.shape,a.shape),$.runKernelFunc(function(i){return i.notEqual(n,a)},{$a:n,$b:a})}}),$T=K({notEqualStrict_:function(r,t){var e=U(r,"a","notEqualStrict"),n=U(t,"b","notEqualStrict");return mt(e.shape,n.shape,"Error in notEqualStrict: "),e.notEqual(n)}});function wS(r,t){for(var e=[],n=r;n<t;++n)e.push(n);return e}function xS(r){for(var t=[],e=0;e<r.length;++e)for(var n=0;n<r[e].length;++n)t.push(r[e][n]);return t}var Uu=K({gather_:function(r,t,e){e===void 0&&(e=0);var n=U(r,"x","gather"),a=U(t,"indices","gather","int32");e=On(e,n.shape)[0];var i=function(s,l,c){for(var f=s.shape[c],d=[],p=1,g=1,v=0;v<c;v++)d.push(s.shape[v]),p*=s.shape[v];for(v=0;v<l.rank;v++)d.push(l.shape[v]);for(v=c+1;v<s.rank;v++)d.push(s.shape[v]),g*=s.shape[v];return{batchSize:p,sliceSize:g,dimSize:f,outputShape:d}}(n,a,e);return $.runKernelFunc(function(s,l){var c=s.gather(n,a.flatten(),e);return l([a]),c},{$x:n},function(s,l){var c=l[0];return{$x:function(){var f=n.shape,d=c.size,p=f.slice(0,e),g=p.length,v=f.slice(e,f.length).slice(1),b=v.length,w=wS(0,g),S=wS(g+1,g+1+b),x=xS([p,[d],v]),C=s.reshape(x),A=c.reshape([d]),T=xS([[g],w,S]),R=C.transpose(T),O=Ub(R,A,n.shape[e]),N=Sd(T);return O=O.transpose(N)}}}).reshape(i.outputShape)}}),Ub=K({unsortedSegmentSum_:function(r,t,e){var n=U(r,"x","unsortedSegmentSum"),a=U(t,"segmentIds","unsortedSegmentSum","int32");return P(Qt(e),function(){return"numSegments must be of dtype int"}),$.runKernelFunc(function(i,s){var l=i.unsortedSegmentSum(n,a,e);return s([a]),l},{$x:n},function(i,s){var l=s[0];return{$x:function(){return function(c,f){for(var d=_a(f,ct(f)),p=Uu(c,d),g=Lc(f,Re(0,"int32")),v=p.rank-g.rank,b=0;b<v;++b)g=Sr(g,b+1);g=mi(g,Oa(p.shape,"bool"));var w=ct(p);return fi(g,p,w)}(i,l)}}})}}),KT=function(r,t,e){return De(this,void 0,void 0,function(){var n,a,i,s,l,c,f,d,p,g,v,b,w;return Oe(this,function(S){switch(S.label){case 0:for(n=U(r,"tensor","boolMask"),a=U(t,"mask","boolMask","bool"),i=e??0,s=a.rank,l=n.shape,P(s>0,function(){return"mask cannot be scalar"}),mt(l.slice(i,i+s),a.shape,"mask's shape must match the first K dimensions of tensor's shape,"),c=1,f=i;f<i+s;f++)c*=l[f];return d=l.slice(0,i).concat([c],l.slice(i+s)),p=n.reshape(d),g=a.reshape([-1]),[4,Ud(g)];case 1:return v=S.sent(),b=v.squeeze([1]),w=Uu(p,b,i),r!==n&&n.dispose(),t!==a&&a.dispose(),b.dispose(),p.dispose(),g.dispose(),v.dispose(),[2,w]}})})};function YT(r,t,e,n,a,i,s){i===void 0&&(i="NHWC"),P(r.length===t.rank,function(){return"Length of inShape ("+r.length+") and rank of dy ("+t.rank+") must match"});var l=r,c=t,f=!1;t.rank===3&&(f=!0,c=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]),l=[1,r[0],r[1],r[2]]),P(l.length===4,function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+l.length+"."}),P(c.rank===4,function(){return"Error in conv2dDerInput: dy must be rank 4, but got rank "+c.rank}),P(e.rank===4,function(){return"Error in conv2dDerInput: filter must be rank 4, but got rank "+e.rank});var d=i==="NHWC"?l[3]:l[1],p=i==="NHWC"?c.shape[3]:c.shape[1];P(d===e.shape[2],function(){return"Error in conv2dDerInput: depth of input ("+d+") must match input depth for filter "+e.shape[2]+"."}),P(p===e.shape[3],function(){return"Error in conv2dDerInput: depth of output ("+p+") must match output depth for filter "+e.shape[3]+"."}),s!=null&&P(Qt(a),function(){return"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+a+"."});var g=Od(i),v=uo(l,e.shape,n,1,a,s,!1,g),b=$.runKernelFunc(function(w,S){var x=w.conv2dDerInput(c,e,v);return S([e,c]),x},{dy4D:c,filter:e},function(w,S){var x=S[0],C=S[1];return{dy4D:function(){return ps(w,x,n,a,i,1,s)},filter:function(){return Pb(w,C,x.shape,n,a,i,s)}}});return f?b.as3D(b.shape[1],b.shape[2],b.shape[3]):b}function ev(r){var t=function(i){return typeof i=="number"?[i,i,i]:i.length===2?[i[0],i[1],1]:i}(r),e=t[0],n=t[1],a=t[2];return e===1&&n===1&&a===1}function ZT(r,t,e,n,a){P(r.length===t.rank,function(){return"Length of inShape ("+r.length+") and rank of dy ("+t.rank+") must match"});var i=r,s=t,l=!1;t.rank===4&&(l=!0,s=t.as5D(1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]),i=[1,r[0],r[1],r[2],r[3]]);var c=i[4],f=s.shape[4];P(i.length===5,function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+i.length+"."}),P(s.rank===5,function(){return"Error in conv3dDerInput: dy must be rank 5, but got rank "+s.rank}),P(e.rank===5,function(){return"Error in conv3dDerInput: filter must be rank 5, but got rank "+e.rank}),P(c===e.shape[3],function(){return"Error in conv3dDerInput: depth of input ("+c+") must match input depth for filter "+e.shape[3]+"."}),P(f===e.shape[4],function(){return"Error in conv3dDerInput: depth of output ("+f+") must match output depth for filter "+e.shape[4]+"."});var d=vc(i,e.shape,n,1,a),p=$.runKernelFunc(function(g){return g.conv3dDerInput(s,e,d)},{dy5D:s});return l?p.as4D(p.shape[1],p.shape[2],p.shape[3],p.shape[4]):p}var jd=K({conv1d_:function(r,t,e,n,a,i,s){a===void 0&&(a="NWC"),i===void 0&&(i=1);var l=U(r,"x","conv1d"),c=U(t,"filter","conv1d"),f=l,d=!1;l.rank===2&&(d=!0,f=l.as3D(1,l.shape[0],l.shape[1])),P(f.rank===3,function(){return"Error in conv1d: input must be rank 3, but got rank "+f.rank+"."}),P(c.rank===3,function(){return"Error in conv1d: filter must be rank 3, but got rank "+c.rank+"."}),s!=null&&P(Qt(n),function(){return"Error in conv1d: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+n+"."}),P(f.shape[2]===c.shape[1],function(){return"Error in conv1d: depth of input ("+f.shape[2]+") must match input depth for filter "+c.shape[1]+"."}),P(Qn(e,i),function(){return"Error in conv1D: Either stride or dilation must be 1. Got stride "+e+" and dilation '"+i+"'"}),P(a==="NWC",function(){return"Error in conv1d: got dataFormat of "+a+" but only NWC is currently supported."});var p=c.as4D(1,c.shape[0],c.shape[1],c.shape[2]),g=f.as4D(f.shape[0],1,f.shape[1],f.shape[2]),v=ps(g,p,[1,e],n,"NHWC",[1,i],s);return d?v.as2D(v.shape[2],v.shape[3]):v.as3D(v.shape[0],v.shape[2],v.shape[3])}}),ps=K({conv2d_:function(r,t,e,n,a,i,s){a===void 0&&(a="NHWC"),i===void 0&&(i=[1,1]);var l=U(r,"x","conv2d"),c=U(t,"filter","conv2d"),f=l,d=!1;l.rank===3&&(d=!0,f=l.as4D(1,l.shape[0],l.shape[1],l.shape[2])),P(f.rank===4,function(){return"Error in conv2d: input must be rank 4, but got rank "+f.rank+"."}),P(c.rank===4,function(){return"Error in conv2d: filter must be rank 4, but got rank "+c.rank+"."}),s!=null&&P(Qt(n),function(){return"Error in conv2d: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+n+"."});var p=a==="NHWC"?f.shape[3]:f.shape[1];P(p===c.shape[2],function(){return"Error in conv2d: depth of input ("+p+") must match input depth for filter "+c.shape[2]+"."}),P(Qn(e,i),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+i+"'"});var g=Od(a),v=uo(f.shape,c.shape,e,i,n,s,!1,g),b=$.runKernelFunc(function(w,S){var x=w.conv2d(f,c,v);return S([c,f]),x},{x:f,$filter:c},function(w,S){var x=S,C=x[0],A=x[1];return P(ns(i),function(){return"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"}),{x:function(){return QT(A.shape,w,C,e,n,a)},$filter:function(){return Pb(A,w,C.shape,e,n,a)}}});return d?b.as3D(b.shape[1],b.shape[2],b.shape[3]):b}}),Wd=K({conv3d_:function(r,t,e,n,a,i){a===void 0&&(a="NDHWC"),i===void 0&&(i=[1,1,1]);var s=U(r,"x","conv3d"),l=U(t,"filter","conv3d"),c=s,f=!1;s.rank===4&&(f=!0,c=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),P(c.rank===5,function(){return"Error in conv3d: input must be rank 5, but got rank "+c.rank+"."}),P(l.rank===5,function(){return"Error in conv3d: filter must be rank 5, but got rank "+l.rank+"."}),P(c.shape[4]===l.shape[3],function(){return"Error in conv3d: depth of input ("+c.shape[4]+") must match input depth for filter "+l.shape[3]+"."}),P(function(g,v){return ev(g)||ev(v)}(e,i),function(){return"Error in conv3D: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+i+"'"}),P(a==="NDHWC",function(){return"Error in conv3d: got dataFormat of "+a+" but only NDHWC is currently supported."});var d=vc(c.shape,l.shape,e,i,n),p=$.runKernelFunc(function(g,v){var b=g.conv3d(c,l,d);return v([c,l]),b},{x:c,$filter:l},function(g,v){P(ev(i),function(){return"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"});var b=v[0],w=v[1];return{x:function(){return ZT(b.shape,g,w,e,n)},$filter:function(){return function(S,x,C,A,T){var R=S;S.rank===4&&(R=S.as5D(1,S.shape[0],S.shape[1],S.shape[2],S.shape[3]));var O=x;O.rank===4&&(O=x.as5D(1,x.shape[0],x.shape[1],x.shape[2],x.shape[3])),P(R.rank===5,function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+R.shape+"."}),P(O.rank===5,function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+O.shape+"."}),P(C.length===5,function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+C+"."}),P(R.shape[4]===C[3],function(){return"Error in conv3dDerFilter: depth of input "+R.shape[4]+") must match input depth in filter ("+C[3]+"."}),P(O.shape[4]===C[4],function(){return"Error in conv3dDerFilter: depth of dy ("+O.shape[4]+") must match output depth for filter ("+C[4]+")."});var N=vc(R.shape,C,A,1,T);return $.runKernelFunc(function(D){return D.conv3dDerFilter(R,O,N)},{x5D:R,dy5D:O})}(b,g,w.shape,e,n)}}});return f?p.as4D(p.shape[1],p.shape[2],p.shape[3],p.shape[4]):p}}),Pb=K({conv2dDerFilter_:function(r,t,e,n,a,i,s){i===void 0&&(i="NHWC");var l=r;r.rank===3&&(l=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var c=t;c.rank===3&&(c=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),P(l.rank===4,function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+l.shape+"."}),P(c.rank===4,function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+c.shape+"."}),P(e.length===4,function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+e+"."});var f=i==="NHWC"?l.shape[3]:l.shape[1],d=i==="NHWC"?c.shape[3]:c.shape[1];P(f===e[2],function(){return"Error in conv2dDerFilter: depth of input "+f+") must match input depth in filter ("+e[2]+"."}),P(d===e[3],function(){return"Error in conv2dDerFilter: depth of dy ("+d+") must match output depth for filter ("+e[3]+")."}),s!=null&&P(Qt(a),function(){return"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+a+"."});var p=Od(i),g=uo(l.shape,e,n,1,a,s,!1,p);return $.runKernelFunc(function(v){return v.conv2dDerFilter(l,c,g)},{x4D:l,dy4D:c})}}),QT=K({conv2dDerInput_:YT}),Pu=K({depthwiseConv2d_:function(r,t,e,n,a,i,s){i===void 0&&(i=[1,1]);var l=U(r,"x","depthwiseConv2d"),c=U(t,"filter","depthwiseConv2d"),f=l,d=!1;l.rank===3&&(d=!0,f=l.as4D(1,l.shape[0],l.shape[1],l.shape[2])),P(f.rank===4,function(){return"Error in depthwiseConv2d: input must be rank 4, but got rank "+f.rank+"."}),P(c.rank===4,function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+c.rank+"."}),P(f.shape[3]===c.shape[2],function(){return"Error in depthwiseConv2d: number of input channels ("+f.shape[3]+") must match the inChannels dimension in filter "+c.shape[2]+"."}),i==null&&(i=[1,1]),P(Qn(e,i),function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+i+"'"}),s!=null&&P(Qt(n),function(){return"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+n+"."});var p=uo(f.shape,c.shape,e,i,n,s,!0),g=$.runKernelFunc(function(v,b){var w=v.depthwiseConv2D(f,c,p);return b([f,c]),w},{x:f,$filter:c},function(v,b){P(ns(i),function(){return"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+i+"'"});var w=b[0],S=b[1];return{x:function(){return JT(w.shape,v,S,p)},$filter:function(){return eN(w,v,S.shape,p)}}});return d?g.as3D(g.shape[1],g.shape[2],g.shape[3]):g}}),JT=K({depthwiseConv2dDerInput_:function(r,t,e,n){var a=t,i=!1;t.rank===3&&(i=!0,a=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var s=$.runKernelFunc(function(l){return l.depthwiseConv2DDerInput(a,e,n)},{dy4D:a});return i?s.as3D(s.shape[1],s.shape[2],s.shape[3]):s}}),eN=K({depthwiseConv2dDerFilter_:function(r,t,e,n){var a=r;r.rank===3&&(a=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var i=t;return i.rank===3&&(i=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),$.runKernelFunc(function(s){return s.depthwiseConv2DDerFilter(a,i,n)},{x4D:a,dy4D:i})}}),Vb=K({separableConv2d_:function(r,t,e,n,a,i,s){i===void 0&&(i=[1,1]),s===void 0&&(s="NHWC");var l=U(r,"x","separableConv2d"),c=U(t,"depthwiseFilter","separableConv2d"),f=U(e,"pointwiseFilter","separableConv2d"),d=l,p=!1;if(l.rank===3&&(p=!0,d=l.as4D(1,l.shape[0],l.shape[1],l.shape[2])),s==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");P(d.rank===4,function(){return"Error in separableConv2d: input must be rank 4, but got rank "+d.rank+"."}),P(c.rank===4,function(){return"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+c.rank+"."}),P(f.rank===4,function(){return"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+c.rank+"."}),P(f.shape[0]===1,function(){return"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+f.shape[0]+"."}),P(f.shape[1]===1,function(){return"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got "+f.shape[1]+"."});var g=c.shape[2],v=c.shape[3];P(f.shape[2]===g*v,function(){return"Error in separableConv2d: the third dimension of pointwise filter must be "+g*v+", but got "+f.shape[2]+"."});var b=Pu(d,c,n,a,s,i),w=ps(b,f,1,"valid",s);return p?w.as3D(w.shape[1],w.shape[2],w.shape[3]):w}}),Hd=K({conv2dTranspose_:function(r,t,e,n,a,i){return YT(e,U(r,"x","conv2dTranspose"),U(t,"filter","conv2dTranspose"),n,a,"NHWC",i)}}),tN=K({conv3dTranspose_:function(r,t,e,n,a){return ZT(e,U(r,"x","conv3dTranspose"),U(t,"filter","conv3dTranspose"),n,a)}}),qd=K({matMul_:function(r,t,e,n){var a;e===void 0&&(e=!1),n===void 0&&(n=!1);var i=U(r,"a","matMul"),s=U(t,"b","matMul");a=Jt(i,s),i=a[0],s=a[1];var l=e?i.shape[i.rank-2]:i.shape[i.rank-1],c=n?s.shape[s.rank-1]:s.shape[s.rank-2],f=e?i.shape[i.rank-1]:i.shape[i.rank-2],d=n?s.shape[s.rank-2]:s.shape[s.rank-1],p=i.shape.slice(0,-2),g=s.shape.slice(0,-2),v=Me(p),b=Me(g);P(i.rank>=2&&s.rank>=2&&i.rank===s.rank,function(){return"Error in matMul: inputs must have the same rank of at least 2, got ranks "+i.rank+" and "+s.rank+"."}),P(kn(p,g),function(){return"Error in matMul: outer dimensions ("+p+") and ("+g+") of Tensors with shapes "+i.shape+" and "+s.shape+" must match."}),P(l===c,function(){return"Error in matMul: inner shapes ("+l+") and ("+c+") of Tensors with shapes "+i.shape+" and "+s.shape+" and transposeA="+e+" and transposeB="+n+" must match."});var w=i.shape.slice(0,-2).concat([f,d]),S=e?i.as3D(v,l,f):i.as3D(v,f,l),x=n?s.as3D(b,d,c):s.as3D(b,c,d),C={transposeA:e,transposeB:n};return $.runKernelFunc(function(A,T){var R=A.batchMatMul(S,x,e,n);return T([S,x]),R},{a:S,b:x},function(A,T){var R=T,O=R[0],N=R[1];return e||n?!e&&n?{a:function(){return A.matMul(N,!1,!1)},b:function(){return A.matMul(O,!0,!1)}}:e&&!n?{a:function(){return N.matMul(A,!1,!0)},b:function(){return O.matMul(A,!1,!1)}}:{a:function(){return N.matMul(A,!0,!0)},b:function(){return A.matMul(O,!0,!0)}}:{a:function(){return A.matMul(N,!1,!0)},b:function(){return O.matMul(A,!0,!1)}}},"BatchMatMul",C).reshape(w)}}),nN=K({dot_:function(r,t){var e=U(r,"t1","dot"),n=U(t,"t2","dot");P(!(e.rank!==1&&e.rank!==2||n.rank!==1&&n.rank!==2),function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+e.rank+" and "+n.rank+"."});var a=e.rank===1?e.size:e.shape[1],i=n.rank===1?n.size:n.shape[0];return P(a===i,function(){return"Error in dot: inner dimensions of inputs must match, but got "+a+" and "+i+"."}),e.rank===1&&n.rank===1?e.as2D(1,-1).matMul(n.as2D(-1,1)).asScalar():e.rank===1&&n.rank===2?e.as2D(1,-1).matMul(n.as2D(n.shape[0],n.shape[1])).as1D():e.rank===2&&n.rank===1?e.matMul(n.as2D(-1,1)).as1D():e.matMul(n.as2D(n.shape[0],n.shape[1]))}}),rN=K({outerProduct_:function(r,t){var e=U(r,"v1","outerProduct"),n=U(t,"v2","outerProduct");return P(e.rank===1&&n.rank===1,function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+e.rank+" and "+n.rank+"."}),e.as2D(-1,1).matMul(n.as2D(1,-1))}}),Ia=K({reverse_:function(r,t){var e=U(r,"x","reverse");if(e.rank===0)return e.clone();var n=On(t,e.shape);return $.runKernelFunc(function(a){return a.reverse(e,n)},{$x:e},function(a){return{$x:function(){return a.reverse(n)}}}).reshapeAs(e)}}),aN=K({reverse1d_:function(r){var t=U(r,"x","reverse");return P(t.rank===1,function(){return"Error in reverse1D: x must be rank 1 but got rank "+t.rank+"."}),Ia(t,0)}}),iN=K({reverse2d_:function(r,t){var e=U(r,"x","reverse");return P(e.rank===2,function(){return"Error in reverse2D: x must be rank 2 but got rank "+e.rank+"."}),Ia(e,t)}}),oN=K({reverse3d_:function(r,t){var e=U(r,"x","reverse");return P(e.rank===3,function(){return"Error in reverse3D: x must be rank 3 but got rank "+e.rank+"."}),Ia(e,t)}}),sN=K({reverse4d_:function(r,t){var e=U(r,"x","reverse");return P(e.rank===4,function(){return"Error in reverse4D: x must be rank 4 but got rank "+e.rank+"."}),Ia(e,t)}});function uN(r,t,e,n,a,i){var s=U(r,"x","maxPool"),l=s,c=!1;s.rank===3&&(c=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),P(l.rank===4,function(){return"Error in maxPool: input must be rank 4 but got rank "+l.rank+"."}),P(Qn(e,n),function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+n+"'"}),i!=null&&P(Qt(a),function(){return"Error in maxPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+a+"."});var f=wu(l.shape,t,e,n,a,i),d=$.runKernelFunc(function(p,g){var v=p.maxPool(l,f);return g([l,v]),v},{x:l},function(p,g){var v=g[0],b=g[1];return{x:function(){return function(w,S,x,C,A,T,R,O){var N=U(w,"dy","maxPoolBackprop"),D=U(S,"input","maxPoolBackprop"),I=U(x,"output","maxPoolBackprop");P(D.rank===N.rank,function(){return"Rank of input ("+D.rank+") does not match rank of dy ("+N.rank+")"}),P(Qn(A,T),function(){return"Error in maxPoolBackProp: Either strides or dilations must be 1. Got strides "+A+" and dilations '"+T+"'"}),P(N.rank===4,function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+N.rank+"."}),P(D.rank===4,function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+D.rank+"."});var _=wu(D.shape,C,A,T,R,O);return $.runKernelFunc(function(F){return F.maxPoolBackprop(N,D,I,_)},{$dy:N,$input:D})}(p,v,b,t,e,n,a)}}});return c?d.as3D(d.shape[1],d.shape[2],d.shape[3]):d}function lN(r,t,e,n,a,i){var s=U(r,"x","avgPool","float32");P(Qn(e,n),function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+n+"'"});var l=s,c=!1;s.rank===3&&(c=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),P(l.rank===4,function(){return"Error in avgPool: x must be rank 4 but got rank "+l.rank+"."}),i!=null&&P(Qt(a),function(){return"Error in avgPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+a+"."});var f=wu(l.shape,t,e,n,a,i),d=$.runKernelFunc(function(p){return p.avgPool(l,f)},{x:l},function(p){return{x:function(){return function(g,v,b,w,S,x){var C=U(g,"dy","avgPoolBackprop"),A=U(v,"input","avgPoolBackprop");P(A.rank===C.rank,function(){return"Rank of input ("+A.rank+") does not match rank of dy ("+C.rank+")"}),P(Qn(w,S),function(){return"Error in avgPoolBackprop: Either strides or dilations must be 1. Got strides "+w+" and dilations '"+S+"'"});var T=A,R=C,O=!1;A.rank===3&&(O=!0,T=A.as4D(1,A.shape[0],A.shape[1],A.shape[2]),R=C.as4D(1,C.shape[0],C.shape[1],C.shape[2])),P(R.rank===4,function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+R.rank+"."}),P(T.rank===4,function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+T.rank+"."});var N=wu(T.shape,b,w,S,x),D=$.runKernelFunc(function(I){return I.avgPoolBackprop(R,T,N)},{dy4D:R,input4D:T});return O?D.as3D(D.shape[1],D.shape[2],D.shape[3]):D}(p,l,t,e,n,a)}}});return d=d.cast(s.dtype),c?d.as3D(d.shape[1],d.shape[2],d.shape[3]):d}var Gd=K({maxPool_:function(r,t,e,n,a){return uN(r,t,e,1,n,a)}}),Xd=K({avgPool_:function(r,t,e,n,a){return lN(r,t,e,1,n,a)}}),cN=K({pool_:function(r,t,e,n,a,i){a==null&&(a=[1,1]),i==null&&(i=1),n===0&&(n="valid");var s=U(r,"x","maxPool"),l=s,c=!1;s.rank===3&&(c=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),P(Qn(i,a),function(){return"Error in pool: Either strides or dilations must be 1. Got strides "+i+" and dilations '"+a+"'"});var f,d=wu(l.shape,t,i,a,n),p=[d.dilationHeight,d.dilationWidth];f=n==="same"?function(T,R){var O=T.map(function(I,_){return I+(I-1)*(R[_]-1)}).map(function(I){return I-1}),N=O.map(function(I){return Math.floor(I/2)}),D=O.map(function(I,_){return I-N[_]});return O.map(function(I,_){return[N[_],D[_]]})}([d.filterHeight,d.filterWidth],p):[[0,0],[0,0]];var g=p[0]===1&&p[1]===1,v=function(T,R,O){var N=O.map(function(X){return X[0]}),D=O.map(function(X){return X[1]}),I=T.concat(N,D),_=R.map(function(X,Y){return(X-I[Y]%X)%X}),F=D.map(function(X,Y){return X+_[Y]}),B=R.map(function(X,Y){return[N[Y],F[Y]]}),V=R.map(function(X,Y){return[0,_[Y]]});return[B,V]}([d.inHeight,d.inWidth],p,f),b=v[0],w=v[1],S=g?n:"valid",x=g?l:Rd(l,p,b),C=(e==="avg"?function(){return lN(x,t,i,1,S)}:function(){return uN(x,t,i,1,S)})(),A=g?C:Ad(C,p,w);return c?A.as3D(A.shape[1],A.shape[2],A.shape[3]):A}}),$d=K({maxPool3d_:function(r,t,e,n,a,i,s){i===void 0&&(i="NDHWC");var l=U(r,"x","maxPool3d"),c=l,f=!1;l.rank===4&&(f=!0,c=l.as5D(1,l.shape[0],l.shape[1],l.shape[2],l.shape[3])),s==null&&(s=[1,1,1]),P(c.rank===5,function(){return"Error in maxPool3d: x must be rank 5 but got rank "+c.rank+"."}),P(i==="NDHWC",function(){return"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+i}),P(Qn(e,s),function(){return"Error in maxPool3d: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+s+"'"}),a!=null&&P(Qt(n),function(){return"Error in maxPool3d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+n+"."});var d=gc(c.shape,t,e,s,n,a,i),p=$.runKernelFunc(function(g,v){var b=g.maxPool3d(c,d);return v([c,b]),b},{x:c},function(g,v){var b=v[0],w=v[1];return{x:function(){return function(S,x,C,A,T,R,O,N){var D=U(S,"dy","maxPool3dBackprop"),I=U(x,"input","maxPool3dBackprop"),_=U(C,"output","maxPool3dBackprop"),F=D,B=I,V=_,X=!1;I.rank===4&&(X=!0,F=D.as5D(1,D.shape[0],D.shape[1],D.shape[2],D.shape[3]),B=I.as5D(1,I.shape[0],I.shape[1],I.shape[2],I.shape[3]),V=_.as5D(1,_.shape[0],_.shape[1],_.shape[2],_.shape[3])),P(F.rank===5,function(){return"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+F.rank+"."}),P(B.rank===5,function(){return"Error in maxPool3dBackprop: input must be rank 5 but got rank "+B.rank+"."}),P(V.rank===5,function(){return"Error in maxPool3dBackprop: output must be rank 5 but got rank "+V.rank+"."}),R==null&&(R=[1,1,1]),P(Qn(T,R),function(){return"Error in maxPool3dBackprop: Either strides or dilations must be 1. Got strides "+T+" and dilations '"+R+"'"}),N!=null&&P(Qt(O),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+N+" but got pad "+O+"."});var Y=gc(B.shape,A,T,R,O,N),j=$.runKernelFunc(function(G){return G.maxPool3dBackprop(F,B,V,Y)},{dy5D:F,input5D:B});return X?j.as4D(j.shape[1],j.shape[2],j.shape[3],j.shape[4]):j}(g,b,w,t,e,s,n,a)}}});return f?p.as4D(p.shape[1],p.shape[2],p.shape[3],p.shape[4]):p}}),Kd=K({avgPool3d_:function(r,t,e,n,a,i,s){i===void 0&&(i="NDHWC");var l=U(r,"x","avgPool3d","float32"),c=l,f=!1;l.rank===4&&(f=!0,c=l.as5D(1,l.shape[0],l.shape[1],l.shape[2],l.shape[3])),s==null&&(s=[1,1,1]),P(c.rank===5,function(){return"Error in avgPool3d: x must be rank 5 but got rank "+c.rank+"."}),P(i==="NDHWC",function(){return"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+i}),P(Qn(e,s),function(){return"Error in avgPool3d: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+s+"'"}),a!=null&&P(Qt(n),function(){return"Error in avgPool3d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+n+"."});var d=gc(c.shape,t,e,s,n,a,i),p=$.runKernelFunc(function(g){return g.avgPool3d(c,d)},{x:c},function(g){return{x:function(){return function(v,b,w,S,x,C,A){var T=U(v,"dy","avgPool3dBackprop"),R=U(b,"input","avgPool3dBackprop"),O=T,N=R,D=!1;R.rank===4&&(D=!0,O=T.as5D(1,T.shape[0],T.shape[1],T.shape[2],T.shape[3]),N=R.as5D(1,R.shape[0],R.shape[1],R.shape[2],R.shape[3])),P(O.rank===5,function(){return"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+O.rank+"."}),P(N.rank===5,function(){return"Error in avgPool3dBackprop: input must be rank 5 but got rank "+N.rank+"."}),x==null&&(x=[1,1,1]),P(Qn(S,x),function(){return"Error in avgPool3dBackprop: Either strides or dilations must be 1. Got strides "+S+" and dilations '"+x+"'"}),A!=null&&P(Qt(C),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+A+" but got pad "+C+"."});var I=gc(N.shape,w,S,x,C,A),_=$.runKernelFunc(function(F){return F.avgPool3dBackprop(O,N,I)},{dy5D:O,input5D:N});return D?_.as4D(_.shape[1],_.shape[2],_.shape[3],_.shape[4]):_}(g,c,t,e,s,n,a)}}});return p=p.cast(c.dtype),f?p.as4D(p.shape[1],p.shape[2],p.shape[3],p.shape[4]):p}}),Rr=K({slice_:function(r,t,e){var n,a,i=U(r,"x","slice");if(i.rank===0)throw new Error("Slicing scalar is not possible");(n=typeof t=="number"?[t].concat(new Array(i.rank-1).fill(0)):t.length<i.rank?t.concat(new Array(i.rank-t.length).fill(0)):t.slice()).forEach(function(c){P(c!==-1,function(){return"slice() does not support negative begin indexing."})}),a=(a=e==null?new Array(i.rank).fill(-1):typeof e=="number"?[e].concat(new Array(i.rank-1).fill(-1)):e.length<i.rank?e.concat(new Array(i.rank-e.length).fill(-1)):e).map(function(c,f){return c>=0?c:(P(c===-1,function(){return"Negative size values should be exactly -1 but got "+c+" for the slice() size at index "+f+"."}),i.shape[f]-n[f])}),PA(i,n,a);var s=i.shape,l={begin:n,size:a};return $.runKernelFunc(function(c){return c.slice(i,n,a)},{x:i},function(c){for(var f=[],d=0;d<c.rank;d++)f.push([n[d],s[d]-n[d]-a[d]]);return{x:function(){return c.pad(f)}}},"Slice",l)}}),Fc=K({slice1d_:function(r,t,e){var n=U(r,"x","slice1d");return P(n.rank===1,function(){return"slice1d expects a rank-1 tensor, but got a rank-"+n.rank+" tensor"}),Rr(n,[t],[e])}}),Yd=K({slice2d_:function(r,t,e){var n=U(r,"x","slice2d");return P(n.rank===2,function(){return"slice2d expects a rank-2 tensor, but got a rank-"+n.rank+" tensor"}),Rr(n,t,e)}}),Bc=K({slice3d_:function(r,t,e){var n=U(r,"x","slice3d");return P(n.rank===3,function(){return"slice3d expects a rank-3 tensor, but got a rank-"+n.rank+" tensor"}),Rr(n,t,e)}}),Eu=K({slice4d_:function(r,t,e){var n=U(r,"x","slice4d");return P(n.rank===4,function(){return"slice4d expects a rank-4 tensor, but got a rank-"+n.rank+" tensor"}),Rr(n,t,e)}});function fN(r,t,e,n,a){return t.rank<e.rank&&(t=t.reshape(Tr(t.shape,n))),r.rank<e.rank&&(r=r.reshape(Tr(r.shape,n))),{$x:function(){var i=r.mul(e.equal(t).cast(r.dtype));return a==null?i:i.transpose(a)}}}var Zd=K({all_:function(r,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var n=U(r,"x","all","bool"),a=On(t,n.shape),i=a,s=ca(i,n.rank);s!=null&&(n=n.transpose(s),i=fa(i.length,n.rank));var l=$.runKernelFunc(function(f){return f.all(n,i)},{$x:n});if(e){var c=Tr(l.shape,a);return l.reshape(c)}return l}}),yc=K({any_:function(r,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var n=U(r,"x","any","bool"),a=On(t,n.shape),i=a,s=ca(i,n.rank);s!=null&&(n=n.transpose(s),i=fa(i.length,n.rank));var l=$.runKernelFunc(function(f){return f.any(n,i)},{$x:n});if(e){var c=Tr(l.shape,a);return l.reshape(c)}return l}}),bc=K({argMax_:function(r,t){t===void 0&&(t=0);var e=U(r,"x","argMax");t==null&&(t=0);var n=On(t,e.shape),a=ca(n,e.rank);return a!=null&&(e=e.transpose(a),n=fa(n.length,e.rank)),$.runKernelFunc(function(i,s){var l=i.argMax(e,n[0]);return s([e]),l},{$x:e},function(i,s){var l=s[0];return{$x:function(){return ct(l)}}})}}),jb=K({argMin_:function(r,t){t===void 0&&(t=0);var e=U(r,"x","argMin");t==null&&(t=0);var n=On(t,e.shape),a=ca(n,e.rank);return a!=null&&(e=e.transpose(a),n=fa(n.length,e.rank)),$.runKernelFunc(function(i,s){var l=i.argMin(e,n[0]);return s([e]),l},{$x:e},function(i,s){var l=s[0];return{$x:function(){return ct(l)}}})}}),hN=K({logSumExp_:function(r,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var n=U(r,"x","logSumExp"),a=On(t,n.shape),i=n.max(a,!0),s=n.sub(i).exp().sum(a).log(),l=i.reshape(s.shape).add(s);if(e){var c=Tr(l.shape,a);return l.reshape(c)}return l}}),no=K({max_:function(r,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var n=U(r,"x","max"),a=n,i=On(t,n.shape),s=i,l=ca(s,n.rank);l!=null&&(n=n.transpose(l),s=fa(s.length,n.rank));var c=$.runKernelFunc(function(d,p){var g=d.max(n,s);return p([a,g]),g},{$x:n},function(d,p){return fN(d,p[1],p[0],i,l)});if(e){var f=Tr(c.shape,i);c=c.reshape(f)}return c}}),an=K({mean_:function(r,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var n=U(r,"x","mean"),a=On(t,n.shape),i=Me(Ln(n.shape,a)[1]);return Lu(function(s){var l=Re(i);return{value:(l.dtype===s.dtype?s:s.cast(l.dtype)).div(l).sum(t,e),gradFunc:function(c){var f=s.shape.slice();return a.forEach(function(d){f[d]=1}),c.reshape(f).mul(Oa(s.shape,"float32")).div(i)}}})(n)}}),Qd=K({min_:function(r,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var n=U(r,"x","min"),a=n,i=On(t,n.shape),s=i,l=ca(s,n.rank);l!=null&&(n=n.transpose(l),s=fa(s.length,n.rank));var c=$.runKernelFunc(function(d,p){var g=d.min(n,s);return p([a,g]),g},{$x:n},function(d,p){return fN(d,p[1],p[0],i,l)});if(e){var f=Tr(c.shape,i);c=c.reshape(f)}return c}}),Uc=K({moments_:function(r,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var n=On(t,(r=U(r,"x","moments")).shape),a=r.mean(n,e),i=a.shape;e||(i=Tr(a.shape,n));var s=r.toFloat().sub(a.reshape(i)).square();return{mean:a,variance:s.mean(n,e)}}}),hr=K({sum_:function(r,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var n=U(r,"x","sum");n.dtype==="bool"&&(n=n.toInt());var a=On(t,n.shape);return Lu(function(i){var s=ca(a,i.rank),l=a,c=i;s!=null&&(c=i.transpose(s),l=fa(l.length,i.rank));var f=$.runKernelFunc(function(p){return p.sum(c,l)},{permutedX:c});if(e){var d=Tr(f.shape,a);f=f.reshape(d)}return{value:f,gradFunc:function(p){var g=i.shape.slice();return a.forEach(function(v){g[v]=1}),p.reshape(g).mul(Oa(i.shape,"float32"))}}})(n)}}),Jd=K({prod_:function(r,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var n=U(r,"x","prod");n.dtype==="bool"&&(n=n.toInt());var a=On(t,n.shape),i=ca(a,n.rank),s=a,l=n;i!=null&&(l=n.transpose(i),s=fa(s.length,n.rank));var c=$.runKernelFunc(function(d){return d.prod(l,s)},{permutedX:l});if(e){var f=Tr(c.shape,a);c=c.reshape(f)}return c}}),Vu=K({elu_:function(r){var t=U(r,"x","elu");return $.runKernelFunc(function(e,n){var a=e.elu(t);return n([a]),a},{$x:t},function(e,n){var a=n[0];return{$x:function(){return $.runKernelFunc(function(i){return i.eluDer(e,a)},{dy:e,y:a})}}})}}),ep=K({leakyRelu_:function(r,t){t===void 0&&(t=.2);var e=U(r,"x","leakyRelu");return _a(Re(t).mul(e),e)}}),tp=K({prelu_:function(r,t){var e=U(r,"x","prelu"),n=U(t,"alpha","prelu");return $.runKernelFunc(function(a,i){var s=a.prelu(e,n);return i([e,n]),s},{x:e,alpha:n},function(a,i){var s=i[0],l=i[1],c=s.greater(0);return{x:function(){return fi(c,a,a.mul(l))},alpha:function(){var f=fi(c,ct(a),a.mul(s)),d=dn(l.shape,a.shape);return d.length>0&&(f=f.sum(d)),f.reshape(l.shape)}}},"Prelu")}}),lo=K({relu_:function(r){var t=U(r,"x","relu");return t.dtype==="bool"?t.toInt():$.runKernelFunc(function(e,n){var a=e.relu(t);return n([t]),a},{$x:t},function(e,n){var a=n[0];return{$x:function(){return e.mulStrict(a.step().toFloat())}}})}}),Wb=K({relu6_:function(r){var t=U(r,"x","relu6");return t.dtype==="bool"?t.toInt():$.runKernelFunc(function(e,n){var a=e.relu6(t);return n([t]),a},{$x:t},function(e,n){var a=n[0],i=a.lessEqual(6).mul(a.step());return{$x:function(){return e.mulStrict(i.toFloat())}}})}}),np=K({selu_:function(r){var t=U(r,"x","selu");return $.runKernelFunc(function(e,n){var a=e.selu(t);return n([t]),a},{$x:t},function(e,n){var a=n[0];return{$x:function(){var i=a.greater(Re(0)),s=Re(ob),l=Re(sb),c=e.mul(l),f=e.mul(s).mul(a.toFloat().exp());return fi(i,c,f)}}})}}),Ut=K({transpose_:function(r,t){var e=U(r,"x","transpose");return t==null&&(t=e.shape.map(function(n,a){return a}).reverse()),P(e.rank===t.length,function(){return"Error in transpose: rank of input "+e.rank+" must match length of perm "+t+"."}),t.forEach(function(n){P(n>=0&&n<e.rank,function(){return"All entries in 'perm' must be between 0 and "+(e.rank-1)+" but got "+t})}),e.rank<=1?e.clone():$.runKernelFunc(function(n){return n.transpose(e,t)},{$x:e},function(n){var a=Sd(t);return{$x:function(){return n.transpose(a)}}})}}),Hb=K({localResponseNormalization_:function(r,t,e,n,a){t===void 0&&(t=5),e===void 0&&(e=1),n===void 0&&(n=1),a===void 0&&(a=.5);var i=U(r,"x","localResponseNormalization");P(i.rank===4||i.rank===3,function(){return`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank `+i.rank+"."}),P(Qt(t),function(){return"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius "+t+"."});var s=i,l=!1;i.rank===3&&(l=!0,s=i.as4D(1,i.shape[0],i.shape[1],i.shape[2]));var c=$.runKernelFunc(function(f,d){var p=f.localResponseNormalization4D(s,t,e,n,a);return d([s,p]),p},{x4D:s},function(f,d){var p=d[0],g=d[1];return{x4D:function(){return $.runKernelFunc(function(v){return v.LRNGrad(f,p,g,t,e,n,a)},{})}}});return l?c.as3D(c.shape[1],c.shape[2],c.shape[3]):c}}),qb=K({norm_:function(r,t,e,n){t===void 0&&(t="euclidean"),e===void 0&&(e=null),n===void 0&&(n=!1);var a=function l(c,f,d){if(d===void 0&&(d=null),c.rank===0)return c.abs();if(c.rank!==1&&d===null)return l(c.reshape([-1]),f,d);if(c.rank===1||typeof d=="number"||Array.isArray(d)&&d.length===1){if(f===1)return c.abs().sum(d);if(f===1/0)return c.abs().max(d);if(f===-1/0)return c.abs().min(d);if(f==="euclidean"||f===2)return c.abs().pow(Re(2,"int32")).sum(d).sqrt();throw new Error("Error in norm: invalid ord value: "+f)}if(Array.isArray(d)&&d.length===2){if(f===1)return c.abs().sum(d[0]).max(d[1]-1);if(f===1/0)return c.abs().sum(d[1]).max(d[0]);if(f===-1/0)return c.abs().sum(d[1]).min(d[0]);if(f==="fro"||f==="euclidean")return c.square().sum(d).sqrt();throw new Error("Error in norm: invalid ord value: "+f)}throw new Error("Error in norm: invalid axis: "+d)}(r=U(r,"x","norm"),t,e),i=a.shape;if(n){var s=On(e,r.shape);i=Tr(a.shape,s)}return a.reshape(i)}}),dN=K({basicLSTMCell_:function(r,t,e,n,a,i){var s=U(r,"forgetBias","basicLSTMCell"),l=U(t,"lstmKernel","basicLSTMCell"),c=U(e,"lstmBias","basicLSTMCell"),f=U(n,"data","basicLSTMCell"),d=U(a,"c","basicLSTMCell"),p=U(i,"h","basicLSTMCell"),g=f.concat(p,1).matMul(l).add(c),v=g.shape[0],b=g.shape[1]/4,w=[v,b],S=g.slice([0,0],w),x=g.slice([0,b],w),C=g.slice([0,2*b],w),A=g.slice([0,3*b],w),T=S.sigmoid().mulStrict(x.tanh()).addStrict(d.mulStrict(s.add(C).sigmoid())),R=T.tanh().mulStrict(A.sigmoid());return[T,R]}}),pN=K({multiRNNCell_:function(r,t,e,n){for(var a=U(t,"data","multiRNNCell"),i=mc(e,"c","multiRNNCell"),s=mc(n,"h","multiRNNCell"),l=a,c=[],f=0;f<r.length;f++){var d=r[f](l,i[f],s[f]);c.push(d[0]),c.push(d[1]),l=d[1]}var p=[],g=[];for(f=0;f<c.length;f+=2)p.push(c[f]),g.push(c[f+1]);return[p,g]}}),mN=K({movingAverage_:function(r,t,e,n,a){a===void 0&&(a=!0);var i=U(r,"v","movingAverage"),s=U(t,"x","movingAverage"),l=U(e,"decay","movingAverage");$C(i,s),P(kn(i.shape,s.shape),function(){return"Shape mismatch in v and x"});var c=Re(1),f=c.sub(l),d=s.sub(i).mul(f);if(a){P(n!=null,function(){return"When using zeroDebias: true, step is required."});var p=U(n,"step","movingAverage");d=d.div(c.sub(xu(l,p)))}return i.add(d)}}),Gb=K({stridedSlice_:function(r,t,e,n,a,i,s,l,c){if(a===void 0&&(a=0),i===void 0&&(i=0),s===void 0&&(s=0),l===void 0&&(l=0),c===void 0&&(c=0),n==null&&(n=new Array(t.length)),s!==0)throw new Error("ellipsis mask is not yet supported");var f=U(r,"x","stridedSlice"),d=Pv(l),p=f.shape.slice();d.forEach(function(S){t[S]=0,e[S]=1,p.splice(S,0,1)}),f=f.reshape(p);for(var g=0;g<f.rank;g++)t[g]=VA(a,t,n,f.shape,g),e[g]=jA(i,e,n,f.shape,g),n[g]=n[g]||1;var v=Pv(c);v.forEach(function(S){e[S]=t[S]+1,n[S]=1});var b=Id(t,e,n),w=b.filter(function(S,x){return v.indexOf(x)===-1});return n.every(function(S){return S===1})?Rr(f,t,b).reshape(w):$.runKernelFunc(function(S){return S.stridedSlice(f,t,e,n)},{$x:f}).reshape(w)}}),Xb=K({topk_:function(r,t,e){t===void 0&&(t=1),e===void 0&&(e=!0);var n=U(r,"x","topk");if(n.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");var a=n.shape[n.shape.length-1];if(t>a)throw new Error("'k' passed to topk() must be <= the last dimension ("+a+") but got "+t);var i=$.runKernelFunc(function(s){return s.topk(n,t,e)},{$x:n});return{values:i[0],indices:i[1]}}}),$b=K({scatterND_:function(r,t,e){var n=U(r,"indices","scatterND","int32"),a=U(t,"updates","scatterND");return e4(a,n,e),$.runKernelFunc(function(i){return i.scatterND(n,a,e)},{$indices:n,$updates:a})}}),Pc=K({fft_:function(r){P(r.dtype==="complex64",function(){return"The dtype for tf.spectral.fft() must be complex64 but got "+r.dtype+"."});var t=r.shape[r.shape.length-1],e=r.size/t,n=r.as2D(e,t);return $.runKernelFunc(function(a){return a.fft(n)},{input:r}).reshape(r.shape)}}),Cu=K({ifft_:function(r){P(r.dtype==="complex64",function(){return"The dtype for tf.spectral.ifft() must be complex64 but got "+r.dtype+"."});var t=r.shape[r.shape.length-1],e=r.size/t,n=r.as2D(e,t);return $.runKernelFunc(function(a){return a.ifft(n)},{input:r}).reshape(r.shape)}}),Vc=K({rfft_:function(r,t){P(r.dtype==="float32",function(){return"The dtype for rfft() must be real value but got "+r.dtype});var e,n=r.shape[r.shape.length-1],a=r.size/n;if(t!=null&&t<n){var i=r.shape.map(function(x){return 0}),s=r.shape.map(function(x){return x});s[r.shape.length-1]=t,e=r.slice(i,s),n=t}else if(t!=null&&t>n){var l=r.shape.map(function(x){return x});l[r.shape.length-1]=t-n,e=r.concat(St(l),r.shape.length-1),n=t}else e=r;var c=e.zerosLike(),f=Sn(e,c).as2D(a,n),d=Pc(f),p=Math.floor(n/2)+1,g=lr(d),v=Gr(d),b=g.split([p,n-p],g.shape.length-1),w=v.split([p,n-p],v.shape.length-1),S=e.shape.slice();return S[e.shape.length-1]=p,Sn(b[0],w[0]).reshape(S)}}),rp=K({irfft_:function(r){var t=r.shape[r.shape.length-1],e=r.size/t;if(t<=2){var n=r.as2D(e,t),a=Cu(n);return lr(a)}var i=[e,2*(t-1)],s=lr(r).as2D(e,t),l=Gr(r).as2D(e,t),c=s.slice([0,1],[e,t-2]).reverse(1),f=l.slice([0,1],[e,t-2]).reverse(1).mul(Re(-1)),d=s.concat(c,1),p=l.concat(f,1);return n=Sn(d,p).as2D(i[0],i[1]),a=Cu(n),lr(a)}}),gN=Object.freeze({fft:Pc,ifft:Cu,rfft:Vc,irfft:rp}),ap=K({sparseToDense_:function(r,t,e,n){n===void 0&&(n=0);var a=U(r,"sparseIndices","sparseToDense","int32"),i=U(t,"sparseValues","sparseToDense"),s=U(n,"defaultValue","sparseToDense",i.dtype);return function(l,c,f,d){if(l.dtype!=="int32")throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was "+l.dtype+".");if(l.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape "+l.shape+".");var p=l.rank>0?l.shape[0]:1,g=l.rank>1?l.shape[1]:1;if(f.length!==g)throw new Error("outputShape has incorrect number of elements:, "+f.length+", should be: "+g+".");var v=c.size;if(c.rank!==0&&(c.rank!==1||v!==p))throw new Error("sparseValues has incorrect shape "+c.shape+", should be [] or ["+p+"]");if(c.dtype!==d.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(a,i,e,s),$.runKernelFunc(function(l){return l.sparseToDense(a,i,e,s)},{$sparseIndices:a,$sparseValues:i,$defaultValue:s})}}),Kb=K({gatherND_:function(r,t){var e=U(t,"indices","gatherND","int32"),n=U(r,"x","gatherND");return $.runKernelFunc(function(a){return a.gatherND(n,e)},{$x:n,$indices:e})}}),vN=K({diag_:function(r){var t=U(r,"x","diag").flatten(),e=r.shape.concat(r.shape);return $.runKernelFunc(function(n){return n.diag(t)},{$x:t}).reshape(e)}}),Yb=K({dropout_:function(r,t,e,n){var a=U(r,"x","dropout");if(P(a.dtype==="float32",function(){return"x has to be a floating point tensor since it's going to be scaled, but got a "+a.dtype+" tensor instead."}),P(t>=0&&t<1,function(){return"rate must be a float in the range [0, 1), but got "+t+"."}),t===0)return r instanceof Ct?a.clone():a;var i=function(c,f){if(f==null)return c.shape.slice();if(kn(c.shape,f))return f;if(c.shape.length===f.length){for(var d=[],p=0;p<c.shape.length;p++)f[p]==null&&c.shape[p]!=null?d.push(c.shape[p]):d.push(f[p]);return d}return f}(a,e),s=1-t,l=cs(i,0,1,"float32",n).add(s).floor().div(s);return a.mul(l)}});function yN(r,t,e){for(var n=1-r%2,a=new Float32Array(r),i=0;i<r;++i){var s=2*Math.PI*i/(r+n-1);a[i]=t-e*Math.cos(s)}return fr(a,"float32")}var ip=K({hannWindow_:function(r){return yN(r,.5,.5)}}),Zb=K({hammingWindow_:function(r){return yN(r,.54,.46)}}),op=K({frame_:function(r,t,e,n,a){n===void 0&&(n=!1),a===void 0&&(a=0);for(var i=0,s=[];i+t<=r.size;)s.push(Rr(r,i,t)),i+=e;if(n)for(;i<r.size;){var l=i+t-r.size,c=Gn([Rr(r,i,t-l),zu([l],a)]);s.push(c),i+=e}return s.length===0?ai([],[0,t]):Gn(s).as2D(s.length,t)}}),Qb=K({stft_:function(r,t,e,n,a){var i;a===void 0&&(a=ip),n==null&&(i=t,n=Math.floor(Math.pow(2,Math.ceil(Math.log(i)/Math.log(2)))));for(var s=op(r,t,e),l=Xe(s,a(t)),c=[],f=0;f<s.shape[0];f++)c.push(Vc(l.slice([f,0],[1,t]),n));return Gn(c)}}),bN=Object.freeze({hannWindow:ip,hammingWindow:Zb,frame:op,stft:Qb}),Bn,wN=function(r,t,e){return e===void 0&&(e=1),De(this,void 0,void 0,function(){var n,a,i,s,l,c,f,d,p,g,v,b,w,S;return Oe(this,function(x){switch(x.label){case 0:return n=U(r,"predictions","inTopK"),a=U(t,"targets","inTopK"),P(n.rank>1,function(){return"inTopK() expects the predictions to be of rank 2 or higher, but got "+n.rank}),P(n.rank-1===a.rank,function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+n.rank+" and targets rank "+a.rank}),mt(n.shape.slice(0,n.shape.length-1),a.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),i=n.shape[n.shape.length-1],P(e>0&&e<=i,function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last dimension ("+i+"), but got "+e}),[4,n.data()];case 1:return s=x.sent(),[4,a.data()];case 2:for(l=x.sent(),c=[s.length/i,i],d=c[1],p=uc("bool",f=c[0]),g=0;g<f;g++){for(v=g*d,b=s.subarray(v,v+d),w=[],S=0;S<b.length;S++)w.push({value:b[S],index:S});for(w.sort(function(C,A){return A.value-C.value}),p[g]=0,S=0;S<e;S++)if(w[S].index===l[g]){p[g]=1;break}}return r!==n&&n.dispose(),t!==a&&a.dispose(),[2,rn(p,a.shape,"bool")]}})})};(function(r){r[r.NONE=0]="NONE",r[r.MEAN=1]="MEAN",r[r.SUM=2]="SUM",r[r.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(Bn||(Bn={}));var WL=K({absoluteDifference_:function(r,t,e,n){n===void 0&&(n=Bn.SUM_BY_NONZERO_WEIGHTS);var a=U(r,"labels","absoluteDifference"),i=U(t,"predictions","absoluteDifference"),s=null;e!=null&&(s=U(e,"weights","absoluteDifference")),mt(a.shape,i.shape,"Error in absoluteDifference: ");var l=a.sub(i).abs();return gi(l,s,n)}}),gi=K({computeWeightedLoss_:function(r,t,e){e===void 0&&(e=Bn.SUM_BY_NONZERO_WEIGHTS);var n=U(r,"losses","computeWeightedLoss"),a=null;t!=null&&(a=U(t,"weights","computeWeightedLoss"));var i=a==null?n:n.mul(a);if(e===Bn.NONE)return i;if(e===Bn.SUM)return i.sum();if(e===Bn.MEAN){if(a==null)return i.mean();var s=n.size/a.size,l=i.sum().div(a.sum());return s>1?l.div(Re(s)):l}if(e===Bn.SUM_BY_NONZERO_WEIGHTS){if(a==null)return i.sum().div(Re(n.size));var c=a.mul(Oa(n.shape)).notEqual(Re(0)).sum().toFloat();return i.sum().div(c)}throw Error("Unknown reduction: "+e)}}),HL=K({cosineDistance_:function(r,t,e,n,a){a===void 0&&(a=Bn.SUM_BY_NONZERO_WEIGHTS);var i=U(r,"labels","cosineDistance"),s=U(t,"predictions","cosineDistance"),l=null;n!=null&&(l=U(n,"weights","cosineDistance")),mt(i.shape,s.shape,"Error in cosineDistance: ");var c=Re(1).sub(i.mul(s).sum(e,!0));return gi(c,l,a)}}),qL=K({hingeLoss_:function(r,t,e,n){n===void 0&&(n=Bn.SUM_BY_NONZERO_WEIGHTS);var a=U(r,"labels","hingeLoss"),i=U(t,"predictions","hingeLoss"),s=null;e!=null&&(s=U(e,"weights","hingeLoss")),mt(a.shape,i.shape,"Error in hingeLoss: ");var l=Re(1);a=Re(2).mul(a).sub(l);var c=l.sub(a.mul(i)).relu();return gi(c,s,n)}}),GL=K({huberLoss_:function(r,t,e,n,a){n===void 0&&(n=1),a===void 0&&(a=Bn.SUM_BY_NONZERO_WEIGHTS);var i=U(r,"labels","huberLoss"),s=U(t,"predictions","huberLoss"),l=null;e!=null&&(l=U(e,"weights","huberLoss")),mt(i.shape,s.shape,"Error in huberLoss: ");var c=Re(n),f=s.sub(i).abs(),d=Fu(f,c),p=f.sub(d),g=Re(.5).mul(d.square()).add(c.mul(p));return gi(g,l,a)}}),XL=K({logLoss_:function(r,t,e,n,a){n===void 0&&(n=1e-7),a===void 0&&(a=Bn.SUM_BY_NONZERO_WEIGHTS);var i=U(r,"labels","logLoss"),s=U(t,"predictions","logLoss"),l=null;e!=null&&(l=U(e,"weights","logLoss")),mt(i.shape,s.shape,"Error in logLoss: ");var c=Re(1),f=Re(n),d=i.mul(s.add(f).log()).neg().sub(c.sub(i).mul(c.sub(s).add(f).log()));return gi(d,l,a)}}),$L=K({meanSquaredError_:function(r,t,e,n){n===void 0&&(n=Bn.SUM_BY_NONZERO_WEIGHTS);var a=U(r,"labels","meanSquaredError"),i=U(t,"predictions","meanSquaredError"),s=null;e!=null&&(s=U(e,"weights","meanSquaredError")),mt(a.shape,i.shape,"Error in meanSquaredError: ");var l=a.squaredDifference(i);return gi(l,s,n)}}),KL=K({sigmoidCrossEntropy_:function(r,t,e,n,a){n===void 0&&(n=0),a===void 0&&(a=Bn.SUM_BY_NONZERO_WEIGHTS);var i=U(r,"multiClassLabels","sigmoidCrossEntropy"),s=U(t,"logits","sigmoidCrossEntropy"),l=null;if(e!=null&&(l=U(e,"weights","sigmoidCrossEntropy")),mt(i.shape,s.shape,"Error in sigmoidCrossEntropy: "),n>0){var c=Re(n),f=Re(1),d=Re(.5);i=i.mul(f.sub(c)).add(d.mul(c))}var p=function(g,v){var b=U(g,"labels","sigmoidCrossEntropyWithLogits"),w=U(v,"logits","sigmoidCrossEntropyWithLogits");mt(b.shape,w.shape,"Error in sigmoidCrossEntropyWithLogits: ");var S=w.relu(),x=w.mul(b),C=w.abs().neg().exp().log1p();return S.sub(x).add(C)}(i,s);return gi(p,l,a)}}),YL=K({softmaxCrossEntropy_:function(r,t,e,n,a){n===void 0&&(n=0),a===void 0&&(a=Bn.SUM_BY_NONZERO_WEIGHTS);var i=U(r,"onehotLabels","softmaxCrossEntropy"),s=U(t,"logits","softmaxCrossEntropy"),l=null;if(e!=null&&(l=U(e,"weights","softmaxCrossEntropy")),mt(i.shape,s.shape,"Error in softmaxCrossEntropy: "),n>0){var c=Re(n),f=Re(1),d=Re(i.shape[1]);i=i.mul(f.sub(c)).add(c.div(d))}var p=function(g,v,b){if(b===void 0&&(b=-1),b===-1&&(b=v.rank-1),b!==v.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+v.rank+" and dim was "+b);return Lu(function(w,S,x){var C=S.logSumExp([b],!0),A=S.toFloat().sub(C);return x([w,A]),{value:A.mul(w).neg().sum([b]),gradFunc:function(T,R){var O=R[0],N=R[1],D=Tr(T.shape,[b]);return[T.reshape(D).mul(O.toFloat().sub(N.exp())),T.reshape(D).mul(N.exp().sub(O.toFloat()))]}}})(g,v)}(i,s);return gi(p,l,a)}}),xN=Object.freeze({get Reduction(){return Bn},absoluteDifference:WL,computeWeightedLoss:gi,cosineDistance:HL,hingeLoss:qL,huberLoss:GL,logLoss:XL,meanSquaredError:$L,sigmoidCrossEntropy:KL,softmaxCrossEntropy:YL});function SS(r,t){return t===void 0&&(t=!1),$.tidy(function(){if(r.shape.length!==2)throw new Error("qr2d() requires a 2D Tensor, but got a "+r.shape.length+"D Tensor.");for(var e=r.shape[0],n=r.shape[1],a=Nd(e),i=r.clone(),s=ai([[1]],[1,1]),l=s.clone(),c=e>=n?n:e,f=function(p){var g,v=i,b=l,w=a;g=$.tidy(function(){var S=i.slice([p,p],[e-p,1]),x=S.norm(),C=i.slice([p,p],[1,1]),A=ai([[-1]]).where(C.greater(0),ai([[1]])),T=C.sub(A.mul(x)),R=S.div(T);l=R.shape[0]===1?s.clone():s.concat(R.slice([1,0],[R.shape[0]-1,R.shape[1]]),0);var O=A.matMul(T).div(x).neg(),N=i.slice([p,0],[e-p,n]),D=O.mul(l);if(p===0)i=N.sub(D.matMul(l.transpose().matMul(N)));else{var I=N.sub(D.matMul(l.transpose().matMul(N)));i=i.slice([0,0],[p,n]).concat(I,0)}var _=a.slice([0,p],[e,a.shape[1]-p]);if(p===0)a=_.sub(_.matMul(l).matMul(D.transpose()));else{var F=_.sub(_.matMul(l).matMul(D.transpose()));a=a.slice([0,0],[e,p]).concat(F,1)}return[l,i,a]}),l=g[0],i=g[1],a=g[2],et([v,b,w])},d=0;d<c;++d)f(d);return!t&&e>n&&(a=a.slice([0,0],[e,n]),i=i.slice([0,0],[n,n])),[a,i]})}var ZL=K({gramSchmidt_:function(r){var t;if(Array.isArray(r)){t=!1,P(r!=null&&r.length>0,function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"});for(var e=r[0].shape[0],n=function(c){P(r[c].shape[0]===e,function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+r[c].shape[0]+" vs. "+e+")"})},a=1;a<r.length;++a)n(a)}else t=!0,r=ii(r,r.shape[0],0).map(function(c){return kc(c,[0])});P(r.length<=r[0].shape[0],function(){return"Gram-Schmidt: Number of vectors ("+r.length+") exceeds number of dimensions ("+r[0].shape[0]+")."});var i=[],s=r,l=function(c){i.push($.tidy(function(){var f=s[c];if(c>0)for(var d=0;d<c;++d){var p=hr(i[d].mulStrict(f)).mul(i[d]);f=f.sub(p)}return f.div(qb(f,"euclidean"))}))};for(a=0;a<r.length;++a)l(a);return t?ia(i,0):i}}),QL=K({qr_:function(r,t){if(t===void 0&&(t=!1),r.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank "+r.rank);if(r.rank===2)return SS(r,t);var e=r.shape.slice(0,r.shape.length-2).reduce(function(s,l){return s*l}),n=ts(r.reshape([e,r.shape[r.shape.length-2],r.shape[r.shape.length-1]]),0),a=[],i=[];return n.forEach(function(s){var l=SS(s,t),c=l[0],f=l[1];a.push(c),i.push(f)}),[ia(a,0).reshape(r.shape),ia(i,0).reshape(r.shape)]}}),Jb=Object.freeze({gramSchmidt:ZL,qr:QL});function SN(r,t,e,n,a){n==null&&(n=.5),a==null&&(a=Number.NEGATIVE_INFINITY);var i=r.shape[0];return e=Math.min(e,i),P(0<=n&&n<=1,function(){return"iouThreshold must be in [0, 1], but was '"+n+"'"}),P(r.rank===2,function(){return"boxes must be a 2D tensor, but was of rank '"+r.rank+"'"}),P(r.shape[1]===4,function(){return"boxes must have 4 columns, but 2nd dimension was "+r.shape[1]}),P(t.rank===1,function(){return"scores must be a 1D tensor"}),P(t.shape[0]===i,function(){return"scores has incompatible shape with boxes. Expected "+i+", but was "+t.shape[0]}),{maxOutputSize:e,iouThreshold:n,scoreThreshold:a}}var JL=K({resizeBilinear_:function(r,t,e){e===void 0&&(e=!1);var n=U(r,"images","resizeBilinear");P(n.rank===3||n.rank===4,function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+n.rank+"."}),P(t.length===2,function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+t+"."});var a=n,i=!1;n.rank===3&&(i=!0,a=n.as4D(1,n.shape[0],n.shape[1],n.shape[2]));var s=t[0],l=t[1],c=$.runKernelFunc(function(f,d){return d([a]),f.resizeBilinear(a,s,l,e)},{batchImages:a},function(f,d){return{batchImages:function(){return $.runKernelFunc(function(p){return p.resizeBilinearBackprop(f,d[0],e)},{})}}});return i?c.as3D(c.shape[1],c.shape[2],c.shape[3]):c}}),eF=K({resizeNearestNeighbor_:function(r,t,e){e===void 0&&(e=!1);var n=U(r,"images","resizeNearestNeighbor");P(n.rank===3||n.rank===4,function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+n.rank+"."}),P(t.length===2,function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+t+"."}),P(n.dtype==="float32"||n.dtype==="int32",function(){return"`images` must have `int32` or `float32` as dtype"});var a=n,i=!1;n.rank===3&&(i=!0,a=n.as4D(1,n.shape[0],n.shape[1],n.shape[2]));var s=t[0],l=t[1],c=$.runKernelFunc(function(f,d){return d([a]),f.resizeNearestNeighbor(a,s,l,e)},{batchImages:a},function(f,d){return{batchImages:function(){return $.runKernelFunc(function(p){return p.resizeNearestNeighborBackprop(f,d[0],e)},{})}}});return i?c.as3D(c.shape[1],c.shape[2],c.shape[3]):c}}),tF=K({nonMaxSuppression_:function(r,t,e,n,a){n===void 0&&(n=.5),a===void 0&&(a=Number.NEGATIVE_INFINITY);var i=U(r,"boxes","nonMaxSuppression"),s=U(t,"scores","nonMaxSuppression"),l=SN(i,s,e,n,a);return e=l.maxOutputSize,n=l.iouThreshold,a=l.scoreThreshold,$.runKernelFunc(function(c){return c.nonMaxSuppression(i,s,e,n,a)},{$boxes:i})}}),nF=function(r,t,e,n,a){return n===void 0&&(n=.5),a===void 0&&(a=Number.NEGATIVE_INFINITY),De(this,void 0,void 0,function(){var i,s,l,c,f,d,p;return Oe(this,function(g){switch(g.label){case 0:return i=U(r,"boxes","nonMaxSuppressionAsync"),s=U(t,"scores","nonMaxSuppressionAsync"),l=SN(i,s,e,n,a),e=l.maxOutputSize,n=l.iouThreshold,a=l.scoreThreshold,[4,Promise.all([i.data(),s.data()])];case 1:return c=g.sent(),f=c[0],d=c[1],p=rb(f,d,e,n,a),i!==r&&i.dispose(),s!==t&&s.dispose(),[2,p]}})})},rF=K({cropAndResize_:function(r,t,e,n,a,i){var s=U(r,"image","cropAndResize","float32"),l=U(t,"boxes","cropAndResize","float32"),c=U(e,"boxInd","cropAndResize","int32");a=a||"bilinear",i=i||0;var f=l.shape[0];return P(s.rank===4,function(){return"Error in cropAndResize: image must be rank 4,but got rank "+s.rank+"."}),P(l.rank===2&&l.shape[1]===4,function(){return"Error in cropAndResize: boxes must be have size ["+f+",4] but had shape "+l.shape+"."}),P(c.rank===1&&c.shape[0]===f,function(){return"Error in cropAndResize: boxInd must be have size ["+f+"] but had shape "+l.shape+"."}),P(n.length===2,function(){return"Error in cropAndResize: cropSize must be of length 2, but got length "+n.length+"."}),P(n[0]>=1&&n[1]>=1,function(){return"cropSize must be atleast [1,1], but was "+n}),P(a==="bilinear"||a==="nearest",function(){return"method must be bilinear or nearest, but was "+a}),$.runKernelFunc(function(d,p){return d.cropAndResize(s,l,c,n,a,i)},{$image:s,$boxes:l})}}),$o=Object.freeze({resizeBilinear:JL,resizeNearestNeighbor:eF,nonMaxSuppression:tF,nonMaxSuppressionAsync:nF,cropAndResize:rF}),e0=function(r,t){return!(r>0)&&(t==="linear"||t==="relu")},t0=function(r,t,e){if(e==null||e==="linear")return r;if(e==="relu")return r.mul(t.step());throw new Error("Gradient for activation "+e+" has not been implemented yet.")},n0=function(r,t){var e=t,n=dn(r.shape,t.shape);return n.length>0&&(e=e.sum(n)),e.reshape(r.shape)},r0=function(r,t,e){if(t==="linear")return r;if(t==="relu")return lo(r);if(t==="elu")return Vu(r);if(t==="relu6")return Wb(r);if(t==="prelu")return tp(r,e);throw new Error("Unknown fused activation "+t+".")},aF=K({matMul_:function(r){var t,e=r.a,n=r.b,a=r.transposeA,i=a!==void 0&&a,s=r.transposeB,l=s!==void 0&&s,c=r.bias,f=r.activation,d=f===void 0?"linear":f,p=r.preluActivationWeights;if(e0($.state.gradientDepth,d)===!1){var g=qd(e,n,i,l);return c!=null&&(g=ot(g,c)),r0(g,d,p)}var v=U(e,"a","fused matMul"),b=U(n,"b","fused matMul");t=Jt(v,b),v=t[0],b=t[1];var w=i?v.shape[v.rank-2]:v.shape[v.rank-1],S=l?b.shape[b.rank-1]:b.shape[b.rank-2],x=i?v.shape[v.rank-1]:v.shape[v.rank-2],C=l?b.shape[b.rank-2]:b.shape[b.rank-1],A=v.shape.slice(0,-2),T=b.shape.slice(0,-2),R=Me(A),O=Me(T);P(v.rank>=2&&b.rank>=2&&v.rank===b.rank,function(){return"Error in fused matMul: inputs must have the same rank of at least 2, got ranks "+v.rank+" and "+b.rank+"."}),P(kn(A,T),function(){return"Error in fused matMul: outer dimensions ("+A+") and ("+T+") of Tensors with shapes "+v.shape+" and "+b.shape+" must match."}),P(w===S,function(){return"Error in fused matMul: inner shapes ("+w+") and ("+S+") of Tensors with shapes "+v.shape+" and "+b.shape+" and transposeA="+i+" and transposeB="+l+" must match."});var N,D,I=v.shape.slice(0,-2).concat([x,C]),_=i?v.as3D(R,w,x):v.as3D(R,x,w),F=l?b.as3D(O,C,S):b.as3D(O,S,C);c!=null&&lt(I,(N=Jt(N=U(c,"bias","fused matMul"),v)[0]).shape),p!=null&&(D=U(p,"prelu weights","fused matMul"));var B={$a:_,$b:F};return c!=null&&(B.$bias=N),p!=null&&(B.$preluActivationWeights=D),$.runKernelFunc(function(V,X){var Y=V.fusedBatchMatMul({a:_,b:F,transposeA:i,transposeB:l,bias:N,activation:d,preluActivationWeights:D});return X([_,F,Y]),Y},B,function(V,X){var Y=X[0],j=X[1],G=X[2],q=t0(V,G,d),ne={};return c!=null&&(ne={$bias:function(){return n0(N,q)}}),Object.assign(i||l?!i&&l?{$a:function(){return q.matMul(j,!1,!1)},$b:function(){return q.matMul(Y,!0,!1)}}:i&&!l?{$a:function(){return j.matMul(q,!1,!0)},$b:function(){return Y.matMul(q,!1,!1)}}:{$a:function(){return j.matMul(q,!0,!0)},$b:function(){return q.matMul(Y,!0,!0)}}:{$a:function(){return q.matMul(j,!1,!0)},$b:function(){return Y.matMul(q,!0,!1)}},ne)}).reshape(I)}}),iF=K({conv2d_:function(r){var t=r.x,e=r.filter,n=r.strides,a=r.pad,i=r.dataFormat,s=i===void 0?"NHWC":i,l=r.dilations,c=l===void 0?[1,1]:l,f=r.dimRoundingMode,d=r.bias,p=r.activation,g=p===void 0?"linear":p,v=r.preluActivationWeights;if(g=g||"linear",e0($.state.gradientDepth,g)===!1){var b=ps(t,e,n,a,s,c,f);return d!=null&&(b=ot(b,d)),r0(b,g,v)}var w=U(t,"x","conv2d"),S=U(e,"filter","conv2d"),x=w,C=!1;w.rank===3&&(C=!0,x=w.as4D(1,w.shape[0],w.shape[1],w.shape[2])),P(x.rank===4,function(){return"Error in fused conv2d: input must be rank 4, but got rank "+x.rank+"."}),P(S.rank===4,function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+S.rank+"."}),f!=null&&P(Qt(a),function(){return"Error in fused conv2d: pad must be an integer when using, dimRoundingMode "+f+" but got pad "+a+"."}),P(x.shape[3]===S.shape[2],function(){return"Error in conv2d: depth of input ("+x.shape[3]+") must match input depth for filter "+S.shape[2]+"."}),P(Qn(n,c),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+c+"'"}),P(s==="NHWC",function(){return"Error in conv2d: got dataFormat of "+s+" but only NHWC is currently supported."});var A,T,R=uo(x.shape,S.shape,n,c,a,f);d!=null&&(A=Jt(A=U(d,"bias","fused conv2d"),w)[0],lt(R.outShape,A.shape)),v!=null&&(T=U(v,"prelu weights","fused conv2d"));var O={x,$filter:S};d!=null&&(O.$bias=A),v!=null&&(O.$preluActivationWeights=T);var N=$.runKernelFunc(function(D,I){var _=D.fusedConv2d({input:x,filter:S,convInfo:R,bias:A,activation:g,preluActivationWeights:T});return I([S,x,_]),_},O,function(D,I){var _=I,F=_[0],B=_[1],V=_[2],X=t0(D,V,g);P(ns(c),function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+c+"'"});var Y={};return d!=null&&(Y={$bias:function(){return n0(A,X)}}),Object.assign({x:function(){return QT(B.shape,X,F,n,a)},$filter:function(){return Pb(B,X,F.shape,n,a)}},Y)});return C?N.as3D(N.shape[1],N.shape[2],N.shape[3]):N}}),oF=K({depthwiseConv2d_:function(r){var t=r.x,e=r.filter,n=r.strides,a=r.pad,i=r.dataFormat,s=i===void 0?"NHWC":i,l=r.dilations,c=l===void 0?[1,1]:l,f=r.dimRoundingMode,d=r.bias,p=r.activation,g=p===void 0?"linear":p,v=r.preluActivationWeights;if(e0($.state.gradientDepth,g)===!1){var b=Pu(t,e,n,a,s,c,f);return d!=null&&(b=ot(b,d)),r0(b,g,v)}var w=U(t,"x","depthwiseConv2d"),S=U(e,"filter","depthwiseConv2d"),x=w,C=!1;w.rank===3&&(C=!0,x=w.as4D(1,w.shape[0],w.shape[1],w.shape[2])),P(x.rank===4,function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got rank "+x.rank+"."}),P(S.rank===4,function(){return"Error in fused depthwiseConv2d: filter must be rank 4, but got rank "+S.rank+"."}),P(x.shape[3]===S.shape[2],function(){return"Error in fused depthwiseConv2d: number of input channels ("+x.shape[3]+") must match the inChannels dimension in filter "+S.shape[2]+"."}),c==null&&(c=[1,1]),P(Qn(n,c),function(){return"Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+c+"'"}),f!=null&&P(Qt(a),function(){return"Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode "+f+" but got pad "+a+"."});var A,T,R=uo(x.shape,S.shape,n,c,a,f,!0);d!=null&&(A=Jt(A=U(d,"bias","fused conv2d"),w)[0],lt(R.outShape,A.shape)),v!=null&&(T=U(v,"prelu weights","fused depthwiseConv2d"));var O={x,$filter:S};d!=null&&(O.$bias=A),v!=null&&(O.$preluActivationWeights=T);var N=$.runKernelFunc(function(D,I){var _=D.fusedDepthwiseConv2D({input:x,filter:S,convInfo:R,bias:A,activation:g,preluActivationWeights:T});return I([x,S,_]),_},O,function(D,I){P(ns(c),function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+c+"'"});var _=I[0],F=I[1],B=I[2],V=t0(D,B,g),X={};return d!=null&&(X={$bias:function(){return n0(A,V)}}),Object.assign({x:function(){return JT(_.shape,V,F,R)},$filter:function(){return eN(_,V,F.shape,R)}},X)});return C?N.as3D(N.shape[1],N.shape[2],N.shape[3]):N}}),Au=Object.freeze({matMul:aF,conv2d:iF,depthwiseConv2d:oF}),sF=Object.freeze({image:$o,linalg:Jb,losses:xN,spectral:gN,fused:Au,signal:bN,square:ub,conv1d:jd,conv2d:ps,conv3d:Wd,depthwiseConv2d:Pu,separableConv2d:Vb,conv2dTranspose:Hd,conv3dTranspose:tN,op:K,batchNormalization2d:kT,batchNormalization3d:DT,batchNormalization4d:OT,batchNormalization:_T,batchNorm:Rb,batchNorm2d:Ib,batchNorm3d:kb,batchNorm4d:Db,booleanMaskAsync:KT,complex:Sn,real:lr,imag:Gr,concat:Gn,concat1d:Vy,concat2d:jy,concat3d:Wy,concat4d:Hy,split:ii,matMul:qd,dot:nN,outerProduct:rN,reverse:Ia,reverse1d:aN,reverse2d:iN,reverse3d:oN,reverse4d:sN,maxPool:Gd,avgPool:Xd,pool:cN,maxPool3d:$d,avgPool3d:Kd,slice:Rr,slice1d:Fc,slice2d:Yd,slice3d:Bc,slice4d:Eu,abs:to,acos:lb,acosh:cb,asin:fb,asinh:hb,atan:db,atanh:pb,ceil:mb,clipByValue:Jn,cos:gb,cosh:vb,erf:yb,exp:bb,expm1:wb,floor:_d,log:ci,log1p:xb,logSigmoid:ST,neg:hs,reciprocal:Sb,round:Eb,rsqrt:Md,sigmoid:zd,sign:Cb,isNaN:ET,isInf:CT,isFinite:AT,sin:Ab,sinh:Tb,softplus:_c,sqrt:Mc,step:TT,tan:Nb,tanh:Ld,all:Zd,any:yc,argMax:bc,argMin:jb,logSumExp:hN,max:no,mean:an,min:Qd,moments:Uc,sum:hr,prod:Jd,equal:ds,equalStrict:WT,greater:Bu,greaterEqual:Lc,greaterEqualStrict:HT,greaterStrict:qT,less:Fb,lessEqual:Bb,lessEqualStrict:GT,lessStrict:XT,notEqual:Su,notEqualStrict:$T,add:ot,addN:_b,addStrict:zT,atan2:Mb,div:Xn,divStrict:LT,floorDiv:Pd,maximum:_a,maximumStrict:FT,minimum:Fu,minimumStrict:BT,mod:zb,modStrict:UT,mul:Xe,mulStrict:Vd,pow:xu,powStrict:PT,squaredDifference:Lb,squaredDifferenceStrict:VT,sub:Dn,subStrict:jT,elu:Vu,leakyRelu:ep,prelu:tp,relu:lo,relu6:Wb,selu:np,logicalAnd:mi,logicalNot:Ob,logicalOr:Bd,logicalXor:MT,where:fi,whereAsync:Ud,buffer:$e,print:NA,batchToSpaceND:Ad,cast:Td,clone:RA,cumsum:IA,depthToSpace:Gy,expandDims:Sr,eye:Nd,multinomial:Xy,oneHot:bu,pad:so,pad1d:kA,pad2d:DA,pad3d:OA,pad4d:_A,rand:MA,randomNormal:$y,randomGamma:zA,randomUniform:cs,reshape:Ic,spaceToBatchND:Rd,squeeze:kc,stack:ia,tile:Yi,truncatedNormal:Dc,unstack:ts,setdiff1dAsync:Ky,fill:zu,linspace:Py,ones:Oa,range:Ed,scalar:Re,tensor:rn,tensor1d:fr,tensor2d:ai,tensor3d:By,tensor4d:Hi,tensor5d:AA,tensor6d:TA,variable:Uy,zeros:St,onesLike:Nr,zerosLike:ct,transpose:Ut,softmax:fs,logSoftmax:Dd,localResponseNormalization:Hb,norm:qb,gather:Uu,unsortedSegmentSum:Ub,basicLSTMCell:dN,multiRNNCell:pN,movingAverage:mN,stridedSlice:Gb,topk:Xb,scatterND:$b,fft:Pc,ifft:Cu,rfft:Vc,irfft:rp,sparseToDense:ap,gatherND:Kb,diag:vN,dropout:Yb,hannWindow:ip,hammingWindow:Zb,frame:op,stft:Qb,inTopKAsync:wN});function ge(r,t){Array.isArray(r)||(r=[r]),r.forEach(function(e){e!=null&&P(e.dtype!=="complex64",function(){return t+" does not support complex64 tensors."})})}function tv(r,t,e,n){if(e==="linear")return r.linear(t);if(e==="relu")return r.relu(t);if(e==="elu")return r.elu(t);if(e==="relu6")return r.relu6(t);if(e==="prelu")return r.prelu(t,n);throw new Error("Activation "+e+" has not been implemented for the CPU backend.")}var uF=function(r){function t(){var e=r.call(this)||this;if(e.blockSize=48,e.firstUse=!0,se().get("IS_BROWSER")){var n=typeof OffscreenCanvas<"u"?new OffscreenCanvas(300,150):typeof document<"u"?document.createElement("canvas"):null;n!==null&&(e.fromPixels2DContext=n.getContext("2d"))}return e.data=new Qy(e,$),e}return la(t,r),t.prototype.write=function(e,n,a){this.firstUse&&(this.firstUse=!1,se().get("IS_NODE")&&Uv(`
============================
Hi there 👋. Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.
============================
`));var i={};return this.data.set(i,{values:e,dtype:a}),i},t.prototype.move=function(e,n,a,i){this.data.set(e,{values:n,dtype:i})},t.prototype.numDataIds=function(){return this.data.numDataIds()},t.prototype.fromPixels=function(e,n){if(e==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var a,i,s=e.data instanceof Uint8Array,l=typeof ImageData<"u"&&e instanceof ImageData,c=typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement,f=typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement,d=c?[e.videoWidth,e.videoHeight]:[e.width,e.height],p=d[0],g=d[1];if(se().get("IS_NODE")&&e.getContext==null)throw new Error("When running in node, pixels must be an HTMLCanvasElement like the one returned by the `canvas` npm package");if(e.getContext!=null)a=e.getContext("2d").getImageData(0,0,p,g).data;else if(l||s)a=e.data;else{if(!f&&!c)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData or {data: Uint32Array, width: number, height: number}, but was "+e.constructor.name);if(this.fromPixels2DContext==null)throw new Error("Can't read pixels from HTMLImageElement outside the browser.");this.fromPixels2DContext.canvas.width=p,this.fromPixels2DContext.canvas.height=g,this.fromPixels2DContext.drawImage(e,0,0,p,g),a=this.fromPixels2DContext.getImageData(0,0,p,g).data}if(n===4)i=new Int32Array(a);else{var v=p*g;i=new Int32Array(v*n);for(var b=0;b<v;b++)for(var w=0;w<n;++w)i[b*n+w]=a[4*b+w]}return By(i,[g,p,n],"int32")},t.prototype.read=function(e){return De(this,void 0,void 0,function(){return Oe(this,function(n){return[2,this.readSync(e)]})})},t.prototype.readSync=function(e){var n=this.data.get(e),a=n.dtype,i=n.complexTensors;return a==="complex64"?jv(this.readSync(i.real.dataId),this.readSync(i.imag.dataId)):this.data.get(e).values},t.prototype.bufferSync=function(e){var n=this.readSync(e.dataId),a=n;if(e.dtype==="string")try{a=n.map(function(i){return cc(i)})}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return $e(e.shape,e.dtype,a)},t.prototype.makeOutput=function(e,n,a){var i=this.write(e,n,a);return $.makeTensorFromDataId(i,n,a,this)},t.prototype.disposeData=function(e){if(this.data.has(e)){var n=this.data.get(e).complexTensors;n!=null&&(n.real.dispose(),n.imag.dispose()),this.data.delete(e)}},t.prototype.time=function(e){return De(this,void 0,void 0,function(){var n;return Oe(this,function(a){return n=ta(),e(),[2,{kernelMs:ta()-n}]})})},t.prototype.memory=function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}},t.prototype.complex=function(e,n){var a=this.makeOutput(null,e.shape,"complex64");return this.data.get(a.dataId).complexTensors={real:$.keep(e.clone()),imag:$.keep(n.clone())},a},t.prototype.real=function(e){return this.data.get(e.dataId).complexTensors.real.clone()},t.prototype.imag=function(e){return this.data.get(e.dataId).complexTensors.imag.clone()},t.prototype.slice=function(e,n,a){if(ge(e,"slice"),Yy(e.shape,n,a)){var i=Zy(n,e.strides),s=Me(a);return rn(this.readSync(e.dataId).subarray(i,i+s),a,e.dtype)}for(var l=$e(a,e.dtype),c=this.bufferSync(e),f=0;f<l.size;++f){var d=l.indexToLoc(f).map(function(p,g){return p+n[g]});l.values[f]=c.get.apply(c,d)}return l.toTensor()},t.prototype.stridedSlice=function(e,n,a,i){ge(e,"stridedSlice");var s=Id(n,a,i);if(s.some(function(v){return v===0}))return rn([],s);for(var l=$e(s,e.dtype),c=this.bufferSync(e),f=0;f<l.size;f++){for(var d=l.indexToLoc(f),p=new Array(d.length),g=0;g<p.length;g++)p[g]=d[g]*i[g]+n[g];l.set.apply(l,[c.get.apply(c,p)].concat(d))}return l.toTensor()},t.prototype.diag=function(e){for(var n=this.readSync(e.dataId),a=$e([e.size,e.size],e.dtype),i=a.values,s=0;s<n.length;s++)i[s*e.size+s]=n[s];return a.toTensor()},t.prototype.unstack=function(e,n){for(var a=e.shape[n],i=new Array(e.rank-1),s=0,l=0;l<e.rank;l++)l!==n&&(i[s++]=e.shape[l]);var c=new Array(e.rank).fill(0),f=e.shape.slice();f[n]=1;var d=new Array(a);for(l=0;l<d.length;l++)c[n]=l,d[l]=this.slice(e,c,f).reshape(i);return d},t.prototype.reverse=function(e,n){ge(e,"reverse");for(var a=$e(e.shape,e.dtype),i=this.bufferSync(e),s=function(c){var f=a.indexToLoc(c),d=f.slice();n.forEach(function(p){return d[p]=e.shape[p]-1-d[p]}),a.set.apply(a,[i.get.apply(i,d)].concat(f))},l=0;l<a.size;l++)s(l);return a.toTensor()},t.prototype.concat=function(e,n){var a=this;if(e[0].dtype==="complex64"){var i=e.map(function(v){return lr(v)}),s=e.map(function(v){return Gr(v)});return Sn(this.concat(i,n),this.concat(s,n))}var l=e.map(function(v){var b=Me(v.shape.slice(n));return v.as2D(-1,b)}),c=es(l.map(function(v){return v.shape}),1),f=$e(c,e[0].dtype).values;if(l[0].shape[0]===1){var d=0;l.forEach(function(v){f.set(a.readSync(v.dataId),d),d+=v.size})}else{var p=0;l.forEach(function(v){for(var b=a.readSync(v.dataId),w=0,S=0;S<v.shape[0];++S)for(var x=S*c[1]+p,C=0;C<v.shape[1];++C)f[x+C]=b[w++];p+=v.shape[1]})}var g=es(e.map(function(v){return v.shape}),n);return rn(f,g,e[0].dtype)},t.prototype.neg=function(e){return ge(e,"neg"),this.multiply(Re(-1),e)},t.prototype.add=function(e,n){return e.dtype==="complex64"||n.dtype==="complex64"?this.broadcastedBinaryComplexOp(e.cast("complex64"),n.cast("complex64"),function(a,i,s,l){return{real:a+s,imag:i+l}}):this.broadcastedBinaryOp(e,n,cn(e.dtype,n.dtype),function(a,i){return a+i})},t.prototype.addN=function(e){var n=this;ge(e,"addN");for(var a=e.map(function(d){return n.readSync(d.dataId)}),i=$e(e[0].shape,e[0].dtype),s=i.values,l=0;l<e.length;l++)for(var c=a[l],f=0;f<s.length;f++)s[f]+=c[f];return i.toTensor()},t.prototype.subtract=function(e,n){return e.dtype==="complex64"||n.dtype==="complex64"?this.broadcastedBinaryComplexOp(e.cast("complex64"),n.cast("complex64"),function(a,i,s,l){return{real:a-s,imag:i-l}}):this.broadcastedBinaryOp(e,n,cn(e.dtype,n.dtype),function(a,i){return a-i})},t.prototype.pow=function(e,n){return ge([e,n],"pow"),this.broadcastedBinaryOp(e,n,e.dtype,function(a,i){return Math.pow(a,i)})},t.prototype.batchMatMul=function(e,n,a,i){ge([e,n],"matMul");for(var s=a?e.shape[1]:e.shape[2],l=a?e.shape[2]:e.shape[1],c=i?n.shape[1]:n.shape[2],f=e.shape[0],d=this.readSync(e.dataId),p=this.readSync(n.dataId),g=a?[e.strides[0],1,e.strides[1]]:[e.strides[0],e.strides[1],1],v=g[0],b=g[1],w=g[2],S=i?[1,n.strides[1],n.strides[0]]:[n.strides[1],1,n.strides[0]],x=S[0],C=S[1],A=S[2],T=l*c,R=$e([f,l,c],e.dtype),O=R.values,N=this.blockSize,D=0;D<f;D++)for(var I=0;I<l;I+=N)for(var _=0;_<c;_+=N)for(var F=0;F<s;F+=N)for(var B=Math.min(I+N,l),V=Math.min(_+N,c),X=Math.min(F+N,s),Y=I;Y<B;Y++)for(var j=_;j<V;j++){for(var G=0,q=F;q<X;q++)G+=d[D*v+Y*b+q*w]*p[q*x+j*C+D*A];O[D*T+(Y*c+j)]+=G}return R.toTensor()},t.prototype.fusedBatchMatMul=function(e){var n=e.a,a=e.b,i=e.transposeA,s=e.transposeB,l=e.bias,c=e.activation,f=e.preluActivationWeights,d=this.batchMatMul(n,a,i,s);return l&&(d=this.add(d,l)),c&&(d=tv(this,d,c,f)),d},t.prototype.multiply=function(e,n){return e.dtype==="complex64"||n.dtype==="complex64"?this.broadcastedBinaryComplexOp(e.cast("complex64"),n.cast("complex64"),function(a,i,s,l){return{real:a*s-i*l,imag:a*l+i*s}}):this.broadcastedBinaryOp(e,n,cn(e.dtype,n.dtype),function(a,i){return a*i})},t.prototype.realDivide=function(e,n){return ge([e,n],"realDivide"),this.broadcastedBinaryOp(e,n,"float32",function(a,i){return a/i})},t.prototype.floorDiv=function(e,n){return ge([e,n],"floorDiv"),this.broadcastedBinaryOp(e,n,"int32",function(a,i){return Math.floor(a/i)})},t.prototype.sum=function(e,n){ge(e,"sum"),ur("sum",n,e.rank);for(var a=Ln(e.shape,n),i=a[0],s=a[1],l=St(i,cn(e.dtype,"int32")),c=Me(s),f=this.readSync(l.dataId),d=this.readSync(e.dataId),p=0;p<f.length;++p){for(var g=p*c,v=0,b=0;b<c;++b)v+=d[g+b];f[p]=v}return l},t.prototype.prod=function(e,n){ge(e,"sum");for(var a=Ln(e.shape,n),i=a[0],s=a[1],l=St(i,cn(e.dtype,"int32")),c=Me(s),f=this.readSync(l.dataId),d=this.readSync(e.dataId),p=0;p<f.length;++p){for(var g=p*c,v=1,b=0;b<c;++b)v*=d[g+b];f[p]=v}return l},t.prototype.unsortedSegmentSum=function(e,n,a){ge(e,"unsortedSegmentSum");for(var i=[],s=e.rank-n.rank,l=0;l<s;++l)n=n.expandDims(l+1);for(l=0;l<a;++l){var c=Re(l,"int32"),f=ds(c,n).asType("float32").mul(e).sum(0);i.push(f)}return ia(i)},t.prototype.argMin=function(e,n){ge(e,"argMin");var a=[n];ur("argMin",a,e.rank);for(var i=Ln(e.shape,a),s=i[0],l=i[1],c=St(s,"int32"),f=Me(l),d=this.readSync(c.dataId),p=this.readSync(e.dataId),g=0;g<d.length;++g){for(var v=g*f,b=p[v],w=0,S=0;S<f;++S){var x=p[v+S];x<b&&(b=x,w=S)}d[g]=w}return c},t.prototype.argMax=function(e,n){ge(e,"argMax");var a=[n];ur("argMax",a,e.rank);for(var i=Ln(e.shape,a),s=i[0],l=i[1],c=St(s,"int32"),f=Me(l),d=this.readSync(c.dataId),p=this.readSync(e.dataId),g=0;g<d.length;++g){for(var v=g*f,b=p[v],w=0,S=0;S<f;++S){var x=p[v+S];x>b&&(b=x,w=S)}d[g]=w}return c},t.prototype.cumsum=function(e,n,a,i){if(ge(e,"cumsum"),n!==e.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+(e.rank-1)+" but got axis="+n);for(var s=cn(e.dtype,"int32"),l=St(e.shape,s),c=this.readSync(l.dataId),f=this.readSync(e.dataId),d=e.shape[e.rank-1],p=i?function(S,x){return S+d-x-1}:function(S,x){return S+x},g=0;g<f.length;g+=d)for(var v=0;v<d;v++){var b=p(g,v);if(v===0)c[b]=a?0:f[b];else{var w=p(g,v-1);c[b]=a?f[w]+c[w]:f[b]+c[w]}}return l},t.prototype.equal=function(e,n){return ge([e,n],"equal"),this.broadcastedBinaryOp(e,n,"bool",function(a,i){return a===i?1:0})},t.prototype.notEqual=function(e,n){return ge([e,n],"notEqual"),this.broadcastedBinaryOp(e,n,"bool",function(a,i){return a!==i?1:0})},t.prototype.less=function(e,n){return ge([e,n],"less"),this.broadcastedBinaryOp(e,n,"bool",function(a,i){return a<i?1:0})},t.prototype.lessEqual=function(e,n){return ge([e,n],"lessEqual"),this.broadcastedBinaryOp(e,n,"bool",function(a,i){return a<=i?1:0})},t.prototype.greater=function(e,n){return ge([e,n],"greater"),this.broadcastedBinaryOp(e,n,"bool",function(a,i){return a>i?1:0})},t.prototype.greaterEqual=function(e,n){return ge([e,n],"greaterEqual"),this.broadcastedBinaryOp(e,n,"bool",function(a,i){return a>=i?1:0})},t.prototype.logicalNot=function(e){ge(e,"logicalNot");for(var n=this.readSync(e.dataId),a=new Uint8Array(n.length),i=0;i<n.length;++i)a[i]=n[i]?0:1;return this.makeOutput(a,e.shape,"bool")},t.prototype.logicalAnd=function(e,n){return ge([e,n],"logicalAnd"),this.broadcastedBinaryOp(e,n,"bool",function(a,i){return a&&i})},t.prototype.logicalOr=function(e,n){return ge([e,n],"logicalOr"),this.broadcastedBinaryOp(e,n,"bool",function(a,i){return a||i})},t.prototype.select=function(e,n,a){ge([e,n,a],"select");for(var i=this.readSync(e.dataId),s=this.readSync(n.dataId),l=this.readSync(a.dataId),c=St(n.shape,cn(n.dtype,a.dtype)),f=this.readSync(c.dataId),d=0,p=e.rank===0||e.rank>1||n.rank===1?1:Me(n.shape.slice(1)),g=0;g<i.length;g++)for(var v=0;v<p;v++)i[g]===1?f[d++]=s[g]:f[d++]=l[g];return c},t.prototype.where=function(e){ge([e],"where");var n=this.readSync(e.dataId);return ab(e.shape,n)},t.prototype.topk=function(e,n,a){return ge(e,"topk"),GA(this.readSync(e.dataId),e.shape,e.dtype,n)},t.prototype.min=function(e,n){ge(e,"min"),ur("min",n,e.rank);for(var a=Ln(e.shape,n),i=a[0],s=a[1],l=St(i,e.dtype),c=Me(s),f=this.readSync(l.dataId),d=this.readSync(e.dataId),p=0;p<f.length;++p){for(var g=p*c,v=d[g],b=0;b<c;++b){var w=d[g+b];w<v&&(v=w)}f[p]=v}return l},t.prototype.minimum=function(e,n){return ge([e,n],"minimum"),this.broadcastedBinaryOp(e,n,e.dtype,function(a,i){return Math.min(a,i)})},t.prototype.mod=function(e,n){return ge([e,n],"mod"),this.broadcastedBinaryOp(e,n,e.dtype,function(a,i){var s=a%i;return a<0&&i<0||a>=0&&i>=0?s:(s+i)%i})},t.prototype.max=function(e,n){ge(e,"max"),ur("max",n,e.rank);for(var a=Ln(e.shape,n),i=a[0],s=a[1],l=St(i,e.dtype),c=Me(s),f=this.readSync(l.dataId),d=this.readSync(e.dataId),p=0;p<f.length;++p){for(var g=p*c,v=d[g],b=0;b<c;++b){var w=d[g+b];w>v&&(v=w)}f[p]=v}return l},t.prototype.maximum=function(e,n){return ge([e,n],"maximum"),this.broadcastedBinaryOp(e,n,e.dtype,function(a,i){return Math.max(a,i)})},t.prototype.all=function(e,n){ge(e,"all"),ur("all",n,e.rank);for(var a=Ln(e.shape,n),i=a[0],s=a[1],l=St(i,e.dtype),c=Me(s),f=this.readSync(l.dataId),d=this.readSync(e.dataId),p=0;p<f.length;++p){for(var g=p*c,v=d[g],b=0;b<c;++b){var w=d[g+b];v=v&&w}f[p]=v}return l},t.prototype.any=function(e,n){ge(e,"any"),ur("any",n,e.rank);for(var a=Ln(e.shape,n),i=a[0],s=a[1],l=St(i,e.dtype),c=Me(s),f=this.readSync(l.dataId),d=this.readSync(e.dataId),p=0;p<f.length;++p){for(var g=p*c,v=d[g],b=0;b<c;++b){var w=d[g+b];v=v||w}f[p]=v}return l},t.prototype.squaredDifference=function(e,n){return ge([e,n],"squaredDifference"),this.broadcastedBinaryOp(e,n,e.dtype,function(a,i){var s=a-i;return s*s})},t.prototype.ceil=function(e){ge(e,"ceil");for(var n=this.readSync(e.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i)a[i]=Math.ceil(n[i]);return this.makeOutput(a,e.shape,"float32")},t.prototype.floor=function(e){ge(e,"floor");for(var n=this.readSync(e.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i)a[i]=Math.floor(n[i]);return this.makeOutput(a,e.shape,"float32")},t.prototype.sign=function(e){ge(e,"x");for(var n=this.readSync(e.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i)n[i]<0?a[i]=-1:n[i]>0?a[i]=1:a[i]=0;return this.makeOutput(a,e.shape,"float32")},t.prototype.isNaN=function(e){ge(e,"x");for(var n=this.readSync(e.dataId),a=new Uint8Array(n.length),i=0;i<n.length;++i)Number.isNaN(n[i])&&(a[i]=1);return this.makeOutput(a,e.shape,"bool")},t.prototype.isInf=function(e){ge(e,"x");for(var n=this.readSync(e.dataId),a=new Uint8Array(n.length),i=0;i<n.length;++i)Math.abs(n[i])===1/0&&(a[i]=1);return this.makeOutput(a,e.shape,"bool")},t.prototype.isFinite=function(e){ge(e,"x");for(var n=this.readSync(e.dataId),a=new Uint8Array(n.length),i=0;i<n.length;++i)Number.isFinite(n[i])&&(a[i]=1);return this.makeOutput(a,e.shape,"bool")},t.prototype.round=function(e){ge(e,"round");for(var n=this.readSync(e.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i){var s=Math.floor(n[i]);n[i]-s<.5?a[i]=Math.floor(n[i]):n[i]-s>.5?a[i]=Math.ceil(n[i]):a[i]=s%2==0?s:s+1}return this.makeOutput(a,e.shape,"float32")},t.prototype.exp=function(e){ge(e,"exp");for(var n=this.readSync(e.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i)a[i]=Math.exp(n[i]);return this.makeOutput(a,e.shape,"float32")},t.prototype.expm1=function(e){ge(e,"expm1");for(var n=this.readSync(e.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i)a[i]=Math.expm1(n[i]);return this.makeOutput(a,e.shape,"float32")},t.prototype.log=function(e){ge(e,"log");for(var n=this.readSync(e.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i){var s=n[i];a[i]=Math.log(s)}return this.makeOutput(a,e.shape,"float32")},t.prototype.log1p=function(e){ge(e,"log1p");for(var n=this.readSync(e.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i){var s=n[i];a[i]=Math.log1p(s)}return this.makeOutput(a,e.shape,"float32")},t.prototype.sqrt=function(e){ge(e,"sqrt");for(var n=this.readSync(e.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i){var s=n[i];a[i]=Math.sqrt(s)}return this.makeOutput(a,e.shape,"float32")},t.prototype.rsqrt=function(e){ge(e,"rsqrt");for(var n=this.readSync(e.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i){var s=n[i];a[i]=1/Math.sqrt(s)}return this.makeOutput(a,e.shape,"float32")},t.prototype.reciprocal=function(e){ge(e,"reciprocal");for(var n=this.readSync(e.dataId),a=new Float32Array(n.length),i=0;i<n.length;++i)a[i]=1/n[i];return this.makeOutput(a,e.shape,"float32")},t.prototype.linear=function(e){return e},t.prototype.relu=function(e){ge(e,"relu");for(var n=St(e.shape,e.dtype),a=this.readSync(n.dataId),i=this.readSync(e.dataId),s=0;s<i.length;++s)a[s]=Math.max(0,i[s]);return n},t.prototype.relu6=function(e){ge(e,"relu");for(var n=St(e.shape,e.dtype),a=this.readSync(n.dataId),i=this.readSync(e.dataId),s=0;s<i.length;++s)a[s]=Math.min(Math.max(0,i[s]),6);return n},t.prototype.prelu=function(e,n){return ge([e,n],"prelu"),this.broadcastedBinaryOp(e,n,e.dtype,function(a,i){return a<0?i*a:a})},t.prototype.elu=function(e){ge(e,"elu");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i){var s=a[i];n[i]=s>=0?s:Math.exp(s)-1}return this.makeOutput(n,e.shape,"float32")},t.prototype.eluDer=function(e,n){ge([e,n],"eluDer");for(var a=new Float32Array(n.size),i=this.readSync(n.dataId),s=this.readSync(e.dataId),l=0;l<i.length;++l){var c=i[l];a[l]=c>=1?s[l]:s[l]*(c+1)}return this.makeOutput(a,n.shape,"float32")},t.prototype.selu=function(e){ge(e,"selu");for(var n=ob,a=sb,i=new Float32Array(e.size),s=this.readSync(e.dataId),l=0;l<s.length;++l){var c=s[l];i[l]=c>=0?a*c:n*(Math.exp(c)-1)}return this.makeOutput(i,e.shape,"float32")},t.prototype.clip=function(e,n,a){ge(e,"clip");for(var i=new Float32Array(e.size),s=this.readSync(e.dataId),l=0;l<s.length;++l){var c=s[l];i[l]=c>a?a:c<n?n:c}return this.makeOutput(i,e.shape,"float32")},t.prototype.abs=function(e){for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)n[i]=Math.abs(a[i]);return this.makeOutput(n,e.shape,"float32")},t.prototype.complexAbs=function(e){for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<e.size;++i){var s=a[2*i],l=a[2*i+1];n[i]=Math.hypot(s,l)}return this.makeOutput(n,e.shape,"float32")},t.prototype.int=function(e){ge(e,"int");for(var n=new Int32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)n[i]=a[i];return this.makeOutput(n,e.shape,"int32")},t.prototype.sigmoid=function(e){ge(e,"sigmoid");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)n[i]=1/(1+Math.exp(-a[i]));return this.makeOutput(n,e.shape,"float32")},t.prototype.softplus=function(e){ge(e,"softplus");for(var n=Math.log(11920928955078125e-23)+2,a=new Float32Array(e.size),i=this.readSync(e.dataId),s=0;s<i.length;++s){var l=i[s]>-n,c=i[s]<n,f=Math.exp(i[s]),d=void 0;d=c?f:l?i[s]:Math.log(1+f),a[s]=d}return this.makeOutput(a,e.shape,"float32")},t.prototype.sin=function(e){ge(e,"sin");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)n[i]=Math.sin(a[i]);return this.makeOutput(n,e.shape,"float32")},t.prototype.cos=function(e){ge(e,"cos");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)n[i]=Math.cos(a[i]);return this.makeOutput(n,e.shape,"float32")},t.prototype.tan=function(e){ge(e,"tan");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)n[i]=Math.tan(a[i]);return this.makeOutput(n,e.shape,"float32")},t.prototype.asin=function(e){ge(e,"asin");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)n[i]=Math.asin(a[i]);return this.makeOutput(n,e.shape,"float32")},t.prototype.acos=function(e){ge(e,"acos");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)n[i]=Math.acos(a[i]);return this.makeOutput(n,e.shape,"float32")},t.prototype.atan=function(e){ge(e,"atan");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)n[i]=Math.atan(a[i]);return this.makeOutput(n,e.shape,"float32")},t.prototype.atan2=function(e,n){return ge([e,n],"atan2"),this.broadcastedBinaryOp(e,n,e.dtype,function(a,i){return Math.atan2(a,i)})},t.prototype.sinh=function(e){ge(e,"sinh");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)n[i]=Math.sinh(a[i]);return this.makeOutput(n,e.shape,"float32")},t.prototype.cosh=function(e){ge(e,"cosh");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)n[i]=Math.cosh(a[i]);return this.makeOutput(n,e.shape,"float32")},t.prototype.tanh=function(e){ge(e,"tanh");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)n[i]=FC(a[i]);return this.makeOutput(n,e.shape,"float32")},t.prototype.asinh=function(e){ge(e,"asinh");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)n[i]=Math.asinh(a[i]);return this.makeOutput(n,e.shape,"float32")},t.prototype.acosh=function(e){ge(e,"acosh");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)n[i]=Math.acosh(a[i]);return this.makeOutput(n,e.shape,"float32")},t.prototype.atanh=function(e){ge(e,"atanh");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i)n[i]=Math.atanh(a[i]);return this.makeOutput(n,e.shape,"float32")},t.prototype.erf=function(e){ge(e,"erf");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i){var s=Math.sign(a[i]),l=Math.abs(a[i]),c=1/(1+.3275911*l);n[i]=s*(1-((((1.061405429*c-1.453152027)*c+1.421413741)*c-.284496736)*c+.254829592)*c*Math.exp(-l*l))}return this.makeOutput(n,e.shape,"float32")},t.prototype.step=function(e,n){n===void 0&&(n=0),ge(e,"step");for(var a=new Float32Array(e.size),i=this.readSync(e.dataId),s=0;s<i.length;++s){var l=i[s];isNaN(l)?a[s]=NaN:a[s]=l>0?1:n}return this.makeOutput(a,e.shape,"float32")},t.prototype.fusedConv2d=function(e){var n=e.input,a=e.filter,i=e.convInfo,s=e.bias,l=e.activation,c=e.preluActivationWeights,f=this.conv2d(n,a,i);return s&&(f=this.add(f,s)),l&&(f=tv(this,f,l,c)),f},t.prototype.conv2d=function(e,n,a){ge([e,n],"conv2d");for(var i=a.filterHeight,s=a.filterWidth,l=a.dilationHeight,c=a.dilationWidth,f=a.padInfo.left,d=a.padInfo.top,p=a.dataFormat==="channelsLast",g=$e(a.outShape,e.dtype),v=e.strides[0],b=p?e.strides[1]:e.strides[2],w=p?e.strides[2]:1,S=p?1:e.strides[1],x=g.strides[0],C=p?g.strides[1]:g.strides[2],A=p?g.strides[2]:1,T=p?1:g.strides[1],R=this.readSync(e.dataId),O=this.readSync(n.dataId),N=g.values,D=0;D<a.batchSize;++D)for(var I=D*v,_=D*x,F=0;F<a.outHeight;++F)for(var B=_+F*C,V=F*a.strideHeight-d,X=0;X<i;X++){var Y=V+X*l;if(!(Y<0||Y>=a.inHeight))for(var j=X*n.strides[0],G=I+Y*b,q=0;q<a.outWidth;++q)for(var ne=B+q*A,L=q*a.strideWidth-f,Z=0;Z<s;Z++){var ce=L+Z*c;if(!(ce<0||ce>=a.inWidth))for(var le=G+ce*w,de=j+Z*n.strides[1],xe=0;xe<a.inChannels;++xe){for(var we=R[le+xe*S],_e=0;_e<a.outChannels;++_e)N[ne+_e*T]+=we*O[de+_e];de+=a.outChannels}}}return g.toTensor()},t.prototype.conv3d=function(e,n,a){for(var i=a.filterDepth,s=a.filterHeight,l=a.filterWidth,c=a.dilationDepth,f=a.dilationHeight,d=a.dilationWidth,p=a.padInfo.front,g=a.padInfo.left,v=a.padInfo.top,b=$e(a.outShape,e.dtype),w=this.readSync(e.dataId),S=this.readSync(n.dataId),x=b.values,C=0;C<a.batchSize;++C)for(var A=C*e.strides[0],T=C*b.strides[0],R=0;R<a.outDepth;++R)for(var O=T+R*b.strides[1],N=R*a.strideDepth-p,D=0;D<i;D++){var I=N+D*c;if(!(I<0||I>=a.inDepth))for(var _=D*n.strides[0],F=A+I*e.strides[1],B=0;B<a.outHeight;++B)for(var V=O+B*b.strides[2],X=B*a.strideHeight-v,Y=0;Y<s;Y++){var j=X+Y*f;if(!(j<0||j>=a.inHeight))for(var G=_+Y*n.strides[1],q=F+j*e.strides[2],ne=0;ne<a.outWidth;++ne)for(var L=V+ne*a.outChannels,Z=ne*a.strideWidth-g,ce=0;ce<l;ce++){var le=Z+ce*d;if(!(le<0||le>=a.inWidth))for(var de=G+ce*n.strides[2],xe=q+le*a.inChannels,we=de,_e=0;_e<a.inChannels;++_e){for(var Ee=w[xe+_e],ke=0;ke<a.outChannels;++ke)x[L+ke]+=Ee*S[we+ke];we+=a.outChannels}}}}return b.toTensor()},t.prototype.conv2dDerInput=function(e,n,a){ge([e,n],"conv2dDerInput");for(var i=$e(a.inShape,"float32"),s=i.values,l=this.readSync(e.dataId),c=this.readSync(n.dataId),f=n.strides,d=f[0],p=f[1],g=f[2],v=a.batchSize,b=a.filterHeight,w=a.filterWidth,S=a.inChannels,x=a.inHeight,C=a.inWidth,A=a.outChannels,T=a.outHeight,R=a.outWidth,O=a.strideHeight,N=a.strideWidth,D=a.dataFormat,I=b-1-a.padInfo.top,_=w-1-a.padInfo.left,F=D==="channelsLast",B=i.strides[0],V=F?i.strides[1]:i.strides[2],X=F?i.strides[2]:1,Y=F?1:i.strides[1],j=e.strides[0],G=F?e.strides[1]:e.strides[2],q=F?e.strides[2]:1,ne=F?1:e.strides[1],L=0;L<v;++L)for(var Z=0;Z<S;++Z)for(var ce=0;ce<x;++ce)for(var le=ce-I,de=Math.max(0,Math.ceil(le/O)),xe=Math.min(T,(b+le)/O),we=0;we<C;++we){for(var _e=we-_,Ee=Math.max(0,Math.ceil(_e/N)),ke=Math.min(R,(w+_e)/N),Ue=0,Fe=de;Fe<xe;++Fe)for(var rt=Fe*O-le,qe=Ee;qe<ke;++qe)for(var Se=j*L+G*Fe+q*qe,dt=d*(b-1-rt)+p*(w-1-(qe*N-_e))+g*Z,Je=0;Je<A;++Je)Ue+=l[Se+ne*Je]*c[dt+Je];s[B*L+V*ce+X*we+Y*Z]=Ue}return i.toTensor()},t.prototype.conv3dDerInput=function(e,n,a){for(var i=$e(a.inShape,"float32"),s=i.values,l=i.strides,c=l[0],f=l[1],d=l[2],p=l[3],g=this.readSync(e.dataId),v=e.strides,b=v[0],w=v[1],S=v[2],x=v[3],C=this.readSync(n.dataId),A=n.strides,T=A[0],R=A[1],O=A[2],N=A[3],D=a.batchSize,I=a.filterDepth,_=a.filterHeight,F=a.filterWidth,B=a.inChannels,V=a.inDepth,X=a.inHeight,Y=a.inWidth,j=a.outChannels,G=a.outDepth,q=a.outHeight,ne=a.outWidth,L=a.strideDepth,Z=a.strideHeight,ce=a.strideWidth,le=I-1-a.padInfo.front,de=_-1-a.padInfo.top,xe=F-1-a.padInfo.left,we=0;we<D;++we)for(var _e=0;_e<B;++_e)for(var Ee=0;Ee<V;++Ee)for(var ke=Ee-le,Ue=Math.max(0,Math.ceil(ke/L)),Fe=Math.min(G,(I+ke)/L),rt=0;rt<X;++rt)for(var qe=rt-de,Se=Math.max(0,Math.ceil(qe/Z)),dt=Math.min(q,(_+qe)/Z),Je=0;Je<Y;++Je){for(var Pt=Je-xe,Cn=Math.max(0,Math.ceil(Pt/ce)),en=Math.min(ne,(F+Pt)/ce),Ft=0,Vt=Ue;Vt<Fe;++Vt)for(var Un=Vt*L-ke,Ge=Se;Ge<dt;++Ge)for(var kt=Ge*Z-qe,Bt=Cn;Bt<en;++Bt)for(var Gt=b*we+w*Vt+S*Ge+x*Bt,Pn=T*(I-1-Un)+R*(_-1-kt)+O*(F-1-(Bt*ce-Pt))+N*_e,mn=0;mn<j;++mn)Ft+=g[Gt+mn]*C[Pn+mn];s[c*we+f*Ee+d*rt+p*Je+_e]=Ft}return i.toTensor()},t.prototype.conv2dDerFilter=function(e,n,a){ge([e,n],"conv2dDerFilter");for(var i=a.strideHeight,s=a.strideWidth,l=a.filterHeight,c=a.filterWidth,f=a.dataFormat==="channelsLast",d=$e(a.filterShape,"float32"),p=a.padInfo.left,g=a.padInfo.top,v=this.bufferSync(e),b=this.bufferSync(n),w=0;w<l;++w)for(var S=Math.max(0,Math.ceil((g-w)/i)),x=Math.min(a.outHeight,(a.inHeight+g-w)/i),C=0;C<c;++C)for(var A=Math.max(0,Math.ceil((p-C)/s)),T=Math.min(a.outWidth,(a.inWidth+p-C)/s),R=0;R<a.inChannels;++R)for(var O=0;O<a.outChannels;++O){for(var N=0,D=0;D<a.batchSize;++D)for(var I=S;I<x;++I)for(var _=w+I*i-g,F=A;F<T;++F){var B=C+F*s-p;N+=f?v.get(D,_,B,R)*b.get(D,I,F,O):v.get(D,R,_,B)*b.get(D,O,I,F)}d.set(N,w,C,R,O)}return d.toTensor()},t.prototype.conv3dDerFilter=function(e,n,a){for(var i=a.strideDepth,s=a.strideHeight,l=a.strideWidth,c=a.filterDepth,f=a.filterHeight,d=a.filterWidth,p=$e(a.filterShape,"float32"),g=p.values,v=p.strides,b=v[0],w=v[1],S=v[2],x=v[3],C=this.readSync(n.dataId),A=n.strides,T=A[0],R=A[1],O=A[2],N=A[3],D=this.readSync(e.dataId),I=e.strides,_=I[0],F=I[1],B=I[2],V=I[3],X=a.padInfo.front,Y=a.padInfo.left,j=a.padInfo.top,G=0;G<c;++G)for(var q=Math.max(0,Math.ceil((X-G)/i)),ne=Math.min(a.outDepth,(a.inDepth+X-G)/i),L=G*b,Z=0;Z<f;++Z)for(var ce=Math.max(0,Math.ceil((j-Z)/s)),le=Math.min(a.outHeight,(a.inHeight+j-Z)/s),de=Z*w+L,xe=0;xe<d;++xe)for(var we=Math.max(0,Math.ceil((Y-xe)/l)),_e=Math.min(a.outWidth,(a.inWidth+Y-xe)/l),Ee=xe*S+de,ke=0;ke<a.inChannels;++ke)for(var Ue=ke*x+Ee,Fe=0;Fe<a.outChannels;++Fe){for(var rt=0,qe=0;qe<a.batchSize;++qe)for(var Se=qe*_,dt=qe*T,Je=q;Je<ne;++Je)for(var Pt=(G+Je*i-X)*F+Se,Cn=Je*R+dt,en=ce;en<le;++en)for(var Ft=(Z+en*s-j)*B+Pt,Vt=en*O+Cn,Un=we;Un<_e;++Un){var Ge=Un*N+Vt;rt+=D[(xe+Un*l-Y)*V+Ft+ke]*C[Ge+Fe]}g[Ue+Fe]=rt}return p.toTensor()},t.prototype.fusedDepthwiseConv2D=function(e){var n=e.input,a=e.filter,i=e.convInfo,s=e.bias,l=e.activation,c=e.preluActivationWeights,f=this.depthwiseConv2D(n,a,i);return s&&(f=this.add(f,s)),l&&(f=tv(this,f,l,c)),f},t.prototype.depthwiseConv2D=function(e,n,a){ge([e,n],"depthwiseConv2D");for(var i=a.filterHeight,s=a.filterWidth,l=a.dilationHeight,c=a.dilationWidth,f=a.padInfo.left,d=a.padInfo.top,p=a.outChannels/a.inChannels,g=$e(a.outShape,e.dtype),v=this.readSync(e.dataId),b=this.readSync(n.dataId),w=g.values,S=0;S<a.batchSize;++S)for(var x=S*e.strides[0],C=S*g.strides[0],A=0;A<a.outHeight;++A)for(var T=C+A*g.strides[1],R=A*a.strideHeight-f,O=0;O<i;++O){var N=R+O*l;if(!(N<0||N>=a.inHeight))for(var D=O*n.strides[0],I=x+N*e.strides[1],_=0;_<a.outWidth;++_)for(var F=T+_*g.strides[2],B=_*a.strideWidth-d,V=0;V<s;++V){var X=B+V*c;if(!(X<0||X>=a.inWidth))for(var Y=D+V*n.strides[1],j=I+X*a.inChannels,G=F,q=Y,ne=0;ne<a.inChannels;++ne){for(var L=v[j+ne],Z=0;Z<p;++Z)w[G+Z]+=L*b[q+Z];G+=p,q+=p}}}return g.toTensor()},t.prototype.depthwiseConv2DDerInput=function(e,n,a){ge([e,n],"depthwiseConv2DDerInput");for(var i=$e(a.inShape,"float32"),s=i.values,l=i.strides,c=l[0],f=l[1],d=l[2],p=this.readSync(e.dataId),g=e.strides,v=g[0],b=g[1],w=g[2],S=this.readSync(n.dataId),x=n.strides,C=x[0],A=x[1],T=x[2],R=a.batchSize,O=a.filterHeight,N=a.filterWidth,D=a.inChannels,I=a.inHeight,_=a.inWidth,F=a.outChannels,B=a.outHeight,V=a.outWidth,X=a.strideHeight,Y=a.strideWidth,j=O-1-a.padInfo.top,G=N-1-a.padInfo.left,q=F/D,ne=0;ne<R;++ne)for(var L=0;L<D;++L)for(var Z=0;Z<I;++Z)for(var ce=Z-j,le=Math.max(0,Math.ceil(ce/X)),de=Math.min(B,(O+ce)/X),xe=0;xe<_;++xe){for(var we=xe-G,_e=Math.max(0,Math.ceil(we/Y)),Ee=Math.min(V,(N+we)/Y),ke=0,Ue=le;Ue<de;++Ue)for(var Fe=Ue*X-ce,rt=_e;rt<Ee;++rt)for(var qe=v*ne+b*Ue+w*rt,Se=C*(O-1-Fe)+A*(N-1-(rt*Y-we))+T*L,dt=0;dt<q;++dt)ke+=p[qe+(L*q+dt)]*S[Se+dt];s[c*ne+f*Z+d*xe+L]=ke}return i.toTensor()},t.prototype.depthwiseConv2DDerFilter=function(e,n,a){ge([e,n],"depthwiseConv2DDerFilter");for(var i=a.strideHeight,s=a.strideWidth,l=a.filterHeight,c=a.filterWidth,f=$e(a.filterShape,"float32"),d=a.padInfo.left,p=a.padInfo.top,g=a.outChannels/a.inChannels,v=this.bufferSync(e),b=this.bufferSync(n),w=0;w<l;++w)for(var S=Math.max(0,Math.ceil((p-w)/i)),x=Math.min(a.outHeight,(a.inHeight+p-w)/i),C=0;C<c;++C)for(var A=Math.max(0,Math.ceil((d-C)/s)),T=Math.min(a.outWidth,(a.inWidth+d-C)/s),R=0;R<a.outChannels;++R){for(var O=Math.trunc(R/g),N=R%g,D=0,I=0;I<a.batchSize;++I)for(var _=S;_<x;++_)for(var F=w+_*i-p,B=A;B<T;++B){var V=C+B*s-d;D+=v.get(I,F,V,O)*b.get(I,_,B,R)}f.set(D,w,C,O,N)}return f.toTensor()},t.prototype.tile=function(e,n){return ge(e,"tile"),qA(this.bufferSync(e),n)},t.prototype.pad=function(e,n,a){ge(e,"pad");var i=n.map(function(g,v){return g[0]+e.shape[v]+g[1]}),s=n.map(function(g){return g[0]}),l=this.bufferSync(e),c=$e(i,e.dtype);a!==0&&c.values.fill(a);for(var f=0;f<e.size;f++){var d=l.indexToLoc(f),p=d.map(function(g,v){return g+s[v]});c.set.apply(c,[l.get.apply(l,d)].concat(p))}return c.toTensor()},t.prototype.transpose=function(e,n){ge(e,"transpose");for(var a=new Array(e.rank),i=0;i<a.length;i++)a[i]=e.shape[n[i]];var s=this.readSync(e.dataId),l=$e(a,e.dtype),c=this.bufferSync(e);for(i=0;i<e.size;++i){for(var f=c.indexToLoc(i),d=new Array(f.length),p=0;p<d.length;p++)d[p]=f[n[p]];var g=l.locToIndex(d);l.values[g]=s[i]}return l.toTensor()},t.prototype.gather=function(e,n,a){ge([e,n],"gather");var i=e.shape.slice(),s=this.readSync(n.dataId);i[a]=s.length;for(var l=$e(i,e.dtype),c=this.bufferSync(e),f=0;f<l.size;++f){var d=l.indexToLoc(f),p=d.slice();p[a]=s[d[a]];var g=c.locToIndex(p);l.values[f]=c.values[g]}return l.toTensor()},t.prototype.batchToSpaceND=function(e,n,a){ge([e],"batchToSpaceND");var i=n.reduce(function(p,g){return p*g}),s=ed(e.shape,n,i),l=td(s.length,n.length),c=nd(e.shape,n,i),f=LA(a,n.length),d=FA(c,a,n.length);return e.reshape(s).transpose(l).reshape(c).slice(f,d)},t.prototype.spaceToBatchND=function(e,n,a){ge([e],"spaceToBatchND");var i=n.reduce(function(g,v){return g*v}),s=[[0,0]];s.push.apply(s,a);for(var l=1+n.length;l<e.shape.length;++l)s.push([0,0]);var c=e.pad(s),f=ed(c.shape,n,i,!1),d=td(f.length,n.length,!1),p=nd(c.shape,n,i,!1);return c.reshape(f).transpose(d).reshape(p)},t.prototype.pool=function(e,n,a){ge(e,"pool");for(var i=n.strideHeight,s=n.strideWidth,l=n.dilationHeight,c=n.dilationWidth,f=n.effectiveFilterHeight,d=n.effectiveFilterWidth,p=n.padInfo.top,g=n.padInfo.left,v=a==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,b=this.readSync(e.dataId),w=$e(n.outShape,e.dtype),S=w.values,x=n.outShape[1]*n.outShape[2]*n.outShape[3],C=n.outShape[2]*n.outShape[3],A=n.outShape[3],T=0;T<n.batchSize;++T)for(var R=T*x,O=T*e.strides[0],N=0;N<n.inChannels;++N)for(var D=0;D<n.outHeight;++D)for(var I=D*i-p,_=Math.max(0,I),F=Math.min(n.inHeight,f+I),B=R+D*C,V=0;V<n.outWidth;++V){for(var X=V*s-g,Y=Math.max(0,X),j=Math.min(n.inWidth,d+X),G=v,q=0,ne=0,L=_;L<F;L+=l){for(var Z=O+L*e.strides[1],ce=Y;ce<j;ce+=c){var le=b[Z+ce*e.strides[2]+N];a==="max"&&le>G?G=le:a==="avg"&&(q+=le,ne++)}if(isNaN(G))break}S[B+V*A+N]=a==="avg"?q/ne:G}return w.toTensor()},t.prototype.maxPool=function(e,n){return this.pool(e,n,"max")},t.prototype.maxPoolPositions=function(e,n){for(var a=$e(n.outShape,"int32"),i=n.strideHeight,s=n.strideWidth,l=n.dilationHeight,c=n.dilationWidth,f=n.effectiveFilterHeight,d=n.effectiveFilterWidth,p=n.padInfo.top,g=n.padInfo.left,v=this.bufferSync(e),b=0;b<n.batchSize;++b)for(var w=0;w<n.inChannels;++w)for(var S=0;S<n.outHeight;++S){for(var x=S*i-p,C=x;C<0;)C+=l;for(var A=Math.min(n.inHeight,f+x),T=0;T<n.outWidth;++T){for(var R=T*s-g,O=R;O<0;)O+=c;for(var N=Math.min(n.inWidth,d+R),D=Number.NEGATIVE_INFINITY,I=-1,_=C;_<A;_+=l)for(var F=_-x,B=O;B<N;B+=c){var V=B-R,X=v.get(b,_,B,w);X>D&&(D=X,I=F*d+V)}a.set(I,b,S,T,w)}}return a.toTensor()},t.prototype.maxPoolBackprop=function(e,n,a,i){ge([n,a],"maxPoolBackprop");for(var s=this.maxPoolPositions(n,i),l=i.strideHeight,c=i.strideWidth,f=i.dilationHeight,d=i.dilationWidth,p=i.effectiveFilterHeight,g=i.effectiveFilterWidth,v=g-1-i.padInfo.left,b=p-1-i.padInfo.top,w=$e(n.shape,"float32"),S=this.bufferSync(s),x=this.bufferSync(e),C=0;C<i.batchSize;++C)for(var A=0;A<i.inChannels;++A)for(var T=0;T<i.inHeight;++T)for(var R=0;R<i.inWidth;++R){for(var O=T-b,N=R-v,D=0,I=0;I<p;I+=f){var _=(O+I)/l;if(!(_<0||_>=i.outHeight||Math.floor(_)!==_))for(var F=0;F<g;F+=d){var B=(N+F)/c;if(!(B<0||B>=i.outWidth||Math.floor(B)!==B)){var V=p*g-1-S.get(C,_,B,A)===I*g+F?1:0;V!==0&&(D+=x.get(C,_,B,A)*V)}}}w.set(D,C,T,R,A)}return w.toTensor()},t.prototype.avgPoolBackprop=function(e,n,a){ge([e,n],"avgPoolBackprop");for(var i=a.strideHeight,s=a.strideWidth,l=a.filterHeight,c=a.filterWidth,f=a.dilationHeight,d=a.dilationWidth,p=a.effectiveFilterHeight,g=a.effectiveFilterWidth,v=g-1-a.padInfo.left,b=p-1-a.padInfo.top,w=$e(n.shape,"float32"),S=1/(l*c),x=this.bufferSync(e),C=0;C<a.batchSize;++C)for(var A=0;A<a.inChannels;++A)for(var T=0;T<a.inHeight;++T)for(var R=0;R<a.inWidth;++R){for(var O=T-b,N=R-v,D=0,I=0;I<p;I+=f){var _=(O+I)/i;if(!(_<0||_>=a.outHeight||Math.floor(_)!==_))for(var F=0;F<g;F+=d){var B=(N+F)/s;B<0||B>=a.outWidth||Math.floor(B)!==B||(D+=x.get(C,_,B,A))}}w.set(D*S,C,T,R,A)}return w.toTensor()},t.prototype.pool3d=function(e,n,a){ge(e,"pool3d");for(var i=n.strideDepth,s=n.strideHeight,l=n.strideWidth,c=n.dilationDepth,f=n.dilationHeight,d=n.dilationWidth,p=n.effectiveFilterDepth,g=n.effectiveFilterHeight,v=n.effectiveFilterWidth,b=n.padInfo.front,w=n.padInfo.top,S=n.padInfo.left,x=a==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,C=this.readSync(e.dataId),A=$e(n.outShape,e.dtype),T=A.values,R=n.outShape[1]*n.outShape[2]*n.outShape[3]*n.outShape[4],O=n.outShape[2]*n.outShape[3]*n.outShape[4],N=n.outShape[3]*n.outShape[4],D=n.outShape[4],I=0;I<n.batchSize;++I)for(var _=I*R,F=I*e.strides[0],B=0;B<n.inChannels;++B)for(var V=0;V<n.outDepth;++V){for(var X=V*i-b,Y=X;Y<0;)Y+=c;for(var j=Math.min(n.inDepth,p+X),G=_+V*O,q=0;q<n.outHeight;++q){for(var ne=q*s-w,L=ne;L<0;)L+=f;for(var Z=Math.min(n.inHeight,g+ne),ce=G+q*N,le=0;le<n.outWidth;++le){for(var de=le*l-S,xe=de;xe<0;)xe+=d;for(var we=Math.min(n.inWidth,v+de),_e=ce+le*D,Ee=x,ke=0,Ue=0,Fe=Y;Fe<j;Fe+=c){for(var rt=F+Fe*e.strides[1],qe=L;qe<Z;qe+=f){for(var Se=rt+qe*e.strides[2],dt=xe;dt<we;dt+=d){var Je=C[Se+dt*e.strides[3]+B];if(a==="max"&&Je>Ee?Ee=Je:a==="avg"&&(ke+=Je,Ue++),isNaN(Ee))break}if(isNaN(Ee))break}if(isNaN(Ee))break}T[_e+B]=a==="avg"?ke/Ue:Ee}}}return A.toTensor()},t.prototype.avgPool3d=function(e,n){return ge(e,"avgPool3d"),this.pool3d(e,n,"avg").toFloat()},t.prototype.avgPool3dBackprop=function(e,n,a){ge([e,n],"avgPool3dBackprop");for(var i=a.strideDepth,s=a.strideHeight,l=a.strideWidth,c=a.filterDepth,f=a.filterHeight,d=a.filterWidth,p=a.dilationDepth,g=a.dilationHeight,v=a.dilationWidth,b=a.effectiveFilterDepth,w=a.effectiveFilterHeight,S=a.effectiveFilterWidth,x=b-1-a.padInfo.front,C=S-1-a.padInfo.left,A=w-1-a.padInfo.top,T=$e(n.shape,"float32"),R=1/(c*f*d),O=this.bufferSync(e),N=0;N<a.batchSize;++N)for(var D=0;D<a.inChannels;++D)for(var I=0;I<a.inDepth;++I)for(var _=0;_<a.inHeight;++_)for(var F=0;F<a.inWidth;++F){for(var B=I-x,V=_-A,X=F-C,Y=0,j=0;j<b;j+=p){var G=(B+j)/i;if(!(G<0||G>=a.outDepth||Math.floor(G)!==G))for(var q=0;q<w;q+=g){var ne=(V+q)/s;if(!(ne<0||ne>=a.outHeight||Math.floor(ne)!==ne))for(var L=0;L<S;L+=v){var Z=(X+L)/l;Z<0||Z>=a.outWidth||Math.floor(Z)!==Z||(Y+=O.get(N,G,ne,Z,D))}}}T.set(Y*R,N,I,_,F,D)}return T.toTensor()},t.prototype.maxPool3d=function(e,n){return ge(e,"maxPool3d"),this.pool3d(e,n,"max").toFloat()},t.prototype.maxPool3dPositions=function(e,n){for(var a=$e(n.outShape,"int32"),i=n.strideDepth,s=n.strideHeight,l=n.strideWidth,c=n.dilationDepth,f=n.dilationHeight,d=n.dilationWidth,p=n.effectiveFilterDepth,g=n.effectiveFilterHeight,v=n.effectiveFilterWidth,b=n.padInfo.front,w=n.padInfo.top,S=n.padInfo.left,x=this.bufferSync(e),C=0;C<n.batchSize;++C)for(var A=0;A<n.inChannels;++A)for(var T=0;T<n.outDepth;++T){for(var R=T*i-b,O=R;O<0;)O+=c;for(var N=Math.min(n.inDepth,p+R),D=0;D<n.outHeight;++D){for(var I=D*s-w,_=I;_<0;)_+=f;for(var F=Math.min(n.inHeight,g+I),B=0;B<n.outWidth;++B){for(var V=B*l-S,X=V;X<0;)X+=d;for(var Y=Math.min(n.inWidth,v+V),j=Number.NEGATIVE_INFINITY,G=-1,q=O;q<N;q+=c)for(var ne=q-R,L=_;L<F;L+=f)for(var Z=L-I,ce=X;ce<Y;ce+=d){var le=ce-V,de=x.get(C,q,L,ce,A);de>=j&&(j=de,G=ne*g*v+Z*g+le)}a.set(G,C,T,D,B,A)}}}return a.toTensor()},t.prototype.maxPool3dBackprop=function(e,n,a,i){ge([n,a],"maxPool3dBackprop");for(var s=this.maxPool3dPositions(n,i),l=i.strideDepth,c=i.strideHeight,f=i.strideWidth,d=i.dilationDepth,p=i.dilationHeight,g=i.dilationWidth,v=i.effectiveFilterDepth,b=i.effectiveFilterHeight,w=i.effectiveFilterWidth,S=v-1-i.padInfo.front,x=w-1-i.padInfo.left,C=b-1-i.padInfo.top,A=$e(n.shape,"float32"),T=this.bufferSync(s),R=this.bufferSync(e),O=0;O<i.batchSize;++O)for(var N=0;N<i.inChannels;++N)for(var D=0;D<i.inDepth;++D)for(var I=0;I<i.inHeight;++I)for(var _=0;_<i.inWidth;++_){for(var F=D-S,B=I-C,V=_-x,X=0,Y=0;Y<v;Y+=d){var j=(F+Y)/l;if(!(j<0||j>=i.outDepth||Math.floor(j)!==j))for(var G=0;G<b;G+=p){var q=(B+G)/c;if(!(q<0||q>=i.outHeight||Math.floor(q)!==q))for(var ne=0;ne<w;ne+=g){var L=(V+ne)/f;if(!(L<0||L>=i.outWidth||Math.floor(L)!==L)){var Z=v*b*w-1-T.get(O,j,q,L,N)===Y*b*w+G*w+ne?1:0;Z!==0&&(X+=R.get(O,j,q,L,N)*Z)}}}}A.set(X,O,D,I,_,N)}return A.toTensor()},t.prototype.cast=function(e,n){return tb(e,n,this)},t.prototype.reshape=function(e,n){return id(e,n)},t.prototype.avgPool=function(e,n){return ge(e,"avgPool"),this.pool(e,n,"avg").toFloat()},t.prototype.resizeBilinear=function(e,n,a,i){ge(e,"resizeBilinear");for(var s=e.shape,l=s[0],c=s[1],f=s[2],d=s[3],p=this.readSync(e.dataId),g=new Float32Array(Me([l,n,a,d])),v=[i&&n>1?c-1:c,i&&a>1?f-1:f],b=[i&&n>1?n-1:n,i&&a>1?a-1:a],w=0,S=v[0]/b[0],x=v[1]/b[1],C=0;C<l;C++)for(var A=0;A<n;A++)for(var T=S*A,R=Math.floor(T),O=T-R,N=Math.min(c-1,Math.ceil(T)),D=C*e.strides[0]+R*e.strides[1],I=C*e.strides[0]+N*e.strides[1],_=0;_<a;_++)for(var F=x*_,B=Math.floor(F),V=F-B,X=Math.min(f-1,Math.ceil(F)),Y=D+B*e.strides[2],j=I+B*e.strides[2],G=D+ +X*e.strides[2],q=I+X*e.strides[2],ne=0;ne<d;ne++){var L=p[Y+ne],Z=p[j+ne],ce=L+(p[G+ne]-L)*V,le=ce+(Z+(p[q+ne]-Z)*V-ce)*O;g[w++]=le}return rn(g,[l,n,a,d])},t.prototype.resizeBilinearBackprop=function(e,n,a){ge([e,n],"resizeBilinearBackprop");for(var i=n.shape,s=i[0],l=i[1],c=i[2],f=i[3],d=e.shape,p=d[1],g=d[2],v=new Float32Array(s*l*c*f),b=[a&&p>1?l-1:l,a&&g>1?c-1:c],w=[a&&p>1?p-1:p,a&&g>1?g-1:g],S=b[0]/w[0],x=b[1]/w[1],C=this.readSync(e.dataId),A=0,T=0;T<s;T++)for(var R=T*n.strides[0],O=0;O<p;O++)for(var N=O*S,D=Math.floor(N),I=Math.min(Math.ceil(N),l-1),_=R+D*n.strides[1],F=R+I*n.strides[1],B=N-D,V=1-B,X=0;X<g;X++)for(var Y=X*x,j=Math.floor(Y),G=Math.min(Math.ceil(Y),c-1),q=Y-j,ne=1-q,L=_+j*n.strides[2],Z=_+G*n.strides[2],ce=F+j*n.strides[2],le=F+G*n.strides[2],de=V*ne,xe=V*q,we=B*ne,_e=B*q,Ee=0;Ee<f;Ee++){var ke=C[A++];v[L+Ee]+=ke*de,v[Z+Ee]+=ke*xe,v[ce+Ee]+=ke*we,v[le+Ee]+=ke*_e}return Hi(v,[s,c,l,f],n.dtype)},t.prototype.resizeNearestNeighbor=function(e,n,a,i){ge(e,"resizeNearestNeighbor");for(var s=e.shape,l=s[0],c=s[1],f=s[2],d=s[3],p=this.readSync(e.dataId),g=new Float32Array(l*n*a*d),v=[i&&n>1?c-1:c,i&&a>1?f-1:f],b=[i&&n>1?n-1:n,i&&a>1?a-1:a],w=v[0]/b[0],S=v[1]/b[1],x=0,C=0;C<l;C++)for(var A=C*e.strides[0],T=0;T<n;T++)for(var R=w*T,O=A+Math.min(c-1,i?Math.round(R):Math.floor(R))*e.strides[1],N=0;N<a;N++)for(var D=S*N,I=O+Math.min(f-1,i?Math.round(D):Math.floor(D))*e.strides[2],_=0;_<d;_++){var F=p[I+_];g[x++]=F}return rn(g,[l,n,a,d],e.dtype)},t.prototype.resizeNearestNeighborBackprop=function(e,n,a){ge([e,n],"resizeNearestNeighborBackprop");for(var i=n.shape,s=i[0],l=i[1],c=i[2],f=i[3],d=e.shape,p=d[1],g=d[2],v=new Float32Array(s*l*c*f),b=this.readSync(e.dataId),w=[a&&p>1?l-1:l,a&&g>1?c-1:c],S=[a&&p>1?p-1:p,a&&g>1?g-1:g],x=w[0]/S[0],C=w[1]/S[1],A=1/x,T=1/C,R=2*Math.ceil(A)+2,O=2*Math.ceil(T)+2,N=0;N<s;N++)for(var D=N*n.strides[0],I=0;I<l;I++)for(var _=D+I*n.strides[1],F=Math.floor(I*A),B=Math.floor(F-R/2),V=0;V<c;V++)for(var X=_+V*n.strides[2],Y=Math.floor(V*T),j=Math.floor(Y-O/2),G=0;G<f;G++){for(var q=0,ne=0;ne<R;ne++){var L=ne+B;if(!(L<0||L>=p)){var Z=D+L*e.strides[1],ce=L*x;if(I===Math.min(l-1,a?Math.round(ce):Math.floor(ce)))for(var le=0;le<O;le++){var de=le+j;if(!(de<0||de>=g)){var xe=Z+de*e.strides[2],we=de*C;V===Math.min(c-1,a?Math.round(we):Math.floor(we))&&(q+=b[xe+G])}}}}v[X+G]=q}return Hi(v,n.shape,n.dtype)},t.prototype.batchNormalization=function(e,n,a,i,s,l){ge([e,n,a,s,l],"batchNorm");for(var c=this.readSync(e.dataId),f=this.readSync(n.dataId),d=this.readSync(a.dataId),p=s?this.readSync(s.dataId):new Float32Array([1]),g=l?this.readSync(l.dataId):new Float32Array([0]),v=new Float32Array(c.length),b=g.length,w=p.length,S=d.length,x=f.length,C=0,A=0,T=0,R=0,O=0;O<c.length;++O)v[O]=g[C++]+(c[O]-f[A++])*p[T++]/Math.sqrt(d[R++]+i),C>=b&&(C=0),A>=x&&(A=0),T>=w&&(T=0),R>=S&&(R=0);return Hi(v,e.shape)},t.prototype.localResponseNormalization4D=function(e,n,a,i,s){ge(e,"localResponseNormalization4D");var l=e.shape[3],c=l-1,f=this.readSync(e.dataId),d=e.size,p=new Float32Array(d);function g(S){for(var x=S%l,C=S-x+Math.max(0,x-n),A=S-x+Math.min(x+n,c),T=0;C<=A;C++){var R=f[C];T+=R*R}return T}for(var v=0;v<d;v++){var b=g(v),w=f[v]*Math.pow(a+i*b,-s);p[v]=w}return Hi(p,e.shape)},t.prototype.LRNGrad=function(e,n,a,i,s,l,c){ge(e,"LRNGrad");for(var f=e.shape[3],d=this.readSync(e.dataId),p=this.readSync(n.dataId),g=this.readSync(a.dataId),v=new Float32Array(e.size),b=e.size,w=0;w<b;w++){for(var S=w%f,x=w-S+Math.max(0,S-i),C=w-S+Math.min(f,S+i+1),A=0,T=x;T<C;T++)A+=Math.pow(p[T],2);for(A=l*A+s,T=x;T<C;T++){var R=-2*l*c*p[T]*g[w]/A;w===T&&(R+=Math.pow(A,-c)),R*=d[w],v[T]+=R}}return Hi(v,e.shape)},t.prototype.multinomial=function(e,n,a,i){ge(e,"multinomial");for(var s=n?e:fs(e),l=s.shape[0],c=s.shape[1],f=St([l,a],"int32"),d=this.readSync(f.dataId),p=this.readSync(s.dataId),g=0;g<l;++g){var v=g*c,b=new Float32Array(c-1);b[0]=p[v];for(var w=1;w<b.length;++w)b[w]=b[w-1]+p[v+w];for(var S=Cd(i.toString()),x=g*a,C=0;C<a;++C){var A=S();d[x+C]=b.length;for(var T=0;T<b.length;T++)if(A<b[T]){d[x+C]=T;break}}}return f},t.prototype.oneHot=function(e,n,a,i){ge(e,"oneHot");var s=new Float32Array(e.size*n);s.fill(i);for(var l=this.readSync(e.dataId),c=0;c<e.size;++c)l[c]>=0&&l[c]<n&&(s[c*n+l[c]]=a);return ai(s,[e.size,n],"int32")},t.prototype.nonMaxSuppression=function(e,n,a,i,s){return ge(e,"nonMaxSuppression"),rb(this.readSync(e.dataId),this.readSync(n.dataId),a,i,s)},t.prototype.fft=function(e){return this.fftBatch(e,!1)},t.prototype.ifft=function(e){return this.fftBatch(e,!0)},t.prototype.fftBatch=function(e,n){for(var a=e.shape[0],i=e.shape[1],s=$e(e.shape,"float32"),l=$e(e.shape,"float32"),c=lr(e).as2D(a,i),f=Gr(e).as2D(a,i),d=0;d<a;d++)for(var p=c.slice([d,0],[1,i]),g=f.slice([d,0],[1,i]),v=Sn(p,g),b=this.readSync(this.fftImpl(v,n).dataId),w=0;w<i;w++){var S=nS(b,w);s.values[d*i+w]=S.real,l.values[d*i+w]=S.imag}return Sn(s.toTensor(),l.toTensor()).as2D(a,i)},t.prototype.fftImpl=function(e,n){var a=e.as1D(),i=a.size;if(this.isExponentOf2(i)){var s=this.fftRadix2(a,i,n).as2D(e.shape[0],e.shape[1]);return n&&(s=Sn(lr(s).div(Re(i)),Gr(s).div(Re(i)))),s}var l=this.readSync(e.dataId),c=function(f){for(var d=new Float32Array(f.length/2),p=new Float32Array(f.length/2),g=0;g<f.length;g+=2)d[g/2]=f[g],p[g/2]=f[g+1];return{real:d,imag:p}}(this.fourierTransformByMatmul(l,i,n));return Sn(c.real,c.imag).as2D(e.shape[0],e.shape[1])},t.prototype.isExponentOf2=function(e){return(e&e-1)==0},t.prototype.fftRadix2=function(e,n,a){if(n===1)return e;var i=this.readSync(e.dataId),s=n/2,l=function(x){for(var C=Math.ceil(x.length/4),A=new Float32Array(C),T=new Float32Array(C),R=0;R<x.length;R+=4)A[Math.floor(R/4)]=x[R],T[Math.floor(R/4)]=x[R+1];return{real:A,imag:T}}(i),c=Sn(l.real,l.imag).as1D(),f=function(x){for(var C=Math.floor(x.length/4),A=new Float32Array(C),T=new Float32Array(C),R=2;R<x.length;R+=4)A[Math.floor(R/4)]=x[R],T[Math.floor(R/4)]=x[R+1];return{real:A,imag:T}}(i),d=Sn(f.real,f.imag).as1D();c=this.fftRadix2(c,s,a),d=this.fftRadix2(d,s,a);var p=function(x,C){for(var A=new Float32Array(x/2),T=new Float32Array(x/2),R=0;R<Math.ceil(x/2);R++){var O=(C?2:-2)*Math.PI*(R/x);A[R]=Math.cos(O),T[R]=Math.sin(O)}return{real:A,imag:T}}(n,a),g=Sn(p.real,p.imag).mul(d),v=c.add(g),b=c.sub(g),w=lr(v).concat(lr(b)),S=Gr(v).concat(Gr(b));return Sn(w,S).as1D()},t.prototype.fourierTransformByMatmul=function(e,n,a){for(var i=new Float32Array(2*n),s=0;s<n;s++){for(var l=0,c=0,f=0;f<n;f++){var d=u4(s*f,n,a),p=nS(e,f);l+=p.real*d.real-p.imag*d.imag,c+=p.real*d.imag+p.imag*d.real}a&&(l/=n,c/=n),s4(i,l,c,s)}return i},t.prototype.depthToSpace=function(e,n,a){P(a==="NHWC",function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+a}),P(n>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+n});for(var i=e.shape[0],s=e.shape[1],l=e.shape[2],c=e.shape[3],f=s*n,d=l*n,p=c/(n*n),g=this.readSync(e.dataId),v=new Float32Array(i*f*d*p),b=0,w=0;w<i;++w)for(var S=0;S<f;++S)for(var x=Math.floor(S/n),C=S%n,A=0;A<d;++A)for(var T=Math.floor(A/n),R=(C*n+A%n)*p,O=0;O<p;++O){var N=O+R+c*(T+l*(x+s*w));v[b++]=g[N]}return Hi(v,[i,f,d,p])},t.prototype.broadcastedBinaryOp=function(e,n,a,i){var s=lt(e.shape,n.shape),l=$e(s,a),c=this.readSync(e.dataId),f=this.readSync(n.dataId),d=Wo(e.shape,s),p=Wo(n.shape,s),g=l.values;if(d.length+p.length===0)for(var v=0;v<g.length;++v)g[v]=i(c[v%c.length],f[v%f.length]);else{var b=this.bufferSync(e),w=this.bufferSync(n),S=function(x){var C=l.indexToLoc(x),A=C.slice(-e.rank);d.forEach(function(N){return A[N]=0});var T=b.locToIndex(A),R=C.slice(-n.rank);p.forEach(function(N){return R[N]=0});var O=w.locToIndex(R);g[x]=i(c[T],f[O])};for(v=0;v<g.length;++v)S(v)}return l.toTensor()},t.prototype.broadcastedBinaryComplexOp=function(e,n,a){var i=lt(e.shape,n.shape),s=$e(i,"float32"),l=$e(i,"float32"),c=this.readSync(e.dataId),f=this.readSync(n.dataId),d=Wo(e.shape,i),p=Wo(n.shape,i),g=s.values,v=l.values;if(d.length+p.length===0)for(var b=0;b<g.length;b++){var w=b%c.length,S=b%f.length,x=a(c[2*w],c[2*w+1],f[2*S],f[2*S+1]);g[b]=x.real,v[b]=x.imag}else{var C=this.bufferSync(this.data.get(e.dataId).complexTensors.real),A=this.bufferSync(this.data.get(n.dataId).complexTensors.real),T=function(R){var O=s.indexToLoc(R),N=O.slice(-e.rank);d.forEach(function(B){return N[B]=0});var D=C.locToIndex(N),I=O.slice(-n.rank);p.forEach(function(B){return I[B]=0});var _=A.locToIndex(I),F=a(c[2*D],c[2*D+1],f[2*_],f[2*_+1]);g[R]=F.real,v[R]=F.imag};for(b=0;b<g.length;b++)T(b)}return this.complex(s.toTensor(),l.toTensor())},t.prototype.split=function(e,n,a){return HA(e,n,a)},t.prototype.dispose=function(){},t.prototype.floatPrecision=function(){return 32},t.prototype.epsilon=function(){return 1e-7},t.prototype.cropAndResize=function(e,n,a,i,s,l){for(var c=e.shape,f=c[0],d=c[1],p=c[2],g=c[3],v=n.shape[0],b=i[0],w=i[1],S=$e([v,b,w,g],e.dtype),x=this.readSync(n.dataId),C=this.readSync(a.dataId),A=this.readSync(e.dataId),T=e.strides,R=S.strides,O=0;O<v;O++){var N=4*O,D=x[N],I=x[N+1],_=x[N+2],F=x[N+3],B=C[O];if(!(B>=f))for(var V=b>1?(_-D)*(d-1)/(b-1):0,X=w>1?(F-I)*(p-1)/(w-1):0,Y=0;Y<b;Y++){var j=b>1?D*(d-1)+Y*V:.5*(D+_)*(d-1);if(j<0||j>d-1)for(var G=0;G<w;G++)for(var q=0;q<g;q++){var ne=q+G*R[2]+Y*R[1]+O*R[0];S.values[ne]=l}else if(s==="bilinear"){var L=Math.floor(j),Z=Math.ceil(j),ce=j-L;for(G=0;G<w;G++)if((Fe=w>1?I*(p-1)+G*X:.5*(I+F)*(p-1))<0||Fe>p-1)for(q=0;q<g;q++)ne=q+G*R[2]+Y*R[1]+O*R[0],S.values[ne]=l;else{var le=Math.floor(Fe),de=Math.ceil(Fe),xe=Fe-le;for(q=0;q<g;q++){var we=A[ne=q+le*T[2]+L*T[1]+B*T[0]],_e=A[ne=q+de*T[2]+L*T[1]+B*T[0]],Ee=A[ne=q+le*T[2]+Z*T[1]+B*T[0]],ke=we+(_e-we)*xe,Ue=Ee+(A[ne=q+de*T[2]+Z*T[1]+B*T[0]]-Ee)*xe;ne=q+G*R[2]+Y*R[1]+O*R[0],S.values[ne]=ke+(Ue-ke)*ce}}}else for(G=0;G<w;++G){var Fe;if((Fe=w>1?I*(p-1)+G*X:.5*(I+F)*(p-1))<0||Fe>p-1)for(q=0;q<g;q++)ne=q+G*R[2]+Y*R[1]+O*R[0],S.values[ne]=l;else{var rt=Math.round(Fe),qe=Math.round(j);for(q=0;q<g;q++){var Se=q+rt*T[2]+qe*T[1]+B*T[0],dt=q+G*R[2]+Y*R[1]+O*R[0];S.values[dt]=A[Se]}}}}}return S.toTensor()},t.prototype.sparseToDense=function(e,n,a,i){var s=rd(0,e,a),l=s.sliceRank,c=s.numUpdates,f=s.sliceSize,d=s.strides,p=s.outputSize;return this.scatter(e,n,a,p,f,c,l,d,i,!1)},t.prototype.gatherND=function(e,n){var a=n.shape,i=a[a.length-1],s=BA(e,n),l=s[0],c=s[1],f=s[2],d=s[3];if(c===0)return rn([],l,e.dtype);for(var p=new yu([c,f],e.dtype),g=this.readSync(n.dataId),v=this.readSync(e.dataId),b=0;b<c;b++){for(var w=[],S=0,x=0;x<i;x++){var C=g[b*i+x];S+=C*d[x],w.push(C)}if(S<0||S>=e.size/f)throw new Error("Invalid indices: "+w+" does not index into "+e.shape);for(var A=0;A<f;A++)p.values[b*f+A]=v[S*f+A]}return p.toTensor().reshape(l)},t.prototype.scatterND=function(e,n,a){var i=rd(0,e,a),s=i.sliceRank,l=i.numUpdates,c=i.sliceSize,f=i.strides,d=i.outputSize,p=Re(0);return this.scatter(e,n,a,d,c,l,s,f,p,!0)},t.prototype.fill=function(e,n,a){var i=lc(a=a||_u(n),Me(e));return i.fill(n),$.makeTensor(i,e,a,this)},t.prototype.onesLike=function(e){if(e.dtype==="string")throw new Error("onesLike is not supported for string tensors");return this.fill(e.shape,1,e.dtype)},t.prototype.zerosLike=function(e){var n=lc(e.dtype,Me(e.shape));return this.makeOutput(n,e.shape,e.dtype)},t.prototype.linspace=function(e,n,a){return nb(e,n,a)},t.prototype.scatter=function(e,n,a,i,s,l,c,f,d,p){var g=[i/s,s],v=this.readSync(e.dataId),b=this.readSync(n.dataId);if(i===0)return rn([],a,n.dtype);var w=new yu(g,n.dtype);w.values.fill(this.readSync(d.dataId)[0]);for(var S=0;S<l;S++){for(var x=[],C=0,A=0;A<c;A++){var T=v[S*c+A];x.push(T),C+=T*f[A]}if(C<0||C>=i/s)throw new Error("Invalid indices: "+x+" does not index into "+a);for(var R=0;R<s;R++)p?w.values[C*s+R]+=b[S*s+R]:w.values[C*s+R]=n.rank===0?b[0]:b[S*s+R]}return w.toTensor().reshape(a)},t}(Jy);$.registerBackend("cpu",function(){return new uF},1),Tv({kernelName:"Square",backendName:"cpu",kernelFunc:function(r){var t=r.inputs,e=r.backend,n=t.x,a=e;ge(n,"square");for(var i=a.data.get(n.dataId).values,s=new Float32Array(i.length),l=0;l<i.length;++l){var c=i[l];s[l]=c*c}return{dataId:a.write(s,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}}),Tv({kernelName:"Square",backendName:"webgl",kernelFunc:function(r){var t=r.inputs,e=r.backend,n=t.x,a=e,i=new Qe(n.shape,"return x * x;");return a.runWebGLProgram(i,[n],n.dtype)}});var lF=function(){function r(){}return r.prototype.fetch=function(t,e){return fetch(t,e)},r.prototype.now=function(){return performance.now()},r.prototype.encode=function(t,e){if(e!=="utf-8"&&e!=="utf8")throw new Error("Browser's encoder only supports utf-8, but got "+e);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)},r.prototype.decode=function(t,e){return new TextDecoder(e).decode(t)},r}();se().get("IS_BROWSER")&&se().setPlatform("browser",new lF);var nv,cF=function(){return require("node-fetch")},fF=function(){function r(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}return r.prototype.fetch=function(t,e){return se().global.fetch!=null?se().global.fetch(t,e):(nv==null&&(nv=cF()),nv(t,e))},r.prototype.now=function(){var t=process.hrtime();return 1e3*t[0]+t[1]/1e6},r.prototype.encode=function(t,e){if(e!=="utf-8"&&e!=="utf8")throw new Error("Node built-in encoder only supports utf-8, but got "+e);return this.textEncoder.encode(t)},r.prototype.decode=function(t,e){return t.length===0?"":new this.util.TextDecoder(e).decode(t)},r}();se().get("IS_NODE")&&se().setPlatform("node",new fF);var Wv={float32:4,int32:4,uint16:2,uint8:1,bool:1},od=4;function EN(r,t){for(var e={},n=0,a=function(l){var c=l.name,f=l.dtype,d=l.shape,p=Me(d),g=void 0;if("quantization"in l){var v=l.quantization;if(v.dtype!=="uint8"&&v.dtype!=="uint16")throw new Error("Weight "+l.name+" has unknown quantization dtype "+v.dtype+". Supported quantization dtypes are: 'uint8' and 'uint16'.");var b=Wv[v.dtype],w=r.slice(n,n+p*b),S=v.dtype==="uint8"?new Uint8Array(w):new Uint16Array(w);if(f==="float32")g=Float32Array.from(S,function(O){return O*v.scale+v.min});else{if(f!=="int32")throw new Error("Unsupported dtype in weight '"+c+"': "+f);g=Int32Array.from(S,function(O){return Math.round(O*v.scale+v.min)})}n+=p*b}else if(f==="string"){var x=Me(l.shape);g=[];for(var C=0;C<x;C++){var A=new Uint32Array(r.slice(n,n+od))[0];n+=od;var T=new Uint8Array(r.slice(n,n+A));g.push(T),n+=A}}else{var R=Wv[f];if(w=r.slice(n,n+p*R),f==="float32")g=new Float32Array(w);else if(f==="int32")g=new Int32Array(w);else{if(f!=="bool")throw new Error("Unsupported dtype in weight '"+c+"': "+f);g=new Uint8Array(w)}n+=p*R}e[c]=rn(g,d,f)},i=0,s=t;i<s.length;i++)a(s[i]);return e}function hF(r){if(r===null)throw new Error("Invalid input value: "+JSON.stringify(r));var t=0,e=[];r.forEach(function(i){if(t+=i.byteLength,e.push(i.byteLength===i.buffer.byteLength?i:new i.constructor(i)),!(i instanceof Float32Array||i instanceof Int32Array||i instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+i.constructor.name)});var n=new Uint8Array(t),a=0;return e.forEach(function(i){n.set(new Uint8Array(i.buffer),a),a+=i.byteLength}),n.buffer}var Hv=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function ES(r){return Hv?Buffer.byteLength(r):new Blob([r]).size}function a0(r){var t=0;r.forEach(function(a){t+=a.byteLength});var e=new Uint8Array(t),n=0;return r.forEach(function(a){e.set(new Uint8Array(a),n),n+=a.byteLength}),e.buffer}function CS(r){for(r=r.trim();r.endsWith("/");)r=r.slice(0,r.length-1);var t=r.split("/");return t[t.length-1]}function jc(r){if(r.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:r.modelTopology==null?0:ES(JSON.stringify(r.modelTopology)),weightSpecsBytes:r.weightSpecs==null?0:ES(JSON.stringify(r.weightSpecs)),weightDataBytes:r.weightData==null?0:r.weightData.byteLength}}var Cr=function(){function r(){this.saveRouters=[],this.loadRouters=[]}return r.getInstance=function(){return r.instance==null&&(r.instance=new r),r.instance},r.registerSaveRouter=function(t){r.getInstance().saveRouters.push(t)},r.registerLoadRouter=function(t){r.getInstance().loadRouters.push(t)},r.getSaveHandlers=function(t){return r.getHandlers(t,"save")},r.getLoadHandlers=function(t,e){return r.getHandlers(t,"load",e)},r.getHandlers=function(t,e,n){var a=[];return(e==="load"?r.getInstance().loadRouters:r.getInstance().saveRouters).forEach(function(i){var s=i(t,n);s!==null&&a.push(s)}),a},r}(),pu="://",Zi=function(){function r(){this.managers={}}return r.getInstance=function(){return r.instance==null&&(r.instance=new r),r.instance},r.registerManager=function(t,e){P(t!=null,function(){return"scheme must not be undefined or null."}),t.endsWith(pu)&&(t=t.slice(0,t.indexOf(pu))),P(t.length>0,function(){return"scheme must not be an empty string."});var n=r.getInstance();P(n.managers[t]==null,function(){return"A model store manager is already registered for scheme '"+t+"'."}),n.managers[t]=e},r.getManager=function(t){var e=this.getInstance().managers[t];if(e==null)throw new Error("Cannot find model manager for scheme '"+t+"'");return e},r.getSchemes=function(){return Object.keys(this.getInstance().managers)},r}();function Bh(r){if(r.indexOf(pu)===-1)throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+Zi.getSchemes().join(","));return{scheme:r.split(pu)[0],path:r.split(pu)[1]}}function AS(r,t,e){return e===void 0&&(e=!1),De(this,void 0,void 0,function(){var n,a,i,s,l,c,f,d,p;return Oe(this,function(g){switch(g.label){case 0:return P(r!==t,function(){return"Old path and new path are the same: '"+r+"'"}),P((n=Cr.getLoadHandlers(r)).length>0,function(){return"Copying failed because no load handler is found for source URL "+r+"."}),P(n.length<2,function(){return"Copying failed because more than one ("+n.length+") load handlers for source URL "+r+"."}),a=n[0],P((i=Cr.getSaveHandlers(t)).length>0,function(){return"Copying failed because no save handler is found for destination URL "+t+"."}),P(i.length<2,function(){return"Copying failed because more than one ("+n.length+") save handlers for destination URL "+t+"."}),s=i[0],l=Bh(r).scheme,c=Bh(r).path,f=l===Bh(r).scheme,[4,a.load()];case 1:return d=g.sent(),e&&f?[4,Zi.getManager(l).removeModel(c)]:[3,3];case 2:g.sent(),g.label=3;case 3:return[4,s.save(d)];case 4:return p=g.sent(),!e||f?[3,6]:[4,Zi.getManager(l).removeModel(c)];case 5:g.sent(),g.label=6;case 6:return[2,p.modelArtifactsInfo]}})})}var qo="models_store",Xi="model_info_store";function CN(){if(!se().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var r=window,t=r.indexedDB||r.mozIndexedDB||r.webkitIndexedDB||r.msIndexedDB||r.shimIndexedDB;if(t==null)throw new Error("The current browser does not appear to support IndexedDB.");return t}function qv(r){var t=r.result;t.createObjectStore(qo,{keyPath:"modelPath"}),t.createObjectStore(Xi,{keyPath:"modelPath"})}var mu=function(){function r(t){if(this.indexedDB=CN(),t==null||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}return r.prototype.save=function(t){return De(this,void 0,void 0,function(){return Oe(this,function(e){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,t)]})})},r.prototype.load=function(){return De(this,void 0,void 0,function(){return Oe(this,function(t){return[2,this.databaseAction(this.modelPath)]})})},r.prototype.databaseAction=function(t,e){var n=this;return new Promise(function(a,i){var s=n.indexedDB.open("tensorflowjs",1);s.onupgradeneeded=function(){return qv(s)},s.onsuccess=function(){var l=s.result;if(e==null){var c=l.transaction(qo,"readonly"),f=c.objectStore(qo).get(n.modelPath);f.onsuccess=function(){if(f.result==null)return l.close(),i(new Error("Cannot find model with path '"+n.modelPath+"' in IndexedDB."));a(f.result.modelArtifacts)},f.onerror=function(w){return l.close(),i(f.error)},c.oncomplete=function(){return l.close()}}else{var d,p=jc(e),g=l.transaction(Xi,"readwrite"),v=g.objectStore(Xi),b=v.put({modelPath:n.modelPath,modelArtifactsInfo:p});b.onsuccess=function(){var w=(d=l.transaction(qo,"readwrite")).objectStore(qo).put({modelPath:n.modelPath,modelArtifacts:e,modelArtifactsInfo:p});w.onsuccess=function(){return a({modelArtifactsInfo:p})},w.onerror=function(S){var x=(v=g.objectStore(Xi)).delete(n.modelPath);x.onsuccess=function(){return l.close(),i(w.error)},x.onerror=function(C){return l.close(),i(w.error)}}},b.onerror=function(w){return l.close(),i(b.error)},g.oncomplete=function(){d==null?l.close():d.oncomplete=function(){return l.close()}}}},s.onerror=function(l){return i(s.error)}})},r.URL_SCHEME="indexeddb://",r}(),TS=function(r){return se().getBool("IS_BROWSER")&&!Array.isArray(r)&&r.startsWith(mu.URL_SCHEME)?(t=r.slice(mu.URL_SCHEME.length),new mu(t)):null;var t};Cr.registerSaveRouter(TS),Cr.registerLoadRouter(TS);var dF=function(){function r(){this.indexedDB=CN()}return r.prototype.listModels=function(){return De(this,void 0,void 0,function(){var t=this;return Oe(this,function(e){return[2,new Promise(function(n,a){var i=t.indexedDB.open("tensorflowjs",1);i.onupgradeneeded=function(){return qv(i)},i.onsuccess=function(){var s=i.result,l=s.transaction(Xi,"readonly"),c=l.objectStore(Xi).getAll();c.onsuccess=function(){for(var f={},d=0,p=c.result;d<p.length;d++){var g=p[d];f[g.modelPath]=g.modelArtifactsInfo}n(f)},c.onerror=function(f){return s.close(),a(c.error)},l.oncomplete=function(){return s.close()}},i.onerror=function(s){return a(i.error)}})]})})},r.prototype.removeModel=function(t){return De(this,void 0,void 0,function(){var e=this;return Oe(this,function(n){var a;return t=(a=t).startsWith(mu.URL_SCHEME)?a.slice(mu.URL_SCHEME.length):a,[2,new Promise(function(i,s){var l=e.indexedDB.open("tensorflowjs",1);l.onupgradeneeded=function(){return qv(l)},l.onsuccess=function(){var c,f=l.result,d=f.transaction(Xi,"readwrite"),p=d.objectStore(Xi),g=p.get(t);g.onsuccess=function(){if(g.result==null)return f.close(),s(new Error("Cannot find model with path '"+t+"' in IndexedDB."));var v=p.delete(t),b=function(){var w=(c=f.transaction(qo,"readwrite")).objectStore(qo).delete(t);w.onsuccess=function(){return i(g.result.modelArtifactsInfo)},w.onerror=function(S){return s(g.error)}};v.onsuccess=b,v.onerror=function(w){return b(),f.close(),s(g.error)}},g.onerror=function(v){return f.close(),s(g.error)},d.oncomplete=function(){c==null?f.close():c.oncomplete=function(){return f.close()}}},l.onerror=function(c){return s(l.error)}})]})})},r}();if(se().getBool("IS_BROWSER"))try{Zi.registerManager(mu.URL_SCHEME,new dF)}catch{}var ni="/",cu="tensorflowjs_models",AN="info",pF="model_topology",mF="weight_specs",gF="weight_data",vF="model_metadata";function TN(r){return{info:[cu,r,AN].join(ni),topology:[cu,r,pF].join(ni),weightSpecs:[cu,r,mF].join(ni),weightData:[cu,r,gF].join(ni),modelMetadata:[cu,r,vF].join(ni)}}function yF(r){var t=r.split(ni);if(t.length<3)throw new Error("Invalid key format: "+r);return t.slice(1,t.length-1).join(ni)}var gu=function(){function r(t){if(!se().getBool("IS_BROWSER")||window.localStorage===void 0)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,t==null||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=TN(this.modelPath)}return r.prototype.save=function(t){return De(this,void 0,void 0,function(){var e,n,a;return Oe(this,function(i){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");e=JSON.stringify(t.modelTopology),n=JSON.stringify(t.weightSpecs),a=jc(t);try{return this.LS.setItem(this.keys.info,JSON.stringify(a)),this.LS.setItem(this.keys.topology,e),this.LS.setItem(this.keys.weightSpecs,n),this.LS.setItem(this.keys.weightData,(s=t.weightData,Hv?Buffer.from(s).toString("base64"):btoa(String.fromCharCode.apply(null,new Uint8Array(s))))),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy})),[2,{modelArtifactsInfo:a}]}catch{throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+a.modelTopologyBytes+", weightSpecsBytes="+a.weightSpecsBytes+", weightDataBytes="+a.weightDataBytes+".")}var s;return[2]})})},r.prototype.load=function(){return De(this,void 0,void 0,function(){var t,e,n,a,i,s,l;return Oe(this,function(c){if((t=JSON.parse(this.LS.getItem(this.keys.info)))==null)throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if(t.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(e={},(n=JSON.parse(this.LS.getItem(this.keys.topology)))==null)throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(e.modelTopology=n,(a=JSON.parse(this.LS.getItem(this.keys.weightSpecs)))==null)throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(e.weightSpecs=a,(i=this.LS.getItem(this.keys.modelMetadata))!=null&&(s=JSON.parse(i),e.format=s.format,e.generatedBy=s.generatedBy,e.convertedBy=s.convertedBy),(l=this.LS.getItem(this.keys.weightData))==null)throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return e.weightData=function(f){if(Hv){var d=Buffer.from(f,"base64");return d.buffer.slice(d.byteOffset,d.byteOffset+d.byteLength)}for(var p=atob(f),g=new Uint8Array(p.length),v=0;v<p.length;++v)g.set([p.charCodeAt(v)],v);return g.buffer}(l),[2,e]})})},r.URL_SCHEME="localstorage://",r}(),NS=function(r){return se().getBool("IS_BROWSER")&&!Array.isArray(r)&&r.startsWith(gu.URL_SCHEME)?(t=r.slice(gu.URL_SCHEME.length),new gu(t)):null;var t};Cr.registerSaveRouter(NS),Cr.registerLoadRouter(NS);var bF=function(){function r(){P(se().getBool("IS_BROWSER"),function(){return"Current environment is not a web browser"}),P(window.localStorage!==void 0,function(){return"Current browser does not appear to support localStorage"}),this.LS=window.localStorage}return r.prototype.listModels=function(){return De(this,void 0,void 0,function(){var t,e,n,a,i,s;return Oe(this,function(l){for(t={},e=cu+ni,n=ni+AN,a=0;a<this.LS.length;++a)(i=this.LS.key(a)).startsWith(e)&&i.endsWith(n)&&(s=yF(i),t[s]=JSON.parse(this.LS.getItem(i)));return[2,t]})})},r.prototype.removeModel=function(t){return De(this,void 0,void 0,function(){var e,n;return Oe(this,function(a){var i;if(t=(i=t).startsWith(gu.URL_SCHEME)?i.slice(gu.URL_SCHEME.length):i,e=TN(t),this.LS.getItem(e.info)==null)throw new Error("Cannot find model at path '"+t+"'");return n=JSON.parse(this.LS.getItem(e.info)),this.LS.removeItem(e.info),this.LS.removeItem(e.topology),this.LS.removeItem(e.weightSpecs),this.LS.removeItem(e.weightData),[2,n]})})},r}();if(se().getBool("IS_BROWSER"))try{Zi.registerManager(gu.URL_SCHEME,new bF)}catch{}var wF="model",xF=".json",SF=".weights.bin";function RS(r){return new Promise(function(t){return setTimeout(t)}).then(r)}var rv=function(){function r(t){if(!se().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(r.URL_SCHEME)&&(t=t.slice(r.URL_SCHEME.length)),t!=null&&t.length!==0||(t=wF),this.modelTopologyFileName=t+xF,this.weightDataFileName=t+SF}return r.prototype.save=function(t){return De(this,void 0,void 0,function(){var e,n,a,i,s,l;return Oe(this,function(c){switch(c.label){case 0:if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");if(e=window.URL.createObjectURL(new Blob([t.weightData],{type:"application/octet-stream"})),!(t.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return n=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],a={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:n},i=window.URL.createObjectURL(new Blob([JSON.stringify(a)],{type:"application/json"})),(s=this.jsonAnchor==null?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,s.href=i,[4,RS(function(){return s.dispatchEvent(new MouseEvent("click"))})];case 2:return c.sent(),t.weightData==null?[3,4]:((l=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,l.href=e,[4,RS(function(){return l.dispatchEvent(new MouseEvent("click"))})]);case 3:c.sent(),c.label=4;case 4:return[2,{modelArtifactsInfo:jc(t)}]}})})},r.URL_SCHEME="downloads://",r}(),EF=function(){function r(t){if(t==null||t.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+t);this.files=t}return r.prototype.load=function(){return De(this,void 0,void 0,function(){var t,e,n=this;return Oe(this,function(a){return t=this.files[0],e=this.files.slice(1),[2,new Promise(function(i,s){var l=new FileReader;l.onload=function(c){var f=JSON.parse(c.target.result),d=f.modelTopology;if(d!=null){e.length===0&&i({modelTopology:d});var p=f.weightsManifest;if(p!=null){var g;try{g=n.checkManifestAndWeightFiles(p,e)}catch(S){return void s(S)}var v=[],b=[],w=[];p.forEach(function(S){S.paths.forEach(function(x){b.push(x),w.push(null)}),v.push.apply(v,S.weights)}),p.forEach(function(S){S.paths.forEach(function(x){var C=new FileReader;C.onload=function(A){var T=A.target.result,R=b.indexOf(x);w[R]=T,w.indexOf(null)===-1&&i({modelTopology:d,weightSpecs:v,weightData:a0(w)})},C.onerror=function(A){return s("Failed to weights data from file of path '"+x+"'.")},C.readAsArrayBuffer(g[x])})})}else s(new Error("weightManifest field is missing from file "+t.name))}else s(new Error("modelTopology field is missing from file "+t.name))},l.onerror=function(c){return s("Failed to read model topology and weights manifest JSON from file '"+t.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},l.readAsText(t)})]})})},r.prototype.checkManifestAndWeightFiles=function(t,e){for(var n=[],a=e.map(function(c){return CS(c.name)}),i={},s=0,l=t;s<l.length;s++)l[s].paths.forEach(function(c){var f=CS(c);if(n.indexOf(f)!==-1)throw new Error("Duplicate file basename found in weights manifest: '"+f+"'");if(n.push(f),a.indexOf(f)===-1)throw new Error("Weight file with basename '"+f+"' is not provided.");i[c]=e[a.indexOf(f)]});if(n.length!==e.length)throw new Error("Mismatch in the number of files in weights manifest ("+n.length+") and the number of weight files provided ("+e.length+").");return i},r}();function IS(r,t,e,n){(function(i){P(i!=null&&Array.isArray(i)&&i.length>0,function(){return"promises must be a none empty array"})})(r),function(i,s){P(i>=0&&i<=1,function(){return"Progress fraction must be in range [0, 1], but got startFraction "+i}),P(s>=0&&s<=1,function(){return"Progress fraction must be in range [0, 1], but got endFraction "+s}),P(s>=i,function(){return"startFraction must be no more than endFraction, but got startFraction "+i+" and endFraction "+s})}(e=e??0,n=n??1);var a=0;return Promise.all(r.map(function(i){return i.then(function(s){var l=e+ ++a/r.length*(n-e);return t(l),s}),i}))}function NN(r,t){return De(this,void 0,void 0,function(){var e,n,a,i,s,l,c,f,d;return Oe(this,function(p){switch(p.label){case 0:return t==null&&(t={}),e=t.fetchFunc==null?se().platform.fetch:t.fetchFunc,n=r.map(function(g){return e(g,t.requestInit,{isBinary:!0})}),a=0,i=.5,t.onProgress!=null?[3,2]:[4,Promise.all(n)];case 1:return s=p.sent(),[3,4];case 2:return[4,IS(n,t.onProgress,a,i)];case 3:s=p.sent(),p.label=4;case 4:return l=s.map(function(g){return g.arrayBuffer()}),c=.5,f=1,t.onProgress!=null?[3,6]:[4,Promise.all(l)];case 5:return d=p.sent(),[3,8];case 6:return[4,IS(l,t.onProgress,c,f)];case 7:d=p.sent(),p.label=8;case 8:return[2,d]}})})}function kS(r){var t=this;return function(e,n,a){return n===void 0&&(n=""),De(t,void 0,void 0,function(){var i,s,l,c,f,d,p,g,v,b;return Oe(this,function(w){switch(w.label){case 0:if(i=e.map(function(){return!1}),s={},l=a!=null?a.map(function(){return!1}):[],c=[],e.forEach(function(S,x){var C=0;S.weights.forEach(function(A){var T="quantization"in A?A.quantization.dtype:A.dtype,R=Wv[T]*Me(A.shape),O=function(){i[x]=!0,s[x]==null&&(s[x]=[]),s[x].push({manifestEntry:A,groupOffset:C,sizeBytes:R})};a!=null?a.forEach(function(N,D){N===A.name&&(O(),l[D]=!0)}):O(),c.push(A.name),C+=R})}),!l.every(function(S){return S}))throw f=a.filter(function(S,x){return!l[x]}),new Error("Could not find weights in manifest with names: "+f.join(", ")+`. 
Manifest JSON has weights with names: `+c.join(", ")+".");return d=i.reduce(function(S,x,C){return x&&S.push(C),S},[]),p=[],d.forEach(function(S){e[S].paths.forEach(function(x){var C=n+(n.endsWith("/")?"":"/")+x;p.push(C)})}),[4,r(p)];case 1:return g=w.sent(),v={},b=0,d.forEach(function(S){for(var x=e[S].paths.length,C=0,A=0;A<x;A++)C+=g[b+A].byteLength;for(var T=new ArrayBuffer(C),R=new Uint8Array(T),O=0,N=0;N<x;N++){var D=new Uint8Array(g[b+N]);R.set(D,O),O+=D.byteLength}s[S].forEach(function(I){var _=EN(T.slice(I.groupOffset,I.groupOffset+I.sizeBytes),[I.manifestEntry]);for(var F in _)v[F]=_[F]}),b+=x}),[2,v]}})})}}Cr.registerSaveRouter(function(r){return se().getBool("IS_BROWSER")&&!Array.isArray(r)&&r.startsWith(rv.URL_SCHEME)?(t=r.slice(rv.URL_SCHEME.length),t===void 0&&(t="model"),new rv(t)):null;var t});var RN=function(){function r(t,e){if(this.DEFAULT_METHOD="POST",e==null&&(e={}),this.weightPathPrefix=e.weightPathPrefix,this.onProgress=e.onProgress,e.fetchFunc!=null?(P(typeof e.fetchFunc=="function",function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"}),this.fetch=e.fetchFunc):this.fetch=se().platform.fetch,P(t!=null&&t.length>0,function(){return"URL path for http must not be null, undefined or empty."}),Array.isArray(t)&&P(t.length===2,function(){return"URL paths for http must have a length of 2, (actual length is "+t.length+")."}),this.path=t,e.requestInit!=null&&e.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=e.requestInit||{}}return r.prototype.save=function(t){return De(this,void 0,void 0,function(){var e,n,a,i;return Oe(this,function(s){switch(s.label){case 0:if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(e=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,n=[{paths:["./model.weights.bin"],weights:t.weightSpecs}],a={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata,weightsManifest:n},e.body.append("model.json",new Blob([JSON.stringify(a)],{type:"application/json"}),"model.json"),t.weightData!=null&&e.body.append("model.weights.bin",new Blob([t.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,this.fetch(this.path,e)];case 1:if((i=s.sent()).ok)return[2,{modelArtifactsInfo:jc(t),responses:[i]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+i.status+".")}})})},r.prototype.load=function(){return De(this,void 0,void 0,function(){var t,e,n,a,i,s,l,c;return Oe(this,function(f){switch(f.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(t=f.sent()).ok)throw new Error("Request to "+this.path+" failed with status code "+t.status+". Please verify this URL points to the model JSON of the model to load.");f.label=2;case 2:return f.trys.push([2,4,,5]),[4,t.json()];case 3:return e=f.sent(),[3,5];case 4:throw f.sent(),n="Failed to parse model JSON of response from "+this.path+".",this.path.endsWith(".pb")?n+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":n+=" Please make sure the server is serving valid JSON for this request.",new Error(n);case 5:if(a=e.modelTopology,i=e.weightsManifest,a==null&&i==null)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return i==null?[3,7]:[4,this.loadWeights(i)];case 6:c=f.sent(),s=c[0],l=c[1],f.label=7;case 7:return[2,{modelTopology:a,weightSpecs:s,weightData:l}]}})})},r.prototype.loadWeights=function(t){return De(this,void 0,void 0,function(){var e,n,a,i,s,l,c,f,d,p,g;return Oe(this,function(v){switch(v.label){case 0:for(e=Array.isArray(this.path)?this.path[1]:this.path,n=function(b){var w=b.lastIndexOf("/"),S=b.lastIndexOf("?"),x=b.substring(0,w),C=S>w?b.substring(S):"";return[x+"/",C]}(e),a=n[0],i=n[1],s=this.weightPathPrefix||a,l=[],c=0,f=t;c<f.length;c++)d=f[c],l.push.apply(l,d.weights);return p=[],t.forEach(function(b){b.paths.forEach(function(w){p.push(s+w+i)})}),[4,NN(p,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})];case 1:return g=v.sent(),[2,[l,a0(g)]]}})})},r.URL_SCHEME_REGEX=/^https?:\/\//,r}();function Gv(r){return r.match(RN.URL_SCHEME_REGEX)!=null}var DS=function(r,t){return typeof fetch>"u"?null:(Array.isArray(r)?r.every(function(e){return Gv(e)}):Gv(r))?Xv(r,{onProgress:t}):null};function Xv(r,t){return new RN(r,t)}Cr.registerSaveRouter(DS),Cr.registerLoadRouter(DS);var av=function(){function r(t){this.modelArtifacts=t}return r.prototype.load=function(){return De(this,void 0,void 0,function(){return Oe(this,function(t){return[2,this.modelArtifacts]})})},r}(),CF=function(){function r(t){this.saveHandler=t}return r.prototype.save=function(t){return De(this,void 0,void 0,function(){return Oe(this,function(e){return[2,this.saveHandler(t)]})})},r}(),Ar=Object.freeze({browserFiles:function(r){return new EF(r)},browserHTTPRequest:function(r,t){return Xv(r,t)},concatenateArrayBuffers:a0,decodeWeights:EN,encodeWeights:function(r,t){return De(this,void 0,void 0,function(){var e,n,a,i,s,l=this;return Oe(this,function(c){switch(c.label){case 0:for(e=[],n=[],a=Array.isArray(r)?r.map(function(f){return f.name}):Object.keys(r),i=function(f){var d=a[f],p=Array.isArray(r)?r[f].tensor:r[d];if(p.dtype!=="float32"&&p.dtype!=="int32"&&p.dtype!=="bool"&&p.dtype!=="string")throw new Error("Unsupported dtype in weight '"+d+"': "+p.dtype);var g={name:d,shape:p.shape,dtype:p.dtype};if(p.dtype==="string"){var v=new Promise(function(b){return De(l,void 0,void 0,function(){var w,S,x,C,A,T,R;return Oe(this,function(O){switch(O.label){case 0:return[4,p.bytes()];case 1:for(w=O.sent(),S=w.reduce(function(N,D){return N+D.length},0)+od*w.length,x=new Uint8Array(S),C=0,A=0;A<w.length;A++)T=w[A],R=new Uint8Array(new Uint32Array([T.length]).buffer),x.set(R,C),C+=od,x.set(T,C),C+=T.length;return b(x),[2]}})})});n.push(v)}else n.push(p.data());t!=null&&(g.group=t),e.push(g)},s=0;s<a.length;++s)i(s);return[4,Promise.all(n)];case 1:return[2,{data:hF(c.sent()),specs:e}]}})})},fromMemory:function(r,t,e,n){return arguments.length===1?r.modelTopology!=null||r.weightSpecs!=null?new av(r):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new av({modelTopology:r})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new av({modelTopology:r,weightSpecs:t,weightData:e,trainingConfig:n}))},getLoadHandlers:function(r,t){return Cr.getLoadHandlers(r,t)},getModelArtifactsInfoForJSON:jc,getSaveHandlers:function(r){return Cr.getSaveHandlers(r)},http:Xv,isHTTPScheme:Gv,loadWeights:function(r,t,e,n){return t===void 0&&(t=""),De(this,void 0,void 0,function(){return Oe(this,function(a){return[2,kS(function(i){return NN(i,{requestInit:n})})(r,t,e)]})})},registerLoadRouter:function(r){return Cr.registerLoadRouter(r)},registerSaveRouter:function(r){return Cr.registerSaveRouter(r)},weightsLoaderFactory:kS,withSaveHandler:function(r){return new CF(r)},copyModel:function(r,t){return De(this,void 0,void 0,function(){return Oe(this,function(e){return[2,AS(r,t,!1)]})})},listModels:function(){return De(this,void 0,void 0,function(){var r,t,e,n,a,i,s;return Oe(this,function(l){switch(l.label){case 0:r=Zi.getSchemes(),t={},e=0,n=r,l.label=1;case 1:return e<n.length?(a=n[e],[4,Zi.getManager(a).listModels()]):[3,4];case 2:for(s in i=l.sent())t[a+pu+s]=i[s];l.label=3;case 3:return e++,[3,1];case 4:return[2,t]}})})},moveModel:function(r,t){return De(this,void 0,void 0,function(){return Oe(this,function(e){return[2,AS(r,t,!0)]})})},removeModel:function(r){return De(this,void 0,void 0,function(){var t;return Oe(this,function(e){return t=Bh(r),[2,Zi.getManager(t.scheme).removeModel(t.path)]})})}}),AF=K({confusionMatrix_:function(r,t,e){var n=U(r,"labels","confusionMatrix"),a=U(t,"predictions","confusionMatrix");P(e==null||e>0&&Number.isInteger(e),function(){return"If provided, numClasses must be a positive integer, but got "+e}),P(n.rank===1,function(){return"Expected the rank of labels to be 1, but got "+n.rank}),P(a.rank===1,function(){return"Expected the rank of predictions to be 1, but got "+a.rank}),P(n.shape[0]===a.shape[0],function(){return"Mismatch in the number of examples: "+n.shape[0]+" vs. "+a.shape[0]+". Labels and predictions should have the same number of elements."}),P(e>0&&Number.isInteger(e),function(){return"numClasses is required to be a positive integer, but got "+e});var i=bu(n.asType("int32"),e),s=bu(a.asType("int32"),e);return i.transpose().matMul(s).asType("int32")}}),TF=Object.freeze({confusionMatrix:AF}),NF=K({fromPixels_:function(r,t){if(t===void 0&&(t=3),t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");var e=typeof HTMLVideoElement<"u"&&r instanceof HTMLVideoElement;if(e&&e&&r.readyState<2)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.");return $.fromPixels(r,t)}}),IN=Object.freeze({toPixels:function(r,t){return De(this,void 0,void 0,function(){var e,n,a,i,s,l,c,f,d,p,g,v,b,w,S,x,C,A,T,R,O,N,D;return Oe(this,function(I){switch(I.label){case 0:if(e=U(r,"img","toPixels"),r instanceof Ct||(e=e.toInt()),e.rank!==2&&e.rank!==3)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+e.rank+".");if(n=e.shape.slice(0,2),a=n[0],i=n[1],(s=e.rank===2?1:e.shape[2])>4||s===2)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+s);return[4,e.data()];case 1:return l=I.sent(),c=e.min(),f=e.max(),[4,Promise.all([c.data(),f.data()])];case 2:if(d=I.sent(),p=d[0],g=d[1],v=p[0],b=g[0],c.dispose(),f.dispose(),e.dtype==="float32"){if(v<0||b>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+v+" - "+b+"].")}else{if(e.dtype!=="int32")throw new Error("Unsupported type for toPixels: "+e.dtype+". Please use float32 or int32 tensors.");if(v<0||b>255)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+v+" - "+b+"].")}for(w=e.dtype==="float32"?255:1,S=new Uint8ClampedArray(i*a*4),x=0;x<a*i;++x)C=void 0,A=void 0,T=void 0,R=void 0,s===1?(C=l[x]*w,A=l[x]*w,T=l[x]*w,R=255):s===3?(C=l[3*x]*w,A=l[3*x+1]*w,T=l[3*x+2]*w,R=255):s===4&&(C=l[4*x]*w,A=l[4*x+1]*w,T=l[4*x+2]*w,R=l[4*x+3]*w),S[0+(O=4*x)]=Math.round(C),S[O+1]=Math.round(A),S[O+2]=Math.round(T),S[O+3]=Math.round(R);return t!=null&&(t.width=i,t.height=a,N=t.getContext("2d"),D=new ImageData(S,i,a),N.putImageData(D,0,0)),e!==r&&e.dispose(),[2,S]}})})},fromPixels:NF}),kN=function(){function r(){}return r.prototype.getClassName=function(){return this.constructor.className},r.fromConfig=function(t,e){return new t(e)},r}(),DN=function(){function r(){this.classNameMap={}}return r.getMap=function(){return r.instance==null&&(r.instance=new r),r.instance},r.register=function(t){r.getMap().classNameMap[t.className]=[t,t.fromConfig]},r}();function co(r){P(r.className!=null,function(){return"Class being registered does not have the static className property defined."}),P(typeof r.className=="string",function(){return"className is required to be a string, but got type "+typeof r.className}),P(r.className.length>0,function(){return"Class being registered has an empty-string as its className, which is disallowed."}),DN.register(r)}var be=Object.freeze({Serializable:kN,SerializationMap:DN,registerClass:co}),RF=.001,ON=.1;function iv(){return $.backend.floatPrecision()===32?RF:ON}function ov(r,t,e){var n=!0;if((Fn(r)||Fn(t))&&(n=!1),Fn(r)&&Fn(t)&&(n=!0),n){var a=r.constructor.name,i=t.constructor.name;if(a!==i)throw new Error("Arrays are of different type. Actual: "+a+". Expected: "+i)}if(Array.isArray(r)&&Array.isArray(t)){var s=Ra(r),l=Ra(t);if(!kn(s,l))throw new Error("Arrays have different shapes. Actual: ["+s+"]. Expected: ["+l+"]")}var c=Fn(r)?r:li(r),f=Fn(t)?t:li(t);if(c.length!==f.length)throw new Error("Arrays have different lengths actual: "+c.length+" vs expected: "+f.length+`.
Actual:   `+c+`.
Expected: `+f+".");for(var d=0;d<f.length;++d){var p=c[d],g=f[d];if(!e(p,g))throw new Error("Arrays differ: actual["+d+"] = "+p+", expected["+d+"] = "+g+`.
Actual:   `+c+`.
Expected: `+f+".")}}function sv(r,t,e){return!isFinite(r)&&!isFinite(t)||!(isNaN(r)||isNaN(t)||Math.abs(r-t)>e)}var IF=Object.freeze({TEST_EPSILON_FLOAT16:ON,expectArraysClose:function(r,t,e){return e==null&&(e=iv()),ov(r,t,function(n,a){return sv(n,a,e)})},testEpsilon:iv,expectPromiseToFail:function(r,t){r().then(function(){return t.fail()},function(){return t()})},expectArraysEqual:function(r,t){var e=typeof t=="string"||typeof t=="number"||typeof t=="boolean"?[t]:t;return Gi(r)||Gi(r[0])||Gi(t)||Gi(t[0])?ov(r,e,function(n,a){return n==a}):ov(r,t,function(n,a){return sv(n,a,0)})},expectNumbersClose:function(r,t,e){if(e==null&&(e=iv()),!sv(r,t,e))throw new Error("Numbers differ: actual === "+r+", expected === "+t)},expectValuesInRange:function(r,t,e){for(var n=0;n<r.length;n++)if(r[n]<t||r[n]>e)throw new Error("Value out of range:"+r[n]+" low: "+t+", high: "+e)},expectArrayBuffersEqual:function(r,t){expect(new Float32Array(r)).toEqual(new Float32Array(t))}}),_N="1.3.1",kF=Object.freeze({gpgpu_util:eL,webgl_util:kz,forceHalfFloat:function(){se().set("WEBGL_FORCE_F16_TEXTURES",!0)},MathBackendWebGL:xT,setWebGLContext:YC,GPGPUContext:pT}),vi=function(r){function t(){return r!==null&&r.apply(this,arguments)||this}return la(t,r),t.prototype.minimize=function(e,n,a){n===void 0&&(n=!1);var i=this.computeGradients(e,a),s=i.value,l=i.grads;if(a!=null){var c=a.map(function(f){return{name:f.name,tensor:l[f.name]}});this.applyGradients(c)}else this.applyGradients(l);return et(l),n?s:(s.dispose(),null)},Object.defineProperty(t.prototype,"iterations",{get:function(){return this.iterations_==null&&(this.iterations_=0),this.iterations_},enumerable:!0,configurable:!0}),t.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},t.prototype.computeGradients=function(e,n){return WA(e,n)},t.prototype.dispose=function(){this.iterations_!=null&&et(this.iterations_)},t.prototype.saveIterations=function(){return De(this,void 0,void 0,function(){return Oe(this,function(e){return this.iterations_==null&&(this.iterations_=0),[2,{name:"iter",tensor:Re(this.iterations_,"int32")}]})})},t.prototype.getWeights=function(){return De(this,void 0,void 0,function(){return Oe(this,function(e){throw new Error("getWeights() is not implemented for this optimizer yet.")})})},t.prototype.setWeights=function(e){return De(this,void 0,void 0,function(){return Oe(this,function(n){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())})})},t.prototype.extractIterations=function(e){return De(this,void 0,void 0,function(){var n;return Oe(this,function(a){switch(a.label){case 0:return n=this,[4,e[0].tensor.data()];case 1:return n.iterations_=a.sent()[0],[2,e.slice(1)]}})})},t}(kN);Object.defineProperty(vi,Symbol.hasInstance,{value:function(r){return r.minimize!=null&&r.computeGradients!=null&&r.applyGradients!=null}});var i0=function(r){function t(e,n,a){a===void 0&&(a=null);var i=r.call(this)||this;return i.learningRate=e,i.rho=n,i.epsilon=a,i.accumulatedGrads=[],i.accumulatedUpdates=[],a==null&&(i.epsilon=$.backend.epsilon()),i}return la(t,r),t.prototype.applyGradients=function(e){var n=this;(Array.isArray(e)?e.map(function(a){return a.name}):Object.keys(e)).forEach(function(a,i){var s=$.registeredVariables[a];n.accumulatedGrads[i]==null&&(n.accumulatedGrads[i]={originalName:a+"/accum_grad",variable:ae(function(){return ct(s).variable(!1)})}),n.accumulatedUpdates[i]==null&&(n.accumulatedUpdates[i]={originalName:a+"/accum_var",variable:ae(function(){return ct(s).variable(!1)})});var l=Array.isArray(e)?e[i].tensor:e[a];if(l!=null){var c=n.accumulatedGrads[i].variable,f=n.accumulatedUpdates[i].variable;ae(function(){var d=c.mul(n.rho).add(l.square().mul(1-n.rho)),p=f.add(n.epsilon).sqrt().div(c.add(n.epsilon).sqrt()).mul(l),g=f.mul(n.rho).add(p.square().mul(1-n.rho));c.assign(d),f.assign(g);var v=p.mul(-n.learningRate).add(s);s.assign(v)})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedUpdates!=null&&(et(this.accumulatedGrads.map(function(e){return e.variable})),et(this.accumulatedUpdates.map(function(e){return e.variable})))},t.prototype.getWeights=function(){return De(this,void 0,void 0,function(){var e;return Oe(this,function(n){switch(n.label){case 0:return e=this.accumulatedGrads.concat(this.accumulatedUpdates),[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(e.map(function(a){return{name:a.originalName,tensor:a.variable}}))]}})})},t.prototype.setWeights=function(e){return De(this,void 0,void 0,function(){var n;return Oe(this,function(a){switch(a.label){case 0:return[4,this.extractIterations(e)];case 1:return e=a.sent(),n=e.length/2,this.accumulatedGrads=e.slice(0,n).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.accumulatedUpdates=e.slice(n,2*n).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},t.fromConfig=function(e,n){return new e(n.learningRate,n.rho,n.epsilon)},t.className="Adadelta",t}(vi);co(i0);var o0=function(r){function t(e,n){n===void 0&&(n=.1);var a=r.call(this)||this;return a.learningRate=e,a.initialAccumulatorValue=n,a.accumulatedGrads=[],a}return la(t,r),t.prototype.applyGradients=function(e){var n=this;(Array.isArray(e)?e.map(function(a){return a.name}):Object.keys(e)).forEach(function(a,i){var s=$.registeredVariables[a];n.accumulatedGrads[i]==null&&(n.accumulatedGrads[i]={originalName:a+"/accumulator",variable:ae(function(){return zu(s.shape,n.initialAccumulatorValue).variable(!1)})});var l=Array.isArray(e)?e[i].tensor:e[a];if(l!=null){var c=n.accumulatedGrads[i].variable;ae(function(){var f=c.add(l.square());c.assign(f);var d=l.div(f.add($.backend.epsilon()).sqrt()).mul(-n.learningRate).add(s);s.assign(d)})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedGrads!=null&&et(this.accumulatedGrads.map(function(e){return e.variable}))},t.prototype.getWeights=function(){return De(this,void 0,void 0,function(){return Oe(this,function(e){switch(e.label){case 0:return[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(this.accumulatedGrads.map(function(n){return{name:n.originalName,tensor:n.variable}}))]}})})},t.prototype.setWeights=function(e){return De(this,void 0,void 0,function(){return Oe(this,function(n){switch(n.label){case 0:return[4,this.extractIterations(e)];case 1:return e=n.sent(),this.accumulatedGrads=e.map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},t.fromConfig=function(e,n){return new e(n.learningRate,n.initialAccumulatorValue)},t.className="Adagrad",t}(vi);co(o0);var s0=function(r){function t(e,n,a,i){i===void 0&&(i=null);var s=r.call(this)||this;return s.learningRate=e,s.beta1=n,s.beta2=a,s.epsilon=i,s.accumulatedFirstMoment=[],s.accumulatedSecondMoment=[],ae(function(){s.accBeta1=Re(n).variable(),s.accBeta2=Re(a).variable()}),i==null&&(s.epsilon=$.backend.epsilon()),s}return la(t,r),t.prototype.applyGradients=function(e){var n=this,a=Array.isArray(e)?e.map(function(i){return i.name}):Object.keys(e);ae(function(){var i=Dn(1,n.accBeta1),s=Dn(1,n.accBeta2);a.forEach(function(l,c){var f=$.registeredVariables[l];n.accumulatedFirstMoment[c]==null&&(n.accumulatedFirstMoment[c]={originalName:l+"/m",variable:ae(function(){return ct(f).variable(!1)})}),n.accumulatedSecondMoment[c]==null&&(n.accumulatedSecondMoment[c]={originalName:l+"/v",variable:ae(function(){return ct(f).variable(!1)})});var d=Array.isArray(e)?e[c].tensor:e[l];if(d!=null){var p=n.accumulatedFirstMoment[c].variable,g=n.accumulatedSecondMoment[c].variable,v=p.mul(n.beta1).add(d.mul(1-n.beta1)),b=g.mul(n.beta2).add(d.square().mul(1-n.beta2)),w=v.div(i),S=b.div(s);p.assign(v),g.assign(b);var x=w.div(S.sqrt().add(n.epsilon)).mul(-n.learningRate).add(f);f.assign(x)}}),n.accBeta1.assign(n.accBeta1.mul(n.beta1)),n.accBeta2.assign(n.accBeta2.mul(n.beta2))}),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&et(this.accumulatedFirstMoment.map(function(e){return e.variable})),this.accumulatedSecondMoment!=null&&et(this.accumulatedSecondMoment.map(function(e){return e.variable}))},t.prototype.getWeights=function(){return De(this,void 0,void 0,function(){var e;return Oe(this,function(n){switch(n.label){case 0:return e=this.accumulatedFirstMoment.concat(this.accumulatedSecondMoment),[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(e.map(function(a){return{name:a.originalName,tensor:a.variable}}))]}})})},t.prototype.setWeights=function(e){return De(this,void 0,void 0,function(){var n,a=this;return Oe(this,function(i){switch(i.label){case 0:return[4,this.extractIterations(e)];case 1:return e=i.sent(),ae(function(){a.accBeta1.assign(xu(a.beta1,a.iterations_+1)),a.accBeta2.assign(xu(a.beta2,a.iterations_+1))}),n=e.length/2,this.accumulatedFirstMoment=e.slice(0,n).map(function(s){return{originalName:s.name,variable:s.tensor.variable(!1)}}),this.accumulatedSecondMoment=e.slice(n,2*n).map(function(s){return{originalName:s.name,variable:s.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},t.fromConfig=function(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon)},t.className="Adam",t}(vi);co(s0);var u0=function(r){function t(e,n,a,i,s){i===void 0&&(i=null),s===void 0&&(s=0);var l=r.call(this)||this;return l.learningRate=e,l.beta1=n,l.beta2=a,l.epsilon=i,l.decay=s,l.accumulatedFirstMoment=[],l.accumulatedWeightedInfNorm=[],ae(function(){l.iteration=Re(0).variable(),l.accBeta1=Re(n).variable()}),i==null&&(l.epsilon=$.backend.epsilon()),l}return la(t,r),t.prototype.applyGradients=function(e){var n=this,a=Array.isArray(e)?e.map(function(i){return i.name}):Object.keys(e);ae(function(){var i=Dn(1,n.accBeta1),s=Xn(-n.learningRate,n.iteration.mul(n.decay).add(1));a.forEach(function(l,c){var f=$.registeredVariables[l];n.accumulatedFirstMoment[c]==null&&(n.accumulatedFirstMoment[c]={originalName:l+"/m",variable:ct(f).variable(!1)}),n.accumulatedWeightedInfNorm[c]==null&&(n.accumulatedWeightedInfNorm[c]={originalName:l+"/v",variable:ct(f).variable(!1)});var d=Array.isArray(e)?e[c].tensor:e[l];if(d!=null){var p=n.accumulatedFirstMoment[c].variable,g=n.accumulatedWeightedInfNorm[c].variable,v=p.mul(n.beta1).add(d.mul(1-n.beta1)),b=g.mul(n.beta2),w=d.abs(),S=b.maximum(w);p.assign(v),g.assign(S);var x=s.div(i).mul(v.div(S.add(n.epsilon))).add(f);f.assign(x)}}),n.iteration.assign(n.iteration.add(1)),n.accBeta1.assign(n.accBeta1.mul(n.beta1))}),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&et(this.accumulatedFirstMoment.map(function(e){return e.variable})),this.accumulatedWeightedInfNorm!=null&&et(this.accumulatedWeightedInfNorm.map(function(e){return e.variable}))},t.prototype.getWeights=function(){return De(this,void 0,void 0,function(){return Oe(this,function(e){throw new Error("getWeights() is not implemented for Adamax yet.")})})},t.prototype.setWeights=function(e){return De(this,void 0,void 0,function(){return Oe(this,function(n){throw new Error("setWeights() is not implemented for Adamax yet.")})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},t.fromConfig=function(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon,n.decay)},t.className="Adamax",t}(vi);co(u0);var sp=function(r){function t(e){var n=r.call(this)||this;return n.learningRate=e,n.setLearningRate(e),n}return la(t,r),t.prototype.applyGradients=function(e){var n=this;(Array.isArray(e)?e.map(function(a){return a.name}):Object.keys(e)).forEach(function(a,i){var s=Array.isArray(e)?e[i].tensor:e[a];if(s!=null){var l=$.registeredVariables[a];ae(function(){var c=n.c.mul(s).add(l);l.assign(c)})}}),this.incrementIterations()},t.prototype.setLearningRate=function(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=Na(Re(-e))},t.prototype.dispose=function(){this.c.dispose()},t.prototype.getWeights=function(){return De(this,void 0,void 0,function(){return Oe(this,function(e){switch(e.label){case 0:return[4,this.saveIterations()];case 1:return[2,[e.sent()]]}})})},t.prototype.setWeights=function(e){return De(this,void 0,void 0,function(){return Oe(this,function(n){switch(n.label){case 0:return[4,this.extractIterations(e)];case 1:if((e=n.sent()).length!==0)throw new Error("SGD optimizer does not have settable weights.");return[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate}},t.fromConfig=function(e,n){return new e(n.learningRate)},t.className="SGD",t}(vi);co(sp);var l0=function(r){function t(e,n,a){a===void 0&&(a=!1);var i=r.call(this,e)||this;return i.learningRate=e,i.momentum=n,i.useNesterov=a,i.accumulations=[],i.m=Re(i.momentum),i}return la(t,r),t.prototype.applyGradients=function(e){var n=this;(Array.isArray(e)?e.map(function(a){return a.name}):Object.keys(e)).forEach(function(a,i){var s=$.registeredVariables[a];n.accumulations[i]==null&&(n.accumulations[i]={originalName:a+"/momentum",variable:ae(function(){return ct(s).variable(!1)})});var l=n.accumulations[i].variable,c=Array.isArray(e)?e[i].tensor:e[a];c!=null&&ae(function(){var f,d=n.m.mul(l).add(c);f=n.useNesterov?n.c.mul(c.add(d.mul(n.m))).add(s):n.c.mul(d).add(s),l.assign(d),s.assign(f)})}),this.incrementIterations()},t.prototype.dispose=function(){this.m.dispose(),this.accumulations!=null&&et(this.accumulations.map(function(e){return e.variable}))},t.prototype.setMomentum=function(e){this.momentum=e},t.prototype.getWeights=function(){return De(this,void 0,void 0,function(){return Oe(this,function(e){switch(e.label){case 0:return[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(this.accumulations.map(function(n){return{name:n.originalName,tensor:n.variable}}))]}})})},t.prototype.setWeights=function(e){return De(this,void 0,void 0,function(){return Oe(this,function(n){switch(n.label){case 0:return[4,this.extractIterations(e)];case 1:return e=n.sent(),this.accumulations=e.map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},t.fromConfig=function(e,n){return new e(n.learningRate,n.momentum,n.useNesterov)},t.className="Momentum",t}(sp);co(l0);var c0=function(r){function t(e,n,a,i,s){n===void 0&&(n=.9),a===void 0&&(a=0),i===void 0&&(i=null),s===void 0&&(s=!1);var l=r.call(this)||this;return l.learningRate=e,l.decay=n,l.momentum=a,l.epsilon=i,l.accumulatedMeanSquares=[],l.accumulatedMoments=[],l.accumulatedMeanGrads=[],l.centered=s,i==null&&(l.epsilon=$.backend.epsilon()),l}return la(t,r),t.prototype.applyGradients=function(e){var n=this;(Array.isArray(e)?e.map(function(a){return a.name}):Object.keys(e)).forEach(function(a,i){var s=$.registeredVariables[a];n.accumulatedMeanSquares[i]==null&&(n.accumulatedMeanSquares[i]={originalName:a+"/rms",variable:ae(function(){return ct(s).variable(!1)})}),n.accumulatedMoments[i]==null&&(n.accumulatedMoments[i]={originalName:a+"/momentum",variable:ae(function(){return ct(s).variable(!1)})}),n.accumulatedMeanGrads[i]==null&&n.centered&&(n.accumulatedMeanGrads[i]={originalName:a+"/mg",variable:ae(function(){return ct(s).variable(!1)})});var l=Array.isArray(e)?e[i].tensor:e[a];if(l!=null){var c=n.accumulatedMeanSquares[i].variable,f=n.accumulatedMoments[i].variable;ae(function(){var d=c.mul(n.decay).add(l.square().mul(1-n.decay));if(n.centered){var p=n.accumulatedMeanGrads[i].variable,g=p.mul(n.decay).add(l.mul(1-n.decay)),v=f.mul(n.momentum).add(l.mul(n.learningRate).div(d.sub(g.square().add(n.epsilon)).sqrt()));c.assign(d),p.assign(g),f.assign(v);var b=s.sub(v);s.assign(b)}else{var w=c.mul(n.decay).add(l.square().mul(1-n.decay));v=f.mul(n.momentum).add(l.mul(n.learningRate).div(w.add(n.epsilon).sqrt())),c.assign(w),f.assign(v),b=s.sub(v),s.assign(b)}})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedMeanSquares!=null&&et(this.accumulatedMeanSquares.map(function(e){return e.variable})),this.accumulatedMeanGrads!=null&&this.centered&&et(this.accumulatedMeanGrads.map(function(e){return e.variable})),this.accumulatedMoments!=null&&et(this.accumulatedMoments.map(function(e){return e.variable}))},t.prototype.getWeights=function(){return De(this,void 0,void 0,function(){var e;return Oe(this,function(n){switch(n.label){case 0:return e=this.accumulatedMeanSquares.concat(this.accumulatedMoments),this.centered&&e.push.apply(e,this.accumulatedMeanGrads),[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(e.map(function(a){return{name:a.originalName,tensor:a.variable}}))]}})})},t.prototype.setWeights=function(e){return De(this,void 0,void 0,function(){var n;return Oe(this,function(a){switch(a.label){case 0:return[4,this.extractIterations(e)];case 1:return e=a.sent(),n=this.centered?e.length/3:e.length/2,this.accumulatedMeanSquares=e.slice(0,n).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.accumulatedMoments=e.slice(n,2*n).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.centered&&(this.accumulatedMeanGrads=e.slice(2*n,3*n).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}})),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},t.fromConfig=function(e,n){return new e(n.learningRate,n.decay,n.momentum,n.epsilon,n.centered)},t.className="RMSProp",t}(vi);co(c0);var zo=function(){function r(){}return r.sgd=function(t){return new sp(t)},r.momentum=function(t,e,n){return n===void 0&&(n=!1),new l0(t,e,n)},r.rmsprop=function(t,e,n,a,i){return e===void 0&&(e=.9),n===void 0&&(n=0),a===void 0&&(a=null),i===void 0&&(i=!1),new c0(t,e,n,a,i)},r.adam=function(t,e,n,a){return t===void 0&&(t=.001),e===void 0&&(e=.9),n===void 0&&(n=.999),a===void 0&&(a=null),new s0(t,e,n,a)},r.adadelta=function(t,e,n){return t===void 0&&(t=.001),e===void 0&&(e=.95),n===void 0&&(n=null),new i0(t,e,n)},r.adamax=function(t,e,n,a,i){return t===void 0&&(t=.002),e===void 0&&(e=.9),n===void 0&&(n=.999),a===void 0&&(a=null),i===void 0&&(i=0),new u0(t,e,n,a,i)},r.adagrad=function(t,e){return e===void 0&&(e=.1),new o0(t,e)},r}(),Uo={sgd:zo.sgd,momentum:zo.momentum,adadelta:zo.adadelta,adagrad:zo.adagrad,rmsprop:zo.rmsprop,adamax:zo.adamax,adam:zo.adam},DF=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:function(r){return r()};function Uh(){return new Promise(function(r){return DF(function(){return r()})})}ue=sF;/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var MN=function(r,t){return(MN=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var a in n)n.hasOwnProperty(a)&&(e[a]=n[a])})(r,t)};function pe(r,t){function e(){this.constructor=r}MN(r,t),r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var uv,ec=function(){return(ec=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++)for(var a in t=arguments[e])Object.prototype.hasOwnProperty.call(t,a)&&(r[a]=t[a]);return r}).apply(this,arguments)};function He(r,t,e,n){return new(e||(e=Promise))(function(a,i){function s(f){try{c(n.next(f))}catch(d){i(d)}}function l(f){try{c(n.throw(f))}catch(d){i(d)}}function c(f){f.done?a(f.value):new e(function(d){d(f.value)}).then(s,l)}c((n=n.apply(r,[])).next())})}function Ve(r,t){var e,n,a,i,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function l(c){return function(f){return function(d){if(e)throw new TypeError("Generator is already executing.");for(;s;)try{if(e=1,n&&(a=2&d[0]?n.return:d[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,d[1])).done)return a;switch(n=0,a&&(d=[2&d[0],a.value]),d[0]){case 0:case 1:a=d;break;case 4:return s.label++,{value:d[1],done:!1};case 5:s.label++,n=d[1],d=[0];continue;case 7:d=s.ops.pop(),s.trys.pop();continue;default:if(!(a=(a=s.trys).length>0&&a[a.length-1])&&(d[0]===6||d[0]===2)){s=0;continue}if(d[0]===3&&(!a||d[1]>a[0]&&d[1]<a[3])){s.label=d[1];break}if(d[0]===6&&s.label<a[1]){s.label=a[1],a=d;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(d);break}a[2]&&s.ops.pop(),s.trys.pop();continue}d=t.call(r,s)}catch(p){d=[6,p],n=0}finally{e=a=0}if(5&d[0])throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}([c,f])}}}function fn(){return uv==null&&(uv=SA().epsilon()),uv}function oa(){return"channelsLast"}var Po=function(r){function t(e){var n=r.call(this,e)||this;return Object.setPrototypeOf(n,t.prototype),n}return pe(t,r),t}(Error),Ca=function(r){function t(e){var n=r.call(this,e)||this;return Object.setPrototypeOf(n,t.prototype),n}return pe(t,r),t}(Error),ee=function(r){function t(e){var n=r.call(this,e)||this;return Object.setPrototypeOf(n,t.prototype),n}return pe(t,r),t}(Error),tt=function(r){function t(e){var n=r.call(this,e)||this;return Object.setPrototypeOf(n,t.prototype),n}return pe(t,r),t}(Error),OF=function(r){function t(e){var n=r.call(this,e)||this;return Object.setPrototypeOf(n,t.prototype),n}return pe(t,r),t}(Error);(function(r){function t(e){var n=r.call(this,e)||this;return Object.setPrototypeOf(n,t.prototype),n}return pe(t,r),t})(Error);function rs(r,t){if(Array.isArray(r)){for(var e=[],n=0;n<t;n++)e=e.concat(r);return e}return(e=new Array(t)).fill(r),e}function xa(r,t){if(!r)throw new OF(t)}function OS(r,t){for(var e=0,n=0,a=r;n<a.length;n++)a[n]===t&&e++;return e}function Yn(r){return r.length===1?r[0]:r}function _t(r){return Array.isArray(r)?r:[r]}function ti(r){var t=r.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return t[0]!=="_"?t:"private"+t}function jo(r){return r.length<=1||r.indexOf("_")===-1?r:r.replace(/[_]+(\w|$)/g,function(t,e){return e.toUpperCase()})}var qr={};function f0(r){if(r==null)return null;var t={};return t.className=r.getClassName(),t.config=r.getConfig(),t}function $v(r){if(r!=null&&typeof r=="object")if(Array.isArray(r))r.forEach(function(i){return $v(i)});else for(var t=0,e=Object.keys(r);t<e.length;t++){var n=e[t],a=r[n];a!=null&&typeof a=="object"&&(Array.isArray(a)||a.type!=="ndarray"||typeof a.value!="number"?$v(a):r[n]=a.value)}}function Wc(r,t,e,n,a){var i,s,l;if(t===void 0&&(t={}),e===void 0&&(e={}),n===void 0&&(n="object"),a===void 0&&(a=!1),typeof r=="string"){var c=r,f=void 0;if(c in e)f=e[c];else if(c in qr)f=qr[c];else if((f=t[c])==null)throw new ee("Unknown "+n+": "+r+`. This may be due to one of the following reasons:
1. The `+n+` is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom `+n+" is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().");return f}var d=r;if(d.className==null||d.config==null)throw new ee(n+": Improper config format: "+JSON.stringify(d)+`.
'className' and 'config' must set.`);var p=d.className,g=void 0,v=void 0;if(p in e?(g=(i=e[p])[0],v=i[1]):p in qr?(g=(s=qr.className)[0],v=s[1]):p in t&&(g=(l=t[p])[0],v=l[1]),g==null)throw new ee("Unknown "+n+": "+p+`. This may be due to one of the following reasons:
1. The `+n+` is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom `+n+" is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().");if(v!=null){for(var b={},w=0,S=Object.keys(qr);w<S.length;w++)b[O=S[w]]=qr[O];for(var x=0,C=Object.keys(e);x<C.length;x++)b[O=C[x]]=e[O];d.config.customObjects=b;for(var A=ec({},qr),T=0,R=Object.keys(e);T<R.length;T++){var O=R[T];qr[O]=e[O]}$v(d.config);var N=v(g,d.config,e,a);return qr=ec({},A),N}A=ec({},qr);for(var D=0,I=Object.keys(e);D<I.length;D++)O=I[D],qr[O]=e[O];return N=new g(d.config),qr=ec({},A),N}function _F(r,t){return r<t?-1:r>t?1:0}function wh(r,t){return-1*_F(r,t)}function Qi(r){if(r==null)return r;for(var t=[],e=0,n=r;e<n.length;e++){var a=n[e];t.indexOf(a)===-1&&t.push(a)}return t}function MF(r){if(r==null)throw new ee("Invalid value in obj: "+JSON.stringify(r));for(var t in r)if(r.hasOwnProperty(t))return!1;return!0}function ju(r,t,e){if(e!=null&&r.indexOf(e)<0)throw new ee(e+" is not a valid "+t+".  Valid values are "+r+" or null/undefined.")}function h0(r,t,e,n){return n===void 0&&(n=1/0),xa(e>=0),xa(n>=e),Array.isArray(r)&&r.length>=e&&r.length<=n&&r.every(function(a){return typeof a===t})}function er(r,t){Array.isArray(r)?(Be.assert(r.length>0,function(){return t+" is unexpectedly an empty array."}),r.forEach(function(e,n){return er(e,"element "+(n+1)+" of "+t)})):Be.assert(Number.isInteger(r)&&r>0,function(){return"Expected "+t+" to be a positive integer, but got "+zN(r)+"."})}function zN(r){return r===null?"null":Array.isArray(r)?"["+r.map(function(t){return zN(t)}).join(",")+"]":typeof r=="string"?'"'+r+'"':""+r}function zF(r,t){var e,n=Be.now();return function(){for(var a=[],i=0;i<arguments.length;i++)a[i]=arguments[i];var s=Be.now();return s-n<t?e:(n=s,e=r.apply(void 0,a))}}function LN(r){return r==="relu"?"relu":r==="linear"?"linear":r==="elu"?"elu":null}function d0(r,t){return ae(function(){return Mc(hr(Vd(r,r),t,!0))})}var Hc=function(r){function t(){return r!==null&&r.apply(this,arguments)||this}return pe(t,r),t.prototype.getConfig=function(){return{}},t}(be.Serializable),FN=function(r){function t(e){var n=r.call(this)||this;return n.defaultMaxValue=2,n.defaultAxis=0,n.maxValue=e.maxValue!=null?e.maxValue:n.defaultMaxValue,n.axis=e.axis!=null?e.axis:n.defaultAxis,n}return pe(t,r),t.prototype.apply=function(e){var n=this;return ae(function(){var a=d0(e,n.axis),i=Jn(a,0,n.maxValue);return Xe(e,Xn(i,ot(fn(),a)))})},t.prototype.getConfig=function(){return{maxValue:this.maxValue,axis:this.axis}},t.className="MaxNorm",t}(Hc);be.registerClass(FN);var BN=function(r){function t(e){var n=r.call(this)||this;return n.defaultAxis=0,n.axis=e.axis!=null?e.axis:n.defaultAxis,n}return pe(t,r),t.prototype.apply=function(e){var n=this;return ae(function(){return Xn(e,ot(fn(),d0(e,n.axis)))})},t.prototype.getConfig=function(){return{axis:this.axis}},t.className="UnitNorm",t}(Hc);be.registerClass(BN);var UN=function(r){function t(){return r!==null&&r.apply(this,arguments)||this}return pe(t,r),t.prototype.apply=function(e){return lo(e)},t.className="NonNeg",t}(Hc);be.registerClass(UN);var PN=function(r){function t(e){var n=r.call(this)||this;return n.defaultMinValue=0,n.defaultMaxValue=1,n.defaultRate=1,n.defaultAxis=0,n.minValue=e.minValue!=null?e.minValue:n.defaultMinValue,n.maxValue=e.maxValue!=null?e.maxValue:n.defaultMaxValue,n.rate=e.rate!=null?e.rate:n.defaultRate,n.axis=e.axis!=null?e.axis:n.defaultAxis,n}return pe(t,r),t.prototype.apply=function(e){var n=this;return ae(function(){var a=d0(e,n.axis),i=ot(Xe(n.rate,Jn(a,n.minValue,n.maxValue)),Xe(1-n.rate,a));return Xe(e,Xn(i,ot(fn(),a)))})},t.prototype.getConfig=function(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}},t.className="MinMaxNorm",t}(Hc);be.registerClass(PN);var _S={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function At(r){return f0(r)}function MS(r,t){return t===void 0&&(t={}),Wc(r,be.SerializationMap.getMap().classNameMap,t,"constraint")}function hn(r){return r==null?null:typeof r=="string"?MS({className:r in _S?_S[r]:r,config:{}}):r instanceof Hc?r:MS(r)}function LF(r){return new FN(r)}function FF(r){return new BN(r)}function BF(){return new UN}function UF(r){return new PN(r)}var PF=Object.freeze({maxNorm:LF,unitNorm:FF,nonNeg:BF,minMaxNorm:UF}),VF=["channelsFirst","channelsLast"],jF=["valid","same","causal"],WF=["max","avg"],HF=["sum","mul","concat","ave"],iu=new Map;function pn(r){ju(VF,"DataFormat",r)}function Xr(r){ju(jF,"PaddingMode",r)}function VN(r){ju(WF,"PoolMode",r)}var ic=[],zS="/";function Ko(r,t){ic.push(r);try{var e=t();return ic.pop(),e}catch(n){throw ic.pop(),n}}function qF(){return ic.length===0?"":ic.join(zS)+zS}function jN(r){if(!HN(r))throw new Error("Not a valid tensor name: '"+r+"'");return qF()+r}function WN(r){if(!HN(r))throw new Error("Not a valid tensor name: '"+r+"'");iu.has(r)||iu.set(r,0);var t=iu.get(r);if(iu.set(r,iu.get(r)+1),t>0){var e=r+"_"+t;return iu.set(e,1),e}return r}var GF=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function HN(r){return!!r.match(GF)}function XF(r){return r===parseInt(r.toString(),10)}function Ji(r,t,e){t==null&&(t=0),e==null&&(e=r.length);for(var n=1,a=t;a<e;++a)n*=r[a];return n}function qN(r){return r=Array.isArray(r)?new Float32Array(r):r,fr(r)}function Tu(r){return Qd(qN(r)).dataSync()[0]}function ro(r){return no(qN(r)).dataSync()[0]}function sa(r,t){if(t<r)throw new ee("end ("+t+") < begin ("+r+") is forbidden.");for(var e=[],n=r;n<t;++n)e.push(n);return e}function qc(r,t){return r.asType(t)}function Gc(r,t){t===void 0&&(t=-1);var e=r.shape.slice();return t<0&&(t=e.length+t+1),e.splice(t,0,1),r.reshape(e)}function $F(r,t){return ae(function(){if(r.shape.length!==2)throw new ee("repeat() expects a rank-2 tensor, but received a rank-"+r.shape.length+" tensor.");return Kv(Gc(r,1),[1,t,1])})}function KF(r){var t=[Ji(r.shape)];return r.reshape(t)}function YF(r){if(r.rank<=1)throw new ee("batchFlatten requires a minimum rank of 2. Got rank: "+r.rank+".");var t=[r.shape[0],Ji(r.shape,1)];return r.reshape(t)}function Yo(r,t,e){return ae(function(){switch(r.rank){case 1:return Fc(r,t,e);case 2:return Yd(r,[t,0],[e,r.shape[1]]);case 3:return Bc(r,[t,0,0],[e,r.shape[1],r.shape[2]]);case 4:return Eu(r,[t,0,0,0],[e,r.shape[1],r.shape[2],r.shape[3]]);case 5:return Rr(r,[t,0,0,0,0],[e,r.shape[1],r.shape[2],r.shape[3],r.shape[4]]);case 6:return Rr(r,[t,0,0,0,0,0],[e,r.shape[1],r.shape[2],r.shape[3],r.shape[4],r.shape[5]]);default:throw new ee("sliceAlongFirstAxis() received an unsupported tensor rank: "+r.rank)}})}function lv(r,t,e){return ae(function(){switch(r.rank){case 1:return Fc(r,t,e);case 2:return Yd(r,[0,t],[r.shape[0],e]);case 3:return Bc(r,[0,0,t],[r.shape[0],r.shape[1],e]);case 4:return Eu(r,[0,0,0,t],[r.shape[0],r.shape[1],r.shape[2],e]);default:throw new ee("sliceAlongLastAxis() received an unsupported tensor rank: "+r.rank)}})}function xh(r,t,e,n){return ae(function(){switch(r.rank){case 1:return Fc(r,t,e);case 2:switch(n){case 1:return Yo(r,t,e);case 2:return lv(r,t,e);default:throw new ee("The axis is not within the rank of the tensor "+n)}case 3:switch(n){case 1:return Yo(r,t,e);case 2:return Bc(r,[0,t,0],[r.shape[0],e,r.shape[2]]);case 3:return lv(r,t,e);default:throw new ee("The axis is not within the rank of the tensor "+n)}case 4:switch(n){case 1:return Yo(r,t,e);case 2:return Eu(r,[0,t,0,0],[r.shape[0],e,r.shape[2],r.shape[3]]);case 3:return Eu(r,[0,0,t,0],[r.shape[0],r.shape[1],e,r.shape[3]]);case 4:return lv(r,t,e);default:throw new ee("The axis is not within the rank of the tensor "+n)}default:throw new ee("sliceAlongLastAxis() received an unsupported tensor rank: "+r.rank)}})}function GN(r,t){var e;return t===void 0&&(t=-1),t<0&&(t=(e=r[0].rank)!==0?e:0),t===r[0].rank&&(t=-1),Gn(r,t)}function LS(r,t){switch(r.rank){case 1:return Vy([r,t]);case 2:return jy([r,t],0);case 3:return Wy([r,t],0);case 4:return Hy([r,t],0);default:throw new ee("concatAlongFirstAxis() received an unsupported tensor rank: "+r.rank)}}function Kv(r,t){if(Array.isArray(t)||(t=[t]),r.rank!==t.length)throw new ee("The length of input n ("+t.length+") does not match the number of dimensions in input x ("+r.rank+")");return Yi(r,t)}function up(r,t,e,n,a){return t===void 0&&(t=0),e===void 0&&(e=1),$y(r,t,e,n,a)}function oi(r,t,e,n){if(r.rank<2||t.rank<2)throw new tt("dot requires both inputs to be rank >= 2 but got x shape = "+r.shape+" and y shape = "+t.shape);if(t.rank>=3&&r.shape.slice(-1)[0]!==(d=t.shape.slice(-2)[0]))throw new tt("If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = "+r.shape+" and  y shape = "+t.shape);if(r.rank===2&&t.rank===2){var a=!1,i=!1;return Au.matMul({a:r,b:t,transposeA:a,transposeB:i,bias:n?Yv(r.rank,n,oa()):null,activation:e})}var s=r.shape.slice(),l=s.pop();r=r.reshape([-1,l]);var c=t.shape.slice(),f=c.pop(),d=c.pop(),p=c.concat([f]),g=Array.from({length:t.rank},function(b,w){return w===0?t.rank-2:w<=t.rank-2?w-1:w});t=t.transpose(g).reshape([d,-1]);var v=s.concat(p);return a=!1,i=!1,Au.matMul({a:r,b:t,transposeA:a,transposeB:i,bias:n?Yv(r.rank,n,oa()):null,activation:e}).reshape(v)}function XN(r,t,e){return ae(function(){return t=Array.isArray(t)?fr(t,"int32"):t.toInt(),Uu(r,t,e)})}function Xc(r){return Vd(r,r)}function Yv(r,t,e){var n=t.shape;if(t.rank!==1&&t.rank!==r)throw new ee("Unexpected bias dimensions: "+t.rank+"; expected it to be 1 or "+r);if(r===5){if(e==="channelsFirst")return n.length===1?t.reshape([1,n[0],1,1,1]):t.reshape([1,n[3],n[0],n[1],n[2]]);if(e==="channelsLast")return n.length===1?t.reshape([1,1,1,1,n[0]]):t.reshape([1].concat(n))}else if(r===4){if(e==="channelsFirst")return n.length===1?t.reshape([1,n[0],1,1]):t.reshape([1,n[2],n[0],n[1]]);if(e==="channelsLast")return n.length===1?t.reshape([1,1,1,n[0]]):t.reshape([1].concat(n))}else if(r===3){if(e==="channelsFirst")return n.length===1?t.reshape([1,n[0],1]):t.reshape([1,n[1],n[0]]);if(e==="channelsLast")return n.length===1?t.reshape([1,1,n[0]]):t.reshape([1].concat(n))}else if(r<3)return t;throw new ee("Unsupported input rank by biasAdd: "+t.rank)}function yi(r,t,e){return ae(function(){return e==null&&(e=oa()),pn(e),r.add(Yv(r.rank,t,e))})}function ZF(r,t){if(t===void 0&&(t=1),t!==1)throw new tt("Support for alpha values other than 1 ("+t+") is not implemented yet.");return Vu(r)}function QF(r){return ae(function(){return Xn(r,to(r).add(1))})}function $N(r,t,e,n){return ae(function(){return Yb(r,t,e,n)})}function JF(r){return ae(function(){var t=ot(.5,Xe(.2,r));return Jn(t,0,1)})}function Nu(r,t,e){return e===void 0&&(e=!1),e?r():t()}var eB=["fanIn","fanOut","fanAvg"],tB=["normal","uniform","truncatedNormal"];function nB(r){ju(eB,"FanMode",r)}function rB(r){ju(tB,"Distribution",r)}var da=function(r){function t(){return r!==null&&r.apply(this,arguments)||this}return pe(t,r),t.prototype.fromConfigUsesCustomObjects=function(){return!1},t.prototype.getConfig=function(){return{}},t}(be.Serializable),KN=function(r){function t(){return r!==null&&r.apply(this,arguments)||this}return pe(t,r),t.prototype.apply=function(e,n){return St(e,n)},t.className="Zeros",t}(da);be.registerClass(KN);var p0=function(r){function t(){return r!==null&&r.apply(this,arguments)||this}return pe(t,r),t.prototype.apply=function(e,n){return Oa(e,n)},t.className="Ones",t}(da);be.registerClass(p0);var YN=function(r){function t(e){var n=r.call(this)||this;if(typeof e!="object")throw new ee("Expected argument of type ConstantConfig but got "+e);if(e.value===void 0)throw new ee("config must have value set but got "+e);return n.value=e.value,n}return pe(t,r),t.prototype.apply=function(e,n){var a=this;return ae(function(){return Xe(Re(a.value),Oa(e,n))})},t.prototype.getConfig=function(){return{value:this.value}},t.className="Constant",t}(da);be.registerClass(YN);var ZN=function(r){function t(e){var n=r.call(this)||this;return n.DEFAULT_MINVAL=-.05,n.DEFAULT_MAXVAL=.05,n.minval=e.minval||n.DEFAULT_MINVAL,n.maxval=e.maxval||n.DEFAULT_MAXVAL,n.seed=e.seed,n}return pe(t,r),t.prototype.apply=function(e,n){return cs(e,this.minval,this.maxval,n)},t.prototype.getConfig=function(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}},t.className="RandomUniform",t}(da);be.registerClass(ZN);var QN=function(r){function t(e){var n=r.call(this)||this;return n.DEFAULT_MEAN=0,n.DEFAULT_STDDEV=.05,n.mean=e.mean||n.DEFAULT_MEAN,n.stddev=e.stddev||n.DEFAULT_STDDEV,n.seed=e.seed,n}return pe(t,r),t.prototype.apply=function(e,n){if((n=n||"float32")!=="float32"&&n!=="int32")throw new tt("randomNormal does not support dType "+n+".");return up(e,this.mean,this.stddev,n,this.seed)},t.prototype.getConfig=function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}},t.className="RandomNormal",t}(da);be.registerClass(QN);var JN=function(r){function t(e){var n=r.call(this)||this;return n.DEFAULT_MEAN=0,n.DEFAULT_STDDEV=.05,n.mean=e.mean||n.DEFAULT_MEAN,n.stddev=e.stddev||n.DEFAULT_STDDEV,n.seed=e.seed,n}return pe(t,r),t.prototype.apply=function(e,n){if((n=n||"float32")!=="float32"&&n!=="int32")throw new tt("truncatedNormal does not support dType "+n+".");return Dc(e,this.mean,this.stddev,n,this.seed)},t.prototype.getConfig=function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}},t.className="TruncatedNormal",t}(da);be.registerClass(JN);var eR=function(r){function t(e){var n=r.call(this)||this;return n.gain=e.gain!=null?e.gain:1,n}return pe(t,r),t.prototype.apply=function(e,n){var a=this;return ae(function(){if(e.length!==2||e[0]!==e[1])throw new ee("Identity matrix initializer can only be used for 2D square matrices.");return Xe(a.gain,Nd(e[0]))})},t.prototype.getConfig=function(){return{gain:this.gain}},t.className="Identity",t}(da);function aB(r,t){var e,n;if(t===void 0&&(t="channelsLast"),pn(t),r.length===2)e=r[0],n=r[1];else if([3,4,5].indexOf(r.length)!==-1)if(t==="channelsFirst"){var a=Ji(r,2);e=r[1]*a,n=r[0]*a}else t==="channelsLast"&&(a=Ji(r,0,r.length-2),e=r[r.length-2]*a,n=r[r.length-1]*a);else{var i=Ji(r);e=Math.sqrt(i),n=Math.sqrt(i)}return[e,n]}be.registerClass(eR);var dr=function(r){function t(e){var n=r.call(this)||this;if(e.scale<0)throw new ee("scale must be a positive float. Got: "+e.scale);return n.scale=e.scale==null?1:e.scale,n.mode=e.mode==null?"fanIn":e.mode,nB(n.mode),n.distribution=e.distribution==null?"normal":e.distribution,rB(n.distribution),n.seed=e.seed,n}return pe(t,r),t.prototype.apply=function(e,n){var a=aB(e),i=a[0],s=a[1],l=this.scale;if(this.mode==="fanIn"?l/=Math.max(1,i):this.mode==="fanOut"?l/=Math.max(1,s):l/=Math.max(1,(i+s)/2),this.distribution==="normal"){var c=Math.sqrt(l);if((n=n||"float32")!=="float32"&&n!=="int32")throw new tt(this.getClassName()+" does not support dType "+n+".");return Dc(e,0,c,n,this.seed)}var f=Math.sqrt(3*l);return cs(e,-f,f,n)},t.prototype.getConfig=function(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}},t.className="VarianceScaling",t}(da);be.registerClass(dr);var m0=function(r){function t(e){return r.call(this,{scale:1,mode:"fanAvg",distribution:"uniform",seed:e==null?null:e.seed})||this}return pe(t,r),t.prototype.getClassName=function(){return dr.className},t.className="GlorotUniform",t}(dr);be.registerClass(m0);var g0=function(r){function t(e){return r.call(this,{scale:1,mode:"fanAvg",distribution:"normal",seed:e==null?null:e.seed})||this}return pe(t,r),t.prototype.getClassName=function(){return dr.className},t.className="GlorotNormal",t}(dr);be.registerClass(g0);var v0=function(r){function t(e){return r.call(this,{scale:2,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})||this}return pe(t,r),t.prototype.getClassName=function(){return dr.className},t.className="HeNormal",t}(dr);be.registerClass(v0);var y0=function(r){function t(e){return r.call(this,{scale:2,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})||this}return pe(t,r),t.prototype.getClassName=function(){return dr.className},t.className="HeUniform",t}(dr);be.registerClass(y0);var b0=function(r){function t(e){return r.call(this,{scale:1,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})||this}return pe(t,r),t.prototype.getClassName=function(){return dr.className},t.className="LeCunNormal",t}(dr);be.registerClass(b0);var w0=function(r){function t(e){return r.call(this,{scale:1,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})||this}return pe(t,r),t.prototype.getClassName=function(){return dr.className},t.className="LeCunNormal",t}(dr);be.registerClass(w0);var tR=function(r){function t(e){var n=r.call(this)||this;if(n.DEFAULT_GAIN=1,n.gain=e.gain==null?n.DEFAULT_GAIN:e.gain,n.seed=e.seed,n.seed!=null)throw new tt("Random seed is not implemented for Orthogonal Initializer yet.");return n}return pe(t,r),t.prototype.apply=function(e,n){var a=this;return ae(function(){if(e.length!==2)throw new tt("The Orthogonal Initializer does not support non-2D shapes yet.");e[0]*e[1]>2e3&&console.warn("Orthogonal initializer is being called on a matrix with more than 2000 ("+e[0]*e[1]+") elements: Slowness may result.");var i=up(e[0]>e[1]?[e[1],e[0]]:e,0,1,"float32"),s=Jb.gramSchmidt(i);return e[0]>e[1]&&(s=s.transpose()),Xe(a.gain,s)})},t.prototype.getConfig=function(){return{gain:this.gain,seed:this.seed}},t.className="Orthogonal",t}(da);be.registerClass(tR);var FS={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function BS(r,t){return t===void 0&&(t={}),Wc(r,be.SerializationMap.getMap().classNameMap,t,"initializer")}function gt(r){return f0(r)}function zt(r){if(typeof r=="string"){var t=r in FS?FS[r]:r;if(t==="GlorotNormal")return new g0;if(t==="GlorotUniform")return new m0;if(t==="HeNormal")return new v0;if(t==="HeUniform")return new y0;if(t==="LeCunNormal")return new b0;if(t==="LeCunUniform")return new w0;var e={};return e.className=t,e.config={},BS(e)}return r instanceof da?r:BS(r)}function iB(){return new KN}function oB(){return new p0}function sB(r){return new YN(r)}function uB(r){return new ZN(r)}function lB(r){return new QN(r)}function cB(r){return new JN(r)}function fB(r){return new eR(r)}function hB(r){return new dr(r)}function dB(r){return new m0(r)}function pB(r){return new g0(r)}function mB(r){return new v0(r)}function gB(r){return new y0(r)}function vB(r){return new b0(r)}function yB(r){return new w0(r)}function bB(r){return new tR(r)}var wB=Object.freeze({zeros:iB,ones:oB,constant:sB,randomUniform:uB,randomNormal:lB,truncatedNormal:cB,identity:fB,varianceScaling:hB,glorotUniform:dB,glorotNormal:pB,heNormal:mB,heUniform:gB,leCunNormal:vB,leCunUniform:yB,orthogonal:bB}),xB=0;function nR(){return xB++}var Sh={};function lp(r){return r===void 0&&(r=""),r in Sh||(Sh[r]=0),Sh[r]+=1,r+Sh[r].toString()}function Zv(r){return Array.isArray(r)&&Array.isArray(r[0])}function sd(r){return r.length===0?[]:Array.isArray(r[0])?r:[r]}function Ye(r){var t;if(Array.isArray(r)){if(r.length!==1)throw new ee("Expected Tensor length to be 1; got "+r.length);t=r[0]}else t=r;return t}function It(r){if(Array.isArray(r)&&Array.isArray(r[0])){if(r.length===1)return(r=r)[0];throw new ee("Expected exactly 1 Shape; got "+r.length)}return r}function ud(r){for(var t=0,e=0,n=r;e<n.length;e++){var a=n[e];a.shape.length===0?t+=1:t+=a.shape.reduce(function(i,s){return i*s})}return t}var US="Variable",rR=function(){function r(t,e,n,a,i){e===void 0&&(e="float32"),n===void 0&&(n=US),a===void 0&&(a=!0),i===void 0&&(i=null),this.dtype=e??"float32",this.shape=t.shape,this.id=nR(),n=n??US,this.originalName=jN(n),this.name=WN(this.originalName),this.trainable_=a,this.constraint=i,this.val=Uy(t,this.trainable_,this.name,this.dtype)}return r.prototype.read=function(){return this.assertNotDisposed(),this.val},r.prototype.write=function(t){return this.assertNotDisposed(),SB(this.val,t),this.val.id!==t.id&&(this.val.assign(t),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this},r.prototype.dispose=function(){this.assertNotDisposed(),this.val.dispose()},r.prototype.assertNotDisposed=function(){if(this.val.isDisposed)throw new Error("LayersVariable "+this.name+" is already disposed.")},Object.defineProperty(r.prototype,"trainable",{get:function(){return this.trainable_},set:function(t){this.trainable_=t,this.val.trainable=t},enumerable:!0,configurable:!0}),r}();function SB(r,t){if(r.shape.toString()!==t.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(r.shape)+" vs. "+JSON.stringify(t.shape))}function Qv(r){return r.map(function(t){return t.read()})}function x0(r){r.forEach(function(t){t[0].write(t[1])})}var In=function(){return function(r){this.dtype=r.dtype,this.shape=r.shape,r.shape!=null?this.ndim=r.shape.length:this.ndim=r.ndim,this.maxNDim=r.maxNDim,this.minNDim=r.minNDim,this.axes=r.axes||{}}}(),ra=function(){return function(r,t,e,n,a,i,s){this.dtype=r,this.shape=t,this.sourceLayer=e,this.inputs=n,this.callArgs=a,this.outputTensorIndex=s,this.id=nR(),i!=null&&(this.originalName=jN(i),this.name=WN(this.originalName)),this.rank=t.length}}(),EB=0,cp=function(){function r(t,e){this.callArgs=e,this.id=EB++,this.outboundLayer=t.outboundLayer,this.inboundLayers=t.inboundLayers,this.nodeIndices=t.nodeIndices,this.tensorIndices=t.tensorIndices,this.inputTensors=t.inputTensors,this.outputTensors=t.outputTensors,this.inputMasks=t.inputMasks,this.outputMasks=t.outputMasks,this.inputShapes=t.inputShapes,this.outputShapes=t.outputShapes;for(var n=0,a=t.inboundLayers;n<a.length;n++){var i=a[n];i!=null&&i.outboundNodes.push(this)}t.outboundLayer.inboundNodes.push(this)}return r.prototype.getConfig=function(){for(var t=[],e=0,n=this.inboundLayers;e<n.length;e++){var a=n[e];a!=null?t.push(a.name):t.push(null)}return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:t,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}},r}(),CB=0,ft=function(r){function t(e){var n=r.call(this)||this;n._callHook=null,n._addedWeightNames=[],n._stateful=!1,n.id=CB++,n.activityRegularizer=null,n.inputSpec=null,n.supportsMasking=!1,n._trainableWeights=[],n._nonTrainableWeights=[],n._losses=[],n._updates=[],n._built=!1,n.inboundNodes=[],n.outboundNodes=[];var a=e.name;if(!a){var i=n.getClassName();a=ti(i)+"_"+lp(i)}if(n.name=a,n.trainable_=e.trainable==null||e.trainable,e.inputShape!=null||e.batchInputShape!=null){var s=void 0;if(e.batchInputShape!=null)s=e.batchInputShape;else if(e.inputShape!=null){var l=null;e.batchSize!=null&&(l=e.batchSize),s=[l].concat(e.inputShape)}n.batchInputShape=s;var c=e.dtype;c==null&&(c=e.inputDType),c==null&&(c="float32"),n.dtype=c}return e.weights!=null?n.initialWeights=e.weights:n.initialWeights=null,n._refCount=null,n.fastWeightInitDuringBuild=!1,n}return pe(t,r),t.nodeKey=function(e,n){return e.name+"_ib-"+n.toString()},t.prototype.getNodeAtIndex=function(e,n){if(this.inboundNodes.length===0)throw new Ca("The layer has never been called and thus has no defined "+n+".");if(this.inboundNodes.length<=e)throw new ee("Asked to get "+n+" at node "+e+", but the layer has only "+this.inboundNodes.length+" inbound nodes.");return this.inboundNodes[e]},t.prototype.getInputAt=function(e){return Yn(this.getNodeAtIndex(e,"input").inputTensors)},t.prototype.getOutputAt=function(e){return Yn(this.getNodeAtIndex(e,"output").outputTensors)},Object.defineProperty(t.prototype,"input",{get:function(){if(this.inboundNodes.length>1)throw new Po("Layer "+this.name+' has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use `getInputAt(nodeIndex)` instead.');if(this.inboundNodes.length===0)throw new Po("Layer "+this.name+" is not connected, no input to return.");return Yn(this.getNodeAtIndex(0,"input").inputTensors)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"output",{get:function(){if(this.inboundNodes.length===0)throw new Po("Layer "+this.name+" has no inbound nodes.");if(this.inboundNodes.length>1)throw new Po("Layer "+this.name+' has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use `getOutputAt(nodeIndex)` instead.');return Yn(this.getNodeAtIndex(0,"output").outputTensors)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"losses",{get:function(){return this._losses},enumerable:!0,configurable:!0}),t.prototype.calculateLosses=function(){return this.losses.map(function(e){return e()})},Object.defineProperty(t.prototype,"updates",{get:function(){return this._updates},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"built",{get:function(){return this._built},set:function(e){this._built=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"trainable",{get:function(){return this.trainable_},set:function(e){this._trainableWeights.forEach(function(n){return n.trainable=e}),this.trainable_=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"trainableWeights",{get:function(){return this.trainable_?this._trainableWeights.filter(function(e){return e.trainable}):[]},set:function(e){this._trainableWeights=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nonTrainableWeights",{get:function(){return this.trainable?this._trainableWeights.filter(function(e){return!e.trainable}).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)},set:function(e){this._nonTrainableWeights=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"weights",{get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"stateful",{get:function(){return this._stateful},enumerable:!0,configurable:!0}),t.prototype.resetStates=function(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")},t.prototype.assertInputCompatibility=function(e){if(e=_t(e),this.inputSpec!=null&&this.inputSpec.length!==0){var n=_t(this.inputSpec);if(e.length!==n.length)throw new ee("Layer "+this.name+" expects "+n.length+" inputs, but it received "+e.length+" input tensors. Input received: "+e);for(var a=0;a<e.length;a++){var i=e[a],s=n[a];if(s!=null){var l=i.rank;if(s.ndim!=null&&l!==s.ndim)throw new ee("Input "+a+" is incompatible with layer "+this.name+": expected ndim="+s.ndim+", found ndim="+l);if(s.maxNDim!=null&&l>s.maxNDim)throw new ee("Input "+a+" is incompatible with layer "+this.name+": expected max_ndim="+s.maxNDim+", found ndim="+l);if(s.minNDim!=null&&l<s.minNDim)throw new ee("Input "+a+" is incompatible with layer "+this.name+": expected min_ndim="+s.minNDim+", found ndim="+l+".");if(s.dtype!=null&&i.dtype!==s.dtype)throw new ee("Input "+a+" is incompatible with layer "+this.name+" : expected dtype="+s.dtype+", found dtype="+i.dtype+".");if(s.axes){var c=i.shape;for(var f in s.axes){var d=Number(f),p=s.axes[f],g=d>=0?c[d]:c[c.length+d];if(p!=null&&[p,null].indexOf(g)===-1)throw new ee("Input "+a+" is incompatible with layer "+this.name+": expected axis "+d+" of input shape to have value "+p+" but got shape "+c+".")}}if(s.shape!=null)for(var v=0;v<s.shape.length;++v){var b=s.shape[v],w=i.shape[v];if(b!=null&&w!=null&&b!==w)throw new ee("Input "+a+" is incompatible with layer "+this.name+": expected shape="+s.shape+", found shape="+i.shape+".")}}}}},t.prototype.call=function(e,n){return e},t.prototype.invokeCallHook=function(e,n){this._callHook!=null&&this._callHook(e,n)},t.prototype.setCallHook=function(e){this._callHook=e},t.prototype.clearCallHook=function(){this._callHook=null},t.prototype.apply=function(e,n){var a=this;n=n||{},this.assertNotDisposed();for(var i=_t(e),s=!0,l=0,c=i;l<c.length;l++)if(!(c[l]instanceof ra)){s=!1;break}for(var f=!0,d=0,p=i;d<p.length;d++)if(p[d]instanceof ra){f=!1;break}if(s===f)throw new ee("Arguments to apply() must be all SymbolicTensors or all Tensors");return Ko(this.name,function(){if(!a.built){a.assertInputCompatibility(e);for(var g=[],v=0,b=_t(e);v<b.length;v++){var w=b[v];g.push(w.shape)}a.build(Yn(g)),a.built=!0,a.initialWeights&&a.setWeights(a.initialWeights),a._refCount===null&&f&&(a._refCount=1)}if(a.assertInputCompatibility(e),f){for(var S=[],x=0,C=_t(O=a.call(e,n));x<C.length;x++){var A=C[x];i.indexOf(A)!==-1&&(A=A.clone()),S.push(A)}if(O=Yn(S),a.activityRegularizer!=null)throw new tt("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return O}var T=AB(e),R=a.computeOutputShape(T),O=void 0,N=TB(e);if(a.warnOnIncompatibleInputShape(Array.isArray(e)?T[0]:T),O=R!=null&&R.length>0&&Array.isArray(R[0])?R.map(function(D,I){return new ra(N,D,a,_t(e),n,a.name,I)}):new ra(N,R,a,_t(e),n,a.name),a.addInboundNode(e,O,null,null,T,R,n),a._refCount++,a.activityRegularizer!=null)throw new tt("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return O})},t.prototype.warnOnIncompatibleInputShape=function(e){if(this.batchInputShape!=null)if(e.length!==this.batchInputShape.length)console.warn("The rank of the input tensor provided (shape: "+JSON.stringify(e)+") does not match that of the batchInputShape ("+JSON.stringify(this.batchInputShape)+") of the layer "+this.name);else{var n=!1;this.batchInputShape.forEach(function(a,i){a!=null&&e[i]!=null&&e[i]!==a&&(n=!0)}),n&&console.warn("The shape of the input tensor ("+JSON.stringify(e)+") does not match the expectation of layer "+this.name+": "+JSON.stringify(this.batchInputShape))}},Object.defineProperty(t.prototype,"outputShape",{get:function(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new Po("The layer "+this.name+" has never been called and thus has no defined output shape.");for(var e=[],n=0,a=this.inboundNodes;n<a.length;n++){var i=a[n],s=JSON.stringify(i.outputShapes);e.indexOf(s)===-1&&e.push(s)}if(e.length===1){var l=this.inboundNodes[0].outputShapes;return Array.isArray(l)&&Array.isArray(l[0])&&l.length===1?l[0]:l}throw new Po("The layer "+this.name+' has multiple inbound nodes with different output shapes. Hence the notion of "outut shape" is ill-defined for the layer.')},enumerable:!0,configurable:!0}),t.prototype.countParams=function(){if(!this.built)throw new Ca("You tried to call countParams() on "+this.name+", but the layer is not built yet. Build it first by calling build(batchInputShape).");return ud(this.weights)},t.prototype.build=function(e){this.built=!0},t.prototype.getWeights=function(e){return e===void 0&&(e=!1),Qv(e?this.trainableWeights:this.weights)},t.prototype.setWeights=function(e){var n=this;ae(function(){var a=n.weights;if(a.length!==e.length)throw new ee('You called setWeights(weights) on layer "'+n.name+'" with a weight list of length '+e.length+", but the layer was expecting "+a.length+" weights. Provided weights: "+e+"...");if(a.length!==0){for(var i=[],s=Qv(a),l=0;l<s.length;++l){var c=s[l],f=a[l],d=e[l];if(!Be.arraysEqual(c.shape,d.shape))throw new ee("Layer weight shape "+c.shape+" not compatible with provided weight shape "+d.shape);i.push([f,d])}x0(i)}})},t.prototype.addWeight=function(e,n,a,i,s,l,c){if(this._addedWeightNames.indexOf(e)!==-1)throw new ee("Duplicate weight name "+e+" for layer "+this.name);this._addedWeightNames.push(e),a==null&&(a="float32"),this.fastWeightInitDuringBuild&&(i=zt("zeros"));var f=i.apply(n,a),d=new rR(f,a,e,l,c);return f.dispose(),s!=null&&this.addLoss(function(){return s.apply(d.read())}),l==null&&(l=!0),l?this._trainableWeights.push(d):this._nonTrainableWeights.push(d),d},t.prototype.setFastWeightInitDuringBuild=function(e){this.fastWeightInitDuringBuild=e},t.prototype.addLoss=function(e){var n;e==null||Array.isArray(e)&&e.length===0||(e=_t(e),this._losses!==void 0&&this._losses!==null&&(n=this.losses).push.apply(n,e))},t.prototype.computeOutputShape=function(e){return e},t.prototype.computeMask=function(e,n){var a=this;if(!this.supportsMasking){if(n!=null){if(!Array.isArray(n))throw new TypeError("Layer "+this.name+" does not support masking, but was passed an inputMask.");n.forEach(function(i){if(i!=null)throw new TypeError("Layer "+a.name+" does not support masking, but was passed an inputMask.")})}return null}return n},t.prototype.addInboundNode=function(e,n,a,i,s,l,c){c===void 0&&(c=null);var f=_t(e);n=_t(n),a=_t(a),i=_t(i),s=sd(s),l=sd(l);for(var d=[],p=[],g=[],v=0,b=f;v<b.length;v++){var w=b[v];d.push(w.sourceLayer),p.push(w.nodeIndex),g.push(w.tensorIndex)}new cp({outboundLayer:this,inboundLayers:d,nodeIndices:p,tensorIndices:g,inputTensors:f,outputTensors:n,inputMasks:a,outputMasks:i,inputShapes:s,outputShapes:l},c);for(var S=0;S<n.length;S++)n[S].sourceLayer=this,n[S].nodeIndex=this.inboundNodes.length-1,n[S].tensorIndex=S},t.prototype.getConfig=function(){var e={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(e.batchInputShape=this.batchInputShape),this.dtype!=null&&(e.dtype=this.dtype),e},t.prototype.disposeWeights=function(){return this.weights.forEach(function(e){return e.dispose()}),this.weights.length},t.prototype.assertNotDisposed=function(){if(this._refCount===0)throw new Error("Layer '"+this.name+"' is already disposed.")},t.prototype.dispose=function(){if(!this.built)throw new Error("Cannot dispose Layer "+this.name+" because it has not been built yet.");if(this._refCount===null)throw new Error("Cannot dispose Layer "+this.name+" because it has not been used yet.");this.assertNotDisposed();var e=0;return--this._refCount==0&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}},t}(be.Serializable);function AB(r){for(var t=[],e=0,n=r=_t(r);e<n.length;e++){var a=n[e];t.push(a.shape)}return Yn(t)}function TB(r){return"float32"}function aR(r,t,e){if((t==null||e!=null&&e>0)&&(t=r.sourceLayer,e=r.nodeIndex),t.inboundNodes.length===0)return[r];var n=t.inboundNodes[e];if(n.inboundLayers.length===0)return n.inputTensors;for(var a=[],i=0;i<n.inboundLayers.length;i++)for(var s=0,l=aR(n.inputTensors[i],n.inboundLayers[i],n.nodeIndices[i]);s<l.length;s++){var c=l[s];a.indexOf(c)===-1&&a.push(c)}return a}var PS,$c=function(r){function t(e){var n=r.call(this,{dtype:e.dtype,name:e.name!=null?e.name:lp("input").toString()})||this;if(e.batchSize==null&&(e.batchSize=null),e.sparse==null&&(e.sparse=!1),n.trainable=!1,n.built=!0,n.sparse=e.sparse,e.inputShape!=null&&e.batchInputShape!=null)throw new ee("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");var a=e.batchInputShape;if(a==null){if(e.inputShape==null)throw new ee("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");a=[e.batchSize].concat(e.inputShape)}else if(e.batchSize!=null)throw new ee("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");var i=e.dtype||"float32";n.batchInputShape=a,n.dtype=i,n.inputSpec=[{shape:a}];var s=new ra(n.dtype,n.batchInputShape,n,[],{},n.name);return s.nodeIndex=0,s.tensorIndex=0,new cp({outboundLayer:n,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[s],outputTensors:[s],inputMasks:[null],outputMasks:[null],inputShapes:[a],outputShapes:[a]}),n}return pe(t,r),t.prototype.apply=function(e,n){throw new ee("Cannot pass any input to an InputLayer's apply() method. InputLayer name: "+this.name)},t.prototype.dispose=function(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}},t.prototype.getConfig=function(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}},t.className="InputLayer",t}(ft);function iR(r){if(r.batchShape==null&&r.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(r.batchShape!=null&&r.shape!=null)throw new ee("Please provide either a `shape` or `batchShape` argument to Input, but not both.");var t=r.batchShape;r.shape!=null&&t==null&&(t=[null].concat(r.shape));var e=r.dtype;return e==null&&(e="float32"),new $c({batchInputShape:t,name:r.name,dtype:e,sparse:r.sparse}).inboundNodes[0].outputTensors[0]}function Wi(r){return He(this,void 0,void 0,function(){var t,e,n,a,i,s,l,c;return Ve(this,function(f){switch(f.label){case 0:if(r==null)return[2];for(a in t=[],e=[],n=[],r)typeof(i=r[a])!="number"&&(s=i,t.push(s.data()),e.push(a),n.push(s));return t.length>0?[4,Promise.all(t)]:[3,2];case 1:for(l=f.sent(),c=0;c<l.length;++c)r[e[c]]=l[c][0];et(n),f.label=2;case 2:return[2]}})})}function oR(r){if(r!=null)for(var t in r){var e=r[t];typeof e!="number"&&e.dispose()}}be.registerClass($c),function(r){r[r.SILENT=0]="SILENT",r[r.VERBOSE=1]="VERBOSE"}(PS||(PS={}));var NB=125,Ru=function(){function r(){this.validationData=null}return r.prototype.setParams=function(t){this.params=t},r.prototype.onEpochBegin=function(t,e){return He(this,void 0,void 0,function(){return Ve(this,function(n){return[2]})})},r.prototype.onEpochEnd=function(t,e){return He(this,void 0,void 0,function(){return Ve(this,function(n){return[2]})})},r.prototype.onBatchBegin=function(t,e){return He(this,void 0,void 0,function(){return Ve(this,function(n){return[2]})})},r.prototype.onBatchEnd=function(t,e){return He(this,void 0,void 0,function(){return Ve(this,function(n){return[2]})})},r.prototype.onTrainBegin=function(t){return He(this,void 0,void 0,function(){return Ve(this,function(e){return[2]})})},r.prototype.onTrainEnd=function(t){return He(this,void 0,void 0,function(){return Ve(this,function(e){return[2]})})},r.prototype.setModel=function(t){},r}(),sR=function(){function r(t,e){e===void 0&&(e=10),t==null&&(t=[]),this.callbacks=t,this.queueLength=e}return r.prototype.append=function(t){this.callbacks.push(t)},r.prototype.setParams=function(t){for(var e=0,n=this.callbacks;e<n.length;e++)n[e].setParams(t)},r.prototype.setModel=function(t){for(var e=0,n=this.callbacks;e<n.length;e++)n[e].setModel(t)},r.prototype.onEpochBegin=function(t,e){return He(this,void 0,void 0,function(){var n,a;return Ve(this,function(i){switch(i.label){case 0:e==null&&(e={}),n=0,a=this.callbacks,i.label=1;case 1:return n<a.length?[4,a[n].onEpochBegin(t,e)]:[3,4];case 2:i.sent(),i.label=3;case 3:return n++,[3,1];case 4:return[2]}})})},r.prototype.onEpochEnd=function(t,e){return He(this,void 0,void 0,function(){var n,a;return Ve(this,function(i){switch(i.label){case 0:e==null&&(e={}),n=0,a=this.callbacks,i.label=1;case 1:return n<a.length?[4,a[n].onEpochEnd(t,e)]:[3,4];case 2:i.sent(),i.label=3;case 3:return n++,[3,1];case 4:return[2]}})})},r.prototype.onBatchBegin=function(t,e){return He(this,void 0,void 0,function(){var n,a;return Ve(this,function(i){switch(i.label){case 0:e==null&&(e={}),n=0,a=this.callbacks,i.label=1;case 1:return n<a.length?[4,a[n].onBatchBegin(t,e)]:[3,4];case 2:i.sent(),i.label=3;case 3:return n++,[3,1];case 4:return[2]}})})},r.prototype.onBatchEnd=function(t,e){return He(this,void 0,void 0,function(){var n,a;return Ve(this,function(i){switch(i.label){case 0:e==null&&(e={}),n=0,a=this.callbacks,i.label=1;case 1:return n<a.length?[4,a[n].onBatchEnd(t,e)]:[3,4];case 2:i.sent(),i.label=3;case 3:return n++,[3,1];case 4:return[2]}})})},r.prototype.onTrainBegin=function(t){return He(this,void 0,void 0,function(){var e,n;return Ve(this,function(a){switch(a.label){case 0:t==null&&(t={}),e=0,n=this.callbacks,a.label=1;case 1:return e<n.length?[4,n[e].onTrainBegin(t)]:[3,4];case 2:a.sent(),a.label=3;case 3:return e++,[3,1];case 4:return[2]}})})},r.prototype.onTrainEnd=function(t){return He(this,void 0,void 0,function(){var e,n;return Ve(this,function(a){switch(a.label){case 0:t==null&&(t={}),e=0,n=this.callbacks,a.label=1;case 1:return e<n.length?[4,n[e].onTrainEnd(t)]:[3,4];case 2:a.sent(),a.label=3;case 3:return e++,[3,1];case 4:return[2]}})})},r}(),RB=function(r){function t(){return r.call(this)||this}return pe(t,r),t.prototype.onEpochBegin=function(e){return He(this,void 0,void 0,function(){return Ve(this,function(n){return this.seen=0,this.totals={},[2]})})},t.prototype.onBatchEnd=function(e,n){return He(this,void 0,void 0,function(){var a,i,s,l,c=this;return Ve(this,function(f){for(l in n==null&&(n={}),a=n.size==null?0:n.size,this.seen+=a,i=function(d){var p=n[d];if(typeof p=="number")s.totals.hasOwnProperty(d)||(s.totals[d]=0),s.totals[d]=s.totals[d]+p*a;else{var g=void 0;d in s.totals?g=s.totals[d]:s.totals[d]=0;var v=ae(function(){return ot(c.totals[d],Xe(p,a))});s.totals[d]=v,g!=null&&g.dispose()}},s=this,n)i(l);return[2]})})},t.prototype.onEpochEnd=function(e,n){return He(this,void 0,void 0,function(){var a,i,s,l,c,f=this;return Ve(this,function(d){if(n!=null)for(a=function(p){if(i.totals[p]==null)return"continue";typeof i.totals[p]=="number"?n[p]=i.totals[p]/i.seen:ae(function(){var g=Xe(Xn(1,f.seen),f.totals[p]);n[p]=g,f.totals[p].dispose(),Na(n[p])})},i=this,s=0,l=this.params.metrics;s<l.length;s++)c=l[s],a(c);return[2]})})},t}(Ru),uR=function(r){function t(){return r!==null&&r.apply(this,arguments)||this}return pe(t,r),t.prototype.onTrainBegin=function(e){return He(this,void 0,void 0,function(){return Ve(this,function(n){return this.epoch=[],this.history={},[2]})})},t.prototype.onEpochEnd=function(e,n){return He(this,void 0,void 0,function(){var a;return Ve(this,function(i){for(a in n==null&&(n={}),this.epoch.push(e),n)this.history[a]==null&&(this.history[a]=[]),this.history[a].push(n[a]);return[2]})})},t.prototype.syncData=function(){return He(this,void 0,void 0,function(){var e,n,a,i,s,l,c,f,d;return Ve(this,function(p){switch(p.label){case 0:for(i in e=[],n=[],a=[],this.history)for(s=this.history[i],l=0;l<s.length;++l)typeof s[l]!="number"&&(c=s[l],e.push(c.data()),n.push(i),a.push(l));return[4,Promise.all(e)];case 1:for(f=p.sent(),d=0;d<f.length;++d)this.history[n[d]][a[d]].dispose(),this.history[n[d]][a[d]]=f[d][0];return[2]}})})},t}(Ru),lR=function(r){function t(e,n){var a=r.call(this)||this;if(a.currentEpoch=0,a.yieldEvery=n||"auto",a.yieldEvery==="auto"&&(a.yieldEvery=NB),a.yieldEvery==="never"&&e.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");return Be.isNumber(a.yieldEvery)&&(a.maybeWait=zF(a.maybeWait.bind(a),a.yieldEvery)),a.trainBegin=e.onTrainBegin,a.trainEnd=e.onTrainEnd,a.epochBegin=e.onEpochBegin,a.epochEnd=e.onEpochEnd,a.batchBegin=e.onBatchBegin,a.batchEnd=e.onBatchEnd,a.yield=e.onYield,a}return pe(t,r),t.prototype.maybeWait=function(e,n,a){return He(this,void 0,void 0,function(){var i;return Ve(this,function(s){switch(s.label){case 0:return i=[],this.yield==null?[3,2]:[4,Wi(a)];case 1:s.sent(),i.push(this.yield(e,n,a)),s.label=2;case 2:return i.push(Uh()),[4,Promise.all(i)];case 3:return s.sent(),[2]}})})},t.prototype.onEpochBegin=function(e,n){return He(this,void 0,void 0,function(){return Ve(this,function(a){switch(a.label){case 0:return this.currentEpoch=e,this.epochBegin==null?[3,3]:[4,Wi(n)];case 1:return a.sent(),[4,this.epochBegin(e,n)];case 2:a.sent(),a.label=3;case 3:return[2]}})})},t.prototype.onEpochEnd=function(e,n){return He(this,void 0,void 0,function(){var a;return Ve(this,function(i){switch(i.label){case 0:return a=[],this.epochEnd==null?[3,2]:[4,Wi(n)];case 1:i.sent(),a.push(this.epochEnd(e,n)),i.label=2;case 2:return this.yieldEvery==="epoch"&&a.push(Uh()),[4,Promise.all(a)];case 3:return i.sent(),[2]}})})},t.prototype.onBatchBegin=function(e,n){return He(this,void 0,void 0,function(){return Ve(this,function(a){switch(a.label){case 0:return this.batchBegin==null?[3,3]:[4,Wi(n)];case 1:return a.sent(),[4,this.batchBegin(e,n)];case 2:a.sent(),a.label=3;case 3:return[2]}})})},t.prototype.onBatchEnd=function(e,n){return He(this,void 0,void 0,function(){var a;return Ve(this,function(i){switch(i.label){case 0:return a=[],this.batchEnd==null?[3,2]:[4,Wi(n)];case 1:i.sent(),a.push(this.batchEnd(e,n)),i.label=2;case 2:return this.yieldEvery==="batch"?a.push(Uh()):Be.isNumber(this.yieldEvery)&&a.push(this.maybeWait(this.currentEpoch,e,n)),[4,Promise.all(a)];case 3:return i.sent(),[2]}})})},t.prototype.onTrainBegin=function(e){return He(this,void 0,void 0,function(){return Ve(this,function(n){switch(n.label){case 0:return this.trainBegin==null?[3,3]:[4,Wi(e)];case 1:return n.sent(),[4,this.trainBegin(e)];case 2:n.sent(),n.label=3;case 3:return[2]}})})},t.prototype.onTrainEnd=function(e){return He(this,void 0,void 0,function(){return Ve(this,function(n){switch(n.label){case 0:return this.trainEnd==null?[3,3]:[4,Wi(e)];case 1:return n.sent(),[4,this.trainEnd(e)];case 2:n.sent(),n.label=3;case 3:return[2]}})})},t}(Ru);function cR(r,t){return r==null&&(r={}),r instanceof Ru?[r]:Array.isArray(r)&&r[0]instanceof Ru?r:_t(r).map(function(e){return new lR(e,t)})}var fR=function(){function r(){}return r.registerCallbackConstructor=function(t,e){Be.assert(t>=0&&Number.isInteger(t),function(){return"Verbosity level is expected to be an integer >= 0, but got "+t}),r.checkForDuplicate(e),r.constructors[t]==null&&(r.constructors[t]=[]),r.constructors[t].push(e)},r.checkForDuplicate=function(t){for(var e in r.constructors)r.constructors[+e].forEach(function(n){if(n===t)throw new ee("Duplicate callback constructor.")})},r.clear=function(){r.constructors={}},r.createCallbacks=function(t){var e=[];for(var n in r.constructors){var a=+n;t>=a&&e.push.apply(e,r.constructors[a])}return e.map(function(i){return new i})},r.constructors={},r}();function hR(r,t,e,n,a,i,s,l,c){var f=new uR,d=[new RB].concat(fR.createCallbacks(t));r!=null&&d.push.apply(d,r),d.push(f);var p=new sR(d);return p.setParams({epochs:e,initialEpoch:n,samples:a,steps:i,batchSize:s,verbose:t,doValidation:l,metrics:c}),{callbackList:p,history:f}}function aa(r,t,e){return t===void 0&&(t={}),e===void 0&&(e=!1),Wc(r,be.SerializationMap.getMap().classNameMap,t,"layer",e)}function ld(r,t){return ae(function(){r.dtype!=="float32"&&(r=r.asType("float32"));var e=hr(Xc(r),t,!0),n=zu(e.shape,fn()),a=Mc(_a(e,n));return Xn(r,a)})}function ms(r,t){return ae(function(){return an(Xc(Dn(t,r)),-1)})}function fp(r,t){return ae(function(){return an(to(Dn(t,r)),-1)})}function Wu(r,t){return ae(function(){var e=Dn(r,t),n=Jn(to(r),fn(),Number.MAX_VALUE),a=to(Xn(e,n));return Xe(100,an(a,-1))})}function IB(r,t){return ae(function(){var e=Jn(t,fn(),Number.MAX_VALUE),n=ci(ot(1,e)),a=Jn(r,fn(),Number.MAX_VALUE),i=ci(ot(1,a));return an(Xc(Dn(n,i)),-1)})}function kB(r,t){return ae(function(){var e=_a(0,Dn(1,Xe(r,t)));return an(Xc(e),-1)})}function DB(r,t){return ae(function(){var e=_a(0,Dn(1,Xe(r,t)));return an(e,-1)})}function OB(r,t){return ae(function(){var e=hr(Xe(r,t),-1),n=no(Xe(Dn(1,r),t),-1);return _a(0,ot(1,Dn(n,e)))})}function _B(r,t){return ae(function(){var e=Math.log(2),n=Dn(t,r),a=Dn(ot(n,_c(Xe(-2,n))),e);return an(a,-1)})}function wc(r,t,e){return e===void 0&&(e=!1),ae(function(){if(e)t=fs(t);else{var n=hr(t,t.shape.length-1,!0);t=Xn(t,n)}return t=Jn(t,fn(),1-fn()),hs(hr(Xe(r.toFloat(),ci(t)),t.shape.length-1))})}function cd(r,t){return ae(function(){var e=_d(KF(r)).toInt(),n=(t=Jn(t,fn(),1-fn())).shape;return wc(bu(e,n[n.length-1]).reshape(n),t,!1)})}function MB(r,t){if(!Be.arraysEqual(r.shape,t.shape))throw new ee("logits and labels must have the same shape, but got shapes "+JSON.stringify(r.shape)+" and "+JSON.stringify(t.shape));return ae(function(){var e=t.relu(),n=t.abs().neg();return e.sub(t.mul(r)).add(n.exp().log1p())})}function hp(r,t){return ae(function(){var e;return e=Jn(t,fn(),1-fn()),e=ci(Xn(e,Dn(1,e))),an(MB(r,e),-1)})}function zB(r,t){return ae(function(){var e=Jn(r,fn(),1),n=Jn(t,fn(),1);return hr(Xe(r,ci(Xn(e,n))),-1)})}function LB(r,t){return ae(function(){var e=ci(ot(fn(),t));return an(Dn(t,Xe(r,e)),-1)})}function S0(r,t){return ae(function(){var e=ld(r,-1),n=ld(t,-1),a=Xe(e,n);return hs(hr(a,-1))})}var fd={meanSquaredError:ms,meanAbsoluteError:fp,meanAbsolutePercentageError:Wu,meanSquaredLogarithmicError:IB,squaredHinge:kB,hinge:DB,categoricalHinge:OB,logcosh:_B,categoricalCrossentropy:wc,sparseCategoricalCrossentropy:cd,binaryCrossentropy:hp,kullbackLeiblerDivergence:zB,poisson:LB,cosineProximity:S0};function cv(r){if(typeof r=="string"){if(r in fd)return fd[r];var t="Unknown loss "+r;throw r.toLowerCase().includes("softmaxcrossentropy")&&(t="Unknown loss "+r+'. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy'),new ee(t)}return r}function E0(r,t){return ae(function(){var e=Xe(.5,Nr(t)),n=qc(Bu(t,e),r.dtype);return an(ds(r,n),-1)})}function C0(r,t){return ae(function(){return qc(ds(bc(r,-1),bc(t,-1)),"float32")})}function dR(r,t){return ae(function(){return mi(r.equal(1),t.equal(1)).sum().cast("float32")})}function FB(r,t){return ae(function(){return mi(r.equal(1),t.equal(0)).sum().cast("float32")})}function BB(r,t){return ae(function(){return mi(r.equal(0),t.equal(1)).sum().cast("float32")})}function pR(r,t){return ae(function(){var e=dR(r,t),n=BB(r,t),a=e.add(n);return fi(Bu(a,0),e.div(a),0).cast("float32")})}function UB(r,t){return ae(function(){var e=dR(r,t),n=FB(r,t),a=e.add(n);return fi(Bu(a,0),e.div(a),0).cast("float32")})}function mR(r,t){return hp(r,t)}function gR(r,t){return r.rank===t.rank&&(r=r.squeeze([r.rank-1])),(t=t.argMax(-1)).dtype!==r.dtype&&(t=t.asType(r.dtype)),ds(r,t).asType("float32")}var PB=ms,VB=ms,jB=fp,WB=fp,HB=Wu,qB=Wu,A0=wc,GB=S0,vR=cd,hd={binaryAccuracy:E0,categoricalAccuracy:C0,precision:pR,categoricalCrossentropy:A0,sparseCategoricalCrossentropy:vR,mse:PB,MSE:VB,mae:jB,MAE:WB,mape:HB,MAPE:qB,cosine:GB};function XB(r){if(typeof r=="string"&&r in hd)return hd[r];if(typeof r!="string"&&r!=null)return r;throw new ee("Unknown metric "+r)}function Eh(r){if(xa(r!==null,"Unknown LossOrMetricFn "+r),typeof r=="string")return r;for(var t=void 0,e=0,n=Object.keys(fd);e<n.length;e++){var a=n[e];if(fd[a]===r){t=a;break}}if(t!==void 0)return t;for(var i=0,s=Object.keys(hd);i<s.length;i++)if(a=s[i],hd[a]===r){t=a;break}return t!==void 0?t:r.name}function $B(r){var t={Adagrad:function(){return Uo.adagrad(.01)},Adadelta:function(){return Uo.adadelta(1,.95,fn())},Adam:function(){return Uo.adam(.001,.9,.999,fn())},Adamax:function(){return Uo.adamax(.002,.9,.999,fn(),0)},RMSProp:function(){return Uo.rmsprop(.001,.9,0,fn())},SGD:function(){return Uo.sgd(.01)}};if(t.adagrad=t.Adagrad,t.adadelta=t.Adadelta,t.adam=t.Adam,t.adamax=t.Adamax,t.rmsprop=t.RMSProp,t.sgd=t.SGD,r in t)return t[r]();throw new ee("Unknown Optimizer "+r)}var VS=1048576;function jS(r,t,e){if(e===void 0&&(e=!1),r==null||typeof r!="object"||Object.getPrototypeOf(r)!==Object.prototype||!Jv(r))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(e){var n=JSON.stringify(r);n.length>VS&&console.warn('User-defined metadata of model "'+t+'" is too large in size (length='+n.length+" when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= "+VS+".")}}function Jv(r){if(r===null)return!0;if(typeof r=="object"){if(Object.getPrototypeOf(r)===Object.prototype){for(var t=0,e=Object.keys(r);t<e.length;t++){var n=e[t];if(typeof n!="string"||!Jv(r[n]))return!1}return!0}if(Array.isArray(r)){for(var a=0,i=r;a<i.length;a++)if(!Jv(i[a]))return!1;return!0}return!1}var s=typeof r;return s==="string"||s==="number"||s==="boolean"}function KB(r,t,e,n){n===void 0&&(n=console.log);var a,i=ZB(r),s=["Layer (type)","Output shape","Param #"];if(i?(t=t||65,e=e||[.45,.85,1]):(t=t||98,e=e||[.33,.55,.67,1]),e[e.length-1]<=1&&(e=e.map(function(g){return Math.floor(t*g)})),!i)for(var l in s.push("Receives inputs"),a=[],r.nodesByDepth)a.push.apply(a,r.nodesByDepth[l]);n("_".repeat(t)),dd(s,e,n),n("=".repeat(t));for(var c=r.layers,f=0;f<c.length;++f)i?QB(c[f],e,n):JB(c[f],e,a,n),n((f===c.length-1?"=":"_").repeat(t));r.checkTrainableWeightsConsistency();var d=YB(r),p=ud(r.nonTrainableWeights);n("Total params: "+(d+p)),n("Trainable params: "+d),n("Non-trainable params: "+p),n("_".repeat(t))}function YB(r){return r.collectedTrainableWeights!=null?ud(r.collectedTrainableWeights):ud(r.trainableWeights)}function ZB(r){var t=!0,e=[],n=[];for(var a in r.nodesByDepth)e.push(r.nodesByDepth[a]);for(var i=0,s=e;i<s.length;i++){var l=s[i];if(l.length>1||l.length===1&&l[0].inboundLayers.length>1){t=!1;break}n.push.apply(n,l)}if(t)for(var c=0,f=r.layers;c<f.length;c++){for(var d=!1,p=0,g=f[c].inboundNodes;p<g.length;p++){var v=g[p];if(n.indexOf(v)!==-1){if(d){t=!1;break}d=!0}}if(!t)break}return t}function dd(r,t,e){e===void 0&&(e=console.log);for(var n="",a=0;a<r.length;++a)a>0&&(n=n.slice(0,n.length-1)+" "),n=(n+=r[a]).slice(0,t[a]),n+=" ".repeat(t[a]-n.length);e(n)}function QB(r,t,e){var n;try{n=JSON.stringify(r.outputShape)}catch{n="multiple"}dd([r.name+" ("+r.getClassName()+")",n,r.countParams().toString()],t,e)}function JB(r,t,e,n){var a;try{a=JSON.stringify(r.outputShape)}catch{a="multiple"}for(var i=[],s=0,l=r.inboundNodes;s<l.length;s++){var c=l[s];if(!(e!=null&&e.length>0&&e.indexOf(c)===-1))for(var f=0;f<c.inboundLayers.length;++f){var d=c.inboundLayers[f].name,p=c.nodeIndices[f],g=c.tensorIndices[f];i.push(d+"["+p+"]["+g+"]")}}var v=r.name,b=r.getClassName(),w=i.length===0?"":i[0];for(dd([v+" ("+b+")",a,r.countParams().toString(),w],t,n),f=1;f<i.length;++f)dd(["","","",i[f]],t,n)}function yR(r,t,e){return(r==="inboundNodes"||r==="outputLayers"||r==="inputLayers")&&t===0&&typeof e=="string"}function xc(r,t){if(r===null)return null;if(typeof r=="string")return jo(r);if(typeof r=="number"||typeof r=="boolean")return r;if(r instanceof Array){for(var e=[],n=r.length,a=0;a<n;++a){var i=r[a];yR(t,a,i)?e.push(i):e.push(xc(i,t))}return e}for(var s={},l=0,c=Object.keys(r);l<c.length;l++){var f=c[l],d=r[f];if(f==="name"&&typeof d=="string")s[f]=d;else{var p=jo(f);s[p]=xc(d,p)}}return s}function ey(r,t){if(r==null)return null;if(typeof r=="string")return ti(r);if(typeof r=="number"||typeof r=="boolean")return r;if(r instanceof Array){for(var e=[],n=r.length,a=0;a<n;++a){var i=r[a];yR(t,a,i)?e.push(i):e.push(ey(i,t))}return e}for(var s={},l=0,c=Object.keys(r);l<c.length;l++){var f=c[l],d=r[f],p=ti(f);s[p]=f!=="name"&&f!=="className"||typeof d!="string"?ey(d,f):d}return s}var dp="1.3.1";function eU(r,t){if(r.dtype==null||r.dtype===t.dtype)return t;try{return Td(t,r.dtype)}catch{throw new ee("The dtype of the feed ("+t.dtype+") can not be cast to the dtype of the key '"+r.name+"' ("+r.dtype+").")}}var fu=function(){function r(t){if(this.id2Value={},this.id2Mask={},this.name2Id={},t instanceof r)for(var e in t.id2Value)this.id2Value[e]=t.id2Value[e],e in t.id2Mask&&(this.id2Mask[e]=t.id2Mask[e]);else{if(t==null)return;for(var n=0,a=t;n<a.length;n++){var i=a[n];this.add(i.key,i.value)}}}return r.prototype.add=function(t,e,n){if(this.id2Value[t.id]!=null)throw new ee("Duplicate key: name="+t.name+", id="+t.id);return this.id2Value[t.id]=eU(t,e),this.name2Id[t.name]=t.id,n!=null&&(this.id2Mask[t.id]=n),this},r.prototype.addFeed=function(t){this.add(t.key,t.value)},r.prototype.hasKey=function(t){return this.id2Value[t.id]!=null},r.prototype.names=function(){return Object.keys(this.name2Id)},r.prototype.getValue=function(t){if(t instanceof ra){if(this.id2Value[t.id]==null)throw new ee("Nonexistent key: "+t.name);return this.id2Value[t.id]}var e=this.name2Id[t];if(e==null)throw new ee("Feed dict has no SymbolicTensor name: "+t);return this.id2Value[e]},r.prototype.getMask=function(t){if(t instanceof ra){if(this.id2Value[t.id]==null)throw new ee("Nonexistent key: "+t.name);return this.id2Mask[t.id]}var e=this.name2Id[t];if(e==null)throw new ee("Feed dict has no SymbolicTensor name: "+t);return this.id2Mask[e]},r.prototype.disposeMasks=function(){this.id2Mask!=null&&et(this.id2Mask)},r}(),fv={},WS={};function tc(r,t,e,n){for(var a=e!=null&&e.training,i=Array.isArray(r),s=i?r:[r],l=s.map(function(L){return L.name}),c=[],f=t.names(),d=0,p=l;d<p.length;d++){var g=p[d];f.indexOf(g)!==-1?c.push(t.getValue(g)):c.push(null)}var v,b,w=l.join(",")+"|"+t.names().join(",");if(fv[w]==null){var S=tU(s,t);v=S.sorted,b=S.recipientCounts,fv[w]=v,WS[w]=b}v=fv[w],b={},a||Object.assign(b,WS[w]);for(var x=new fu(t),C=0;C<v.length;++C){var A=v[C],T=A.sourceLayer;if(!(T instanceof $c)){for(var R=[],O=[],N=[],D=!1,I=0,_=A.inputs;I<_.length;I++){var F=_[I],B=x.getValue(F),V=x.getMask(F);R.push(B),O.push(V),V!=null&&(D=!0),a||(b[F.name]--,b[F.name]!==0||t.hasKey(F)||l.indexOf(F.name)!==-1||B.isDisposed||F.sourceLayer.stateful===!0||N.push(B))}D&&((e=e||{}).mask=O[0]);var X=_t(T.apply(R,e)),Y=null;T.supportsMasking&&(Y=T.computeMask(R,O));for(var j=rU(A),G=Array.isArray(j)?j:[j],q=0;q<G.length;++q){x.hasKey(G[q])||x.add(G[q],X[q],Array.isArray(Y)?Y[0]:Y);var ne=l.indexOf(G[q].name);ne!==-1&&(c[ne]=X[q])}a||et(N)}}return x.disposeMasks(),i?c:c[0]}function tU(r,t){Be.assert(r!=null&&r.length>0,function(){return"Expected at least one fetch, got none"});var e=[],n={};if(r.length===1){var a=HS(r[0],t);e=a.sorted,n=a.recipientMap}else for(var i=new Set,s=0,l=r;s<l.length;s++){for(var c=HS(l[s],t),f=c.sorted,d=c.recipientMap,p=0,g=f;p<g.length;p++){var v=g[p];i.has(v.name)||(e.push(v),i.add(v.name))}var b=function(S){n[S]==null&&(n[S]=new Set),d[S].forEach(function(x){return n[S].add(x)})};for(var w in d)b(w)}return{sorted:e,recipientCounts:nU(n)}}function nU(r){var t={};for(var e in r)t[e]=r[e].size;return t}function HS(r,t){for(var e=new Set,n=[],a={},i=0,s=t.names();i<s.length;i++){var l=s[i];e.add(l)}var c=[],f=[];for(c.push(r);c.length>0;){var d=c[c.length-1];if(e.has(d.name))c.pop();else{var p=f[f.length-1]===c.length-1;if(d.inputs.length===0||p)c.pop(),n.push(d),e.add(d.name),p&&f.pop();else{f.push(c.length-1);for(var g=0,v=d.inputs;g<v.length;g++){var b=v[g];a[b.name]==null&&(a[b.name]=new Set),a[b.name].add(d.name),e.has(b.name)||c.push(b)}}}}return{sorted:n,recipientMap:a}}function rU(r){var t;if(r.sourceLayer.inboundNodes.length===1)t=r.sourceLayer.output;else{for(var e=null,n=0;n<r.sourceLayer.inboundNodes.length;++n)for(var a=0,i=r.sourceLayer.inboundNodes[n].outputTensors;a<i.length;a++)if(i[a].id===r.id){e=n;break}t=r.sourceLayer.getOutputAt(e)}return t}var aU=function(r){function t(e){var n=r.call(this,{})||this;if(n.containerNodes=new Set,n.name=e.name,n.name==null){var a=n.getClassName().toLowerCase();n.name=lp(a)}if(n.supportsMasking=!1,n.trainable_=!0,Array.isArray(e.inputs)?n.inputs=e.inputs.slice():n.inputs=[e.inputs],Array.isArray(e.outputs)?n.outputs=e.outputs.slice():n.outputs=[e.outputs],Qi(n.inputs).length!==n.inputs.length)throw new ee("The list of inputs passed to the model is redundant. All inputs should only appear once. Found: "+n.inputs.map(function(Ge){return Ge.name}));Qi(n.outputs).length!==n.outputs.length&&console.warn("The list of outputs passed to the model is redundant. All outputs should only appear once. Found: "+n.outputs.map(function(Ge){return Ge.name})),n.inputLayers=[],n.inputLayersNodeIndices=[],n.inputLayersTensorIndices=[],n.outputLayers=[],n.outputLayersNodeIndices=[],n.outputLayersTensorIndices=[],n.layers=[],n.internalContainerRefs=[];for(var i=0,s=n.outputs;i<s.length;i++){var l=(_=s[i]).sourceLayer,c=_.nodeIndex,f=_.tensorIndex;n.outputLayers.push(l),n.outputLayersNodeIndices.push(c),n.outputLayersTensorIndices.push(f)}for(var d=0,p=n.inputs;d<p.length;d++)l=(_=p[d]).sourceLayer,c=_.nodeIndex,f=_.tensorIndex,xa(c===0,"input layer has >1 nodes"),xa(f===0,"input layer has >1 tensors"),n.inputLayers.push(l),n.inputLayersNodeIndices.push(c),n.inputLayersTensorIndices.push(f);n.inputNames=[],n.outputNames=[],n.feedInputShapes=[],n.feedInputNames=[],n.feedOutputNames=[];for(var g=0;g<n.inputLayers.length;g++){if(!((l=n.inputLayers[g])instanceof $c))throw new TypeError("Input layers to a LayersModel must be InputLayer objects. Received inputs: "+e.inputs+". Input "+g+" (0-based) originates from layer type "+l.getClassName()+".");n.inputNames.push(l.name),n.feedInputShapes.push(l.batchInputShape),n.feedInputNames.push(l.name)}for(var v=0,b=n.outputLayers;v<b.length;v++)l=b[v],n.outputNames.push(l.name);n.internalInputShapes=n.inputs.map(function(Ge){return Ge.shape}),n.internalOutputShapes=n.outputs.map(function(Ge){return Ge.shape});for(var w={},S={},x={},C={},A={},T=[],R=function(Ge,kt,Bt,Gt,Pn,mn){Gt!=null&&Pn!=null&&mn!=null||(Gt=Ge.sourceLayer,Pn=Ge.nodeIndex,mn=Ge.tensorIndex);var Xt=Gt.inboundNodes[Pn];if(Bt.indexOf(Xt)!==-1)throw new Ca("The tensor "+Ge.name+' at layer "'+Gt.name+'" is part of a cycle.');if(kt.indexOf(Xt)===-1){n.containerNodes.add(t.nodeKey(Gt,Pn)),Gt.id in A||(A[Gt.id]=Object.keys(A).length),Bt.indexOf(Xt)===-1&&Bt.push(Xt);for(var pr=Xt.inboundLayers.length,tr=0;tr<pr;tr++){var $r=Xt.inputTensors[tr],Dr=Xt.inboundLayers[tr],gn=Xt.nodeIndices[tr],Ma=Xt.tensorIndices[tr];R($r,kt,Bt,Dr,gn,Ma)}for(kt.push(Xt);Bt.indexOf(Xt)>=0;)Bt.splice(Bt.indexOf(Xt),1);T.push(Xt)}},O=[],N=[],D=0,I=n.outputs;D<I.length;D++){var _=I[D];R(_,O,N)}for(var F=0,B=T.slice().reverse();F<B.length;F++){S[(Se=B[F]).id]=Se,Se.id in w||(w[Se.id]=0);var V=w[Se.id],X=x[Se.outboundLayer.id]==null?0:x[Se.outboundLayer.id];for(V=Math.max(V,X),x[Se.outboundLayer.id]=V,C[Se.outboundLayer.id]=Se.outboundLayer,w[Se.id]=V,g=0;g<Se.inboundLayers.length;g++){var Y=Se.inboundLayers[g],j=(c=Se.nodeIndices[g],Y.inboundNodes[c]),G=w[j.id]==null?0:w[j.id];w[j.id]=Math.max(V+1,G),S[j.id]=j}}var q={};for(var ne in w)(V=w[ne])in q||(q[V]=[]),q[V].push(S[ne]);var L={};for(var Z in x)(V=x[Z])in L||(L[V]=[]),L[V].push(C[Z]);var ce=Object.keys(L).map(function(Ge){return parseInt(Ge,10)}).sort(wh);n.layers=[];for(var le=0,de=ce;le<de.length;le++){var xe=L[V=de[le]];xe.sort(function(Ge,kt){var Bt=A[Ge.id],Gt=A[kt.id];return Bt<Gt?-1:Bt>Gt?1:0});for(var we=0,_e=xe;we<_e.length;we++)(l=_e[we])instanceof t&&n.internalContainerRefs.push(l),n.layers.push(l)}n.layersByDepth=L,ce=Object.keys(q).map(function(Ge){return parseInt(Ge,10)}).sort(wh);for(var Ee=n.inputs.slice(),ke=[],Ue=0,Fe=ce;Ue<Fe.length;Ue++)for(var rt=0,qe=q[V=Fe[Ue]];rt<qe.length;rt++){var Se;if((l=(Se=qe[rt]).outboundLayer)!=null){for(var dt=0,Je=Se.inputTensors;dt<Je.length;dt++)if(_=Je[dt],Ee.indexOf(_)===-1)throw new Ca("Graph disconnected: cannot obtain value for tensor "+_+' at layer "'+l.name+'". The following previous layers were accessed without issue: '+ke);for(var Pt=0,Cn=Se.outputTensors;Pt<Cn.length;Pt++)_=Cn[Pt],Ee.push(_);ke.push(l.name)}}n.nodesByDepth=q;for(var en=n.layers.map(function(Ge){return Ge.name}),Ft=function(Ge){var kt=en.filter(function(Bt){return Bt===Ge}).length;if(kt!==1)throw new Ca('The name "'+Ge+'" is used '+kt+" times in the model. All layer names should be unique. Layer names: "+JSON.stringify(en))},Vt=0,Un=en;Vt<Un.length;Vt++)Ft(Un[Vt]);return n.outboundNodes=[],n.inboundNodes=[],new cp({outboundLayer:n,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:n.inputs,outputTensors:n.outputs,inputMasks:n.inputs.map(function(Ge){return null}),outputMasks:n.outputs.map(function(Ge){return null}),inputShapes:n.inputs.map(function(Ge){return Ge.shape}),outputShapes:n.outputs.map(function(Ge){return Ge.shape})}),n.built=!0,n._refCount=1,n}return pe(t,r),t.prototype.assertNotDisposed=function(){if(this._refCount===0)throw new Error("Container '"+this.name+"' is already disposed.")},t.prototype.dispose=function(){this.assertNotDisposed();var e={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount==0){for(var n=0,a=this.layers;n<a.length;n++){var i=a[n];e.numDisposedVariables+=i.dispose().numDisposedVariables}for(var s=0,l=this.internalContainerRefs;s<l.length;s++){var c=l[s];e.numDisposedVariables+=c.dispose().numDisposedVariables}}return e.refCountAfterDispose=this._refCount,e},Object.defineProperty(t.prototype,"trainable",{get:function(){return this.trainable_},set:function(e){this.layers.forEach(function(n){n._trainableWeights.forEach(function(a){return a.trainable=e})}),this.trainable_=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"trainableWeights",{get:function(){if(this._trainableWeights.length>0)throw new ee("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];for(var e=[],n=0,a=this.layers;n<a.length;n++){var i=a[n];e=e.concat(i.trainableWeights)}return e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nonTrainableWeights",{get:function(){for(var e=[],n=0,a=this.layers;n<a.length;n++){var i=a[n];e.push.apply(e,i.nonTrainableWeights)}if(!this.trainable){for(var s=[],l=0,c=this.layers;l<c.length;l++)i=c[l],s.push.apply(s,i.trainableWeights);return s.concat(e)}return e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"weights",{get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)},enumerable:!0,configurable:!0}),t.prototype.loadWeights=function(e,n){n===void 0&&(n=!0);for(var a={},i=0,s=0,l=this.layers;s<l.length;s++)for(var c=0,f=l[s].weights;c<f.length;c++){var d=f[c];if(a[d.originalName]!=null)throw new ee("Duplicate weight name: "+d.originalName);a[d.originalName]=d,i++}var p=[];for(var g in e){if(a[g]!=null)p.push([a[g],e[g]]);else if(n)throw new ee("Provided weight data has no target variable: "+g);delete a[g]}if(n){var v=[];for(var b in a)v.push(b);if(v.length>0)throw new ee(v.length+" of "+i+" weights are not set: "+v)}x0(p)},t.prototype.updatedConfig=function(){var e=this.getConfig(),n={};return n.className=this.getClassName(),n.config=e,n.kerasVersion="tfjs-layers "+dp,n.backend="TensorFlow.js",n},t.prototype.toJSON=function(e,n){n===void 0&&(n=!0);var a=ey(this.updatedConfig());return n?JSON.stringify(a):a},t.prototype.call=function(e,n){var a=this;return ae(function(){e=_t(e);for(var i=new fu,s=0;s<a.inputs.length;++s)i.add(a.inputs[s],e[s]);return tc(a.outputs,i,n)})},t.prototype.computeMask=function(e,n){var a=this;return ae(function(){var i;return e=_t(e),i=n==null?rs(null,e.length):_t(n),a.runInternalGraph(e,i)[1]})},t.prototype.computeOutputShape=function(e){var n=sd(e);if(n.length!==this.inputLayers.length)throw new ee("Invalid inputShape argument "+e+": model has "+this.inputLayers.length+" tensor inputs.");for(var a={},i=0;i<n.length;i++){var s=this.inputLayers[i],l=n[i];a[I=s.name+"_0_0"]=l}var c=Object.keys(this.nodesByDepth).map(function(F){return parseInt(F,10)}).sort(wh);if(c.length>1)for(var f=0,d=c;f<d.length;f++)for(var p=d[f],g=0,v=this.nodesByDepth[p];g<v.length;g++){var b=v[g];if(s=b.outboundLayer,this.inputLayers.map(function(F){return F.id}).indexOf(s.id)===-1){for(var w=[],S=0;S<b.inboundLayers.length;S++){var x=b.inboundLayers[S],C=b.nodeIndices[S],A=b.tensorIndices[S],T=a[I=x.name+"_"+C+"_"+A];w.push(T)}var R=sd(s.computeOutputShape(Yn(w))),O=s.inboundNodes.indexOf(b);for(S=0;S<R.length;S++)a[I=s.name+"_"+O+"_"+S]=R[S]}}var N=[],D=[];for(i=0;i<this.outputLayers.length;i++){s=this.outputLayers[i],O=this.outputLayersNodeIndices[i],A=this.outputLayersTensorIndices[i];var I=s.name+"_"+O+"_"+A;D.push(I)}for(i=0;i<D.length;i++){var _=D[i];xa(_ in a),N.push(a[_])}return Yn(N)},t.prototype.runInternalGraph=function(e,n){n==null&&(n=rs(null,e.length));for(var a={},i=0;i<this.inputs.length;++i){var s=this.inputs[i],l=e[i],c=n[i];a[s.id]=[l,c]}for(var f=0,d=Object.keys(this.nodesByDepth).map(function(L){return parseInt(L,10)}).sort(wh);f<d.length;f++)for(var p=d[f],g=0,v=this.nodesByDepth[p];g<v.length;g++){for(var b=v[g],w=b.outboundLayer,S=b.inputTensors,x=b.outputTensors,C=new Array,A=0,T=S;A<T.length;A++)(s=T[A]).id in a&&C.push(a[s.id]);if(C.length===S.length){var R={},O=void 0,N=void 0,D=void 0,I=void 0;if(b.callArgs!=null&&(R=b.callArgs),C.length===1){var _=C[0],F=_[0],B=_[1];R.mask==null&&(R.mask=B),D=_t(w.call(F,R)),I=_t(w.computeMask(F,B)),O=[F],N=[B]}else O=C.map(function(L){return L[0]}),N=C.map(function(L){return L[1]}),R.mask==null&&(R.mask=N),D=_t(w.call(O,R)),I=_t(w.computeMask(O,N));if(w.activityRegularizer)throw new tt("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(i=0;i<x.length;++i)s=x[i],l=D[i],c=I[i],a[s.id]=[l,c]}}for(var V=[],X=[],Y=[],j=0,G=this.outputs;j<G.length;j++){xa((s=G[j]).id in a,"Could not compute output "+s.name+" : "+s.id);var q=a[s.id],ne=q[0];c=q[1],Y.push(ne.shape),V.push(ne),X.push(c)}return[V,X,Y]},t.prototype.buildNodeConversionMap=function(e){for(var n,a={},i=0,s=this.layers;i<s.length;i++){var l=s[i];n=l instanceof t?1:0;for(var c=0;c<l.inboundNodes.length;c++){var f=t.nodeKey(l,c);this.containerNodes.has(f)&&(a[f]=n,n+=1)}}return a},t.prototype.getLayer=function(e,n){if(n!=null){if(this.layers.length<=n)throw new ee("Was asked to retrieve layer at index "+n+", but model only has "+this.layers.length+" layer(s).");return this.layers[n]}if(e==null)throw new ee("Provide either a layer name or layer index");for(var a=0,i=this.layers;a<i.length;a++){var s=i[a];if(s.name===e)return s}throw new ee("No such layer: "+e)},t.prototype.calculateLosses=function(){var e=this;return ae(function(){for(var n=[],a=0,i=e.layers;a<i.length;a++)for(var s=i[a],l=0;l<s.inboundNodes.length;++l){var c=t.nodeKey(s,l);e.containerNodes.has(c)&&n.push.apply(n,s.calculateLosses())}return n})},t.prototype.getConfig=function(){for(var e={name:this.name},n=this.buildNodeConversionMap(this.layers),a=[],i=0,s=this.layers;i<s.length;i++){for(var l=(R=s[i]).getClassName(),c=R.getConfig(),f=[],d=0;d<R.inboundNodes.length;d++){var p=R.inboundNodes[d],g=t.nodeKey(R,d),v={};if(this.containerNodes.has(g)){if(p.callArgs)try{JSON.stringify(p.callArgs),v=p.callArgs}catch{console.warn("Layer "+R.name+" was passed non-serializable keyword arguments: "+p.callArgs+". They will not be included in the serialized model (and thus will be missing at deserialization time)."),v={}}if(p.inboundLayers.length>0){for(var b=[],w=0;w<p.inboundLayers.length;w++){var S=p.inboundLayers[w],x=p.nodeIndices[w],C=p.tensorIndices[w];(N=n[t.nodeKey(S,x)])==null&&(N=0),b.push([S.name,N,C,v])}f.push(b)}}}var A={};A.name=R.name,A.className=l,A.config=c,A.inboundNodes=f,a.push(A)}e.layers=a;var T=[];for(w=0;w<this.inputLayers.length;w++){var R=this.inputLayers[w];x=this.inputLayersNodeIndices[w],g=t.nodeKey(R,x),this.containerNodes.has(g)&&((N=n[g])!==null&&N!==void 0||(N=0),C=this.inputLayersTensorIndices[w],T.push([R.name,N,C]))}e.inputLayers=T;var O=[];for(w=0;w<this.outputLayers.length;w++)if(R=this.outputLayers[w],x=this.outputLayersNodeIndices[w],g=t.nodeKey(R,x),this.containerNodes.has(g)){var N;(N=n[g])!==null&&N!==void 0||(N=0),C=this.outputLayersTensorIndices[w],O.push([R.name,N,C])}return e.outputLayers=O,e},t.fromConfig=function(e,n,a,i){i===void 0&&(i=!1);var s={},l={};function c(j,G){j.name in l?l[j.name].push(G):l[j.name]=[G]}function f(j,G){for(var q,ne=[],L=0,Z=G;L<Z.length;L++){var ce=Z[L],le=ce[0],de=ce[1],xe=ce[2];if(q=ce[3]==null?{}:ce[3],!(le in s))return void c(j,G);var we=s[le];if(we.inboundNodes.length<=de)return void c(j,G);var _e=we.inboundNodes[de];ne.push(_e.outputTensors[xe])}ne.length>0&&j.apply(Yn(ne),q)}function d(j){var G=j.name,q=aa(j,n.customObjects!=null?n.customObjects:{});q.setFastWeightInitDuringBuild(i),s[G]=q,j.inboundNodes.forEach(function(ne){if(!(ne instanceof Array))throw new ee("Corrupted configuration, expected array for nodeData: "+ne);c(q,ne)})}for(var p=n.name,g=n.layers,v=0,b=g;v<b.length;v++)d(x=b[v]);for(;!MF(l);)for(var w=0,S=g;w<S.length;w++){var x=S[w];if((Y=s[x.name]).name in l){var C=l[Y.name];delete l[Y.name];for(var A=0,T=C;A<T.length;A++)f(Y,T[A])}}for(var R=[],O=[],N=0,D=n.inputLayers;N<D.length;N++){var I=(x=D[N])[0],_=x[1],F=x[2];xa(I in s);var B=(Y=s[I]).inboundNodes[_].outputTensors;R.push(B[F])}for(var V=0,X=n.outputLayers;V<X.length;V++){I=(x=X[V])[0],_=x[1],F=x[2],xa(I in s);var Y;B=(Y=s[I]).inboundNodes[_].outputTensors,O.push(B[F])}return new e({inputs:R,outputs:O,name:p})},Object.defineProperty(t.prototype,"stateful",{get:function(){if(this._stateful)throw new ee("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(var e=0,n=this.layers;e<n.length;e++)if(n[e].stateful)return!0;return!1},enumerable:!0,configurable:!0}),t.prototype.resetStates=function(){var e=this;ae(function(){e.layers.forEach(function(n){n.stateful&&n.resetStates()})})},t}(ft);function iU(r,t,e){var n=t.length;if(r==null||Array.isArray(r)&&r.length===0)return t.map(function(i){return null});if(n===1)return Array.isArray(r)&&r.length===1?r:typeof r=="object"&&t[0]in r?[r[t[0]]]:[r];if(Array.isArray(r)){if(r.length!==n)throw new Error("Provided "+e+" is an array of "+r.length+" element(s), but the model has "+n+" outputs. Make sure a set of weights is provided for each model output.");return r}if(typeof r=="object"&&Object.keys(r).length>0&&typeof r[Object.keys(r)[0]]=="object"){var a=[];return t.forEach(function(i){i in r?a.push(r[i]):a.push(null)}),a}throw new Error("The model has multiple ("+n+") outputs, so "+e+" must be either an array with "+n+" elements or an object with "+t+" keys. Provided "+e+" not understood: "+JSON.stringify(r))}function bR(r,t){return iU(r,t,"classWeight")}function wR(r,t,e,n){return He(this,void 0,void 0,function(){var a,i,s,l,c;return Ve(this,function(f){switch(f.label){case 0:return e==null?[3,2]:(a=ae(function(){if(r.shape.length===1)return r.clone();if(r.shape.length===2){if(r.shape[1]>1)return r.argMax(1);if(r.shape[1]===1)return r.reshape([r.shape[0]]);throw new Error("Encountered unexpected last-dimension size ("+r.shape[1]+") during handling of class weights. The size is expected to be >= 1.")}throw new Error("Unexpected rank of target (y) tensor ("+r.rank+") during handling of class weights. The rank is expected to be 1 or 2.")}),l=(s=Array).from,[4,a.data()]);case 1:return i=l.apply(s,[f.sent()]),et(a),c=[],i.forEach(function(d){if(e[d]==null)throw new Error("classWeight must contain all classes in the training data. The class "+d+" exists in the data but not in classWeight");c.push(e[d])}),[2,fr(c,"float32")];case 2:return[2,null]}})})}function oU(r,t){return Xe(r,t)}var sU=32;function xR(r,t){var e,n,a=t;e=a.xs,n=a.ys,Be.assert(e!=null&&n!=null,function(){return"A Dataset iterator for fitDataset() is expected to generate objects of the form `{xs: xVal, ys: yVal}`, where the two values may be `tf.Tensor`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates "+t});var i=qS("input",r.inputNames,e),s=qS("output",r.outputNames,n),l=i[0].shape[0];Be.assert(i.length===r.inputs.length,function(){return"LayersModel has "+r.inputs.length+" inputs, but the dataset provides "+i.length+" inputs.  (Expected input keys: "+JSON.stringify(r.inputNames)+")"}),Be.assert(s.length===r.outputs.length,function(){return"LayersModel has "+r.outputs.length+" outputs, but the dataset provides "+s.length+" outputs.  (Expected output keys: "+JSON.stringify(r.outputNames)+")"});var c=function(g){Be.assert(i[g].shape[0]===l,function(){return"Batch size mismatch: input "+r.inputNames[g]+" has "+i[g].shape[0]+"; expected  "+l+" based on input "+r.inputNames[0]+"."})};for(var f in i)c(f);var d=function(g){Be.assert(s[g].shape[0]===l,function(){return"Batch size mismatch: output "+r.outputNames[g]+" has "+s[g].shape[0]+"; expected  "+l+" based on input "+r.inputNames[0]+"."})};for(var p in s)d(p);return{xs:i,ys:s}}function qS(r,t,e){if(e instanceof Ct)return[e];if(Array.isArray(e))return Be.assert(e.length===t.length,function(){return"Received an array of "+e.length+" Tensors, but expected "+t.length+" to match the "+r+" keys "+t+"."}),e;for(var n=[],a=0,i=t;a<i.length;a++){var s=i[a];if(e[s]==null)throw new ee("The feature data generated by the dataset lacks the required "+r+" key '"+s+"'.");n.push(e[s])}return n}function uU(r){if(r.length===3)throw new tt("Validation with sample weights is not implemented yet.");return{xs:r[0],ys:r[1]}}function lU(r,t,e){return He(this,void 0,void 0,function(){var n,a,i,s,l,c,f,d,p,g,v,b,w,S,x,C,A,T,R,O,N,D,I,_,F,B,V,X,Y,j,G,q,ne,L;return Ve(this,function(Z){switch(Z.label){case 0:if(n=e.batchesPerEpoch!=null,Be.assert(r.optimizer!=null,function(){return"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."}),Be.assert(e!=null,function(){return"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."}),Be.assert(e.epochs!=null&&e.epochs>0&&Number.isInteger(e.epochs),function(){return"For fitDataset(), config.epochs is expected to be a positive integer, but got "+e.epochs}),Be.assert(!n||e.batchesPerEpoch>0&&Number.isInteger(e.batchesPerEpoch),function(){return"For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got "+e.batchesPerEpoch}),Be.assert(e.validationSplit==null,function(){return"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."}),r.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");r.isTraining=!0,Z.label=1;case 1:return Z.trys.push([1,,26,27]),a=e.validationData!=null,i=void 0,s=void 0,a&&(GS(e.validationData)?Be.assert(e.validationBatches==null||e.validationBatches>0&&Number.isInteger(e.validationBatches),function(){return"For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got "+e.validationBatches}):(l=uU(e.validationData),i=l.xs,s=l.ys)),c=r.makeTrainFunction(),f=r.getDedupedMetricsNames(),d=void 0,d=a?f.slice().concat(f.map(function(ce){return"val_"+ce})):f.slice(),p=cR(e.callbacks,e.yieldEvery),g=e.verbose==null?1:e.verbose,v=hR(p,g,e.epochs,null,null,cU(t,e),null,a,d),b=v.callbackList,w=v.history,b.setModel(r),r.history=w,[4,b.onTrainBegin()];case 2:return Z.sent(),r.stopTraining_=!1,S=e.initialEpoch==null?0:e.initialEpoch,[4,t.iterator()];case 3:x=Z.sent(),Z.label=4;case 4:return S<e.epochs?(C={},[4,b.onEpochBegin(S)]):[3,23];case 5:return Z.sent(),A=0,T=0,n?[3,7]:[4,t.iterator()];case 6:x=Z.sent(),Z.label=7;case 7:return!n||A<e.batchesPerEpoch?[4,x.next()]:[3,21];case 8:return R=Z.sent(),n&&R.done?(console.warn("You provided `batchesPerEpoch` as "+e.batchesPerEpoch+", but your dataset iterator ran out of data after "+A+" batches; interrupting training. Make sure that your dataset can generate at least `batchesPerEpoch * epochs` batches (in this case, "+e.batchesPerEpoch*e.epochs+" batches). You may need to use the repeat() function when building your dataset."),[3,21]):R.value==null?[3,15]:(O=xR(r,R.value),N=O.xs,D=O.ys,(I={}).batch=T,I.size=N[0].shape[0],[4,b.onBatchBegin(T,I)]);case 9:if(Z.sent(),_=[],e.classWeight==null)return[3,13];F=bR(e.classWeight,r.outputNames),L=0,Z.label=10;case 10:return L<F.length?(V=(B=_).push,[4,wR(D[L],null,F[L])]):[3,13];case 11:V.apply(B,[Z.sent()]),Z.label=12;case 12:return++L,[3,10];case 13:for(X=N.concat(D).concat(_),Y=c(X),et(X),L=0;L<f.length;++L)j=f[L],G=Y[L],I[j]=G,Na(G);return[4,b.onBatchEnd(T,I)];case 14:Z.sent(),oR(I),T++,A++,Z.label=15;case 15:return(n?A>=e.batchesPerEpoch:R.done)?a?(q=void 0,GS(e.validationData)?(ne=_t,[4,r.evaluateDataset(e.validationData,{batches:e.validationBatches})]):[3,17]):[3,19]:[3,20];case 16:return q=ne.apply(void 0,[Z.sent()]),[3,18];case 17:q=_t(r.evaluate(i,s,{batchSize:e.validationBatchSize==null?sU:e.validationBatchSize,verbose:0})),Z.label=18;case 18:for(L=0;L<r.metricsNames.length;++L)C["val_"+r.metricsNames[L]]=q[L];Z.label=19;case 19:return[3,21];case 20:return r.stopTraining_?[3,21]:[3,7];case 21:return[4,b.onEpochEnd(S,C)];case 22:return Z.sent(),S++,r.stopTraining_?[3,23]:[3,4];case 23:return[4,b.onTrainEnd()];case 24:return Z.sent(),[4,r.history.syncData()];case 25:return Z.sent(),[2,r.history];case 26:return r.isTraining=!1,[7];case 27:return[2]}})})}function cU(r,t){var e=null;return t.batchesPerEpoch!=null?e=t.batchesPerEpoch:Number.isFinite(r.size)&&(e=r.size),e}function GS(r){return typeof r.iterator=="function"}function fU(r){return typeof r.next=="function"}function hU(r,t,e){return He(this,void 0,void 0,function(){var n,a,i,s,l,c,f,d,p,g;return Ve(this,function(v){switch(v.label){case 0:if(n=(e=e||{}).batches!=null,a=r.testFunction,i=[],e.verbose>0)throw new tt("Verbose mode is not implemented yet.");return Be.assert(!n||e.batches>0&&Number.isInteger(e.batches),function(){return"Test loop expects `batches` to be a positive integer, but received "+JSON.stringify(e.batches)}),fU(t)?(l=t,[3,3]):[3,1];case 1:return[4,t.iterator()];case 2:l=v.sent(),v.label=3;case 3:s=l,c=0,f=0,d=function(){var b;return Ve(this,function(w){switch(w.label){case 0:return[4,s.next()];case 1:return b=w.sent(),i=ae(function(){if(b.value){var S=xR(r,b.value),x=S.xs,C=S.ys,A=x.concat(C),T=ae(function(){return a(A)});if(et(A),f===0)for(var R=0;R<T.length;++R)i.push(Re(0));var O=A[0].shape[0],N=function(D){var I=T[D],_=i[D];i[D]=ae(function(){return ot(i[D],Xe(O,I))}),f>0&&et(_)};for(R=0;R<T.length;++R)N(R);et(T),c+=O,++f}return i}),b.done?(n&&console.warn("Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least `batches` batches (in this case, "+e.batches+" batches). You may need to use the repeat() function when building your dataset."),[2,"break"]):[2]}})},v.label=4;case 4:return!n||f<e.batches?[5,d()]:[3,6];case 5:return v.sent()==="break"?[3,6]:[3,4];case 6:for(p=0;p<i.length;++p)g=i[p],i[p]=Xn(i[p],c),et(g);return[2,Yn(i)]}})})}function ty(r){Be.assert(r>0&&Number.isInteger(r),function(){return"batchSize is required to be a positive integer, but got "+r})}function nc(r,t,e){return r==null?[null]:Array.isArray(r)?r.map(function(n){return Yo(n,t,e-t)}):Yo(r,t,e-t)}function T0(r,t){return ae(function(){return r==null?null:Array.isArray(r)?r.map(function(e){return T0(e,t)}):XN(r,t.dtype==="int32"?t:t.toInt())})}function ny(r,t){for(var e=[],n=0,a=null;n<r;)(a=n+t)>=r&&(a=r),e.push([n,a]),n=a;return e}function dU(r,t,e,n,a,i,s,l,c,f,d,p,g,v,b){return He(this,void 0,void 0,function(){var w,S,x,C,A,T,R,O;return Ve(this,function(N){switch(N.label){case 0:return a==null&&(a=32),i==null&&(i=1),d==null&&(d=!0),g==null&&(g=0),w=!1,c!=null&&f!=null&&(w=!0),b!=null,(S=r.checkNumSamples(e,a,v,"steps_per_epoch"))!=null&&(x=sa(0,S)),s==null&&(s=1),C=hR(l,s,i,g,S,v,a,w,p),A=C.callbackList,T=C.history,A.setModel(r),r.history=T,[4,A.onTrainBegin()];case 1:N.sent(),r.stopTraining_=!1,R=function(D){var I,_,F,B,V;return Ve(this,function(X){switch(X.label){case 0:return[4,A.onEpochBegin(D)];case 1:if(X.sent(),I={},v==null)return[3,2];case 2:if(d==="batch")throw new tt("batch shuffling is not implemneted yet");d&&Be.shuffle(x),_=fr(x),F=ny(S,a),B=function(Y){var j;return Ve(this,function(G){switch(G.label){case 0:return j={},[4,A.onBatchBegin(Y,j)];case 1:return G.sent(),ae(function(){var q=F[Y][0],ne=F[Y][1],L=Yo(_,q,ne-q);j.batch=Y,j.size=ne-q;for(var Z=T0(e,L),ce=t(Z),le=0;le<n.length;++le){var de=n[le],xe=ce[le];j[de]=xe,Na(xe)}if(Y===F.length-1&&w){var we=r.testLoop(c,f,a);for(le=0;le<n.length;++le)de=n[le],xe=we[le],Na(xe),I["val_"+de]=xe}}),[4,A.onBatchEnd(Y,j)];case 2:return G.sent(),oR(j),r.stopTraining_?[2,"break"]:[2]}})},V=0,X.label=3;case 3:return V<F.length?[5,B(V)]:[3,6];case 4:if(X.sent()==="break")return[3,6];X.label=5;case 5:return++V,[3,3];case 6:_.dispose(),X.label=7;case 7:return[4,A.onEpochEnd(D,I)];case 8:return X.sent(),r.stopTraining_?[2,"break"]:[2]}})},O=g,N.label=2;case 2:return O<i?[5,R(O)]:[3,5];case 3:if(N.sent()==="break")return[3,5];N.label=4;case 4:return++O,[3,2];case 5:return[4,A.onTrainEnd()];case 6:return N.sent(),[4,r.history.syncData()];case 7:return N.sent(),[2,r.history]}})})}function pU(r,t,e,n){return n===void 0&&(n={}),He(this,void 0,void 0,function(){var a,i,s,l,c,f,d,p,g,v,b,w,S,x,C,A,T,R,O,N,D,I;return Ve(this,function(_){switch(_.label){case 0:if(r.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");r.isTraining=!0,_.label=1;case 1:return _.trys.push([1,,7,8]),ty(p=n.batchSize==null?32:n.batchSize),g=!1,[4,r.standardizeUserData(t,e,n.sampleWeight,n.classWeight,g,p)];case 2:if(v=_.sent(),a=v[0],i=v[1],d=v[2],b=!1,w=void 0,!(n.validationData!=null&&n.validationData.length>0))return[3,4];if(b=!0,n.validationData.length!==2)throw n.validationData.length===3?new tt("validationData including sample weights is not supported yet."):new ee("When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; "+n.validationData+" is invalid.");return s=n.validationData[0],l=n.validationData[1],S=!0,[4,r.standardizeUserData(s,l,null,null,S,p)];case 3:return x=_.sent(),c=x[0],f=x[1],w=c.concat(f),[3,5];case 4:n.validationSplit!=null&&n.validationSplit>0&&n.validationSplit<1?(b=!0,C=Math.floor(a[0].shape[0]*(1-n.validationSplit)),A=a[0].shape[0],c=nc(a,C,A),a=nc(a,0,C),f=nc(i,C,A),i=nc(i,0,C),w=c.concat(f)):n.validationSteps!=null&&(b=!0),_.label=5;case 5:return T=a.concat(i).concat(d),r.checkTrainableWeightsConsistency(),R=r.makeTrainFunction(),O=r.getDedupedMetricsNames(),N=void 0,D=void 0,b?(r.makeTestFunction(),N=r.testFunction,D=O.slice().concat(O.map(function(F){return"val_"+F}))):(N=null,w=[],D=O.slice()),I=cR(n.callbacks,n.yieldEvery),[4,dU(r,R,T,O,p,n.epochs,n.verbose,I,N,w,n.shuffle,D,n.initialEpoch,null,null)];case 6:return[2,_.sent()];case 7:return r.isTraining=!1,Go(a,t),Go(i,e),Go(c,s),Go(f,l),d!=null&&et(d),[7];case 8:return[2]}})})}function SR(r){var t=[];r instanceof Ct&&(r=[r]);for(var e=0;e<r.length;++e){var n=r[e];if(n.rank===1)t.push(Gc(n,1));else{if(n.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");t.push(n)}}return t}function Go(r,t){if(r!=null){var e=[];if(t instanceof Ct)e.push(t.id);else if(Array.isArray(t))t.forEach(function(c){return e.push(c.id)});else if(t!=null)for(var n in t){var a=t[n];e.push(a.id)}var i=[];if(r instanceof Ct)e.indexOf(r.id)===-1&&i.push(r);else if(Array.isArray(r))r.forEach(function(c){e.indexOf(c.id)===-1&&i.push(c)});else if(r!=null)for(var s in r){var l=r[s];e.indexOf(l.id)===-1&&i.push(l)}i.forEach(function(c){c.isDisposed||c.dispose()})}}function mU(r){return r instanceof Ct}function ry(r){return Array.isArray(r)}function XS(r){return!mU(r)&&!ry(r)}function $S(r,t,e,n,a){if(a===void 0&&(a=""),t==null||t.length===0){if(r!=null){var i=!1;if(ry(r)&&r.length>0)i=!0;else if(XS(r)){for(var s in r)if(r.hasOwnProperty(s)){i=!0;break}}else i=!0;if(i)throw new ee("Error when checking model "+a+" expected no data, but got "+r)}return[]}if(r==null)return t.map(function(S){return null});var l;if(XS(r)){r=r,l=[];for(var c=0,f=t;c<f.length;c++){var d=f[c];if(r[d]==null)throw new ee('No data provided for "'+d+'". Need data for each key in: '+t);l.push(r[d])}}else if(ry(r)){if((r=r).length!==t.length)throw new ee("Error when checking model "+a+": the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see "+t.length+" Tensor(s), but instead got the following list of Tensor(s): "+r);l=r}else{if(r=r,t.length>1)throw new ee("The model "+a+" expects "+t.length+" Tensor(s), but only received one Tensor. Found: Tensor with shape "+r.shape);l=[r]}if(l=SR(l),e!=null){for(var p=0;p<t.length;++p)if(e[p]!=null){var g=l[p];if(g.shape.length!==e[p].length)throw new ee("Error when checking "+a+": expected "+t[p]+" to have "+e[p].length+" dimension(s). but got array with shape "+g.shape);for(var v=0;v<e[p].length;++v)if(v!==0||n){var b=g.shape[v],w=e[p][v];if(w!=null&&w>=0&&b!==w)throw new ee("Error when checking "+a+": expected "+t[p]+" to have shape ["+e[p]+"], but got array with shape ["+g.shape+"].")}}}return l}function gU(r,t,e){var n=Qi(r.map(function(i){return i.shape[0]}));n.sort();var a=Qi(t.map(function(i){return i.shape[0]}));if(a.sort(),n.length>1)throw new ee("All input Tensors (x) should have the same number of samples. Got array shapes: "+JSON.stringify(r.map(function(i){return i.shape})));if(a.length>1)throw new ee("All target Tensors (y) should have the same number of samples. Got array shapes: "+JSON.stringify(t.map(function(i){return i.shape})));if(n.length>0&&a.length>0&&!Be.arraysEqual(n,a))throw new ee("Input Tensors should have the same number of samples as target Tensors. Found "+n[0]+" input sample(s) and "+a[0]+" target sample(s).")}function vU(r,t,e){for(var n=[ms,hp,wc],a=0;a<r.length;++a){var i=r[a],s=t[a],l=e[a];if(s!=null){if(s===wc&&i.shape[i.shape.length-1]===1)throw new ee("You are passing a target array of shape "+i.shape+" while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].");if(n.indexOf(s)!==-1)for(var c=i.shape.slice(1),f=l.slice(1),d=0;d<c.length;++d){var p=c[d],g=f[d];if(g!=null&&p!==g)throw new ee("A target Tensor with shape "+i.shape+" was passed for an output of shape "+l+", while using a loss function that expects targets to have the same shape as the output.")}}}}function KS(r,t,e,n,a){var i;if(n===void 0&&(n=!0),a===void 0&&(a=""),Array.isArray(r)){if(r.length!==t.length)throw new ee("Error when checking model "+a+": the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see "+t.length+" Tensor(s), but instead got "+r.length+" Tensors(s).");i=r}else{if(t.length>1)throw new ee("The model expects "+t.length+" "+a+" Tensors, but only received one Tensor. Found: array with shape "+JSON.stringify(r.shape)+".");i=[r]}if(e!=null){for(var s=0;s<t.length;++s)if(e[s]!=null){var l=i[s];if(l.shape.length!==e[s].length)throw new ee("Error when checking "+a+": expected "+t[s]+" to have "+e[s].length+" dimension(s), but got array with shape "+JSON.stringify(l.shape));for(var c=0;c<e[s].length;++c)if(c!==0||n){var f=l.shape[c],d=e[s][c];if(d!=null&&d!==f)throw new ee("Error when checking "+a+": expected "+t[s]+" to have shape "+JSON.stringify(e[s])+" but got array with shape "+JSON.stringify(l.shape)+".")}}}}function yU(r,t){if(r==null||Array.isArray(r)&&r.length===0)return t.map(function(c){return[]});var e;if(typeof r=="string"||typeof r=="function")e=[r];else{if(!Array.isArray(r)&&typeof r!="object")throw new TypeError("Type of metrics argument not understood. Expected an string,function, Array, or Object, found: "+r);e=r}if(Array.isArray(e))return t.map(function(c){return e});for(var n=[],a=0,i=t;a<i.length;a++){var s=i[a],l=e.hasOwnProperty(s)?e[s]:[];Array.isArray(l)||(l=[l]),n.push(l)}return n}var bU="layers-model",Zo=function(r){function t(e){var n=r.call(this,e)||this;return n.isTraining=!1,n}return pe(t,r),t.prototype.summary=function(e,n,a){if(a===void 0&&(a=console.log),!this.built)throw new ee("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");KB(this,e,n,a)},t.prototype.compile=function(e){var n=this;if(e.loss==null&&(e.loss=[]),this.loss=e.loss,typeof e.optimizer=="string")this.optimizer_=$B(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof vi))throw new ee("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}var a=[];if(Array.isArray(e.loss)||typeof e.loss=="string"||typeof e.loss=="function")if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new ee("When passing an Array as loss, it should have one entry per model output. The model has "+this.outputs.length+" output(s), but you passed loss="+e.loss+".");var i=e.loss;a=i.map(function(S){return cv(S)})}else{var s=cv(e.loss);this.outputs.forEach(function(S){a.push(s)})}else{for(var l in e.loss=e.loss,e.loss)if(this.outputNames.indexOf(l)===-1)throw new ee('Unknown entry in loss dictionary: "'+l+'". Only expected the following keys: '+this.outputNames);for(var c=0,f=this.outputNames;c<f.length;c++){var d=f[c];e.loss[d]==null&&console.warn('Output "'+d+'" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to '+d+" during training"),a.push(cv(e.loss[d]))}}this.lossFunctions=a,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(var p=0;p<this.outputs.length;++p){var g=this.internalOutputShapes[p],v=this.outputNames[p];this.feedOutputNames.push(v),this.feedOutputShapes.push(g),this.feedLossFns.push(this.lossFunctions[p])}var b=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],Ko("loss",function(){for(var S=0;S<n.outputs.length;++S)if(b.indexOf(S)===-1){var x=n.lossFunctions[S];n.outputs.length>1&&(n.metricsTensors.push([x,S]),n.metricsNames.push(n.outputNames[S]+"_loss"))}});var w=yU(e.metrics,this.outputNames);Ko("metric",function(){for(var S=function(C){if(b.indexOf(C)!==-1)return"continue";(function(A){for(var T,R,O,N=function(_){if(typeof _=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(_)!==-1){var F=n.internalOutputShapes[C];F[F.length-1]===1||n.lossFunctions[C]===hp?["accuracy","acc"].indexOf(_)!==-1?R=E0:["crossentropy","ce"].indexOf(_)!==-1&&(R=mR):n.lossFunctions[C]===cd?["accuracy","acc"].indexOf(_)!==-1?R=gR:["crossentropy","ce"].indexOf(_)!==-1&&(R=vR):["accuracy","acc"].indexOf(_)!==-1?R=C0:["crossentropy","ce"].indexOf(_)!==-1&&(R=A0);var B=void 0;["accuracy","acc"].indexOf(_)!==-1?B="acc":["crossentropy","ce"].indexOf(_)!==-1&&(B="ce"),O=R,T=""+B}else{var V=XB(_);O=V,T=""+Eh(_)}var X;Ko(T,function(){X=O}),function(Y,j,G){n.outputNames.length>1&&(j=n.outputNames[Y]+"_"+j),n.metricsNames.push(j),n.metricsTensors.push([G,Y])}(C,T,X)},D=0,I=A;D<I.length;D++)N(I[D])})(w[C])},x=0;x<n.outputs.length;++x)S(x)}),this.collectedTrainableWeights=this.trainableWeights},t.prototype.checkTrainableWeightsConsistency=function(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")},t.prototype.evaluate=function(e,n,a){a===void 0&&(a={});var i=a.batchSize==null?32:a.batchSize;ty(i);var s=this.standardizeUserDataXY(e,n,!0,i);try{var l=s[0].concat(s[1]);this.makeTestFunction();var c=this.testFunction;return Yn(this.testLoop(c,l,i,a.verbose,a.steps))}finally{Go(s[0],e),Go(s[1],n)}},t.prototype.evaluateDataset=function(e,n){return He(this,void 0,void 0,function(){return Ve(this,function(a){return this.makeTestFunction(),[2,hU(this,e,n)]})})},t.prototype.checkNumSamples=function(e,n,a,i){var s;if(i===void 0&&(i="steps"),a!=null){if(s=null,n!=null)throw new ee("If "+i+" is set, batchSize must be null or undefined.Got batchSize = "+n)}else{if(e==null)throw new ee("Either the input data should have a defined shape, or "+i+" shoud be specified.");s=Array.isArray(e)?e[0].shape[0]:e.shape[0]}return s},t.prototype.execute=function(e,n){if(Array.isArray(n)&&n.length===0)throw new ee("`outputs` is an empty Array, which is not allowed.");var a=Array.isArray(n),i=a?n:[n],s=this.retrieveSymbolicTensors(i),l=new fu;if(e instanceof Ct&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new ee("The number of inputs provided ("+e.length+") does not match the number of inputs of this model ("+this.inputs.length+").");for(var c=0;c<this.inputs.length;++c)l.add(this.inputs[c],e[c])}else for(var f=0,d=this.inputs;f<d.length;f++){var p=d[f],g=e[p.name];if(g==null)throw new ee("No value is provided for the model's input "+p.name);l.add(p,g)}var v=tc(s,l);return a?v:v[0]},t.prototype.retrieveSymbolicTensors=function(e){for(var n=rs(null,e.length),a=e.length,i=0,s=this.layers;i<s.length;i++){for(var l=s[i],c=Array.isArray(l.output)?l.output:[l.output],f=c.map(function(v){return v.name}),d=0;d<e.length;++d){var p=f.indexOf(e[d]);if(p!==-1&&(n[d]=c[p],a--),a===0)break}if(a===0)break}if(a>0){var g=[];throw n.forEach(function(v,b){v==null&&g.push(e[b])}),new ee("Cannot find SymbolicTensors for output name(s): "+JSON.stringify(g))}return n},t.prototype.predictLoop=function(e,n,a){var i=this;return n===void 0&&(n=32),a===void 0&&(a=!1),ae(function(){var s=i.checkNumSamples(e);if(a)throw new tt("Verbose predictLoop() is not implemented yet.");for(var l=ny(s,n),c=i.outputs.map(function(p){return[]}),f=function(p){ae(function(){var g=l[p][0],v=l[p][1],b=nc(e,g,v),w=[];if(Array.isArray(b))for(var S=0;S<b.length;++S)w.push({key:i.inputs[S],value:b[S]});else w.push({key:i.inputs[0],value:b});var x=new fu(w);return tc(i.outputs,x)}).forEach(function(g,v){return c[v].push(g)})},d=0;d<l.length;++d)f(d);return Yn(c.map(function(p){return Gn(p,0)}))})},t.prototype.predict=function(e,n){n===void 0&&(n={});var a=SR(e);KS(a,this.inputNames,this.feedInputShapes,!1);try{var i=n.batchSize==null?32:n.batchSize;return ty(i),this.predictLoop(a,i)}finally{Go(a,e)}},t.prototype.predictOnBatch=function(e){KS(e,this.inputNames,this.feedInputShapes,!0);var n=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,n)},t.prototype.standardizeUserDataXY=function(e,n,a,i){if(this.optimizer_==null)throw new Ca("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");for(var s=[],l=0;l<this.feedOutputShapes.length;++l){var c=this.feedOutputShapes[l];this.feedLossFns[l]===cd?s.push(c.slice(0,c.length-1).concat([1])):s.push(c)}if(gU(e=$S(e,this.feedInputNames,this.feedInputShapes,!1,"input"),n=$S(n,this.feedOutputNames,s,!1,"target")),vU(n,this.feedLossFns,this.feedOutputShapes),this.stateful&&i!=null&&i>0&&e[0].shape[0]%i!=0)throw new ee("In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size "+i+". Found: "+e[0].shape[0]+" sample(s).");return[e,n]},t.prototype.standardizeUserData=function(e,n,a,i,s,l){return s===void 0&&(s=!0),He(this,void 0,void 0,function(){var c,f,d,p,g,v,b,w;return Ve(this,function(S){switch(S.label){case 0:if(c=this.standardizeUserDataXY(e,n,s,l),f=c[0],d=c[1],a!=null)throw new Error("sample weight is not supported yet.");if(p=null,i==null)return[3,4];g=bR(i,this.outputNames),p=[],v=0,S.label=1;case 1:return v<g.length?(w=(b=p).push,[4,wR(d[v],null,g[v])]):[3,4];case 2:w.apply(b,[S.sent()]),S.label=3;case 3:return++v,[3,1];case 4:return[2,[f,d,p]]}})})},t.prototype.testLoop=function(e,n,a,i,s){var l=this;return i===void 0&&(i=0),ae(function(){var c=l.checkNumSamples(n,a,s,"steps"),f=[];if(i>0)throw new tt("Verbose mode is not implemented yet.");if(s!=null)throw new tt("steps mode in testLoop() is not implemented yet");for(var d=ny(c,a),p=fr(sa(0,c)),g=0;g<d.length;++g){var v=d[g][0],b=d[g][1],w=Yo(p,v,b-v),S=T0(n,w),x=e(S);if(g===0)for(var C=0;C<x.length;++C)f.push(Re(0));for(C=0;C<x.length;++C){var A=x[C];f[C]=ot(f[C],Xe(b-v,A))}}for(C=0;C<f.length;++C)f[C]=Xn(f[C],c);return f})},t.prototype.getDedupedMetricsNames=function(){for(var e=this.metricsNames,n=[],a=0;a<e.length;++a){var i=e[a],s=i;OS(e,i)>1&&(s+="_"+OS(e.slice(0,a),i)),n.push(s)}return n},t.prototype.makeTrainFunction=function(){var e=this;return function(n){var a=[],i=n.slice(0,e.inputs.length),s=n.slice(e.inputs.length,e.inputs.length+e.outputs.length),l=n.slice(e.inputs.length+e.outputs.length,e.inputs.length+2*e.outputs.length),c=[],f=e.collectedTrainableWeights.map(function(d){return d.read()});return[e.optimizer_.minimize(function(){for(var d=[],p=0;p<e.inputs.length;++p)d.push({key:e.inputs[p],value:i[p]});var g,v=new fu(d),b=tc(e.outputs,v,{training:!0});for(p=0;p<e.lossFunctions.length;++p){var w=(0,e.lossFunctions[p])(s[p],b[p]);l[p]!=null&&(w=oU(w,l[p]));var S=an(w);a.push(S),g=p===0?w:ot(g,w)}for(p=0;p<e.metricsTensors.length;++p){var x=void 0;if(e.outputs.length>1&&p<e.outputs.length)x=a[p];else{var C=e.metricsTensors[p][0],A=e.metricsTensors[p][1];x=an(C(s[A],b[A]))}Na(x),c.push(x)}return g=an(g),e.calculateLosses().forEach(function(T){g=ot(g,T)}),g},!0,f)].concat(c)}},t.prototype.makeTestFunction=function(){var e=this;this.testFunction=function(n){return ae(function(){for(var a,i=[],s=n.slice(0,e.inputs.length),l=n.slice(e.inputs.length,e.inputs.length+e.outputs.length),c=[],f=0;f<e.inputs.length;++f)c.push({key:e.inputs[f],value:s[f]});var d=new fu(c),p=tc(e.outputs,d);for(f=0;f<e.lossFunctions.length;++f){var g=e.lossFunctions[f],v=an(g(l[f],p[f]));a=f===0?v:ot(a,v),i.push(a)}for(f=0;f<e.metricsTensors.length;++f){var b=e.metricsTensors[f][0],w=e.metricsTensors[f][1],S=an(b(l[w],p[w]));i.push(S)}return i})}},t.prototype.fit=function(e,n,a){return a===void 0&&(a={}),He(this,void 0,void 0,function(){return Ve(this,function(i){return[2,pU(this,e,n,a)]})})},t.prototype.fitDataset=function(e,n){return He(this,void 0,void 0,function(){return Ve(this,function(a){return[2,lU(this,e,n)]})})},t.prototype.trainOnBatch=function(e,n){return He(this,void 0,void 0,function(){var a,i,s,l,c,f,d,p,g;return Ve(this,function(v){switch(v.label){case 0:return[4,this.standardizeUserData(e,n)];case 1:a=v.sent(),i=a[0],s=a[1],l=this.makeTrainFunction(),c=l(i.concat(s)),f=[],d=0,p=c,v.label=2;case 2:return d<p.length?[4,p[d].data()]:[3,5];case 3:g=v.sent(),f.push(g[0]),v.label=4;case 4:return d++,[3,2];case 5:return et(c),[2,Yn(f)]}})})},t.prototype.getNamedWeights=function(e){for(var n=[],a=e!=null&&e.trainableOnly,i=a?this.trainableWeights:this.weights,s=this.getWeights(a),l=0;l<i.length;++l)a&&!i[l].trainable||n.push({name:i[l].originalName,tensor:s[l]});return n},Object.defineProperty(t.prototype,"stopTraining",{get:function(){return this.stopTraining_},set:function(e){this.stopTraining_=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"optimizer",{get:function(){return this.optimizer_},set:function(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){var e=r.prototype.dispose.call(this);if(e.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){var n=Bv().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=n-Bv().numTensors}return e},t.prototype.getLossIdentifiers=function(){var e;if(typeof this.loss=="string")e=ti(this.loss);else if(Array.isArray(this.loss)){for(var n=0,a=this.loss;n<a.length;n++)if(typeof a[n]!="string")throw new Error("Serialization of non-string loss is not supported.");e=this.loss.map(function(d){return ti(d)})}else{var i=Object.keys(this.loss);e={};for(var s=this.loss,l=0,c=i;l<c.length;l++){var f=c[l];if(typeof s[f]!="string")throw new Error("Serialization of non-string loss is not supported.");e[f]=ti(s[f])}}return e},t.prototype.getMetricIdentifiers=function(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[ti(Eh(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(function(a){return ti(Eh(a))});var e={};for(var n in this.metrics)e[n]=ti(Eh(this.metrics[n]));return e},t.prototype.getTrainingConfig=function(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}},t.prototype.loadTrainingConfig=function(e){if(e.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(e.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(e.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");var n,a,i=aa(xc(e.optimizer_config));if(typeof e.loss=="string")n=jo(e.loss);else if(Array.isArray(e.loss))n=e.loss.map(function(l){return jo(l)});else if(e.loss!=null)for(var s in n={},e.loss)n[s]=jo(e.loss[s]);if(Array.isArray(e.metrics))a=e.metrics.map(function(l){return jo(l)});else if(e.metrics!=null)for(var s in a={},e.metrics)a[s]=jo(e.metrics[s]);this.compile({loss:n,metrics:a,optimizer:i})},t.prototype.save=function(e,n){return He(this,void 0,void 0,function(){var a,i,s,l,c,f,d,p,g,v,b,w,S,x;return Ve(this,function(C){switch(C.label){case 0:if(typeof e=="string"){if((a=Ar.getSaveHandlers(e)).length===0)throw new ee("Cannot find any save handlers for URL '"+e+"'");if(a.length>1)throw new ee("Found more than one ("+a.length+") save handlers for URL '"+e+"'");e=a[0]}if(e.save==null)throw new ee("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return[4,Ar.encodeWeights(this.getNamedWeights(n))];case 1:return i=C.sent(),s=!1,l=null,c=this.toJSON(l,s),f={modelTopology:c,format:bU,generatedBy:"TensorFlow.js tfjs-layers v"+dp,convertedBy:null},n!=null&&n.includeOptimizer&&this.optimizer!=null?(f.trainingConfig=this.getTrainingConfig(),d="optimizer",w=(b=Ar).encodeWeights,[4,this.optimizer.getWeights()]):[3,4];case 2:return[4,w.apply(b,[C.sent(),d])];case 3:p=C.sent(),g=p.data,v=p.specs,(x=i.specs).push.apply(x,v),i.data=Ar.concatenateArrayBuffers([i.data,g]),C.label=4;case 4:return this.userDefinedMetadata!=null&&(S=!0,jS(this.userDefinedMetadata,this.name,S),f.userDefinedMetadata=this.userDefinedMetadata),f.weightData=i.data,f.weightSpecs=i.specs,[2,e.save(f)]}})})},t.prototype.setUserDefinedMetadata=function(e){jS(e,this.name),this.userDefinedMetadata=e},t.prototype.getUserDefinedMetadata=function(){return this.userDefinedMetadata},t.className="Model",t}(aU);function wU(r,t){return He(this,void 0,void 0,function(){var e,n,a,i,s,l,c,f;return Ve(this,function(d){switch(d.label){case 0:return"modelTopology"in r||(r={modelTopology:r}),(e=(r=r).modelTopology).model_config!=null&&(e=e.model_config),n=xc(e),a=aa(n,t),r.weightsManifest==null?[3,2]:[4,Ar.loadWeights(r.weightsManifest,r.pathPrefix,a.weights.map(function(p){return p.originalName}))];case 1:for(i=d.sent(),s={},l=0,c=a.weights;l<c.length;l++)f=c[l],s[f.originalName]=i[f.originalName];a.loadWeights(s),et(i),d.label=2;case 2:return[2,a]}})})}function xU(r,t){return He(this,void 0,void 0,function(){var e;return Ve(this,function(n){if(t==null&&(t={}),typeof r=="string"){if((e=Ar.getLoadHandlers(r,t.onProgress)).length===0)e.push(Ar.browserHTTPRequest(r,t));else if(e.length>1)throw new ee("Found more than one ("+e.length+") load handlers for URL '"+r+"'");r=e[0]}return[2,SU(r,void 0,t)]})})}function SU(r,t,e){return He(this,void 0,void 0,function(){var n,a,i,s,l,c,f,d,p;return Ve(this,function(g){switch(g.label){case 0:if(e==null&&(e={}),r.load==null)throw new ee("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");return[4,r.load()];case 1:if(n=g.sent(),(a=n.modelTopology).model_config!=null&&(a=a.model_config),i=e.strict==null||e.strict,s=n.weightData!=null&&n.weightSpecs!=null&&i,l=aa(xc(a),t,s),(c=n.trainingConfig)!=null&&l.loadTrainingConfig(c),n.userDefinedMetadata!=null&&l.setUserDefinedMetadata(n.userDefinedMetadata),n.weightData==null)return[3,4];if(n.weightSpecs==null)throw new ee("LayersModel artifacts contains weight data, but not weight specs. Therefore loading of weights cannot proceed.");return f=EU(n.weightData,n.weightSpecs),d=f.modelWeights,p=f.optimizerWeights,l.loadWeights(d,i),l.optimizer!=null&&p.length>0?[4,l.optimizer.setWeights(p)]:[3,3];case 2:g.sent(),g.label=3;case 3:et(d),et(p.map(function(v){return v.tensor})),g.label=4;case 4:return[2,l]}})})}function EU(r,t){var e=Ar.decodeWeights(r,t),n={},a=[];return t.forEach(function(i){i.group==="optimizer"?a.push({name:i.name,tensor:e[i.name]}):n[i.name]=e[i.name]}),{modelWeights:n,optimizerWeights:a}}be.registerClass(Zo);var N0=function(r){function t(e){var n=r.call(this,{inputs:[],outputs:[]})||this;if(e=e||{},n.trainable=!0,n.built=!1,n.name=e.name!=null?e.name:lp("sequential_"),e.layers!=null)for(var a=0,i=e.layers;a<i.length;a++){var s=i[a];n.add(s)}return n}return pe(t,r),t.prototype.checkShape=function(e){if(e.inboundNodes[0].outputTensors[0].shape.some(function(n){return n<0}))throw new ee("Negative dimension size caused by adding layer "+e.name+" with input shape ["+e.inboundNodes[0].inputTensors[0].shape+"]")},t.prototype.add=function(e){var n,a=e instanceof t||e instanceof Zo;if(a){if((n=e).outputs.length!==1)throw new ee("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(n.inputs.length!==1)throw new ee("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(e.inboundNodes.length===0){if(e.batchInputShape==null)throw new ee("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");var i=iR({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(i)}if(a)this.outputs=n.outputs,this.inputs=n.inputs;else{if(e.inboundNodes.length!==1)throw new ee("A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer "+e.name+" which has "+e.inboundNodes.length+" pre-existing inbound connections.");if(e.inboundNodes[0].outputTensors.length!==1)throw new ee("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=aR(this.outputs[0])}this.inboundNodes=[],new cp({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:rs(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(function(l){return l.shape}),outputShapes:this.outputs[0].shape})}else{var s=e.apply(this.outputs[0]);if(Array.isArray(s))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[s],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1},t.prototype.pop=function(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{var e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}},t.prototype.call=function(e,n){return this.model==null&&this.build(),this.model.call(e,n)},t.prototype.build=function(e){if(It(e),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new Zo({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0},t.prototype.countParams=function(){return this.built||this.build(),r.prototype.countParams.call(this)},t.prototype.summary=function(e,n,a){a===void 0&&(a=console.log),this.built||this.build(),r.prototype.summary.call(this,e,n,a)},t.prototype.setWeights=function(e){this.model==null&&this.build(),this.model.setWeights(e)},t.prototype.evaluate=function(e,n,a){if(a===void 0&&(a={}),!this.built)throw new Ca("The model needs to be compiled before being used.");return this.model.evaluate(e,n,a)},t.prototype.evaluateDataset=function(e,n){return He(this,void 0,void 0,function(){return Ve(this,function(a){if(!this.built)throw new Ca("The model needs to be compiled before being used.");return[2,this.model.evaluateDataset(e,n)]})})},t.prototype.predict=function(e,n){return n===void 0&&(n={}),this.model==null&&this.build(),this.model.predict(e,n)},t.prototype.predictOnBatch=function(e){return this.model==null&&this.build(),this.model.predictOnBatch(e)},t.prototype.compile=function(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames},Object.defineProperty(t.prototype,"optimizer",{get:function(){return this.model==null?void 0:this.model.optimizer},set:function(e){this.model.optimizer=e},enumerable:!0,configurable:!0}),t.prototype.fit=function(e,n,a){return a===void 0&&(a={}),He(this,void 0,void 0,function(){return Ve(this,function(i){if(!this.built)throw new Ca("The model needs to be compiled before being used.");return[2,this.model.fit(e,n,a)]})})},t.prototype.fitDataset=function(e,n){return He(this,void 0,void 0,function(){return Ve(this,function(a){if(!this.built)throw new Ca("The model needs to be compiled before being used.");return[2,this.model.fitDataset(e,n)]})})},t.prototype.trainOnBatch=function(e,n){return He(this,void 0,void 0,function(){return Ve(this,function(a){return[2,this.model.trainOnBatch(e,n)]})})},t.fromConfig=function(e,n,a,i){var s;i===void 0&&(i=!1);var l={};if(n instanceof Array){if(n[0].className==null||n[0].className==="Merge")throw new ee("Legacy serialization format not supported yet.");s=n}else Be.assert(n.layers!=null,function(){return"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."}),s=n.layers,delete n.layers,l=n;var c=new e(l);if(!(c instanceof t))throw new tt("Sequential.fromConfig called on non-Sequential input: "+c);for(var f=0,d=s;f<d.length;f++){var p=aa(d[f],void 0,i);i&&p.setFastWeightInitDuringBuild(!0),c.add(p)}return c},Object.defineProperty(t.prototype,"stopTraining",{get:function(){if(this.model==null)throw new ee("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining},set:function(e){if(this.model==null)throw new ee("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e},enumerable:!0,configurable:!0}),t.prototype.getConfig=function(){for(var e=[],n=0,a=this.layers;n<a.length;n++){var i=a[n],s={};s.className=i.getClassName(),s.config=i.getConfig(),e.push(s)}return{name:this.name,layers:e}},t.className="Sequential",t}(Zo);function CU(r){return new Zo(r)}function AU(r){return new N0(r)}function TU(r,t){return t==null&&(t={}),xU(r,t)}function ER(r){return iR(r)}function NU(r,t){fR.registerCallbackConstructor(r,t)}be.registerClass(N0);var kr=function(r){function t(){return r!==null&&r.apply(this,arguments)||this}return pe(t,r),t.prototype.getConfig=function(){return{}},t}(be.Serializable),RU=function(r){function t(){return r!==null&&r.apply(this,arguments)||this}return pe(t,r),t.prototype.apply=function(e,n){return n===void 0&&(n=1),ZF(e,n)},t.className="elu",t}(kr);be.registerClass(RU);var IU=function(r){function t(){return r!==null&&r.apply(this,arguments)||this}return pe(t,r),t.prototype.apply=function(e){return np(e)},t.className="selu",t}(kr);be.registerClass(IU);var kU=function(r){function t(){return r!==null&&r.apply(this,arguments)||this}return pe(t,r),t.prototype.apply=function(e){return lo(e)},t.className="relu",t}(kr);be.registerClass(kU);var DU=function(r){function t(){return r!==null&&r.apply(this,arguments)||this}return pe(t,r),t.prototype.apply=function(e){return ae(function(){return Fu(6,lo(e))})},t.className="relu6",t}(kr);be.registerClass(DU);var OU=function(r){function t(){return r!==null&&r.apply(this,arguments)||this}return pe(t,r),t.prototype.apply=function(e){return e},t.className="linear",t}(kr);be.registerClass(OU);var _U=function(r){function t(){return r!==null&&r.apply(this,arguments)||this}return pe(t,r),t.prototype.apply=function(e){return zd(e)},t.className="sigmoid",t}(kr);be.registerClass(_U);var MU=function(r){function t(){return r!==null&&r.apply(this,arguments)||this}return pe(t,r),t.prototype.apply=function(e){return JF(e)},t.className="hardSigmoid",t}(kr);be.registerClass(MU);var zU=function(r){function t(){return r!==null&&r.apply(this,arguments)||this}return pe(t,r),t.prototype.apply=function(e){return _c(e)},t.className="softplus",t}(kr);be.registerClass(zU);var LU=function(r){function t(){return r!==null&&r.apply(this,arguments)||this}return pe(t,r),t.prototype.apply=function(e){return QF(e)},t.className="softsign",t}(kr);be.registerClass(LU);var FU=function(r){function t(){return r!==null&&r.apply(this,arguments)||this}return pe(t,r),t.prototype.apply=function(e){return Ld(e)},t.className="tanh",t}(kr);be.registerClass(FU);var CR=function(r){function t(){return r!==null&&r.apply(this,arguments)||this}return pe(t,r),t.prototype.apply=function(e,n){return n===void 0&&(n=-1),fs(e,n)},t.className="softmax",t}(kr);be.registerClass(CR);var BU=function(r){function t(){return r!==null&&r.apply(this,arguments)||this}return pe(t,r),t.prototype.apply=function(e,n){return n===void 0&&(n=-1),Dd(e,n)},t.className="logSoftmax",t}(kr);function Ir(r){return r.getClassName()}function hv(r,t){return t===void 0&&(t={}),Wc(r,be.SerializationMap.getMap().classNameMap,t,"activation")}function ao(r){var t;return r==null?hv(t={className:"linear",config:{}}):typeof r=="string"?((t={}).className=r,t.config={},hv(t)):r instanceof kr?r:hv(r)}function R0(r){if(r!=null&&typeof r!="object")throw new Error("Argument to L1L2 regularizer's constructor is expected to be an object, but received: "+r)}be.registerClass(BU);var AR=function(r){function t(){return r!==null&&r.apply(this,arguments)||this}return pe(t,r),t}(be.Serializable),pp=function(r){function t(e){var n=r.call(this)||this;return R0(e),n.l1=e==null||e.l1==null?.01:e.l1,n.l2=e==null||e.l2==null?.01:e.l2,n.hasL1=n.l1!==0,n.hasL2=n.l2!==0,n}return pe(t,r),t.prototype.apply=function(e){var n=this;return ae(function(){var a=St([1]);return n.hasL1&&(a=ot(a,hr(Xe(n.l1,to(e))))),n.hasL2&&(a=ot(a,hr(Xe(n.l2,Xc(e))))),a.asScalar()})},t.prototype.getConfig=function(){return{l1:this.l1,l2:this.l2}},t.fromConfig=function(e,n){return new e({l1:n.l1,l2:n.l2})},t.className="L1L2",t}(AR);function UU(r){return R0(r),new pp({l1:r!=null?r.l1:null,l2:0})}function PU(r){return R0(r),new pp({l2:r!=null?r.l2:null,l1:0})}be.registerClass(pp);var YS={l1l2:"L1L2"};function nt(r){return f0(r)}function ZS(r,t){return t===void 0&&(t={}),Wc(r,be.SerializationMap.getMap().classNameMap,t,"regularizer")}function Lt(r){return r==null?null:typeof r=="string"?ZS({className:r in YS?YS[r]:r,config:{}}):r instanceof AR?r:ZS(r)}var TR=function(r){function t(e){var n=r.call(this,e??{})||this;return n.supportsMasking=!0,e!=null&&(n.maxValue=e.maxValue),n}return pe(t,r),t.prototype.call=function(e,n){e=Ye(e);var a=lo(e);return this.maxValue!=null&&(a=Jn(a,0,this.maxValue)),a},t.prototype.computeOutputShape=function(e){return e},t.prototype.getConfig=function(){var e={maxValue:this.maxValue},n=r.prototype.getConfig.call(this);return Object.assign(e,n),e},t.className="ReLU",t}(ft);be.registerClass(TR);var NR=function(r){function t(e){var n=r.call(this,e??{})||this;return n.DEFAULT_ALPHA=.3,e==null&&(e={}),n.alpha=e.alpha==null?n.DEFAULT_ALPHA:e.alpha,n}return pe(t,r),t.prototype.call=function(e,n){var a=Ye(e);return ep(a,this.alpha)},t.prototype.computeOutputShape=function(e){return e},t.prototype.getConfig=function(){var e={alpha:this.alpha},n=r.prototype.getConfig.call(this);return Object.assign(e,n),e},t.className="LeakyReLU",t}(ft);be.registerClass(NR);var RR=function(r){function t(e){var n=r.call(this,e??{})||this;if(n.DEFAULT_ALPHA_INITIALIZER="zeros",e==null&&(e={}),n.supportsMasking=!0,n.alphaInitializer=zt(e.alphaInitializer||n.DEFAULT_ALPHA_INITIALIZER),n.alphaRegularizer=Lt(e.alphaRegularizer),n.alphaConstraint=hn(e.alphaConstraint),e.sharedAxes==null)n.sharedAxes=null;else if(Array.isArray(e.sharedAxes))n.sharedAxes=e.sharedAxes;else{if(typeof e.sharedAxes!="number")throw new ee("Expected sharedAxes to be a number or an array of numbers, but got "+e.sharedAxes);n.sharedAxes=[e.sharedAxes]}return n}return pe(t,r),t.prototype.build=function(e){var n=(e=It(e)).slice(1);if(this.sharedAxes!=null)for(var a=0,i=this.sharedAxes;a<i.length;a++)n[(l=i[a])-1]=1;this.alpha=this.addWeight("alpha",n,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);var s={};if(this.sharedAxes!=null)for(var l=1;l<e.length;++l)s[l]=e[l];this.inputSpec=[new In({ndim:e.length,axes:s})],this.built=!0},t.prototype.call=function(e,n){return e=Ye(e),tp(e,this.alpha.read())},t.prototype.getConfig=function(){var e={alphaInitializer:gt(this.alphaInitializer),alphaRegularizer:nt(this.alphaRegularizer),alphaConstraint:At(this.alphaConstraint),sharedAxes:this.sharedAxes},n=r.prototype.getConfig.call(this);return Object.assign(e,n),e},t.className="PReLU",t}(ft);be.registerClass(RR);var IR=function(r){function t(e){var n=r.call(this,e??{})||this;if(n.DEFAULT_ALPHA=1,e==null&&(e={}),e.alpha!=null&&e.alpha!==n.DEFAULT_ALPHA)throw new tt("Non-default alpha value ("+e.alpha+") is not supported by the ELU layer yet.");return n.alpha=e.alpha==null?n.DEFAULT_ALPHA:e.alpha,n}return pe(t,r),t.prototype.call=function(e,n){var a=Ye(e);return Vu(a)},t.prototype.computeOutputShape=function(e){return e},t.prototype.getConfig=function(){var e={alpha:this.alpha},n=r.prototype.getConfig.call(this);return Object.assign(e,n),e},t.className="ELU",t}(ft);be.registerClass(IR);var kR=function(r){function t(e){var n=r.call(this,e??{})||this;return n.DEFAULT_THETA=1,e==null&&(e={}),n.theta=e.theta==null?n.DEFAULT_THETA:e.theta,n}return pe(t,r),t.prototype.call=function(e,n){var a=Ye(e);return a.mul(qc(a.greater(this.theta),"float32"))},t.prototype.computeOutputShape=function(e){return e},t.prototype.getConfig=function(){var e={theta:this.theta},n=r.prototype.getConfig.call(this);return Object.assign(e,n),e},t.className="ThresholdedReLU",t}(ft);be.registerClass(kR);var DR=function(r){function t(e){var n=r.call(this,e??{})||this;return n.DEFAULT_AXIS=1,e==null&&(e={}),n.softmax=new CR().apply,n.axis=e.axis==null?n.DEFAULT_AXIS:e.axis,n}return pe(t,r),t.prototype.call=function(e,n){var a=Ye(e);return this.softmax(a,this.axis)},t.prototype.computeOutputShape=function(e){return e},t.prototype.getConfig=function(){var e={axis:this.axis},n=r.prototype.getConfig.call(this);return Object.assign(e,n),e},t.className="Softmax",t}(ft);function dv(r,t,e){if(typeof r=="number")return rs(r,t);if(r.length!==t)throw new ee("The "+e+" argument must be an integer or tuple of "+t+" integers. Received: "+r.length+" elements.");for(var n=0;n<t;++n){var a=r[n];if(!XF(a))throw new ee("The "+e+" argument must be an integer or tuple of "+t+" integers. Received: "+JSON.stringify(r)+" including a non-integer number "+a)}return r}function si(r,t,e,n,a){return a===void 0&&(a=1),r==null?r:(i=e==="same"?r:r-(t+(t-1)*(a-1))+1,Math.floor((i+n-1)/n));var i}function Ch(r,t,e,n){if(r==null)return null;if(n==="valid")r=r*t+ro([e-t,0]);else{if(n!=="same")throw new ee("Unsupport padding mode: "+n+".");r*=t}return r}function I0(r,t){return ae(function(){return pn(t),t==="channelsFirst"?Ut(r,[0,2,3,1]):r})}function OR(r,t){return ae(function(){return pn(t),t==="channelsFirst"?Ut(r,[0,2,3,4,1]):r})}function VU(r,t,e,n,a,i,s){return n===void 0&&(n=1),a===void 0&&(a="valid"),s===void 0&&(s=1),ae(function(){if(i==null&&(i=oa()),pn(i),r.shape.length!==3)throw new ee("The input of a conv1dWithBias operation should be 3, but is "+r.shape.length+" instead.");if(t.shape.length!==3)throw new ee("The kernel for a conv1dWithBias operation should be 3, but is "+t.shape.length+" instead");if(e!=null&&e.shape.length!==1)throw new ee("The bias for a conv1dWithBias operation should be 1, but is "+t.shape.length+" instead");if(i==="channelsFirst"&&(r=Ut(r,[0,2,1])),a==="causal")throw new tt("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");var l=jd(r,t,n,a==="same"?"same":"valid","NWC",s);return e!=null&&(l=yi(l,e)),l})}function QS(r,t,e,n,a,i,s,l){return n===void 0&&(n=[1,1]),a===void 0&&(a="valid"),l===void 0&&(l=null),ae(function(){if(i==null&&(i=oa()),pn(i),r.rank!==3&&r.rank!==4)throw new ee("conv2dWithBiasActivation expects input to be of rank 3 or 4, but received "+r.rank+".");if(t.rank!==3&&t.rank!==4)throw new ee("conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received "+r.rank+".");var c=I0(r,i);if(a==="causal")throw new tt("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return c=Au.conv2d({x:c,filter:t,strides:n,pad:a==="same"?"same":"valid",dilations:s,dataFormat:"NHWC",bias:e,activation:l}),i==="channelsFirst"&&(c=Ut(c,[0,3,1,2])),c})}function jU(r,t,e,n,a,i,s){return n===void 0&&(n=[1,1,1]),a===void 0&&(a="valid"),ae(function(){if(i==null&&(i=oa()),pn(i),r.rank!==4&&r.rank!==5)throw new ee("conv3dWithBias expects input to be of rank 4 or 5, but received "+r.rank+".");if(t.rank!==4&&t.rank!==5)throw new ee("conv3dWithBias expects kernel to be of rank 4 or 5, but received "+r.rank+".");var l=OR(r,i);if(a==="causal")throw new tt("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return l=Wd(l,t,n,a==="same"?"same":"valid","NDHWC",s),e!=null&&(l=yi(l,e)),i==="channelsFirst"&&(l=Ut(l,[0,4,1,2,3])),l})}be.registerClass(DR);var _R=function(r){function t(e,n){var a=r.call(this,n)||this;if(a.bias=null,a.DEFAULT_KERNEL_INITIALIZER="glorotNormal",a.DEFAULT_BIAS_INITIALIZER="zeros",t.verifyArgs(n),a.rank=e,er(a.rank,"rank"),a.rank!==1&&a.rank!==2&&a.rank!==3)throw new tt("Convolution layer for rank other than 1, 2, or 3 ("+a.rank+") is not implemented yet.");if(a.kernelSize=dv(n.kernelSize,e,"kernelSize"),a.strides=dv(n.strides==null?1:n.strides,e,"strides"),a.padding=n.padding==null?"valid":n.padding,Xr(a.padding),a.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,pn(a.dataFormat),a.activation=ao(n.activation),a.useBias=n.useBias==null||n.useBias,a.biasInitializer=zt(n.biasInitializer||a.DEFAULT_BIAS_INITIALIZER),a.biasConstraint=hn(n.biasConstraint),a.biasRegularizer=Lt(n.biasRegularizer),a.activityRegularizer=Lt(n.activityRegularizer),a.dilationRate=dv(n.dilationRate==null?1:n.dilationRate,e,"dilationRate"),a.rank===1&&Array.isArray(a.dilationRate)&&a.dilationRate.length!==1)throw new ee("dilationRate must be a number or an array of a single number for 1D convolution, but received "+JSON.stringify(a.dilationRate));if(a.rank===2){if(typeof a.dilationRate=="number")a.dilationRate=[a.dilationRate,a.dilationRate];else if(a.dilationRate.length!==2)throw new ee("dilationRate must be a number or array of two numbers for 2D convolution, but received "+JSON.stringify(a.dilationRate))}else if(a.rank===3){if(typeof a.dilationRate=="number")a.dilationRate=[a.dilationRate,a.dilationRate,a.dilationRate];else if(a.dilationRate.length!==3)throw new ee("dilationRate must be a number or array of three numbers for 3D convolution, but received "+JSON.stringify(a.dilationRate))}return a}return pe(t,r),t.verifyArgs=function(e){if(xa("kernelSize"in e,"required key 'kernelSize' not in config"),typeof e.kernelSize!="number"&&!h0(e.kernelSize,"number",1,3))throw new ee("BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received "+JSON.stringify(e.kernelSize)+".")},t.prototype.getConfig=function(){var e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:Ir(this.activation),useBias:this.useBias,biasInitializer:gt(this.biasInitializer),biasRegularizer:nt(this.biasRegularizer),activityRegularizer:nt(this.activityRegularizer),biasConstraint:At(this.biasConstraint)},n=r.prototype.getConfig.call(this);return Object.assign(e,n),e},t}(ft),mp=function(r){function t(e,n){var a=r.call(this,e,n)||this;return a.kernel=null,t.verifyArgs(n),a.filters=n.filters,er(a.filters,"filters"),a.kernelInitializer=zt(n.kernelInitializer||a.DEFAULT_KERNEL_INITIALIZER),a.kernelConstraint=hn(n.kernelConstraint),a.kernelRegularizer=Lt(n.kernelRegularizer),a}return pe(t,r),t.prototype.build=function(e){var n;e=It(e);var a=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[a]==null)throw new ee("The channel dimension of the input should be defined. Found "+e[a]);var i=e[a],s=this.kernelSize.concat([i,this.filters]);this.kernel=this.addWeight("kernel",s,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:(n={},n[a]=i,n)}],this.built=!0},t.prototype.call=function(e,n){var a=this;return ae(function(){var i;e=Ye(e);var s=a.bias==null?null:a.bias.read(),l=LN(a.activation.getClassName());if(l!=null&&a.rank===2)i=QS(e,a.kernel.read(),s,a.strides,a.padding,a.dataFormat,a.dilationRate,l);else{if(a.rank===1)i=VU(e,a.kernel.read(),s,a.strides[0],a.padding,a.dataFormat,a.dilationRate[0]);else if(a.rank===2)i=QS(e,a.kernel.read(),s,a.strides,a.padding,a.dataFormat,a.dilationRate);else{if(a.rank!==3)throw new tt("convolutions greater than 3D are not implemented yet.");i=jU(e,a.kernel.read(),s,a.strides,a.padding,a.dataFormat,a.dilationRate)}a.activation!=null&&(i=a.activation.apply(i))}return i})},t.prototype.computeOutputShape=function(e){e=It(e);for(var n=[],a=this.dataFormat==="channelsLast"?e.slice(1,e.length-1):e.slice(2),i=0;i<a.length;++i){var s=si(a[i],this.kernelSize[i],this.padding,this.strides[i],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[i]);n.push(s)}var l=[e[0]];return this.dataFormat==="channelsLast"?(l=l.concat(n)).push(this.filters):(l.push(this.filters),l=l.concat(n)),l},t.prototype.getConfig=function(){var e={filters:this.filters,kernelInitializer:gt(this.kernelInitializer),kernelRegularizer:nt(this.kernelRegularizer),kernelConstraint:At(this.kernelConstraint)},n=r.prototype.getConfig.call(this);return Object.assign(e,n),e},t.verifyArgs=function(e){if(!("filters"in e)||typeof e.filters!="number"||e.filters<1)throw new ee("Convolution layer expected config.filters to be a 'number' > 0 but got "+JSON.stringify(e.filters))},t}(_R),k0=function(r){function t(e){var n=r.call(this,2,e)||this;return t.verifyArgs(e),n}return pe(t,r),t.prototype.getConfig=function(){var e=r.prototype.getConfig.call(this);return delete e.rank,e},t.verifyArgs=function(e){if(typeof e.kernelSize!="number"&&!h0(e.kernelSize,"number",1,2))throw new ee("Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received "+JSON.stringify(e.kernelSize)+".")},t.className="Conv2D",t}(mp);be.registerClass(k0);var MR=function(r){function t(e){var n=r.call(this,3,e)||this;return t.verifyArgs(e),n}return pe(t,r),t.prototype.getConfig=function(){var e=r.prototype.getConfig.call(this);return delete e.rank,e},t.verifyArgs=function(e){if(typeof e.kernelSize!="number"&&(!Array.isArray(e.kernelSize)||e.kernelSize.length!==1&&e.kernelSize.length!==3))throw new ee("Conv3D expects config.kernelSize to be number or [number, number, number], but received "+JSON.stringify(e.kernelSize)+".")},t.className="Conv3D",t}(mp);be.registerClass(MR);var zR=function(r){function t(e){var n=r.call(this,e)||this;if(n.inputSpec=[new In({ndim:4})],n.padding!=="same"&&n.padding!=="valid")throw new ee("Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode "+n.padding);return n}return pe(t,r),t.prototype.build=function(e){var n;if((e=It(e)).length!==4)throw new ee("Input should have rank 4; Received input shape: "+JSON.stringify(e));var a=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[a]==null)throw new ee("The channel dimension of the inputs should be defined. Found `None`.");var i=e[a],s=this.kernelSize.concat([this.filters,i]);this.kernel=this.addWeight("kernel",s,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new In({ndim:4,axes:(n={},n[a]=i,n)})],this.built=!0},t.prototype.call=function(e,n){var a=this;return ae(function(){var i=Ye(e);if(i.shape.length!==4)throw new ee("Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-"+i.shape.length);var s,l,c=i.shape,f=c[0];a.dataFormat==="channelsFirst"?(s=2,l=3):(s=1,l=2);var d=c[s],p=c[l],g=a.kernelSize[0],v=a.kernelSize[1],b=a.strides[0],w=a.strides[1],S=[f,Ch(d,b,g,a.padding),Ch(p,w,v,a.padding),a.filters];a.dataFormat!=="channelsLast"&&(i=Ut(i,[0,2,3,1]));var x=Hd(i,a.kernel.read(),S,a.strides,a.padding);return a.dataFormat!=="channelsLast"&&(x=Ut(x,[0,3,1,2])),a.bias!=null&&(x=yi(x,a.bias.read(),a.dataFormat)),a.activation!=null&&(x=a.activation.apply(x)),x})},t.prototype.computeOutputShape=function(e){var n,a,i,s=(e=It(e)).slice();this.dataFormat==="channelsFirst"?(n=1,a=2,i=3):(n=3,a=1,i=2);var l=this.kernelSize[0],c=this.kernelSize[1],f=this.strides[0],d=this.strides[1];return s[n]=this.filters,s[a]=Ch(s[a],f,l,this.padding),s[i]=Ch(s[i],d,c,this.padding),s},t.prototype.getConfig=function(){var e=r.prototype.getConfig.call(this);return delete e.dilationRate,e},t.className="Conv2DTranspose",t}(k0);be.registerClass(zR);var WU=function(r){function t(e,n){var a=r.call(this,e,n)||this;if(a.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",a.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",a.depthwiseKernel=null,a.pointwiseKernel=null,n.filters==null)throw new ee("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(n.kernelInitializer!=null||n.kernelRegularizer!=null||n.kernelConstraint!=null)throw new ee("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(n.padding!=null&&n.padding!=="same"&&n.padding!=="valid")throw new ee("SeparableConv"+a.rank+"D supports only padding modes: 'same' and 'valid', but received "+JSON.stringify(n.padding));return a.depthMultiplier=n.depthMultiplier==null?1:n.depthMultiplier,a.depthwiseInitializer=zt(n.depthwiseInitializer||a.DEFAULT_DEPTHWISE_INITIALIZER),a.depthwiseRegularizer=Lt(n.depthwiseRegularizer),a.depthwiseConstraint=hn(n.depthwiseConstraint),a.pointwiseInitializer=zt(n.depthwiseInitializer||a.DEFAULT_POINTWISE_INITIALIZER),a.pointwiseRegularizer=Lt(n.pointwiseRegularizer),a.pointwiseConstraint=hn(n.pointwiseConstraint),a}return pe(t,r),t.prototype.build=function(e){var n;if((e=It(e)).length<this.rank+2)throw new ee("Inputs to SeparableConv"+this.rank+"D should have rank "+(this.rank+2)+", but received input shape: "+JSON.stringify(e));var a=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[a]==null||e[a]<0)throw new ee("The channel dimension of the inputs should be defined, but found "+JSON.stringify(e[a]));for(var i=e[a],s=this.kernelSize.concat([i,this.depthMultiplier]),l=[],c=0;c<this.rank;++c)l.push(1);l.push(i*this.depthMultiplier,this.filters),this.depthwiseKernel=this.addWeight("depthwise_kernel",s,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",l,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,!0,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.inputSpec=[new In({ndim:this.rank+2,axes:(n={},n[a]=i,n)})],this.built=!0},t.prototype.call=function(e,n){var a=this;return ae(function(){var i;if(e=Ye(e),a.rank===1)throw new tt("1D separable convolution is not implemented yet.");return a.rank===2&&(a.dataFormat==="channelsFirst"&&(e=Ut(e,[0,2,3,1])),i=Vb(e,a.depthwiseKernel.read(),a.pointwiseKernel.read(),a.strides,a.padding,a.dilationRate,"NHWC")),a.useBias&&(i=yi(i,a.bias.read(),a.dataFormat)),a.activation!=null&&(i=a.activation.apply(i)),a.dataFormat==="channelsFirst"&&(i=Ut(i,[0,3,1,2])),i})},t.prototype.getConfig=function(){var e=r.prototype.getConfig.call(this);return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=gt(this.depthwiseInitializer),e.pointwiseInitializer=gt(this.pointwiseInitializer),e.depthwiseRegularizer=nt(this.depthwiseRegularizer),e.pointwiseRegularizer=nt(this.pointwiseRegularizer),e.depthwiseConstraint=At(this.depthwiseConstraint),e.pointwiseConstraint=At(this.pointwiseConstraint),e},t.className="SeparableConv",t}(mp),LR=function(r){function t(e){return r.call(this,2,e)||this}return pe(t,r),t.className="SeparableConv2D",t}(WU);be.registerClass(LR);var FR=function(r){function t(e){var n=r.call(this,1,e)||this;return t.verifyArgs(e),n.inputSpec=[{ndim:3}],n}return pe(t,r),t.prototype.getConfig=function(){var e=r.prototype.getConfig.call(this);return delete e.rank,delete e.dataFormat,e},t.verifyArgs=function(e){if(typeof e.kernelSize!="number"&&!h0(e.kernelSize,"number",1,1))throw new ee("Conv1D expects config.kernelSize to be number or number[] with length 1, but received "+JSON.stringify(e.kernelSize)+".")},t.className="Conv1D",t}(mp);be.registerClass(FR);var BR=function(r){function t(e){var n=r.call(this,e)||this;return typeof e.cropping=="number"?n.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:typeof e.cropping[0]=="number"?n.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:n.cropping=e.cropping,n.dataFormat=e.dataFormat===void 0?"channelsLast":e.dataFormat,n.inputSpec=[{ndim:4}],n}return pe(t,r),t.prototype.computeOutputShape=function(e){return this.dataFormat==="channelsFirst"?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]},t.prototype.call=function(e,n){var a=this;return ae(function(){return e=Ye(e),a.dataFormat==="channelsLast"?xh(xh(e,a.cropping[0][0],e.shape[1]-a.cropping[0][0]-a.cropping[0][1],2),a.cropping[1][0],e.shape[2]-a.cropping[1][1]-a.cropping[1][0],3):xh(xh(e,a.cropping[0][0],e.shape[2]-a.cropping[0][0]-a.cropping[0][1],3),a.cropping[1][0],e.shape[3]-a.cropping[1][1]-a.cropping[1][0],4)})},t.prototype.getConfig=function(){var e={cropping:this.cropping,dataFormat:this.dataFormat},n=r.prototype.getConfig.call(this);return Object.assign(e,n),e},t.className="Cropping2D",t}(ft);be.registerClass(BR);var UR=function(r){function t(e){var n=r.call(this,e)||this;return n.DEFAULT_SIZE=[2,2],n.inputSpec=[{ndim:4}],n.size=e.size==null?n.DEFAULT_SIZE:e.size,n.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,n}return pe(t,r),t.prototype.computeOutputShape=function(e){if(this.dataFormat==="channelsFirst"){var n=e[2]==null?null:this.size[0]*e[2],a=e[3]==null?null:this.size[1]*e[3];return[e[0],e[1],n,a]}return n=e[1]==null?null:this.size[0]*e[1],a=e[2]==null?null:this.size[1]*e[2],[e[0],n,a,e[3]]},t.prototype.call=function(e,n){var a=this;return ae(function(){var i=Ye(e),s=i.shape;if(a.dataFormat==="channelsFirst"){i=Ut(i,[0,2,3,1]);var l=a.size[0]*s[2],c=a.size[1]*s[3],f=i.resizeNearestNeighbor([l,c]);return Ut(f,[0,3,1,2])}return l=a.size[0]*s[1],c=a.size[1]*s[2],i.resizeNearestNeighbor([l,c])})},t.prototype.getConfig=function(){var e={size:this.size,dataFormat:this.dataFormat},n=r.prototype.getConfig.call(this);return Object.assign(e,n),e},t.className="UpSampling2D",t}(ft);function HU(r,t,e,n,a,i){return e===void 0&&(e=[1,1]),n===void 0&&(n="valid"),ae(function(){a==null&&(a=oa()),pn(a);var s=I0(r,a);if(r.rank!==4)throw new ee("Input for depthwiseConv2d is required to be 4-D, but is instead "+r.rank+"-D");if(t.rank!==4)throw new ee("depthwiseKernel is required to be 4-D, but is instead "+t.rank+"-D");return s=Pu(s,t,e,n==="same"?"same":"valid","NHWC",i),a==="channelsFirst"&&(s=Ut(s,[0,3,1,2])),s})}be.registerClass(UR);var PR=function(r){function t(e){var n=r.call(this,2,e)||this;return n.depthwiseKernel=null,n.depthMultiplier=e.depthMultiplier==null?1:e.depthMultiplier,n.depthwiseInitializer=zt(e.depthwiseInitializer||n.DEFAULT_KERNEL_INITIALIZER),n.depthwiseConstraint=hn(e.depthwiseConstraint),n.depthwiseRegularizer=Lt(e.depthwiseRegularizer),n}return pe(t,r),t.prototype.build=function(e){if((e=It(e)).length<4)throw new ee("Inputs to DepthwiseConv2D should have rank 4. Received input shape: "+JSON.stringify(e)+".");var n=this.dataFormat==="channelsFirst"?1:3;if(e[n]==null||e[n]<0)throw new ee("The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not ("+e[n]+").");var a=e[n],i=[this.kernelSize[0],this.kernelSize[1],a,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",i,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[a*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0},t.prototype.call=function(e,n){var a=this;return ae(function(){var i=HU(e=Ye(e),a.depthwiseKernel.read(),a.strides,a.padding,a.dataFormat,null);return a.useBias&&(i=yi(i,a.bias.read(),a.dataFormat)),a.activation!=null&&(i=a.activation.apply(i)),i})},t.prototype.computeOutputShape=function(e){e=It(e);var n=this.dataFormat==="channelsFirst"?e[2]:e[1],a=this.dataFormat==="channelsFirst"?e[3]:e[2],i=this.dataFormat==="channelsFirst"?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,s=si(n,this.kernelSize[0],this.padding,this.strides[0]),l=si(a,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[e[0],i,s,l]:[e[0],s,l,i]},t.prototype.getConfig=function(){var e=r.prototype.getConfig.call(this);return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=gt(this.depthwiseInitializer),e.depthwiseRegularizer=nt(this.depthwiseRegularizer),e.depthwiseConstraint=At(this.depthwiseRegularizer),e},t.className="DepthwiseConv2D",t}(_R);be.registerClass(PR);var VR=function(r){function t(e){var n=r.call(this,e)||this;return n.rate=Math.max(Math.min(e.rate,1),0),n.noiseShape=e.noiseShape,n.seed=e.seed,n.supportsMasking=!0,n}return pe(t,r),t.prototype.getNoiseShape=function(e){if(this.noiseShape==null)return this.noiseShape;for(var n=e.shape,a=[],i=0;i<this.noiseShape.length;++i)a.push(this.noiseShape[i]==null?n[i]:this.noiseShape[i]);return a},t.prototype.call=function(e,n){var a=this;return ae(function(){a.invokeCallHook(e,n);var i=Ye(e);if(0<a.rate&&a.rate<1){var s=n.training!=null&&n.training,l=a.getNoiseShape(i);return Nu(function(){return $N(i,a.rate,l,a.seed)},function(){return i},s)}return e})},t.prototype.getConfig=function(){var e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},n=r.prototype.getConfig.call(this);return Object.assign(e,n),e},t.prototype.dispose=function(){return r.prototype.dispose.call(this)},t.className="Dropout",t}(ft);be.registerClass(VR);var jR=function(r){function t(e){var n=r.call(this,e)||this;if(n.activation=null,n.useBias=!0,n.kernel=null,n.bias=null,n.DEFAULT_KERNEL_INITIALIZER="glorotNormal",n.DEFAULT_BIAS_INITIALIZER="zeros",e.batchInputShape==null&&e.inputShape==null&&e.inputDim!=null){var a=null;e.batchSize!=null&&(a=e.batchSize),n.batchInputShape=[a,e.inputDim]}return n.units=e.units,er(n.units,"units"),n.activation=ao(e.activation),e.useBias!=null&&(n.useBias=e.useBias),n.kernelInitializer=zt(e.kernelInitializer||n.DEFAULT_KERNEL_INITIALIZER),n.biasInitializer=zt(e.biasInitializer||n.DEFAULT_BIAS_INITIALIZER),n.kernelConstraint=hn(e.kernelConstraint),n.biasConstraint=hn(e.biasConstraint),n.kernelRegularizer=Lt(e.kernelRegularizer),n.biasRegularizer=Lt(e.biasRegularizer),n.activityRegularizer=Lt(e.activityRegularizer),n.supportsMasking=!0,n.inputSpec=[{minNDim:2}],n}return pe(t,r),t.prototype.build=function(e){var n,a=(e=It(e))[e.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[a,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:(n={},n[-1]=a,n)}],this.built=!0},t.prototype.computeOutputShape=function(e){var n=(e=It(e)).slice();return n[n.length-1]=this.units,n},t.prototype.call=function(e,n){var a=this;return ae(function(){a.invokeCallHook(e,n);var i,s=Ye(e),l=LN(a.activation.getClassName());return l!=null?i=oi(s,a.kernel.read(),l,a.bias?a.bias.read():null):(i=oi(s,a.kernel.read()),a.bias!=null&&(i=yi(i,a.bias.read())),a.activation!=null&&(i=a.activation.apply(i))),i})},t.prototype.getConfig=function(){var e={units:this.units,activation:Ir(this.activation),useBias:this.useBias,kernelInitializer:gt(this.kernelInitializer),biasInitializer:gt(this.biasInitializer),kernelRegularizer:nt(this.kernelRegularizer),biasRegularizer:nt(this.biasRegularizer),activityRegularizer:nt(this.activityRegularizer),kernelConstraint:At(this.kernelConstraint),biasConstraint:At(this.biasConstraint)},n=r.prototype.getConfig.call(this);return Object.assign(e,n),e},t.className="Dense",t}(ft);be.registerClass(jR);var WR=function(r){function t(e){var n=r.call(this,e||{})||this;return n.inputSpec=[{minNDim:3}],n}return pe(t,r),t.prototype.computeOutputShape=function(e){for(var n=0,a=(e=It(e)).slice(1);n<a.length;n++)if(a[n]==null)throw new ee('The shape of the input to "Flatten" is not fully defined (got '+e.slice(1)+'). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.');return[e[0],Ji(e,1)]},t.prototype.call=function(e,n){var a=this;return ae(function(){return a.invokeCallHook(e,n),YF(Ye(e))})},t.className="Flatten",t}(ft);be.registerClass(WR);var HR=function(r){function t(e){var n=r.call(this,e)||this;return n.supportsMasking=!0,n.activation=ao(e.activation),n}return pe(t,r),t.prototype.call=function(e,n){var a=this;return ae(function(){a.invokeCallHook(e,n);var i=Ye(e);return a.activation.apply(i)})},t.prototype.getConfig=function(){var e={activation:Ir(this.activation)},n=r.prototype.getConfig.call(this);return Object.assign(e,n),e},t.className="Activation",t}(ft);be.registerClass(HR);var qR=function(r){function t(e){var n=r.call(this,e)||this;return n.n=e.n,n.inputSpec=[{ndim:2}],n}return pe(t,r),t.prototype.computeOutputShape=function(e){return[e[0],this.n,e[1]]},t.prototype.call=function(e,n){var a=this;return ae(function(){return $F(e=Ye(e),a.n)})},t.prototype.getConfig=function(){var e={n:this.n},n=r.prototype.getConfig.call(this);return Object.assign(e,n),e},t.className="RepeatVector",t}(ft);be.registerClass(qR);var GR=function(r){function t(e){var n=r.call(this,e)||this;n.targetShape=e.targetShape;for(var a=0;a<n.targetShape.length;++a)n.isUnknown(n.targetShape[a])&&(n.targetShape[a]=null);return n}return pe(t,r),t.prototype.isUnknown=function(e){return e<0||e==null},t.prototype.fixUnknownDimension=function(e,n){for(var a="Total size of new array must be unchanged.",i=n.slice(),s=1,l=null,c=0;c<i.length;++c){var f=i[c];if(this.isUnknown(f)){if(l!==null)throw new ee("Can only specifiy one unknown dimension.");l=c}else s*=f}var d=Ji(e);if(l!==null){if(s===0||d%s!=0)throw new ee(a);i[l]=d/s}else if(d!==s)throw new ee(a);return i},t.prototype.computeOutputShape=function(e){for(var n=!1,a=0;a<e.length;++a)if(this.isUnknown(e[a])){n=!0;break}return n?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))},t.prototype.call=function(e,n){var a=this;return ae(function(){a.invokeCallHook(e,n);var i=Ye(e),s=i.shape,l=s.slice(0,1).concat(a.fixUnknownDimension(s.slice(1),a.targetShape));return i.reshape(l)})},t.prototype.getConfig=function(){var e={targetShape:this.targetShape},n=r.prototype.getConfig.call(this);return Object.assign(e,n),e},t.className="Reshape",t}(ft);be.registerClass(GR);var XR=function(r){function t(e){var n=r.call(this,e)||this;if(e.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error("Permute constructor requires `dims` to be an Array, but received "+e.dims+" instead.");var a=sa(1,e.dims.length+1);if(!Be.arraysEqual(e.dims.slice().sort(),a))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");return n.dims=e.dims,n.dimsIncludingBatch=[0].concat(n.dims),n.inputSpec=[new In({ndim:n.dims.length+1})],n}return pe(t,r),t.prototype.computeOutputShape=function(e){var n=(e=It(e)).slice();return this.dims.forEach(function(a,i){n[i+1]=e[a]}),n},t.prototype.call=function(e,n){return Ut(Ye(e),this.dimsIncludingBatch)},t.prototype.getConfig=function(){var e={dims:this.dims},n=r.prototype.getConfig.call(this);return Object.assign(e,n),e},t.className="Permute",t}(ft);be.registerClass(XR);var $R=function(r){function t(e){var n=r.call(this,e??{})||this;return n.supportsMasking=!0,n.maskValue=e!=null?e.maskValue==null?0:e.maskValue:0,n}return pe(t,r),t.prototype.computeOutputShape=function(e){return e},t.prototype.getConfig=function(){var e=r.prototype.getConfig.call(this),n={maskValue:this.maskValue};return Object.assign(n,e),n},t.prototype.computeMask=function(e,n){var a=Ye(e);return yc(Su(a,this.maskValue),-1)},t.prototype.call=function(e,n){var a=this;return ae(function(){a.invokeCallHook(e,n);var i=Ye(e),s=yc(Su(i,a.maskValue),-1,!0);return i.mul(s.asType(i.dtype))})},t.className="Masking",t}(ft);be.registerClass($R);var KR=function(r){function t(e){var n=r.call(this,e)||this;if(n.embeddings=null,n.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",e.batchInputShape==null&&e.inputShape==null){var a=null;e.batchSize!=null&&(a=e.batchSize),e.inputLength==null?n.batchInputShape=[a,null]:n.batchInputShape=[a].concat(_t(e.inputLength))}return n.inputDim=e.inputDim,er(n.inputDim,"inputDim"),n.outputDim=e.outputDim,er(n.outputDim,"outputDim"),n.embeddingsInitializer=zt(e.embeddingsInitializer||n.DEFAULT_EMBEDDINGS_INITIALIZER),n.embeddingsRegularizer=Lt(e.embeddingsRegularizer),n.activityRegularizer=Lt(e.activityRegularizer),n.embeddingsConstraint=hn(e.embeddingsConstraint),n.maskZero=e.maskZero,n.supportsMasking=e.maskZero,n.inputLength=e.inputLength,n}return pe(t,r),t.prototype.build=function(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0},t.prototype.warnOnIncompatibleInputShape=function(e){},t.prototype.computeMask=function(e,n){var a=this;return ae(function(){return a.maskZero?(e=Ye(e),Su(e,ct(e))):null})},t.prototype.computeOutputShape=function(e){if(e=It(e),this.inputLength==null)return e.concat([this.outputDim]);var n=_t(this.inputLength);if(n.length!==e.length-1)throw new ee('"inputLength" is '+this.inputLength+", but received input shape has shape "+e);for(var a=0,i=0;i<n.length;++i){var s=n[i],l=e[i+1];if(s!=null&&l!=null&&s!==l)throw new ee('"inputLength" is '+this.inputLength+", but received input shape has shape "+e);s==null&&(n[a]=l),a++}return[e[0]].concat(n,[this.outputDim])},t.prototype.call=function(e,n){var a=this;return ae(function(){a.invokeCallHook(e,n);var i=Ye(e);return i.dtype!=="int32"&&(i=qc(i,"int32")),XN(a.embeddings.read(),i.as1D()).reshape(It(a.computeOutputShape(i.shape)))})},t.prototype.getConfig=function(){var e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:gt(this.embeddingsInitializer),embeddingsRegularizer:nt(this.embeddingsRegularizer),activityRegularizer:nt(this.activityRegularizer),embeddingsConstraint:At(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},n=r.prototype.getConfig.call(this);return Object.assign(e,n),e},t.className="Embedding",t}(ft);be.registerClass(KR);var gs=function(r){function t(e){var n=r.call(this,e||{})||this;return n.supportsMasking=!0,n}return pe(t,r),t.prototype.mergeFunction=function(e){throw new tt},t.prototype.computeElementwiseOpOutputShape=function(e,n){if(e==null||n==null)return null;if(e.length<n.length)return this.computeElementwiseOpOutputShape(n,e);if(n.length===0)return e;for(var a=e.slice(0,e.length-n.length),i=0;i<n.length;++i){var s=e[e.length-n.length+i],l=n[i];if(s==null||l==null||s<0||l<0)a.push(null);else if(s===1)a.push(l);else if(l===1)a.push(s);else{if(s!==l)throw new ee("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(n));a.push(s)}}return a},t.prototype.build=function(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[It(e)]),(e=e).length<2)throw new ee("A merge layer should be called on an Array of at least 2 inputs. Got "+e.length+" input(s).");for(var n=[],a=0,i=e;a<i.length;a++)(c=i[a])!=null&&c[0]!==null&&n.push(c[0]);if((n=Qi(n)).length>1)throw new ee("Can not merge tensors with different batch sizes. Got tensors with shapes: "+JSON.stringify(e)+".");for(var s=e[0]==null?null:e[0].slice(1),l=1;l<e.length;++l){var c=e[l]==null?null:e[l].slice(1);s=this.computeElementwiseOpOutputShape(s,c)}var f=e.map(function(d){return d.length});e.indexOf(null)===-1&&Qi(f).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0},t.prototype.call=function(e,n){var a=this;return ae(function(){if(e=e,a.reshapeRequired){var i=[],s=e.map(function(D){return D.rank});if(s.indexOf(null)===-1){for(var l=ro(s),c=0,f=e;c<f.length;c++){for(var d=(w=f[c]).rank,p=0;p<l-d;++p)w=Gc(w,1);i.push(w)}return a.mergeFunction(i)}for(var g=!1,v=0,b=e;v<b.length;v++){var w;if((d=(w=b[v]).rank)==null){var S=w.shape,x=S[0],C=S.slice(1).concat([x]),A=w.reshape([x].concat(Ji(S.slice(1))));A=(A=Ut(A,[1,0])).reshape(C),i.push(A),g=!0}else if(d>1){var T=sa(1,d).concat([0]);i.push(Ut(w,T)),g=!0}else i.push(w)}var R=a.mergeFunction(i),O=R.rank;if(g)if(O==null){var N=R.shape;C=[x=N[N.length-1]].concat(N.slice(0,N.length-1)),R=Ut(R.reshape([-1,x]),[1,0]).reshape(C)}else O>1&&(T=[O-1].concat(sa(0,O-1)),R=Ut(R,T));return R}return a.mergeFunction(e)})},t.prototype.computeOutputShape=function(e){var n;n=(e=e)[0]==null?null:e[0].slice(1);for(var a=1;a<e.length;++a){var i=e[a]==null?null:e[a].slice(1);n=this.computeElementwiseOpOutputShape(n,i)}for(var s=[],l=0,c=e;l<c.length;l++)(i=c[l])!=null&&i[0]!==null&&s.push(i[0]);return n=(s=Qi(s)).length===1?s.concat(n):[null].concat(n)},t.prototype.computeMask=function(e,n){return ae(function(){if(n==null)return null;if(!Array.isArray(n))throw new ee("`mask` should be an Array");if(!Array.isArray(e))throw new ee("`inputs` should be an Array");if(n.length!==e.length)throw new ee("The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths ("+e.length+" vs "+n.length+")");if(n.every(function(s){return s==null}))return null;for(var a=(n=n.map(function(s){return s==null?s:Sr(s,0)}))[0],i=1;i<n.length-1;++i)a=mi(a,n[i]);return a})},t}(ft),YR=function(r){function t(e){return r.call(this,e)||this}return pe(t,r),t.prototype.mergeFunction=function(e){return ae(function(){for(var n=e[0].clone(),a=1;a<e.length;++a)n=ot(n,e[a]);return n})},t.className="Add",t}(gs);be.registerClass(YR);var ZR=function(r){function t(e){return r.call(this,e)||this}return pe(t,r),t.prototype.mergeFunction=function(e){return ae(function(){for(var n=e[0].clone(),a=1;a<e.length;++a)n=Xe(n,e[a]);return n})},t.className="Multiply",t}(gs);be.registerClass(ZR);var QR=function(r){function t(e){return r.call(this,e)||this}return pe(t,r),t.prototype.mergeFunction=function(e){return ae(function(){for(var n=e[0].clone(),a=1;a<e.length;++a)n=ot(n,e[a]);return Xe(1/e.length,n)})},t.className="Average",t}(gs);be.registerClass(QR);var JR=function(r){function t(e){return r.call(this,e)||this}return pe(t,r),t.prototype.mergeFunction=function(e){return ae(function(){for(var n=e[0],a=1;a<e.length;++a)n=_a(n,e[a]);return n})},t.className="Maximum",t}(gs);be.registerClass(JR);var eI=function(r){function t(e){return r.call(this,e)||this}return pe(t,r),t.prototype.mergeFunction=function(e){return ae(function(){for(var n=e[0],a=1;a<e.length;++a)n=Fu(n,e[a]);return n})},t.className="Minimum",t}(gs);be.registerClass(eI);var tI=function(r){function t(e){var n=r.call(this,e)||this;return n.DEFAULT_AXIS=-1,e==null&&(e={}),n.axis=e.axis==null?n.DEFAULT_AXIS:e.axis,n.supportsMasking=!0,n.reshapeRequired=!1,n}return pe(t,r),t.prototype.build=function(e){if(!Array.isArray(e)||!Array.isArray(e[0])||e.length===1)throw new ee("A `Concatenate` layer should be called on a list of at least 2 inputs");for(var n=!0,a=0,i=e=e;a<i.length;a++)if((g=i[a])!=null){n=!1;break}if(!n){for(var s=[],l=0;l<e.length;++l){var c=e[l].slice();c.splice(this.axis,1);for(var f=!1,d=0,p=s;d<p.length;d++){var g=p[d];if(Be.arraysEqual(g,c)){f=!0;break}}f||s.push(c)}if(s.length>1)throw new ee("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}},t.prototype.mergeFunction=function(e){var n=this;return ae(function(){return GN(e,n.axis)})},t.prototype.computeOutputShape=function(e){if(!Array.isArray(e)||!Array.isArray(e[0]))throw new ee("A `Concatenate` layer should be called on a list of inputs.");for(var n=e,a=n[0].slice(),i=this.axis<0?a.length+this.axis:this.axis,s=0,l=n.slice(1);s<l.length;s++){var c=l[s];if(a[i]==null||c[i]==null){a[i]=null;break}a[i]+=c[i]}return a},t.prototype.computeMask=function(e,n){var a=this;if(n==null)return null;if(!Array.isArray(n))throw new ee("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new ee("`inputs` should be an array for Concatenate");if(n.length!==e.length)throw new ee("Mismatch in the length of mask ("+n.length+") and the legnth of inputs ("+e.length+")");return ae(function(){var i=!0;if(n.forEach(function(f){f==null||(i=!1)}),i)return null;for(var s=[],l=0;l<e.length;++l)n[l]==null?s.push(Nr(e[l]).asType("bool")):n[l].rank<e[l].rank?s.push(Sr(n[l],-1)):s.push(n[l]);var c=Gn(s,a.axis);return Zd(c,-1,!1)})},t.prototype.getConfig=function(){var e={axis:this.axis},n=r.prototype.getConfig.call(this);return Object.assign(e,n),e},t.className="Concatenate",t}(gs);function $l(r,t){for(;r<0;)r+=t;return r}function qU(r,t,e){if(r.shape.length>3||t.shape.length>3)throw new tt("batchDot is not implemented for tensors of 4D or higher rank yet");if(Be.assert(r.shape.length>=2,function(){return"batchDot requires the rank of x to be >= 2, but got "+r.shape.length}),Be.assert(r.shape.length>=2,function(){return"batchDot requires the rank of y to be >= 2, but got "+t.shape.length}),typeof e=="number"&&(e=[e,e]),r.dtype==="complex64"||t.dtype==="complex64")throw new tt("batchDot is not implemented for complex64-type Tensors yet.");var n=r.shape.length,a=t.shape.length;e==null&&(e=[n-1,a-2]);var i=e;return ae(function(){var s,l;if(n>a){s=n-a;for(var c=[],f=0;f<s;++f)c.push(1);t=t.reshape(t.shape.concat(c))}else if(a>n){for(s=a-n,c=[],f=0;f<s;++f)c.push(1);r=r.reshape(r.shape.concat(c))}else s=0;if(r.shape.length===2&&t.shape.length===2)l=i[0]===i[1]?r.mulStrict(t).sum(i[0]):r.transpose([1,0]).mulStrict(t).sum(i[1]);else{var d=i[0]!==r.shape.length-1,p=i[1]===t.shape.length-1;l=r.matMul(t,d,p)}if(s>0){var g=void 0,v=[];for(f=g=n>a?n+a-3:n-1;f<g+s;++f)v.push(f);l=l.squeeze(v)}return l.shape.length===1&&(l=l.expandDims(1)),l})}be.registerClass(tI);var nI=function(r){function t(e){var n=r.call(this,e)||this;return n.axes=e.axes,n.normalize=e.normalize!=null&&e.normalize,n.supportsMasking=!0,n.reshapeRequired=!1,n}return pe(t,r),t.prototype.build=function(e){Be.assert(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),function(){return"A `Dot` layer should be called on a list of exactly 2 inputs."});var n=e[0],a=e[1];if(n.length>3||a.length>3)throw new tt("Dot layer does not support tensors of 4D or higher rank yet.");var i=this.interpretAxes(n,a);if(n[i[0]]!==a[i[1]])throw new ee("Dimension incompatibility: "+n[i[0]]+" !== "+a[i[1]])},t.prototype.mergeFunction=function(e){if(e.length!==2)throw new ee("A `Dot` layer must be called on exactly 2 inputs, but received "+e.length+" input(s).");var n,a=e[0],i=e[1];return n=Array.isArray(this.axes)?this.axes.map(function(s,l){return $l(s,e[l].shape.length)}):[$l(this.axes,a.shape.length),$l(this.axes,i.shape.length)],this.normalize&&(a=ld(a,n[0]),i=ld(i,n[1])),qU(a,i,n)},t.prototype.interpretAxes=function(e,n){return Array.isArray(this.axes)?this.axes:[$l(this.axes,e.length),$l(this.axes,n.length)]},t.prototype.computeOutputShape=function(e){Be.assert(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),function(){return"A `Dot` layer should be called on a list of exactly 2 inputs."});var n=e[0].slice(),a=e[1].slice();if(n.length>3||a.length>3)throw new tt("Dot layer does not support tensors of 4D or higher rank yet.");var i=this.interpretAxes(n,a);n.splice(i[0],1),a.splice(i[1],1),a.splice(0,1);var s=n.concat(a);return s.length===1&&s.push(1),s},t.prototype.computeMask=function(e,n){return null},t.prototype.getConfig=function(){var e={axes:this.axes,normalize:this.normalize},n=r.prototype.getConfig.call(this);return Object.assign(e,n),e},t.className="Dot",t}(gs);be.registerClass(nI);var rI=function(r){function t(e){var n=r.call(this,e)||this;return n.supportsMasking=!0,n.stddev=e.stddev,n}return pe(t,r),t.prototype.computeOutputShape=function(e){return e},t.prototype.getConfig=function(){var e=r.prototype.getConfig.call(this),n={stddev:this.stddev};return Object.assign(n,e),n},t.prototype.call=function(e,n){var a=this;return ae(function(){a.invokeCallHook(e,n);var i=Ye(e);return Nu(function(){return up(i.shape,0,a.stddev).add(i)},function(){return i},n.training||!1)})},t.className="GaussianNoise",t}(ft);be.registerClass(rI);var aI=function(r){function t(e){var n=r.call(this,e)||this;return n.supportsMasking=!0,n.rate=e.rate,n}return pe(t,r),t.prototype.computeOutputShape=function(e){return e},t.prototype.getConfig=function(){var e=r.prototype.getConfig.call(this),n={rate:this.rate};return Object.assign(n,e),n},t.prototype.call=function(e,n){var a=this;return ae(function(){a.invokeCallHook(e,n);var i=Ye(e);return a.rate>0&&a.rate<1?Nu(function(){var s=Math.sqrt(a.rate/(1-a.rate));return i.mul(up(i.shape,1,s))},function(){return i},n.training||!1):i})},t.className="GaussianDropout",t}(ft);be.registerClass(aI);var iI=function(r){function t(e){var n=r.call(this,e)||this;return n.supportsMasking=!0,n.rate=e.rate,n.noiseShape=e.noiseShape,n}return pe(t,r),t.prototype._getNoiseShape=function(e){return this.noiseShape||Ye(e).shape},t.prototype.computeOutputShape=function(e){return e},t.prototype.getConfig=function(){var e=r.prototype.getConfig.call(this),n={rate:this.rate};return Object.assign(n,e),n},t.prototype.call=function(e,n){var a=this;return ae(function(){if(a.rate<1&&a.rate>0){var i=a._getNoiseShape(e);return Nu(function(){var s=Ye(e),l=-1.7580993408473766,c=Lc(cs(i),a.rate);c=qc(c,"float32");var f=Math.pow((1-a.rate)*(1+a.rate*Math.pow(l,2)),-.5),d=-f*l*a.rate;return s.mul(c).add(c.add(-1).mul(l)).mul(f).add(d)},function(){return Ye(e)},n.training||!1)}return e})},t.className="AlphaDropout",t}(ft);function Sc(r,t,e,n,a,i){var s;if(i===void 0&&(i=.001),r.rank===2)s=Ib(r,t,e,n,a,i);else if(r.rank===3)s=kb(r,t,e,n,a,i);else{if(r.rank!==4)throw new tt("batchNormalization is not implemented for array of rank "+r.rank+" yet");s=Db(r,t,e,n,a,i)}return s}function GU(r,t,e,n,a){return a===void 0&&(a=.001),ae(function(){var i=Uc(r,n),s=i.mean,l=i.variance;return[Sc(r,s,l,e,t,a),s,l]})}function XU(r,t,e,n,a){return a===void 0&&(a=.001),ae(function(){for(var i=Uc(r,n),s=i.mean,l=i.variance,c=[],f=0,d=sa(0,r.rank);f<d.length;f++){var p=d[f];n.indexOf(p)!==-1?c.push(1):c.push(r.shape[p])}var g=s.reshape(c),v=l.reshape(c),b=t==null?null:t.reshape(c),w=e==null?null:e.reshape(c);return[Sc(r,g,v,w,b,a),s,l]})}function $U(r,t,e,n,a){return a===void 0&&(a=.001),Be.arraysEqual(n.slice().sort(),sa(0,r.rank-1))?GU(r,t,e,n,a):XU(r,t,e,n,a)}be.registerClass(iI);var oI=function(r){function t(e){var n=this;return e==null&&(e={}),(n=r.call(this,e)||this).supportsMasking=!0,n.axis=e.axis==null?-1:e.axis,n.momentum=e.momentum==null?.99:e.momentum,n.epsilon=e.epsilon==null?.001:e.epsilon,n.center=e.center==null||e.center,n.scale=e.scale==null||e.scale,n.betaInitializer=zt(e.betaInitializer||"zeros"),n.gammaInitializer=zt(e.gammaInitializer||"ones"),n.movingMeanInitializer=zt(e.movingMeanInitializer||"zeros"),n.movingVarianceInitializer=zt(e.movingVarianceInitializer||"ones"),n.betaConstraint=hn(e.betaConstraint),n.gammaConstraint=hn(e.gammaConstraint),n.betaRegularizer=Lt(e.betaRegularizer),n.gammaRegularizer=Lt(e.gammaRegularizer),n}return pe(t,r),t.prototype.build=function(e){var n;e=It(e);var a=this.axis>=0?this.axis:this.axis+e.length,i=e[a];if(i==null)throw new ee("Axis "+a+" of input tensor should have a defined dimension but the layer received an input with shape "+JSON.stringify(e)+".");this.inputSpec=[new In({ndim:e.length,axes:(n={},n[a]=i,n)})];var s=[i];this.scale&&(this.gamma=this.addWeight("gamma",s,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",s,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",s,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",s,null,this.movingVarianceInitializer,null,!1),this.built=!0},t.prototype.call=function(e,n){var a=this;return ae(function(){var i=n.training!=null&&n.training,s=Ye(e),l=s.shape,c=l.length,f=sa(0,c),d=a.axis>=0?a.axis:a.axis+c;f.splice(d,1);var p=rs(1,c);p[d]=l[d];var g=f.slice();g.sort();var v=!Be.arraysEqual(g,sa(0,c).slice(0,c-1));if(!i)return function(){if(v){var A=a.movingMean.read().reshape(p),T=a.movingVariance.read().reshape(p),R=a.center?a.beta.read().reshape(p):null,O=a.scale?a.gamma.read().reshape(p):null;return Sc(s,A,T,R,O,a.epsilon)}return Sc(s,a.movingMean.read(),a.movingVariance.read(),a.beta==null?null:a.beta.read(),a.gamma==null?null:a.gamma.read(),a.epsilon)}();var b=$U(s,a.gamma.read(),a.beta.read(),f,a.epsilon),w=b[0],S=b[1],x=b[2],C=function(A,T,R){ae(function(){var O=1-R,N=A.read(),D=N.sub(T).mul(O);A.write(N.sub(D))})};return C(a.movingMean,S,a.momentum),C(a.movingVariance,x,a.momentum),w})},t.prototype.getConfig=function(){var e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:gt(this.betaInitializer),gammaInitializer:gt(this.gammaInitializer),movingMeanInitializer:gt(this.movingMeanInitializer),movingVarianceInitializer:gt(this.movingVarianceInitializer),betaRegularizer:nt(this.betaRegularizer),gammaRegularizer:nt(this.gammaRegularizer),betaConstraint:At(this.betaConstraint),gammaConstraint:At(this.gammaConstraint)},n=r.prototype.getConfig.call(this);return Object.assign(e,n),e},t.className="BatchNormalization",t}(ft);be.registerClass(oI);var sI=function(r){function t(e){var n=this;if(e==null&&(e={}),(n=r.call(this,e)||this).axis=e.axis==null?-1:e.axis,typeof n.axis=="number"){if(!Number.isInteger(n.axis))throw new Error("Expected axis to be an integer, but received "+n.axis)}else{if(!Array.isArray(n.axis))throw new Error("Expected axis to be an integer or an array of integers, but received "+JSON.stringify(n.axis));for(var a=0,i=n.axis;a<i.length;a++){var s=i[a];if(!Number.isInteger(s))throw new Error("Expected axis to be an array of integers, but received "+JSON.stringify(n.axis))}}return n.epsilon=e.epsilon==null?.001:e.epsilon,n.center=e.center==null||e.center,n.scale=e.scale==null||e.scale,n.betaInitializer=zt(e.betaInitializer||"zeros"),n.gammaInitializer=zt(e.gammaInitializer||"ones"),n.betaRegularizer=Lt(e.betaRegularizer),n.gammaRegularizer=Lt(e.gammaRegularizer),n.supportsMasking=!0,n}return pe(t,r),t.prototype.build=function(e){var n=(e=It(e)).length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(var a=0;a<this.axis.length;++a)this.axis[a]<0&&(this.axis[a]+=n);for(var i=0,s=this.axis;i<s.length;i++){var l=s[i];if(l<0||l>=n)throw new Error("Invalid axis: "+l)}if(this.axis.length!==Qi(this.axis).length)throw new Error("Found duplicate axes in: "+this.axis);var c=this.axis.map(function(f){return e[f]});this.scale?this.gamma=this.addWeight("gamma",c,"float32",this.gammaInitializer,this.gammaRegularizer,!0):this.gamma=null,this.center?this.beta=this.addWeight("beta",c,"float32",this.betaInitializer,this.betaRegularizer,!0):this.beta=null,this.built=!0},t.prototype.call=function(e,n){var a=this,i=Ye(e),s=i.shape,l=s.length;return ae(function(){for(var c=Uc(i,a.axis,!0),f=c.mean,d=c.variance,p=rs(1,l),g=0,v=a.axis;g<v.length;g++){var b=v[g];p[b]=s[b]}for(var w=function(R){return R!=null&&R.shape.length!==l&&a.axis!==[l-1]?R.reshape(p):R},S=w(a.gamma.read()),x=w(a.beta.read()),C=[],A=[],T=0;T<l;++T)a.axis.indexOf(T)!==-1?(C.push(s[T]),A.push(1)):(C.push(1),A.push(s[T]));return f=f.tile(C),d=d.tile(C),S=S.tile(A),x=x.tile(A),Sc(i,f,d,x,S,a.epsilon)})},t.prototype.getConfig=function(){var e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:gt(this.betaInitializer),gammaInitializer:gt(this.gammaInitializer),betaRegularizer:nt(this.betaRegularizer),gammaRegularizer:nt(this.gammaRegularizer)},n=r.prototype.getConfig.call(this);return Object.assign(e,n),e},t.className="LayerNormalization",t}(ft);function KU(r,t,e){return ae(function(){if(r.rank!==4)throw new ee("temporalPadding expects input tensor to be 4-D, but received a "+r.rank+"-D tensor.");if(t==null&&(t=[[1,1],[1,1]]),t.length!==2||t[0].length!==2||t[1].length!==2)throw new ee("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(e==null&&(e=oa()),e!=="channelsLast"&&e!=="channelsFirst")throw new ee("Unknown data format: "+e+". Supported data formats are 'channelsLast' and 'channelsFirst.");var n;return n=e==="channelsFirst"?[[0,0],[0,0],t[0],t[1]]:[[0,0],t[0],t[1],[0,0]],so(r,n)})}be.registerClass(sI);var uI=function(r){function t(e){var n=this;if(e==null&&(e={}),(n=r.call(this,e)||this).dataFormat=e.dataFormat==null?oa():e.dataFormat,e.padding==null)n.padding=[[1,1],[1,1]];else if(typeof e.padding=="number")n.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,e.padding.length!==2)throw new ee("ZeroPadding2D expects padding to be a length-2 array, but received a length-"+e.padding.length+" array.");var a=void 0,i=void 0;if(typeof e.padding[0]=="number")a=[e.padding[0],e.padding[0]],i=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,e.padding[0].length!==2)throw new ee("ZeroPadding2D expects height padding to be a length-2 array, but received a length-"+e.padding[0].length+" array.");if(a=e.padding[0],e.padding[1].length!==2)throw new ee("ZeroPadding2D expects width padding to be a length-2 array, but received a length-"+e.padding[1].length+" array.");i=e.padding[1]}n.padding=[a,i]}return n.inputSpec=[new In({ndim:4})],n}return pe(t,r),t.prototype.computeOutputShape=function(e){var n,a;return e=It(e),this.dataFormat==="channelsFirst"?(n=e[2]!=null&&e[2]>=0?e[2]+this.padding[0][0]+this.padding[0][1]:null,a=e[3]!=null&&e[3]>=0?e[3]+this.padding[1][0]+this.padding[1][1]:null,[e[0],e[1],n,a]):(n=e[1]!=null&&e[1]>=0?e[1]+this.padding[0][0]+this.padding[0][1]:null,a=e[2]!=null&&e[2]>=0?e[2]+this.padding[1][0]+this.padding[1][1]:null,[e[0],n,a,e[3]])},t.prototype.call=function(e,n){var a=this;return ae(function(){return KU(Ye(e),a.padding,a.dataFormat)})},t.prototype.getConfig=function(){var e={padding:this.padding,dataFormat:this.dataFormat},n=r.prototype.getConfig.call(this);return Object.assign(e,n),e},t.className="ZeroPadding2D",t}(ft);function gp(r,t,e,n,a,i){return ae(function(){var s;pn(a),VN(i),Xr(n),e==null&&(e=[1,1]),n==null&&(n="valid"),a==null&&(a=oa()),i==null&&(i="max"),r=I0(r,a);var l=n==="same"?"same":"valid";return s=i==="max"?Gd(r,t,e,l):Xd(r,t,e,l),a==="channelsFirst"&&(s=Ut(s,[0,3,1,2])),s})}function lI(r,t,e,n,a,i){return ae(function(){var s;pn(a),VN(i),Xr(n),e==null&&(e=[1,1,1]),n==null&&(n="valid"),a==null&&(a=oa()),i==null&&(i="max"),r=OR(r,a);var l=n==="same"?"same":"valid";return s=i==="max"?$d(r,t,e,l):Kd(r,t,e,l),a==="channelsFirst"&&(s=Ut(s,[0,4,1,2,3])),s})}be.registerClass(uI);var cI=function(r){function t(e){var n=this;if(e.poolSize==null&&(e.poolSize=2),n=r.call(this,e)||this,typeof e.poolSize=="number")n.poolSize=[e.poolSize];else{if(!Array.isArray(e.poolSize)||e.poolSize.length!==1||typeof e.poolSize[0]!="number")throw new ee("poolSize for 1D convolutional layer must be a number or an Array of a single number, but received "+JSON.stringify(e.poolSize));n.poolSize=e.poolSize}if(er(n.poolSize,"poolSize"),e.strides==null)n.strides=n.poolSize;else if(typeof e.strides=="number")n.strides=[e.strides];else{if(!Array.isArray(e.strides)||e.strides.length!==1||typeof e.strides[0]!="number")throw new ee("strides for 1D convolutional layer must be a number or an Array of a single number, but received "+JSON.stringify(e.strides));n.strides=e.strides}return er(n.strides,"strides"),n.padding=e.padding==null?"valid":e.padding,Xr(n.padding),n.inputSpec=[new In({ndim:3})],n}return pe(t,r),t.prototype.computeOutputShape=function(e){var n=si((e=It(e))[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],n,e[2]]},t.prototype.call=function(e,n){var a=this;return ae(function(){a.invokeCallHook(e,n),e=Gc(Ye(e),2);var i=a.poolingFunction(Ye(e),[a.poolSize[0],1],[a.strides[0],1],a.padding,"channelsLast");return kc(i,[2])})},t.prototype.getConfig=function(){var e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},n=r.prototype.getConfig.call(this);return Object.assign(e,n),e},t}(ft),fI=function(r){function t(e){return r.call(this,e)||this}return pe(t,r),t.prototype.poolingFunction=function(e,n,a,i,s){return pn(s),Xr(i),gp(e,n,a,i,s,"max")},t.className="MaxPooling1D",t}(cI);be.registerClass(fI);var hI=function(r){function t(e){return r.call(this,e)||this}return pe(t,r),t.prototype.poolingFunction=function(e,n,a,i,s){return pn(s),Xr(i),gp(e,n,a,i,s,"avg")},t.className="AveragePooling1D",t}(cI);be.registerClass(hI);var dI=function(r){function t(e){var n=this;if(e.poolSize==null&&(e.poolSize=[2,2]),(n=r.call(this,e)||this).poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],e.strides==null)n.strides=n.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==2)throw new ee("If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length "+e.strides.length+".");n.strides=e.strides}else n.strides=[e.strides,e.strides];return er(n.poolSize,"poolSize"),er(n.strides,"strides"),n.padding=e.padding==null?"valid":e.padding,n.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,pn(n.dataFormat),Xr(n.padding),n.inputSpec=[new In({ndim:4})],n}return pe(t,r),t.prototype.computeOutputShape=function(e){e=It(e);var n=this.dataFormat==="channelsFirst"?e[2]:e[1],a=this.dataFormat==="channelsFirst"?e[3]:e[2];return n=si(n,this.poolSize[0],this.padding,this.strides[0]),a=si(a,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[e[0],e[1],n,a]:[e[0],n,a,e[3]]},t.prototype.call=function(e,n){var a=this;return ae(function(){return a.invokeCallHook(e,n),a.poolingFunction(Ye(e),a.poolSize,a.strides,a.padding,a.dataFormat)})},t.prototype.getConfig=function(){var e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=r.prototype.getConfig.call(this);return Object.assign(e,n),e},t}(ft),pI=function(r){function t(e){return r.call(this,e)||this}return pe(t,r),t.prototype.poolingFunction=function(e,n,a,i,s){return pn(s),Xr(i),gp(e,n,a,i,s,"max")},t.className="MaxPooling2D",t}(dI);be.registerClass(pI);var mI=function(r){function t(e){return r.call(this,e)||this}return pe(t,r),t.prototype.poolingFunction=function(e,n,a,i,s){return pn(s),Xr(i),gp(e,n,a,i,s,"avg")},t.className="AveragePooling2D",t}(dI);be.registerClass(mI);var gI=function(r){function t(e){var n=this;if(e.poolSize==null&&(e.poolSize=[2,2,2]),(n=r.call(this,e)||this).poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],e.strides==null)n.strides=n.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==3)throw new ee("If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length "+e.strides.length+".");n.strides=e.strides}else n.strides=[e.strides,e.strides,e.strides];return er(n.poolSize,"poolSize"),er(n.strides,"strides"),n.padding=e.padding==null?"valid":e.padding,n.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,pn(n.dataFormat),Xr(n.padding),n.inputSpec=[new In({ndim:5})],n}return pe(t,r),t.prototype.computeOutputShape=function(e){e=It(e);var n=this.dataFormat==="channelsFirst"?e[2]:e[1],a=this.dataFormat==="channelsFirst"?e[3]:e[2],i=this.dataFormat==="channelsFirst"?e[4]:e[3];return n=si(n,this.poolSize[0],this.padding,this.strides[0]),a=si(a,this.poolSize[1],this.padding,this.strides[1]),i=si(i,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[e[0],e[1],n,a,i]:[e[0],n,a,i,e[4]]},t.prototype.call=function(e,n){var a=this;return ae(function(){return a.invokeCallHook(e,n),a.poolingFunction(Ye(e),a.poolSize,a.strides,a.padding,a.dataFormat)})},t.prototype.getConfig=function(){var e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=r.prototype.getConfig.call(this);return Object.assign(e,n),e},t}(ft),vI=function(r){function t(e){return r.call(this,e)||this}return pe(t,r),t.prototype.poolingFunction=function(e,n,a,i,s){return pn(s),Xr(i),lI(e,n,a,i,s,"max")},t.className="MaxPooling3D",t}(gI);be.registerClass(vI);var yI=function(r){function t(e){return r.call(this,e)||this}return pe(t,r),t.prototype.poolingFunction=function(e,n,a,i,s){return pn(s),Xr(i),lI(e,n,a,i,s,"avg")},t.className="AveragePooling3D",t}(gI);be.registerClass(yI);var bI=function(r){function t(e){var n=r.call(this,e)||this;return n.inputSpec=[new In({ndim:3})],n}return pe(t,r),t.prototype.computeOutputShape=function(e){return[e[0],e[2]]},t.prototype.call=function(e,n){throw new tt},t}(ft),wI=function(r){function t(e){return r.call(this,e||{})||this}return pe(t,r),t.prototype.call=function(e,n){return ae(function(){var a=Ye(e);return an(a,1)})},t.className="GlobalAveragePooling1D",t}(bI);be.registerClass(wI);var xI=function(r){function t(e){return r.call(this,e||{})||this}return pe(t,r),t.prototype.call=function(e,n){return ae(function(){var a=Ye(e);return no(a,1)})},t.className="GlobalMaxPooling1D",t}(bI);be.registerClass(xI);var SI=function(r){function t(e){var n=r.call(this,e)||this;return n.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,pn(n.dataFormat),n.inputSpec=[new In({ndim:4})],n}return pe(t,r),t.prototype.computeOutputShape=function(e){return e=e,this.dataFormat==="channelsLast"?[e[0],e[3]]:[e[0],e[1]]},t.prototype.call=function(e,n){throw new tt},t.prototype.getConfig=function(){var e={dataFormat:this.dataFormat},n=r.prototype.getConfig.call(this);return Object.assign(e,n),e},t}(ft),EI=function(r){function t(){return r!==null&&r.apply(this,arguments)||this}return pe(t,r),t.prototype.call=function(e,n){var a=this;return ae(function(){var i=Ye(e);return a.dataFormat==="channelsLast"?an(i,[1,2]):an(i,[2,3])})},t.className="GlobalAveragePooling2D",t}(SI);be.registerClass(EI);var CI=function(r){function t(){return r!==null&&r.apply(this,arguments)||this}return pe(t,r),t.prototype.call=function(e,n){var a=this;return ae(function(){var i=Ye(e);return a.dataFormat==="channelsLast"?no(i,[1,2]):no(i,[2,3])})},t.className="GlobalMaxPooling2D",t}(SI);function AI(r,t,e,n){if(Array.isArray(r)){if(t!=null||e!=null)throw new ee("When inputs is an array, neither initialState or constants should be provided");n!=null&&(e=r.slice(r.length-n,r.length),r=r.slice(0,r.length-n)),r.length>1&&(t=r.slice(1,r.length)),r=r[0]}function a(i){return i==null||Array.isArray(i)?i:[i]}return{inputs:r,initialState:t=a(t),constants:e=a(e)}}function TI(r,t,e,n,a,i,s,l){return n===void 0&&(n=!1),s===void 0&&(s=!1),l===void 0&&(l=!1),ae(function(){var c=t.shape.length;if(c<3)throw new ee("Input should be at least 3D, but is "+c+"D.");var f=[1,0].concat(sa(2,c));t=Ut(t,f),i!=null,s&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),a!=null&&((a=a.asType("bool").asType("float32")).rank===c-1&&(a=Sr(a,-1)),a=Ut(a,f)),n&&(t=Ia(t,0),a!=null&&(a=Ia(a,0)));var d,p,g=[],v=e,b=t.shape[0],w=ts(t);a!=null&&(p=ts(a));for(var S,x=function(A){var T=w[A],R=ae(function(){return r(T,v)});if(a==null)d=R[0],v=R[1];else{var O=ae(function(){var N=p[A],D=Nr(N).sub(N);return{output:R[0].mul(N).addStrict(v[0].mul(D)),newStates:v.map(function(I,_){return R[1][_].mul(N).addStrict(I.mul(D))})}});d=O.output,v=O.newStates}l&&g.push(d)},C=0;C<b;++C)x(C);return l&&(S=ia(g,1)),[d,S,v]})}be.registerClass(CI);var vs=function(r){function t(e){var n,a=r.call(this,e)||this;if(e.cell==null)throw new ee("cell property is missing for the constructor of RNN.");if((n=Array.isArray(e.cell)?new M0({cells:e.cell}):e.cell).stateSize==null)throw new ee("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");return a.cell=n,a.returnSequences=e.returnSequences!=null&&e.returnSequences,a.returnState=e.returnState!=null&&e.returnState,a.goBackwards=e.goBackwards!=null&&e.goBackwards,a._stateful=e.stateful!=null&&e.stateful,a.unroll=e.unroll!=null&&e.unroll,a.supportsMasking=!0,a.inputSpec=[new In({ndim:3})],a.stateSpec=null,a.states_=null,a.numConstants=null,a.keptStates=[],a}return pe(t,r),t.prototype.getStates=function(){return this.states_==null?sa(0,Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1).map(function(e){return null}):this.states_},t.prototype.setStates=function(e){this.states_=e},t.prototype.computeOutputShape=function(e){Zv(e)&&(e=e[0]),e=e;var n=this.cell.stateSize;Array.isArray(n)||(n=[n]);var a,i=n[0];if(a=this.returnSequences?[e[0],e[1],i]:[e[0],i],this.returnState){for(var s=[],l=0,c=n;l<c.length;l++){var f=c[l];s.push([e[0],f])}return[a].concat(s)}return a},t.prototype.computeMask=function(e,n){var a=this;return ae(function(){Array.isArray(n)&&(n=n[0]);var i=a.returnSequences?n:null;if(a.returnState){var s=a.states.map(function(l){return null});return[i].concat(s)}return i})},Object.defineProperty(t.prototype,"states",{get:function(){if(this.states_==null){for(var e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,n=[],a=0;a<e;++a)n.push(null);return n}return this.states_},set:function(e){this.states_=e},enumerable:!0,configurable:!0}),t.prototype.build=function(e){if(this.numConstants!=null)throw new tt("Constants support is not implemented in RNN yet.");Zv(e)&&(e=e[0]),e=e;var n=this.stateful?e[0]:null,a=e[e.length-1];this.inputSpec[0]=new In({shape:[n,null,a]});var i,s=[e[0]].concat(e.slice(2));if(this.cell.build(s),i=Array.isArray(this.cell.stateSize)?this.cell.stateSize:[this.cell.stateSize],this.stateSpec!=null){if(!Be.arraysEqual(this.stateSpec.map(function(l){return l.shape[l.shape.length-1]}),i))throw new ee("An initialState was passed that is not compatible with cell.stateSize. Received stateSpec="+this.stateSpec+"; However cell.stateSize is "+this.cell.stateSize)}else this.stateSpec=i.map(function(l){return new In({shape:[null,l]})});this.stateful&&this.resetStates()},t.prototype.resetStates=function(e,n){var a=this;n===void 0&&(n=!1),ae(function(){if(!a.stateful)throw new Po("Cannot call resetStates() on an RNN Layer that is not stateful.");var i=a.inputSpec[0].shape[0];if(i==null)throw new ee("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(a.states_==null)Array.isArray(a.cell.stateSize)?a.states_=a.cell.stateSize.map(function(d){return St([i,d])}):a.states_=[St([i,a.cell.stateSize])];else if(e==null)et(a.states_),a.keptStates!=null&&(et(a.keptStates),a.keptStates=[]),Array.isArray(a.cell.stateSize)?a.states_=a.cell.stateSize.map(function(d){return St([i,d])}):a.states_[0]=St([i,a.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==a.states_.length)throw new ee("Layer "+a.name+" expects "+a.states_.length+" state(s), but it received "+e.length+" state value(s). Input received: "+e);n===!0?a.keptStates.push(a.states_.slice()):et(a.states_);for(var s=0;s<a.states_.length;++s){var l=e[s],c=Array.isArray(a.cell.stateSize)?a.cell.stateSize[s]:a.cell.stateSize,f=[i,c];if(!Be.arraysEqual(l.shape,f))throw new ee("State "+s+" is incompatible with layer "+a.name+": expected shape="+f+", received shape="+l.shape);a.states_[s]=l}}a.states_=a.states_.map(function(d){return Na(d.clone())})})},t.prototype.apply=function(e,n){var a=n==null?null:n.initialState,i=n==null?null:n.constants;n==null&&(n={});var s=AI(e,a,i,this.numConstants);e=s.inputs,a=s.initialState,i=s.constants;var l=[],c=[];if(a!=null){n.initialState=a,l=l.concat(a),this.stateSpec=[];for(var f=0,d=a;f<d.length;f++){var p=d[f];this.stateSpec.push(new In({shape:p.shape}))}c=c.concat(this.stateSpec)}if(i!=null&&(n.constants=i,l=l.concat(i),this.numConstants=i.length),l[0]instanceof ra){var g=[e].concat(l),v=this.inputSpec.concat(c),b=this.inputSpec;this.inputSpec=v;var w=r.prototype.apply.call(this,g,n);return this.inputSpec=b,w}return r.prototype.apply.call(this,e,n)},t.prototype.call=function(e,n){var a=this;return ae(function(){var i=n==null?null:n.mask,s=n==null?null:n.training,l=n==null?null:n.initialState;e=Ye(e),l==null&&(l=a.stateful?a.states_:a.getInitialState(e));var c=Array.isArray(a.cell.stateSize)?a.cell.stateSize.length:1;if(l.length!==c)throw new ee("RNN Layer has "+c+" state(s) but was passed "+l.length+" initial state(s).");a.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");var f={training:s},d=TI(function(w,S){var x=a.cell.call([w].concat(S),f);return[x[0],x.slice(1)]},e,l,a.goBackwards,i,null,a.unroll,a.returnSequences),p=d[0],g=d[1],v=d[2];a.stateful&&a.resetStates(v,s);var b=a.returnSequences?g:p;return a.returnState?[b].concat(v):b})},t.prototype.getInitialState=function(e){var n=this;return ae(function(){var a=St(e.shape);return a=Gc(a=hr(a,[1,2])),Array.isArray(n.cell.stateSize)?n.cell.stateSize.map(function(i){return i>1?Kv(a,[1,i]):a}):n.cell.stateSize>1?[Kv(a,[1,n.cell.stateSize])]:[a]})},Object.defineProperty(t.prototype,"trainableWeights",{get:function(){return this.trainable?this.cell.trainableWeights:[]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nonTrainableWeights",{get:function(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights},enumerable:!0,configurable:!0}),t.prototype.setFastWeightInitDuringBuild=function(e){r.prototype.setFastWeightInitDuringBuild.call(this,e),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(e)},t.prototype.getConfig=function(){var e={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(e.numConstants=this.numConstants);var n=this.cell.getConfig();e.cell={className:this.cell.getClassName(),config:n};var a=r.prototype.getConfig.call(this);return Object.assign(e,a),e},t.fromConfig=function(e,n,a){a===void 0&&(a={});var i=aa(n.cell,a);return new e(Object.assign(n,{cell:i}))},t.className="RNN",t}(ft);be.registerClass(vs);var Kc=function(r){function t(){return r!==null&&r.apply(this,arguments)||this}return pe(t,r),t}(ft),D0=function(r){function t(e){var n=r.call(this,e)||this;return n.DEFAULT_ACTIVATION="tanh",n.DEFAULT_KERNEL_INITIALIZER="glorotNormal",n.DEFAULT_RECURRENT_INITIALIZER="orthogonal",n.DEFAULT_BIAS_INITIALIZER="zeros",n.units=e.units,er(n.units,"units"),n.activation=ao(e.activation==null?n.DEFAULT_ACTIVATION:e.activation),n.useBias=e.useBias==null||e.useBias,n.kernelInitializer=zt(e.kernelInitializer||n.DEFAULT_KERNEL_INITIALIZER),n.recurrentInitializer=zt(e.recurrentInitializer||n.DEFAULT_RECURRENT_INITIALIZER),n.biasInitializer=zt(e.biasInitializer||n.DEFAULT_BIAS_INITIALIZER),n.kernelRegularizer=Lt(e.kernelRegularizer),n.recurrentRegularizer=Lt(e.recurrentRegularizer),n.biasRegularizer=Lt(e.biasRegularizer),n.kernelConstraint=hn(e.kernelConstraint),n.recurrentConstraint=hn(e.recurrentConstraint),n.biasConstraint=hn(e.biasConstraint),n.dropout=Tu([1,ro([0,e.dropout==null?0:e.dropout])]),n.recurrentDropout=Tu([1,ro([0,e.recurrentDropout==null?0:e.recurrentDropout])]),n.stateSize=n.units,n.dropoutMask=null,n.recurrentDropoutMask=null,n}return pe(t,r),t.prototype.build=function(e){e=It(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0},t.prototype.call=function(e,n){var a=this;return ae(function(){if((e=e).length!==2)throw new ee("SimpleRNNCell expects 2 input Tensors, got "+e.length+".");var i=e[1];e=e[0];var s,l=n.training!=null&&n.training;0<a.dropout&&a.dropout<1&&a.dropoutMask==null&&(a.dropoutMask=Iu(function(){return Nr(e)},a.dropout,l)),0<a.recurrentDropout&&a.recurrentDropout<1&&a.recurrentDropoutMask==null&&(a.recurrentDropoutMask=Iu(function(){return Nr(i)},a.recurrentDropout,l));var c=a.dropoutMask,f=a.recurrentDropoutMask;s=oi(c!=null?Xe(e,c):e,a.kernel.read()),a.bias!=null&&(s=yi(s,a.bias.read())),f!=null&&(i=Xe(i,f));var d=ot(s,oi(i,a.recurrentKernel.read()));return a.activation!=null&&(d=a.activation.apply(d)),[d,d]})},t.prototype.getConfig=function(){var e={units:this.units,activation:Ir(this.activation),useBias:this.useBias,kernelInitializer:gt(this.kernelInitializer),recurrentInitializer:gt(this.recurrentInitializer),biasInitializer:gt(this.biasInitializer),kernelRegularizer:nt(this.kernelRegularizer),recurrentRegularizer:nt(this.recurrentRegularizer),biasRegularizer:nt(this.biasRegularizer),activityRegularizer:nt(this.activityRegularizer),kernelConstraint:At(this.kernelConstraint),recurrentConstraint:At(this.recurrentConstraint),biasConstraint:At(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout},n=r.prototype.getConfig.call(this);return Object.assign(e,n),e},t.className="SimpleRNNCell",t}(Kc);be.registerClass(D0);var NI=function(r){function t(e){return e.cell=new D0(e),r.call(this,e)||this}return pe(t,r),t.prototype.call=function(e,n){var a=this;return ae(function(){a.cell.dropoutMask!=null&&(et(a.cell.dropoutMask),a.cell.dropoutMask=null),a.cell.recurrentDropoutMask!=null&&(et(a.cell.recurrentDropoutMask),a.cell.recurrentDropoutMask=null);var i=n==null?null:n.mask,s=n==null?null:n.training,l=n==null?null:n.initialState;return r.prototype.call.call(a,e,{mask:i,training:s,initialState:l})})},Object.defineProperty(t.prototype,"units",{get:function(){return this.cell.units},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"activation",{get:function(){return this.cell.activation},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useBias",{get:function(){return this.cell.useBias},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelInitializer",{get:function(){return this.cell.kernelInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentInitializer",{get:function(){return this.cell.recurrentInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasInitializer",{get:function(){return this.cell.biasInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelRegularizer",{get:function(){return this.cell.kernelRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentRegularizer",{get:function(){return this.cell.recurrentRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasRegularizer",{get:function(){return this.cell.biasRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelConstraint",{get:function(){return this.cell.kernelConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentConstraint",{get:function(){return this.cell.recurrentConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasConstraint",{get:function(){return this.cell.biasConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dropout",{get:function(){return this.cell.dropout},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentDropout",{get:function(){return this.cell.recurrentDropout},enumerable:!0,configurable:!0}),t.prototype.getConfig=function(){var e={units:this.units,activation:Ir(this.activation),useBias:this.useBias,kernelInitializer:gt(this.kernelInitializer),recurrentInitializer:gt(this.recurrentInitializer),biasInitializer:gt(this.biasInitializer),kernelRegularizer:nt(this.kernelRegularizer),recurrentRegularizer:nt(this.recurrentRegularizer),biasRegularizer:nt(this.biasRegularizer),activityRegularizer:nt(this.activityRegularizer),kernelConstraint:At(this.kernelConstraint),recurrentConstraint:At(this.recurrentConstraint),biasConstraint:At(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout},n=r.prototype.getConfig.call(this);return delete n.cell,Object.assign(e,n),e},t.fromConfig=function(e,n){return new e(n)},t.className="SimpleRNN",t}(vs);be.registerClass(NI);var O0=function(r){function t(e){var n=r.call(this,e)||this;return n.DEFAULT_ACTIVATION="tanh",n.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",n.DEFAULT_KERNEL_INITIALIZER="glorotNormal",n.DEFAULT_RECURRENT_INITIALIZER="orthogonal",n.DEFAULT_BIAS_INITIALIZER="zeros",n.units=e.units,er(n.units,"units"),n.activation=ao(e.activation===void 0?n.DEFAULT_ACTIVATION:e.activation),n.recurrentActivation=ao(e.recurrentActivation===void 0?n.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),n.useBias=e.useBias==null||e.useBias,n.kernelInitializer=zt(e.kernelInitializer||n.DEFAULT_KERNEL_INITIALIZER),n.recurrentInitializer=zt(e.recurrentInitializer||n.DEFAULT_RECURRENT_INITIALIZER),n.biasInitializer=zt(e.biasInitializer||n.DEFAULT_BIAS_INITIALIZER),n.kernelRegularizer=Lt(e.kernelRegularizer),n.recurrentRegularizer=Lt(e.recurrentRegularizer),n.biasRegularizer=Lt(e.biasRegularizer),n.kernelConstraint=hn(e.kernelConstraint),n.recurrentConstraint=hn(e.recurrentConstraint),n.biasConstraint=hn(e.biasConstraint),n.dropout=Tu([1,ro([0,e.dropout==null?0:e.dropout])]),n.recurrentDropout=Tu([1,ro([0,e.recurrentDropout==null?0:e.recurrentDropout])]),n.implementation=e.implementation,n.stateSize=n.units,n.dropoutMask=null,n.recurrentDropoutMask=null,n}return pe(t,r),t.prototype.build=function(e){var n=(e=It(e))[e.length-1];this.kernel=this.addWeight("kernel",[n,3*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,3*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[3*this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0},t.prototype.call=function(e,n){var a=this;return ae(function(){if((e=e).length!==2)throw new ee("GRUCell expects 2 input Tensors (inputs, h, c), got "+e.length+".");var i=n.training!=null&&n.training,s=e[1];e=e[0],0<a.dropout&&a.dropout<1&&a.dropoutMask==null&&(a.dropoutMask=Iu(function(){return Nr(e)},a.dropout,i,3)),0<a.recurrentDropout&&a.recurrentDropout<1&&a.recurrentDropoutMask==null&&(a.recurrentDropoutMask=Iu(function(){return Nr(s)},a.recurrentDropout,i,3));var l,c,f,d=a.dropoutMask,p=a.recurrentDropoutMask;0<a.dropout&&a.dropout<1&&(e=Xe(e,d[0]));var g=oi(e,a.kernel.read());a.useBias&&(g=yi(g,a.bias.read())),0<a.recurrentDropout&&a.recurrentDropout<1&&(s=Xe(s,p[0]));var v=a.recurrentKernel.read(),b=ii(v,[2*a.units,a.units],v.rank-1),w=b[0],S=b[1],x=oi(s,w),C=ii(g,3,g.rank-1),A=C[0],T=C[1],R=C[2],O=ii(x,2,x.rank-1),N=O[0],D=O[1];l=a.recurrentActivation.apply(ot(A,N)),c=a.recurrentActivation.apply(ot(T,D));var I=oi(Xe(c,s),S);f=a.activation.apply(ot(R,I));var _=ot(Xe(l,s),Xe(ot(1,hs(l)),f));return[_,_]})},t.prototype.getConfig=function(){var e={units:this.units,activation:Ir(this.activation),recurrentActivation:Ir(this.recurrentActivation),useBias:this.useBias,kernelInitializer:gt(this.kernelInitializer),recurrentInitializer:gt(this.recurrentInitializer),biasInitializer:gt(this.biasInitializer),kernelRegularizer:nt(this.kernelRegularizer),recurrentRegularizer:nt(this.recurrentRegularizer),biasRegularizer:nt(this.biasRegularizer),activityRegularizer:nt(this.activityRegularizer),kernelConstraint:At(this.kernelConstraint),recurrentConstraint:At(this.recurrentConstraint),biasConstraint:At(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},n=r.prototype.getConfig.call(this);return Object.assign(e,n),e},t.className="GRUCell",t}(Kc);be.registerClass(O0);var RI=function(r){function t(e){return e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new O0(e),r.call(this,e)||this}return pe(t,r),t.prototype.call=function(e,n){var a=this;return ae(function(){a.cell.dropoutMask!=null&&(et(a.cell.dropoutMask),a.cell.dropoutMask=null),a.cell.recurrentDropoutMask!=null&&(et(a.cell.recurrentDropoutMask),a.cell.recurrentDropoutMask=null);var i=n==null?null:n.mask,s=n==null?null:n.training,l=n==null?null:n.initialState;return r.prototype.call.call(a,e,{mask:i,training:s,initialState:l})})},Object.defineProperty(t.prototype,"units",{get:function(){return this.cell.units},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"activation",{get:function(){return this.cell.activation},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentActivation",{get:function(){return this.cell.recurrentActivation},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useBias",{get:function(){return this.cell.useBias},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelInitializer",{get:function(){return this.cell.kernelInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentInitializer",{get:function(){return this.cell.recurrentInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasInitializer",{get:function(){return this.cell.biasInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelRegularizer",{get:function(){return this.cell.kernelRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentRegularizer",{get:function(){return this.cell.recurrentRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasRegularizer",{get:function(){return this.cell.biasRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelConstraint",{get:function(){return this.cell.kernelConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentConstraint",{get:function(){return this.cell.recurrentConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasConstraint",{get:function(){return this.cell.biasConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dropout",{get:function(){return this.cell.dropout},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentDropout",{get:function(){return this.cell.recurrentDropout},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"implementation",{get:function(){return this.cell.implementation},enumerable:!0,configurable:!0}),t.prototype.getConfig=function(){var e={units:this.units,activation:Ir(this.activation),recurrentActivation:Ir(this.recurrentActivation),useBias:this.useBias,kernelInitializer:gt(this.kernelInitializer),recurrentInitializer:gt(this.recurrentInitializer),biasInitializer:gt(this.biasInitializer),kernelRegularizer:nt(this.kernelRegularizer),recurrentRegularizer:nt(this.recurrentRegularizer),biasRegularizer:nt(this.biasRegularizer),activityRegularizer:nt(this.activityRegularizer),kernelConstraint:At(this.kernelConstraint),recurrentConstraint:At(this.recurrentConstraint),biasConstraint:At(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},n=r.prototype.getConfig.call(this);return delete n.cell,Object.assign(e,n),e},t.fromConfig=function(e,n){return n.implmentation===0&&(n.implementation=1),new e(n)},t.className="GRU",t}(vs);be.registerClass(RI);var _0=function(r){function t(e){var n=r.call(this,e)||this;return n.DEFAULT_ACTIVATION="tanh",n.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",n.DEFAULT_KERNEL_INITIALIZER="glorotNormal",n.DEFAULT_RECURRENT_INITIALIZER="orthogonal",n.DEFAULT_BIAS_INITIALIZER="zeros",n.units=e.units,er(n.units,"units"),n.activation=ao(e.activation===void 0?n.DEFAULT_ACTIVATION:e.activation),n.recurrentActivation=ao(e.recurrentActivation===void 0?n.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),n.useBias=e.useBias==null||e.useBias,n.kernelInitializer=zt(e.kernelInitializer||n.DEFAULT_KERNEL_INITIALIZER),n.recurrentInitializer=zt(e.recurrentInitializer||n.DEFAULT_RECURRENT_INITIALIZER),n.biasInitializer=zt(e.biasInitializer||n.DEFAULT_BIAS_INITIALIZER),n.unitForgetBias=e.unitForgetBias,n.kernelRegularizer=Lt(e.kernelRegularizer),n.recurrentRegularizer=Lt(e.recurrentRegularizer),n.biasRegularizer=Lt(e.biasRegularizer),n.kernelConstraint=hn(e.kernelConstraint),n.recurrentConstraint=hn(e.recurrentConstraint),n.biasConstraint=hn(e.biasConstraint),n.dropout=Tu([1,ro([0,e.dropout==null?0:e.dropout])]),n.recurrentDropout=Tu([1,ro([0,e.recurrentDropout==null?0:e.recurrentDropout])]),n.implementation=e.implementation,n.stateSize=[n.units,n.units],n.dropoutMask=null,n.recurrentDropoutMask=null,n}return pe(t,r),t.prototype.build=function(e){var n,a,i=(e=It(e))[e.length-1];if(this.kernel=this.addWeight("kernel",[i,4*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,4*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){if(this.unitForgetBias){var s=this.biasInitializer,l=this.units;a=new((n=function(c){function f(){return c!==null&&c.apply(this,arguments)||this}return pe(f,c),f.prototype.apply=function(d,p){var g=s.apply([l]),v=new p0().apply([l]),b=s.apply([2*l]);return LS(LS(g,v),b)},f}(da)).className="CustomInit",n)}else a=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.units],null,a,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0},t.prototype.call=function(e,n){var a=this;return ae(function(){var i=n.training!=null&&n.training;if((e=e).length!==3)throw new ee("LSTMCell expects 3 input Tensors (inputs, h, c), got "+e.length+".");var s=e[1],l=e[2];e=e[0],0<a.dropout&&a.dropout<1&&a.dropoutMask==null&&(a.dropoutMask=Iu(function(){return Nr(e)},a.dropout,i,4)),0<a.recurrentDropout&&a.recurrentDropout<1&&a.recurrentDropoutMask==null&&(a.recurrentDropoutMask=Iu(function(){return Nr(s)},a.recurrentDropout,i,4));var c,f,d,p,g=a.dropoutMask,v=a.recurrentDropoutMask;0<a.dropout&&a.dropout<1&&(e=Xe(e,g[0]));var b=oi(e,a.kernel.read());0<a.recurrentDropout&&a.recurrentDropout<1&&(s=Xe(s,v[0])),b=ot(b,oi(s,a.recurrentKernel.read())),a.useBias&&(b=yi(b,a.bias.read()));var w=ii(b,4,b.rank-1),S=w[0],x=w[1],C=w[2],A=w[3];c=a.recurrentActivation.apply(S),f=a.recurrentActivation.apply(x),d=ot(Xe(f,l),Xe(c,a.activation.apply(C))),p=a.recurrentActivation.apply(A);var T=Xe(p,a.activation.apply(d));return[T,T,d]})},t.prototype.getConfig=function(){var e={units:this.units,activation:Ir(this.activation),recurrentActivation:Ir(this.recurrentActivation),useBias:this.useBias,kernelInitializer:gt(this.kernelInitializer),recurrentInitializer:gt(this.recurrentInitializer),biasInitializer:gt(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:nt(this.kernelRegularizer),recurrentRegularizer:nt(this.recurrentRegularizer),biasRegularizer:nt(this.biasRegularizer),activityRegularizer:nt(this.activityRegularizer),kernelConstraint:At(this.kernelConstraint),recurrentConstraint:At(this.recurrentConstraint),biasConstraint:At(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},n=r.prototype.getConfig.call(this);return Object.assign(e,n),e},t.className="LSTMCell",t}(Kc);be.registerClass(_0);var II=function(r){function t(e){return e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new _0(e),r.call(this,e)||this}return pe(t,r),t.prototype.call=function(e,n){var a=this;return ae(function(){a.cell.dropoutMask!=null&&(et(a.cell.dropoutMask),a.cell.dropoutMask=null),a.cell.recurrentDropoutMask!=null&&(et(a.cell.recurrentDropoutMask),a.cell.recurrentDropoutMask=null);var i=n==null?null:n.mask,s=n==null?null:n.training,l=n==null?null:n.initialState;return r.prototype.call.call(a,e,{mask:i,training:s,initialState:l})})},Object.defineProperty(t.prototype,"units",{get:function(){return this.cell.units},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"activation",{get:function(){return this.cell.activation},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentActivation",{get:function(){return this.cell.recurrentActivation},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useBias",{get:function(){return this.cell.useBias},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelInitializer",{get:function(){return this.cell.kernelInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentInitializer",{get:function(){return this.cell.recurrentInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasInitializer",{get:function(){return this.cell.biasInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"unitForgetBias",{get:function(){return this.cell.unitForgetBias},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelRegularizer",{get:function(){return this.cell.kernelRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentRegularizer",{get:function(){return this.cell.recurrentRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasRegularizer",{get:function(){return this.cell.biasRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelConstraint",{get:function(){return this.cell.kernelConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentConstraint",{get:function(){return this.cell.recurrentConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasConstraint",{get:function(){return this.cell.biasConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dropout",{get:function(){return this.cell.dropout},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentDropout",{get:function(){return this.cell.recurrentDropout},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"implementation",{get:function(){return this.cell.implementation},enumerable:!0,configurable:!0}),t.prototype.getConfig=function(){var e={units:this.units,activation:Ir(this.activation),recurrentActivation:Ir(this.recurrentActivation),useBias:this.useBias,kernelInitializer:gt(this.kernelInitializer),recurrentInitializer:gt(this.recurrentInitializer),biasInitializer:gt(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:nt(this.kernelRegularizer),recurrentRegularizer:nt(this.recurrentRegularizer),biasRegularizer:nt(this.biasRegularizer),activityRegularizer:nt(this.activityRegularizer),kernelConstraint:At(this.kernelConstraint),recurrentConstraint:At(this.recurrentConstraint),biasConstraint:At(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},n=r.prototype.getConfig.call(this);return delete n.cell,Object.assign(e,n),e},t.fromConfig=function(e,n){return n.implmentation===0&&(n.implementation=1),new e(n)},t.className="LSTM",t}(vs);be.registerClass(II);var M0=function(r){function t(e){var n=r.call(this,e)||this;return n.cells=e.cells,n}return pe(t,r),Object.defineProperty(t.prototype,"stateSize",{get:function(){for(var e=[],n=0,a=this.cells.slice().reverse();n<a.length;n++){var i=a[n];Array.isArray(i.stateSize)?e.push.apply(e,i.stateSize):e.push(i.stateSize)}return e},enumerable:!0,configurable:!0}),t.prototype.call=function(e,n){var a=this;return ae(function(){for(var i=(e=e).slice(1),s=[],l=0,c=a.cells.slice().reverse();l<c.length;l++){var f=c[l];Array.isArray(f.stateSize)?s.push(i.splice(0,f.stateSize.length)):s.push(i.splice(0,1))}s.reverse();for(var d,p=[],g=0;g<a.cells.length;++g)f=a.cells[g],i=s[g],d=g===0?[e[0]].concat(i):[d[0]].concat(i),d=f.call(d,n),p.push(d.slice(1));i=[];for(var v=0,b=p.slice().reverse();v<b.length;v++){var w=b[v];i.push.apply(i,w)}return[d[0]].concat(i)})},t.prototype.build=function(e){var n;Zv(e)&&(e=e[0]),e=e,this.cells.forEach(function(a,i){Ko("RNNCell_"+i,function(){a.build(e),n=Array.isArray(a.stateSize)?a.stateSize[0]:a.stateSize,e=[e[0],n]})}),this.built=!0},t.prototype.getConfig=function(){for(var e=[],n=0,a=this.cells;n<a.length;n++){var i=a[n];e.push({className:i.getClassName(),config:i.getConfig()})}var s={cells:e},l=r.prototype.getConfig.call(this);return Object.assign(s,l),s},t.fromConfig=function(e,n,a){a===void 0&&(a={});for(var i=[],s=0,l=n.cells;s<l.length;s++){var c=l[s];i.push(aa(c,a))}return new e({cells:i})},Object.defineProperty(t.prototype,"trainableWeights",{get:function(){if(!this.trainable)return[];for(var e=[],n=0,a=this.cells;n<a.length;n++){var i=a[n];e.push.apply(e,i.trainableWeights)}return e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nonTrainableWeights",{get:function(){for(var e=[],n=0,a=this.cells;n<a.length;n++){var i=a[n];e.push.apply(e,i.nonTrainableWeights)}if(!this.trainable){for(var s=[],l=0,c=this.cells;l<c.length;l++)i=c[l],s.push.apply(s,i.trainableWeights);return s.concat(e)}return e},enumerable:!0,configurable:!0}),t.prototype.getWeights=function(){for(var e=[],n=0,a=this.cells;n<a.length;n++){var i=a[n];e.push.apply(e,i.weights)}return Qv(e)},t.prototype.setWeights=function(e){for(var n=[],a=0,i=this.cells;a<i.length;a++)for(var s=i[a],l=s.weights.length,c=e.splice(l),f=0;f<s.weights.length;++f)n.push([s.weights[f],c[f]]);x0(n)},t.className="StackedRNNCells",t}(Kc);function Iu(r,t,e,n){function a(){return $N(r(),t)}if(e===void 0&&(e=null),n===void 0&&(n=1),n>1){for(var i=[],s=0;s<n;s++)i.push(Nu(a,r,e));return i.map(function(l){return Na(l.clone())})}return Na(Nu(a,r,e).clone())}be.registerClass(M0);var kI=function(r){function t(e){var n=r.call(this,e)||this;return n.layer=e.layer,n}return pe(t,r),t.prototype.build=function(e){this.built=!0},Object.defineProperty(t.prototype,"trainable",{get:function(){return this.layer!=null&&this.layer.trainable},set:function(e){this.layer!=null&&(this.layer.trainable=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"trainableWeights",{get:function(){return this.layer.trainableWeights},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nonTrainableWeights",{get:function(){return this.layer.nonTrainableWeights},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"updates",{get:function(){return this.layer._updates},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"losses",{get:function(){return this.layer.losses},enumerable:!0,configurable:!0}),t.prototype.getWeights=function(){return this.layer.getWeights()},t.prototype.setWeights=function(e){this.layer.setWeights(e)},t.prototype.getConfig=function(){var e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},n=r.prototype.getConfig.call(this);return Object.assign(e,n),e},t.prototype.setFastWeightInitDuringBuild=function(e){r.prototype.setFastWeightInitDuringBuild.call(this,e),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(e)},t.fromConfig=function(e,n,a){a===void 0&&(a={});var i=aa(n.layer,a);delete n.layer;var s={layer:i};return Object.assign(s,n),new e(s)},t}(ft),DI=function(r){function t(e){var n=r.call(this,e)||this;return n.supportsMasking=!0,n}return pe(t,r),t.prototype.build=function(e){if((e=It(e)).length<3)throw new ee("TimeDistributed layer expects an input shape >= 3D, but received input shape "+JSON.stringify(e));this.inputSpec=[{shape:e}];var n=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(n),this.layer.built=!0),r.prototype.build.call(this,e)},t.prototype.computeOutputShape=function(e){var n=[(e=It(e))[0]].concat(e.slice(2)),a=this.layer.computeOutputShape(n),i=e[1];return[a[0],i].concat(a.slice(1))},t.prototype.call=function(e,n){var a=this;return ae(function(){return TI(function(i,s){return[Ye(a.layer.call(i,n)),[]]},e=Ye(e),[],!1,null,null,!1,!0)[1]})},t.className="TimeDistributed",t}(kI);function YU(r){ju(HF,"BidirectionalMergeMode",r)}be.registerClass(DI);var ZU="concat",OI=function(r){function t(e){var n=r.call(this,e)||this,a=e.layer.getConfig(),i={};i.className=e.layer.getClassName(),i.config=a,n.forwardLayer=aa(i),a.goBackwards=a.goBackwards!==!0;var s={};if(s.className=e.layer.getClassName(),s.config=a,n.backwardLayer=aa(s),n.forwardLayer.name="forward_"+n.forwardLayer.name,n.backwardLayer.name="backward_"+n.backwardLayer.name,n.mergeMode=e.mergeMode===void 0?ZU:e.mergeMode,YU(n.mergeMode),e.weights)throw new tt("weights support is not implemented for Bidirectional layer yet.");return n._stateful=e.layer.stateful,n.returnSequences=e.layer.returnSequences,n.returnState=e.layer.returnState,n.supportsMasking=!0,n._trainable=!0,n.inputSpec=e.layer.inputSpec,n.numConstants=null,n}return pe(t,r),Object.defineProperty(t.prototype,"trainable",{get:function(){return this._trainable},set:function(e){this._trainable=e,this.forwardLayer!=null&&(this.forwardLayer.trainable=e),this.backwardLayer!=null&&(this.backwardLayer.trainable=e)},enumerable:!0,configurable:!0}),t.prototype.getWeights=function(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())},t.prototype.setWeights=function(e){var n=e.length,a=Math.floor(n/2);this.forwardLayer.setWeights(e.slice(0,a)),this.backwardLayer.setWeights(e.slice(a))},t.prototype.computeOutputShape=function(e){var n,a,i,s=this.forwardLayer.computeOutputShape(e);return Array.isArray(s)&&Array.isArray(s[0])||(s=[s]),s=s,this.returnState&&(i=s.slice(1)),n=s[0],n=n,this.mergeMode==="concat"?(n[n.length-1]*=2,a=[n]):a=this.mergeMode==null?[n,n.slice()]:[n],this.returnState?this.mergeMode==null?a.concat(i).concat(i.slice()):[n].concat(i).concat(i.slice()):Yn(a)},t.prototype.apply=function(e,n){var a=n==null?null:n.initialState,i=n==null?null:n.constants;n==null&&(n={});var s=AI(e,a,i,this.numConstants);if(e=s.inputs,a=s.initialState,i=s.constants,Array.isArray(e)&&(a=e.slice(1),e=e[0]),(a==null||a.length===0)&&i==null)return r.prototype.apply.call(this,e,n);var l=[],c=[];if(a!=null){var f=a.length;if(f%2>0)throw new ee("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");n.initialState=a,l.push.apply(l,a);var d=a.map(function(C){return new In({shape:C.shape})});this.forwardLayer.stateSpec=d.slice(0,f/2),this.backwardLayer.stateSpec=d.slice(f/2),c.push.apply(c,d)}if(i!=null)throw new tt("Support for constants in Bidirectional layers is not implemented yet.");for(var p=l[0]instanceof ra,g=0,v=l;g<v.length;g++)if(v[g]instanceof ra!==p)throw new ee("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(p){var b=[e].concat(l),w=this.inputSpec.concat(c),S=this.inputSpec;this.inputSpec=w;var x=r.prototype.apply.call(this,b,n);return this.inputSpec=S,x}return r.prototype.apply.call(this,e,n)},t.prototype.call=function(e,n){var a=this;return ae(function(){if(n.mask!=null)throw new tt("The support for masking is not implemented for Bidirectional layers yet.");var i,s,l,c,f=n.initialState;if(f==null)i=a.forwardLayer.call(e,n),s=a.backwardLayer.call(e,n);else{var d=f.slice(0,f.length/2),p=f.slice(f.length/2);i=a.forwardLayer.call(e,Object.assign(n,{initialState:d})),s=a.backwardLayer.call(e,Object.assign(n,{initialState:p}))}return a.returnState&&(Array.isArray(i)&&(l=i.slice(1).concat(s.slice(1))),i=i[0],s=s[0]),a.returnSequences&&(s=Ia(s,1)),a.mergeMode==="concat"?c=GN([i,s]):a.mergeMode==="sum"?c=ot(i,s):a.mergeMode==="ave"?c=Xe(.5,ot(i,s)):a.mergeMode==="mul"?c=Xe(i,s):a.mergeMode==null&&(c=[i,s]),a.returnState?a.mergeMode==null?c.concat(l):[c].concat(l):c})},t.prototype.resetStates=function(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()},t.prototype.build=function(e){var n=this;Ko(this.forwardLayer.name,function(){n.forwardLayer.build(e)}),Ko(this.backwardLayer.name,function(){n.backwardLayer.build(e)}),this.built=!0},Object.defineProperty(t.prototype,"trainableWeights",{get:function(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nonTrainableWeights",{get:function(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)},enumerable:!0,configurable:!0}),t.prototype.setFastWeightInitDuringBuild=function(e){r.prototype.setFastWeightInitDuringBuild.call(this,e),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(e),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(e)},t.prototype.getConfig=function(){var e={mergeMode:this.mergeMode},n=r.prototype.getConfig.call(this);return Object.assign(e,n),e},t.fromConfig=function(e,n){var a=aa(n.layer);if(delete n.layer,n.numConstants!=null)throw new tt("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");var i=n;return i.layer=a,new e(i)},t.className="Bidirectional",t}(kI);function QU(r){return new $c(r)}function JU(r){return new IR(r)}function eP(r){return new TR(r)}function tP(r){return new NR(r)}function nP(r){return new RR(r)}function rP(r){return new DR(r)}function aP(r){return new kR(r)}function iP(r){return new FR(r)}function oP(r){return new k0(r)}function sP(r){return new zR(r)}function uP(r){return new MR(r)}function lP(r){return new LR(r)}function cP(r){return new BR(r)}function fP(r){return new UR(r)}function hP(r){return new PR(r)}function dP(r){return new HR(r)}function pP(r){return new jR(r)}function mP(r){return new VR(r)}function gP(r){return new WR(r)}function vP(r){return new qR(r)}function yP(r){return new GR(r)}function bP(r){return new XR(r)}function wP(r){return new KR(r)}function xP(r){return new YR(r)}function SP(r){return new QR(r)}function EP(r){return new tI(r)}function CP(r){return new JR(r)}function AP(r){return new eI(r)}function TP(r){return new ZR(r)}function NP(r){return new nI(r)}function RP(r){return new oI(r)}function IP(r){return new sI(r)}function kP(r){return new uI(r)}function z0(r){return new hI(r)}function DP(r){return z0(r)}function OP(r){return z0(r)}function L0(r){return new mI(r)}function _P(r){return L0(r)}function MP(r){return L0(r)}function F0(r){return new yI(r)}function zP(r){return F0(r)}function LP(r){return F0(r)}function FP(r){return new wI(r)}function BP(r){return new EI(r)}function _I(r){return new xI(r)}function MI(r){return new CI(r)}function zI(r){return new fI(r)}function LI(r){return new pI(r)}function UP(r){return new vI(r)}function PP(r){return new RI(r)}function VP(r){return new O0(r)}function jP(r){return new II(r)}function WP(r){return new _0(r)}function HP(r){return new NI(r)}function qP(r){return new D0(r)}function GP(r){return new vs(r)}function XP(r){return new M0(r)}function $P(r){return new OI(r)}function KP(r){return new DI(r)}be.registerClass(OI);var YP=_I,ZP=MI,QP=zI,JP=LI;function eV(r){return new rI(r)}function tV(r){return new aI(r)}function nV(r){return new iI(r)}function rV(r){return new $R(r)}var aV=Object.freeze({inputLayer:QU,elu:JU,reLU:eP,leakyReLU:tP,prelu:nP,softmax:rP,thresholdedReLU:aP,conv1d:iP,conv2d:oP,conv2dTranspose:sP,conv3d:uP,separableConv2d:lP,cropping2D:cP,upSampling2d:fP,depthwiseConv2d:hP,activation:dP,dense:pP,dropout:mP,flatten:gP,repeatVector:vP,reshape:yP,permute:bP,embedding:wP,add:xP,average:SP,concatenate:EP,maximum:CP,minimum:AP,multiply:TP,dot:NP,batchNormalization:RP,layerNormalization:IP,zeroPadding2d:kP,averagePooling1d:z0,avgPool1d:DP,avgPooling1d:OP,averagePooling2d:L0,avgPool2d:_P,avgPooling2d:MP,averagePooling3d:F0,avgPool3d:zP,avgPooling3d:LP,globalAveragePooling1d:FP,globalAveragePooling2d:BP,globalMaxPooling1d:_I,globalMaxPooling2d:MI,maxPooling1d:zI,maxPooling2d:LI,maxPooling3d:UP,gru:PP,gruCell:VP,lstm:jP,lstmCell:WP,simpleRNN:HP,simpleRNNCell:qP,rnn:GP,stackedRNNCells:XP,bidirectional:$P,timeDistributed:KP,globalMaxPool1d:YP,globalMaxPool2d:ZP,maxPool1d:QP,maxPool2d:JP,Layer:ft,RNN:vs,RNNCell:Kc,input:ER,gaussianNoise:eV,gaussianDropout:tV,alphaDropout:nV,masking:rV});function iV(r,t){return E0(r,t)}function oV(r,t){return mR(r,t)}function sV(r,t){return gR(r,t)}function uV(r,t){return C0(r,t)}function lV(r,t){return A0(r,t)}function cV(r,t){return pR(r,t)}function fV(r,t){return UB(r,t)}function hV(r,t){return S0(r,t)}function dV(r,t){return fp(r,t)}function pV(r,t){return Wu(r,t)}function mV(r,t){return Wu(r,t)}function gV(r,t){return Wu(r,t)}function vV(r,t){return ms(r,t)}function yV(r,t){return ms(r,t)}function bV(r,t){return ms(r,t)}var wV=Object.freeze({binaryAccuracy:iV,binaryCrossentropy:oV,sparseCategoricalAccuracy:sV,categoricalAccuracy:uV,categoricalCrossentropy:lV,precision:cV,recall:fV,cosineProximity:hV,meanAbsoluteError:dV,meanAbsolutePercentageError:pV,MAPE:mV,mape:gV,meanSquaredError:vV,MSE:yV,mse:bV}),xV=Object.freeze({modelFromJSON:wU});function SV(r){return new pp(r)}function EV(r){return UU(r)}function CV(r){return PU(r)}var AV=Object.freeze({l1l2:SV,l1:EV,l2:CV}),FI=function(r){function t(){var e=r!==null&&r.apply(this,arguments)||this;return e.model=null,e}return pe(t,r),t.prototype.setModel=function(e){if(!(e instanceof Zo))throw new Error("model must be a LayersModel, not some other Container");this.model=e},t}(Ru);function Ah(r,t){return r<t}function JS(r,t){return r>t}var BI=function(r){function t(e){var n=r.call(this)||this;if(e==null&&(e={}),e.restoreBestWeights)throw new tt("restoreBestWeights = True is not implemented in EarlyStopping yet.");return n.monitor=e.monitor||"val_loss",n.minDelta=Math.abs(e.minDelta||0),n.patience=e.patience||0,n.verbose=e.verbose||0,n.mode=e.mode||"auto",n.baseline=e.baseline,["auto","min","max"].indexOf(n.mode)===-1&&(console.warn("EarlyStopping mode '"+n.mode+"' is invalid. Falling back to mode 'auto'."),n.mode="auto"),n.mode==="min"?n.monitorFunc=Ah:n.mode==="max"||n.monitor.indexOf("acc")!==-1?n.monitorFunc=JS:n.monitorFunc=Ah,n.monitorFunc===Ah&&(n.minDelta*=-1),n}return pe(t,r),t.prototype.onTrainBegin=function(e){return He(this,void 0,void 0,function(){return Ve(this,function(n){return this.wait=0,this.stoppedEpoch=0,this.baseline!=null?this.best=this.baseline:this.best=this.monitorFunc===Ah?1/0:-1/0,[2]})})},t.prototype.onEpochEnd=function(e,n){return He(this,void 0,void 0,function(){var a;return Ve(this,function(i){switch(i.label){case 0:return[4,Wi(n)];case 1:return i.sent(),(a=this.getMonitorValue(n))==null?[2]:(this.monitorFunc(a-this.minDelta,this.best)?(this.best=a,this.wait=0):(this.wait++,this.wait>=this.patience&&(this.stoppedEpoch=e,this.model.stopTraining=!0)),[2])}})})},t.prototype.onTrainEnd=function(e){return He(this,void 0,void 0,function(){return Ve(this,function(n){return this.stoppedEpoch>0&&this.verbose&&console.log("Epoch "+this.stoppedEpoch+": early stopping."),[2]})})},t.prototype.getMonitorValue=function(e){e==null&&(e={});var n=e[this.monitor];return n==null&&console.warn("Metric for EarlyStopping "+this.monitor+" is not available. Available metrics are: "+Object.keys(e)),n},t}(FI);function TV(r){return new BI(r)}var NV={earlyStopping:TV};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var ei,eE,ay=function(){return(ay=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++)for(var a in t=arguments[e])Object.prototype.hasOwnProperty.call(t,a)&&(r[a]=t[a]);return r}).apply(this,arguments)};function as(r,t,e,n){return new(e||(e=Promise))(function(a,i){function s(f){try{c(n.next(f))}catch(d){i(d)}}function l(f){try{c(n.throw(f))}catch(d){i(d)}}function c(f){f.done?a(f.value):new e(function(d){d(f.value)}).then(s,l)}c((n=n.apply(r,[])).next())})}function is(r,t){var e,n,a,i,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function l(c){return function(f){return function(d){if(e)throw new TypeError("Generator is already executing.");for(;s;)try{if(e=1,n&&(a=2&d[0]?n.return:d[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,d[1])).done)return a;switch(n=0,a&&(d=[2&d[0],a.value]),d[0]){case 0:case 1:a=d;break;case 4:return s.label++,{value:d[1],done:!1};case 5:s.label++,n=d[1],d=[0];continue;case 7:d=s.ops.pop(),s.trys.pop();continue;default:if(!(a=(a=s.trys).length>0&&a[a.length-1])&&(d[0]===6||d[0]===2)){s=0;continue}if(d[0]===3&&(!a||d[1]>a[0]&&d[1]<a[3])){s.label=d[1];break}if(d[0]===6&&s.label<a[1]){s.label=a[1],a=d;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(d);break}a[2]&&s.ops.pop(),s.trys.pop();continue}d=t.call(r,s)}catch(p){d=[6,p],n=0}finally{e=a=0}if(5&d[0])throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}([c,f])}}}(function(r){r[r.DT_INVALID=0]="DT_INVALID",r[r.DT_FLOAT=1]="DT_FLOAT",r[r.DT_DOUBLE=2]="DT_DOUBLE",r[r.DT_INT32=3]="DT_INT32",r[r.DT_UINT8=4]="DT_UINT8",r[r.DT_INT16=5]="DT_INT16",r[r.DT_INT8=6]="DT_INT8",r[r.DT_STRING=7]="DT_STRING",r[r.DT_COMPLEX64=8]="DT_COMPLEX64",r[r.DT_INT64=9]="DT_INT64",r[r.DT_BOOL=10]="DT_BOOL",r[r.DT_QINT8=11]="DT_QINT8",r[r.DT_QUINT8=12]="DT_QUINT8",r[r.DT_QINT32=13]="DT_QINT32",r[r.DT_BFLOAT16=14]="DT_BFLOAT16",r[r.DT_FLOAT_REF=101]="DT_FLOAT_REF",r[r.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",r[r.DT_INT32_REF=103]="DT_INT32_REF",r[r.DT_UINT8_REF=104]="DT_UINT8_REF",r[r.DT_INT16_REF=105]="DT_INT16_REF",r[r.DT_INT8_REF=106]="DT_INT8_REF",r[r.DT_STRING_REF=107]="DT_STRING_REF",r[r.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",r[r.DT_INT64_REF=109]="DT_INT64_REF",r[r.DT_BOOL_REF=110]="DT_BOOL_REF",r[r.DT_QINT8_REF=111]="DT_QINT8_REF",r[r.DT_QUINT8_REF=112]="DT_QUINT8_REF",r[r.DT_QINT32_REF=113]="DT_QINT32_REF",r[r.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF"})(ei||(ei={})),function(r){(function(t){t[t.LEGACY=0]="LEGACY",t[t.V1=1]="V1",t[t.V2=2]="V2"})(r.CheckpointFormatVersion||(r.CheckpointFormatVersion={}))}(eE||(eE={}));var B0={};function RV(r,t){var e={tfOpName:r,category:"custom",inputs:[],attrs:[],customExecutor:t};B0[r]=e}function UI(r){return B0[r]}function IV(r){delete B0[r]}function M(r,t,e,n){var a=t.inputParams[r];if(a&&a.inputIndexStart!==void 0){var i=a.inputIndexStart,s=a.inputIndexEnd===0?void 0:a.inputIndexEnd===void 0?i+1:a.inputIndexEnd;if(a.type==="tensor")return Zn(t.inputNames[a.inputIndexStart],e,n);if(a.type==="tensors")return t.inputNames.slice(i,s).map(function(f){return Zn(f,e,n)});var l=Array.prototype.slice.call(Zn(t.inputNames.slice(i)[0],e,n).dataSync());return a.type==="number"?l[0]:l}var c=t.attrParams[r];return c&&c.value}function Zn(r,t,e){var n=oc(r),a=n[0],i=n[1],s=e.currentContextIds.find(function(l){return!!t[pd(a,l)]});return s!==void 0?t[pd(a,s)][i]:void 0}function kV(r,t,e){return t[pd(r,e.currentContextId)]}function Ph(r,t){var e=oc(r),n=e[0],a=e[1];return[pd(n,t&&t.currentContextId),a]}function pd(r,t){return t?r+"-"+t:r}function oc(r){var t=r.lastIndexOf(":");return t===-1?[r,0]:[r.substring(0,t),Number(r.substring(t+1))]}function pv(r,t){for(var e=[],n=0;n<r.length;n+=t)e.push(r.slice(n,n+t));return e}var DV=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],OV=Object.freeze({json:DV}),_V=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"clip_value_min",name:"clipValueMin",type:"number"},{tfName:"clip_value_max",name:"clipValueMax",type:"number"}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"clipValueMin",name:"clipValueMin",type:"number",defaultValue:0},{tfName:"clipValueMax",name:"clipValueMax",type:"number",defaultValue:6}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Prod",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axes",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],MV=Object.freeze({json:_V}),zV=[{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"}]}],LV=Object.freeze({json:zV}),FV=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]}],BV=Object.freeze({json:FV}),UV=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],PV=Object.freeze({json:UV}),VV=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],jV=Object.freeze({json:VV}),WV=[{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]}],HV=Object.freeze({json:WV}),qV=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],GV=Object.freeze({json:qV}),XV=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]}],$V=Object.freeze({json:XV}),KV=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],YV=Object.freeze({json:KV}),ZV=[{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],QV=Object.freeze({json:ZV}),JV=[{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"SparseToDense",category:"normalization",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!0,notSupported:!0}]}],ej=Object.freeze({json:JV}),tj=[{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]}],nj=Object.freeze({json:tj}),rj=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool",notSupported:!0}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]}],aj=Object.freeze({json:rj}),ij=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],oj=Object.freeze({json:ij}),sj=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]}],uj=Object.freeze({json:sj}),lj=function(){function r(){var t=[OV,MV,LV,BV,PV,jV,HV,YV,$V,GV,QV,ej,nj,aj,oj,uj],e=[].concat.apply([],t.map(function(n){return n.json}));this.opMappers=e.reduce(function(n,a){return n[a.tfOpName]=a,n},{})}return Object.defineProperty(r,"Instance",{get:function(){return this._instance||(this._instance=new this)},enumerable:!0,configurable:!0}),r.prototype.transformGraph=function(t){var e=this,n=[],a=[],i=t.node.reduce(function(f,d){return f[d.name]=e.mapNode(d),d.op==="Placeholder"&&n.push(f[d.name]),d.op==="Const"&&a.push(f[d.name]),f},{}),s=[],l=[],c=Object.keys(i);return c.forEach(function(f){var d=i[f];d.inputNames.forEach(function(p){var g=Ph(p)[0];d.inputs.push(i[g]),i[g].children.push(d)}),d.inputs.length===0&&s.push(d)}),c.forEach(function(f){var d=i[f];d.children.length===0&&l.push(d)}),{nodes:i,inputs:s,outputs:l,weights:a,placeholders:n}},r.prototype.mapNode=function(t){var e=UI(t.op)||this.opMappers[t.op]||{};t.attr==null&&(t.attr={});var n={name:t.name,op:t.op,category:e.category,inputNames:(t.input||[]).map(function(a){return a.startsWith("^")?a.substr(1):a}),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:t.attr};return e.inputs!=null&&(n.inputParams=e.inputs.reduce(function(a,i){return a[i.name]={type:i.type,inputIndexStart:i.start,inputIndexEnd:i.end},a},{})),e.attrs!=null&&(n.attrParams=e.attrs.reduce(function(a,i){var s=i.type,l=void 0;switch(i.type){case"string":(l=iy(t.attr,i.tfName,i.defaultValue))===void 0&&i.tfDeprecatedName&&(l=iy(t.attr,i.tfDeprecatedName,i.defaultValue));break;case"string[]":(l=hy(t.attr,i.tfName,i.defaultValue))===void 0&&i.tfDeprecatedName&&(l=hy(t.attr,i.tfDeprecatedName,i.defaultValue));break;case"number":(l=sy(t.attr,i.tfName,i.defaultValue||0))===void 0&&i.tfDeprecatedName&&(l=sy(t.attr,i.tfDeprecatedName,i.defaultValue));break;case"number[]":(l=fy(t.attr,i.tfName,i.defaultValue))===void 0&&i.tfDeprecatedName&&(l=fy(t.attr,i.tfDeprecatedName,i.defaultValue));break;case"bool":(l=oy(t.attr,i.tfName,i.defaultValue))===void 0&&i.tfDeprecatedName&&(l=oy(t.attr,i.tfDeprecatedName,i.defaultValue));break;case"bool[]":(l=py(t.attr,i.tfName,i.defaultValue))===void 0&&i.tfDeprecatedName&&(l=py(t.attr,i.tfDeprecatedName,i.defaultValue));break;case"shape":(l=cy(t.attr,i.tfName,i.defaultValue))===void 0&&i.tfDeprecatedName&&(l=cy(t.attr,i.tfDeprecatedName,i.defaultValue));break;case"shape[]":(l=dy(t.attr,i.tfName,i.defaultValue))===void 0&&i.tfDeprecatedName&&(l=dy(t.attr,i.tfDeprecatedName,i.defaultValue));break;case"dtype":(l=uy(t.attr,i.tfName,i.defaultValue))===void 0&&i.tfDeprecatedName&&(l=uy(t.attr,i.tfDeprecatedName,i.defaultValue));break;case"dtype[]":(l=ly(t.attr,i.tfName,i.defaultValue))===void 0&&i.tfDeprecatedName&&(l=ly(t.attr,i.tfDeprecatedName,i.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error("Unsupported param type: "+i.type+" for op: "+t.op)}return a[i.name]={value:l,type:s},a},{})),n},r}();function cj(r){var t=se().global;if(t.atob!==void 0)return t.atob(r);if(typeof Buffer<"u")return new Buffer(r,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function PI(r,t){var e=Array.isArray(r)?String.fromCharCode.apply(null,r):cj(r);return t?e:e.toLowerCase()}function iy(r,t,e,n){n===void 0&&(n=!1);var a=r[t];return a!=null?PI(a.s,n):e}function oy(r,t,e){var n=r[t];return n?n.b:e}function sy(r,t,e){var n=r[t]||{},a=n.i!=null?n.i:n.f!=null?n.f:e;return typeof a=="number"?a:parseInt(a,10)}function VI(r){switch(typeof r=="string"&&(r=ei[r]),r){case ei.DT_FLOAT:return"float32";case ei.DT_INT32:case ei.DT_INT64:return"int32";case ei.DT_BOOL:return"bool";case ei.DT_DOUBLE:return"float32";case ei.DT_STRING:return"string";default:return null}}function uy(r,t,e){var n=r[t];return n&&n.type?VI(n.type):e}function ly(r,t,e){var n=r[t];return n&&n.list&&n.list.type?n.list.type.map(function(a){return VI(a)}):e}function jI(r){if(!r.unknownRank)return r.dim!=null?r.dim.map(function(t){return typeof t.size=="number"?t.size:parseInt(t.size,10)}):[]}function cy(r,t,e){var n=r[t];return n&&n.shape?jI(n.shape):e}function fy(r,t,e){var n=r[t];return n?((n.list.f&&n.list.f.length?n.list.f:n.list.i)||[]).map(function(a){return typeof a=="number"?a:parseInt(a,10)}):e}function hy(r,t,e,n){n===void 0&&(n=!1);var a=r[t];return a&&a.list&&a.list.s?a.list.s.map(function(i){return PI(i,n)}):e}function dy(r,t,e){var n=r[t];return n&&n.list&&n.list.shape?n.list.shape.map(function(a){return jI(a)}):e}function py(r,t,e){var n=r[t];return n&&n.list&&n.list.b?n.list.b:e}var fj=function(){function r(t,e,n){var a=this;this.node=t,this.tensorMap=e,this.context=n,this.inputs=[],this.attrs={},this.inputs=t.inputNames.map(function(i){return a.getInput(i)}),t.rawAttrs!=null&&(this.attrs=Object.keys(t.rawAttrs).reduce(function(i,s){return i[s]=a.getAttr(s),i},{}))}return r.prototype.getInput=function(t){return Zn(t,this.tensorMap,this.context)},r.prototype.getAttr=function(t,e){var n=this.node.rawAttrs[t];if(n.tensor!=null)return Zn(t,this.tensorMap,this.context);if(n.i!=null||n.f!=null)return sy(this.node.rawAttrs,t,e);if(n.s!=null)return iy(this.node.rawAttrs,t,e);if(n.b!=null)return oy(this.node.rawAttrs,t,e);if(n.shape!=null)return cy(this.node.rawAttrs,t,e);if(n.type!=null)return uy(this.node.rawAttrs,t,e);if(n.list!=null){if(n.list.i!=null||n.list.f!=null)return fy(this.node.rawAttrs,t,e);if(n.list.s!=null)return hy(this.node.rawAttrs,t,e);if(n.list.shape!=null)return dy(this.node.rawAttrs,t,e);if(n.list.b!=null)return py(this.node.rawAttrs,t,e);if(n.list.type!=null)return ly(this.node.rawAttrs,t,e)}return e},r}(),hj=function(r,t,e){switch(r.op){case"BiasAdd":case"AddV2":case"Add":return[ot(M("a",r,t,e),M("b",r,t,e))];case"AddN":return[_b(M("tensors",r,t,e))];case"FloorMod":case"Mod":return[zb(M("a",r,t,e),M("b",r,t,e))];case"Mul":return[Xe(M("a",r,t,e),M("b",r,t,e))];case"RealDiv":case"Div":return[Xn(M("a",r,t,e),M("b",r,t,e))];case"FloorDiv":return[Pd(M("a",r,t,e),M("b",r,t,e))];case"Sub":return[Dn(M("a",r,t,e),M("b",r,t,e))];case"Minimum":return[Fu(M("a",r,t,e),M("b",r,t,e))];case"Maximum":return[_a(M("a",r,t,e),M("b",r,t,e))];case"Pow":return[xu(M("a",r,t,e),M("b",r,t,e))];case"SquaredDifference":return[Lb(M("a",r,t,e),M("b",r,t,e))];default:throw TypeError("Node type "+r.op+" is not implemented")}},dj=function(r,t,e){switch(r.op){case"Abs":case"ComplexAbs":return[to(M("x",r,t,e))];case"Acos":return[lb(M("x",r,t,e))];case"Acosh":return[cb(M("x",r,t,e))];case"Asin":return[fb(M("x",r,t,e))];case"Asinh":return[hb(M("x",r,t,e))];case"Atan":return[db(M("x",r,t,e))];case"Atan2":return[Mb(M("x",r,t,e),M("y",r,t,e))];case"Atanh":return[pb(M("x",r,t,e))];case"Ceil":return[mb(M("x",r,t,e))];case"Complex":return[Sn(M("real",r,t,e),M("imag",r,t,e))];case"Cos":return[gb(M("x",r,t,e))];case"Cosh":return[vb(M("x",r,t,e))];case"Elu":return[Vu(M("x",r,t,e))];case"Erf":return[yb(M("x",r,t,e))];case"Exp":return[bb(M("x",r,t,e))];case"Expm1":return[wb(M("x",r,t,e))];case"Floor":return[_d(M("x",r,t,e))];case"Log":return[ci(M("x",r,t,e))];case"Log1p":return[xb(M("x",r,t,e))];case"Imag":return[Gr(M("x",r,t,e))];case"Neg":return[hs(M("x",r,t,e))];case"Reciprocal":return[Sb(M("x",r,t,e))];case"Real":return[lr(M("x",r,t,e))];case"Relu":return[lo(M("x",r,t,e))];case"Round":return[Eb(M("x",r,t,e))];case"Selu":return[np(M("x",r,t,e))];case"Sigmoid":return[zd(M("x",r,t,e))];case"Sin":return[Ab(M("x",r,t,e))];case"Sign":return[Cb(M("x",r,t,e))];case"Sinh":return[Tb(M("x",r,t,e))];case"Softplus":return[_c(M("x",r,t,e))];case"Sqrt":return[Mc(M("x",r,t,e))];case"Square":return[ub(M("x",r,t,e))];case"Tanh":return[Ld(M("x",r,t,e))];case"Tan":return[Nb(M("x",r,t,e))];case"Relu6":case"ClipByValue":return[Jn(M("x",r,t,e),M("clipValueMin",r,t,e),M("clipValueMax",r,t,e))];case"Rsqrt":return[Md(Zn(r.inputNames[0],t,e))];case"Prod":return[Jd(M("x",r,t,e),M("axes",r,t,e))];case"LeakyRelu":return[ep(M("x",r,t,e),M("alpha",r,t,e))];default:throw TypeError("Node type "+r.op+" is not implemented")}},pj=function(){function r(t,e,n,a,i,s,l){this.name=t,this.dtype=e,this.maxSize=n,this.elementShape=a,this.identicalElementShapes=i,this.dynamicSize=s,this.clearAfterRead=l,this.tensors=[],this.closed_=!1,this.id=r.nextId++}return Object.defineProperty(r.prototype,"closed",{get:function(){return this.closed_},enumerable:!0,configurable:!0}),r.prototype.clearAndClose=function(){this.tensors.forEach(function(t){return t.tensor.dispose()}),this.tensors=[],this.closed_=!0},r.prototype.size=function(){return this.tensors.length},r.prototype.read=function(t){if(this.closed_)throw new Error("TensorArray "+this.name+" has already been closed.");if(t<0||t>=this.tensors.length)throw new Error("Tried to read from index "+t+", but array size is: "+this.tensors.length);var e=this.tensors[t];if(e.cleared)throw new Error("TensorArray "+this.name+": Could not read index "+t+" twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).");return this.clearAfterRead&&(e.cleared=!0),e.read=!0,e.tensor},r.prototype.readMany=function(t){var e=this;return t.map(function(n){return e.read(n)})},r.prototype.write=function(t,e){if(this.closed_)throw new Error("TensorArray "+this.name+" has already been closed.");if(t<0||!this.dynamicSize&&t>=this.maxSize)throw new Error("Tried to write to index "+t+", but array is not resizeable and size is: "+this.maxSize);var n=this.tensors[t]||{};if(e.dtype!==this.dtype)throw new Error("TensorArray "+this.name+": Could not write to TensorArray index "+t+`,
          because the value dtype is `+e.dtype+", but TensorArray dtype is "+this.dtype+".");if(this.size()!==0||this.elementShape!=null&&this.elementShape.length!==0||(this.elementShape=e.shape),this.assertShapesMatchAllowUndefinedSize(this.elementShape,e.shape,"TensorArray "+this.name+": Could not write to TensorArray index "+t+"."),n&&n.read)throw new Error("TensorArray "+this.name+": Could not write to TensorArray index "+t+", because it has already been read.");if(n&&n.written)throw new Error("TensorArray "+this.name+": Could not write to TensorArray index "+t+", because it has already been written.");n.tensor=e,n.written=!0,this.tensors[t]=n},r.prototype.writeMany=function(t,e){var n=this;if(t.length!==e.length)throw new Error("TensorArray "+this.name+": could not write multiple tensors,because the index size: "+t.length+" is not the same as tensors size: "+e.length+".");t.forEach(function(a,i){return n.write(a,e[i])})},r.prototype.gather=function(t,e){if(e&&e!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but gather requested dtype "+e);if(!t){t=[];for(var n=0;n<this.size();n++)t.push(n)}if(t.length===0)return rn([],[0].concat(this.elementShape));var a=this.readMany(t);return this.assertShapesMatchAllowUndefinedSize(this.elementShape,a[0].shape,"TensorArray shape mismatch: "),ia(a,0)},r.prototype.concat=function(t){if(t&&t!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but concat requested dtype "+t);if(this.size()===0)return rn([],[0].concat(this.elementShape));for(var e=[],n=0;n<this.size();n++)e.push(n);var a=this.readMany(e);return this.assertShapesMatchAllowUndefinedSize(this.elementShape,a[0].shape,"TensorArray shape mismatch: tensor array shape ("+this.elementShape+") vs first tensor shape ("+a[0].shape+")"),Gn(a,0)},r.prototype.scatter=function(t,e){if(e.dtype!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but tensor has dtype "+e.dtype);if(t.length!==e.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: "+t.length+" vs. "+e.shape[0]);var n=Math.max.apply(Math,t);if(!this.dynamicSize&&n>=this.maxSize)throw new Error("Max index must be < array size ("+n+"  vs. "+this.maxSize+")");this.writeMany(t,ts(e,0))},r.prototype.split=function(t,e){var n=this;if(e.dtype!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but tensor has dtype "+e.dtype);var a=0,i=t.map(function(d){return a+=d});if(a!==e.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        `+a+", and tensor's shape is: "+e.shape);if(!this.dynamicSize&&t.length!==this.maxSize)throw new Error("TensorArray's size is not equal to the size of lengths ("+this.maxSize+" vs. "+t.length+"), and the TensorArray is not marked as dynamically resizeable");var s=a===0?0:e.size/a,l=[];ae(function(){e=e.reshape([1,a,s]);for(var d=0;d<t.length;++d){var p=[0,d===0?0:i[d-1],0],g=[1,t[d],s];l[d]=Rr(e,p,g).reshape(n.elementShape)}return l});for(var c=[],f=0;f<t.length;f++)c[f]=f;this.writeMany(c,l)},r.prototype.assertShapesMatchAllowUndefinedSize=function(t,e,n){n===void 0&&(n=""),Be.assert(this.shapesEqualAllowUndefinedSize(t,e),function(){return n+" Shapes "+t+" and "+e+" must match"})},r.prototype.shapesEqualAllowUndefinedSize=function(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(t[n]!==-1&&e[n]!==-1&&t[n]!==e[n])return!1;return!0},r.nextId=0,r}();function mj(r,t,e){return as(this,void 0,void 0,function(){var n,a,i,s,l,c,f,d,p,g,v,b,w,S,x,C,A,T,R,O,N,D,I,_,F,B,V,X,Y,j,G,q,ne,L,Z;return is(this,function(ce){switch(ce.label){case 0:switch(r.op){case"LoopCond":return[3,1];case"Switch":return[3,2];case"Merge":return[3,4];case"Enter":return[3,5];case"Exit":return[3,6];case"NextIteration":return[3,7];case"TensorArrayV3":return[3,8];case"TensorArrayWriteV3":return[3,9];case"TensorArrayReadV3":return[3,10];case"TensorArrayGatherV3":return[3,11];case"TensorArrayScatterV3":return[3,12];case"TensorArrayConcatV3":return[3,13];case"TensorArraySplitV3":return[3,14];case"TensorArraySizeV3":return[3,15];case"TensorArrayCloseV3":return[3,16]}return[3,17];case 1:return[2,[M("pred",r,t,e).clone()]];case 2:return n=M("pred",r,t,e),a=M("data",r,t,e),[4,n.data()];case 3:return[2,ce.sent()[0]?[void 0,a.clone()]:[a.clone(),void 0]];case 4:return[2,(i=r.inputNames.find(function(le){return Zn(le,t,e)!==void 0}))?[Zn(i,t,e).clone()]:void 0];case 5:return s=M("frameName",r,t,e),l=M("tensor",r,t,e),e.enterFrame(s),[2,[l.clone()]];case 6:return c=M("tensor",r,t,e),e.exitFrame(),[2,[c.clone()]];case 7:return f=M("tensor",r,t,e),e.nextIteration(),[2,[f.clone()]];case 8:return d=M("size",r,t,e),p=M("dtype",r,t,e),g=M("elementShape",r,t,e),v=M("dynamicSize",r,t,e),b=M("clearAfterRead",r,t,e),w=M("identicalElementShapes",r,t,e),S=M("name",r,t,e),x=new pj(S,p,d,g,w,v,b),e.addTensorArray(x),[2,[Re(x.id),Re(1)]];case 9:return C=M("tensorArrayId",r,t,e),A=M("index",r,t,e),T=M("tensor",r,t,e),e.getTensorArray(C).write(A,T),[2,[Re(1)]];case 10:return R=M("tensorArrayId",r,t,e),O=M("index",r,t,e),[2,[e.getTensorArray(R).read(O)]];case 11:return N=M("tensorArrayId",r,t,e),D=M("indices",r,t,e),I=M("dtype",r,t,e),[2,[e.getTensorArray(N).gather(D,I)]];case 12:return _=M("tensorArrayId",r,t,e),F=M("indices",r,t,e),B=M("tensor",r,t,e),e.getTensorArray(_).scatter(F,B),[2,[Re(1)]];case 13:return V=M("tensorArrayId",r,t,e),X=e.getTensorArray(V),Y=M("dtype",r,t,e),[2,[X.concat(Y)]];case 14:return j=M("tensorArrayId",r,t,e),G=M("tensor",r,t,e),q=M("lengths",r,t,e),e.getTensorArray(j).split(q,G),[2,[Re(1)]];case 15:return ne=M("tensorArrayId",r,t,e),L=e.getTensorArray(ne),[2,[Re(L.size(),"int32")]];case 16:return Z=M("tensorArrayId",r,t,e),e.getTensorArray(Z).clearAndClose(),[2,[]];case 17:throw TypeError("Node type "+r.op+" is not implemented")}})})}var gj=function(r,t,e){var n,a;switch(r.op){case"Conv1D":var i=M("stride",r,t,e),s=M("pad",r,t,e),l=M("dataFormat",r,t,e).toUpperCase(),c=M("dilation",r,t,e);return[jd(M("x",r,t,e),M("filter",r,t,e),i,s,l,c)];case"Conv2D":i=M("strides",r,t,e),s=M("pad",r,t,e),l=M("dataFormat",r,t,e).toUpperCase();var f=M("dilations",r,t,e);return[ps(M("x",r,t,e),M("filter",r,t,e),[i[1],i[2]],s,l,[f[1],f[2]])];case"_FusedConv2D":var d=(n=M("fusedOps",r,t,e))[0],p=n[1],g=d==="biasadd",v=p==="prelu",b=d==="fusedbatchnorm",w=M("numArgs",r,t,e);if(g){if(v&&w!==2)throw new Error("Fused Conv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!v&&w!==1)throw new Error("Fused Conv2d with BiasAdd must have one extra argument: bias.")}if(b)throw new Error("Fused Conv2d with FusedBatchNorm is not supported.");i=M("strides",r,t,e),s=M("pad",r,t,e),l=M("dataFormat",r,t,e).toUpperCase(),f=M("dilations",r,t,e);var S=(a=M("args",r,t,e))[0],x=a[1];return[Au.conv2d({x:M("x",r,t,e),filter:M("filter",r,t,e),strides:[i[1],i[2]],pad:s,dataFormat:l,dilations:[f[1],f[2]],bias:S,activation:p,preluActivationWeights:x})];case"Conv2DBackpropInput":case"Conv2dTranspose":var C=M("outputShape",r,t,e);return i=M("strides",r,t,e),s=M("pad",r,t,e),[Hd(M("x",r,t,e),M("filter",r,t,e),C,[i[1],i[2]],s)];case"DepthwiseConv2dNative":case"DepthwiseConv2d":return i=M("strides",r,t,e),s=M("pad",r,t,e),f=M("dilations",r,t,e),l=M("dataFormat",r,t,e).toUpperCase(),[Pu(M("input",r,t,e),M("filter",r,t,e),[i[1],i[2]],s,l,[f[1],f[2]])];case"Conv3D":return i=M("strides",r,t,e),s=M("pad",r,t,e),l=M("dataFormat",r,t,e).toUpperCase(),f=M("dilations",r,t,e),[Wd(M("x",r,t,e),M("filter",r,t,e),[i[1],i[2],i[3]],s,l,[f[1],f[2],f[3]])];case"AvgPool":i=M("strides",r,t,e),s=M("pad",r,t,e);var A=M("kernelSize",r,t,e);return[Xd(M("x",r,t,e),[A[1],A[2]],[i[1],i[2]],s)];case"MaxPool":return i=M("strides",r,t,e),s=M("pad",r,t,e),A=M("kernelSize",r,t,e),[Gd(M("x",r,t,e),[A[1],A[2]],[i[1],i[2]],s)];case"AvgPool3D":return i=M("strides",r,t,e),s=M("pad",r,t,e),A=M("kernelSize",r,t,e),[Kd(M("x",r,t,e),[A[1],A[2],A[3]],[i[1],i[2],i[3]],s)];case"MaxPool3D":return i=M("strides",r,t,e),s=M("pad",r,t,e),A=M("kernelSize",r,t,e),[$d(M("x",r,t,e),[A[1],A[2],A[3]],[i[1],i[2],i[3]],s)];default:throw TypeError("Node type "+r.op+" is not implemented")}},vj=function(r,t,e){switch(r.op){case"Fill":var n=M("shape",r,t,e),a=M("dtype",r,t,e),i=M("value",r,t,e);return[zu(n,i,a)];case"LinSpace":var s=M("start",r,t,e),l=M("stop",r,t,e),c=M("num",r,t,e);return[Py(s,l,c)];case"Multinomial":var f=M("logits",r,t,e),d=M("numSamples",r,t,e),p=M("seed",r,t,e);return[Xy(f,d,p)];case"OneHot":var g=M("indices",r,t,e),v=M("depth",r,t,e),b=M("onValue",r,t,e),w=M("offValue",r,t,e);return[bu(g,v,b,w)];case"Ones":return[Oa(M("shape",r,t,e),M("dtype",r,t,e))];case"OnesLike":return[Nr(M("x",r,t,e))];case"RandomUniform":return[cs(M("shape",r,t,e),M("minval",r,t,e),M("maxval",r,t,e),M("dtype",r,t,e))];case"Range":s=M("start",r,t,e);var S=M("stop",r,t,e),x=M("step",r,t,e);return[Ed(s,S,x,M("dtype",r,t,e))];case"TruncatedNormal":n=M("shape",r,t,e);var C=M("mean",r,t,e),A=M("stdDev",r,t,e);return p=M("seed",r,t,e),[Dc(n,C,A,M("dtype",r,t,e),p)];case"Zeros":return[St(M("shape",r,t,e),M("dtype",r,t,e))];case"ZerosLike":return[ct(M("x",r,t,e))];default:throw TypeError("Node type "+r.op+" is not implemented")}};function yj(r,t,e){return as(this,void 0,void 0,function(){var n,a,i,s,l;return is(this,function(c){switch(c.label){case 0:switch(r.op){case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":return[3,1];case"Where":return[3,3];case"ListDiff":return[3,5]}return[3,6];case 1:return n=M("boxes",r,t,e),a=M("scores",r,t,e),i=M("maxOutputSize",r,t,e),s=M("iouThreshold",r,t,e),l=M("scoreThreshold",r,t,e),[4,$o.nonMaxSuppressionAsync(n,a,i,s,l)];case 2:return[2,[c.sent()]];case 3:return[4,Ud(M("condition",r,t,e).asType("bool"))];case 4:return[2,[c.sent()]];case 5:return[2,Ky(M("x",r,t,e),M("y",r,t,e))];case 6:throw TypeError("Node type "+r.op+" is not implemented")}})})}var bj=function(r,t,e){switch(r.op){case"TopKV2":var n=M("x",r,t,e),a=M("k",r,t,e),i=M("sorted",r,t,e),s=Xb(n,a,i);return[s.values,s.indices];default:throw TypeError("Node type "+r.op+" is not implemented")}},wj=function(r,t,e){switch(r.op){case"Const":return t[r.name];case"PlaceholderWithDefault":var n=M("default",r,t,e);return[Zn(r.name,t,e)||n];case"Placeholder":return[Zn(r.name,t,e)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":return[M("x",r,t,e).clone()];case"IdentityN":return M("x",r,t,e).map(function(f){return f.clone()});case"Snapshot":return[M("x",r,t,e).clone()];case"Shape":return[fr(M("x",r,t,e).shape,"int32")];case"ShapeN":return M("x",r,t,e).map(function(f){return fr(f.shape)});case"Size":return[Re(M("x",r,t,e).size,"int32")];case"Rank":return[Re(M("x",r,t,e).rank,"int32")];case"NoOp":return[];case"Print":var a=M("x",r,t,e),i=M("data",r,t,e),s=M("message",r,t,e),l=M("summarize",r,t,e);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(s);for(var c=0;c<i.length;c++)console.log(Array.prototype.slice.call(i[c].dataSync()).slice(0,l));return[a];default:throw TypeError("Node type "+r.op+" is not implemented")}},xj=function(r,t,e){switch(r.op){case"ResizeBilinear":var n=M("images",r,t,e),a=M("size",r,t,e),i=M("alignCorners",r,t,e);return[$o.resizeBilinear(n,[a[0],a[1]],i)];case"ResizeNearestNeighbor":return n=M("images",r,t,e),a=M("size",r,t,e),i=M("alignCorners",r,t,e),[$o.resizeNearestNeighbor(n,[a[0],a[1]],i)];case"CropAndResize":var s=M("image",r,t,e),l=M("boxes",r,t,e),c=M("boxInd",r,t,e),f=M("cropSize",r,t,e),d=M("method",r,t,e),p=M("extrapolationValue",r,t,e);return[$o.cropAndResize(s,l,c,f,d,p)];default:throw TypeError("Node type "+r.op+" is not implemented")}},Sj=function(r,t,e){switch(r.op){case"Equal":return[ds(M("a",r,t,e),M("b",r,t,e))];case"NotEqual":return[Su(M("a",r,t,e),M("b",r,t,e))];case"Greater":return[Bu(M("a",r,t,e),M("b",r,t,e))];case"GreaterEqual":return[Lc(M("a",r,t,e),M("b",r,t,e))];case"Less":return[Fb(M("a",r,t,e),M("b",r,t,e))];case"LessEqual":return[Bb(M("a",r,t,e),M("b",r,t,e))];case"LogicalAnd":return[mi(M("a",r,t,e),M("b",r,t,e))];case"LogicalNot":return[Ob(M("a",r,t,e))];case"LogicalOr":return[Bd(M("a",r,t,e),M("b",r,t,e))];case"Select":return[fi(M("condition",r,t,e),M("a",r,t,e),M("b",r,t,e))];default:throw TypeError("Node type "+r.op+" is not implemented")}},Ej=function(r,t,e){switch(r.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[qd(M("a",r,t,e),M("b",r,t,e),M("transposeA",r,t,e),M("transposeB",r,t,e))];case"Transpose":return[Ut(M("x",r,t,e),M("perm",r,t,e))];default:throw TypeError("Node type "+r.op+" is not implemented")}},Cj=function(r,t,e){switch(r.op){case"FusedBatchNorm":case"FusedBatchNormV2":case"FusedBatchNormV3":return[Rb(M("x",r,t,e),M("mean",r,t,e),M("variance",r,t,e),M("offset",r,t,e),M("scale",r,t,e),M("epsilon",r,t,e))];case"LRN":return[Hb(M("x",r,t,e),M("radius",r,t,e),M("bias",r,t,e),M("alpha",r,t,e),M("beta",r,t,e))];case"Softmax":return[fs(M("x",r,t,e))];case"LogSoftmax":return[Dd(M("x",r,t,e))];case"SparseToDense":return[ap(M("sparseIndices",r,t,e),M("outputShape",r,t,e),M("sparseValues",r,t,e),M("defaultValue",r,t,e))];default:throw TypeError("Node type "+r.op+" is not implemented")}},Aj=function(r,t,e){switch(r.op){case"Max":var n=M("axis",r,t,e),a=M("keepDims",r,t,e);return[no(M("x",r,t,e),n,a)];case"Mean":return n=M("axis",r,t,e),a=M("keepDims",r,t,e),[an(M("x",r,t,e),n,a)];case"Min":return n=M("axis",r,t,e),a=M("keepDims",r,t,e),[Qd(M("x",r,t,e),n,a)];case"Sum":return n=M("axis",r,t,e),a=M("keepDims",r,t,e),[hr(M("x",r,t,e),n,a)];case"All":return n=M("axis",r,t,e),a=M("keepDims",r,t,e),[Zd(M("x",r,t,e),n,a)];case"Any":return n=M("axis",r,t,e),a=M("keepDims",r,t,e),[yc(M("x",r,t,e),n,a)];case"ArgMax":return n=M("axis",r,t,e),[bc(M("x",r,t,e),n)];case"ArgMin":return n=M("axis",r,t,e),[jb(M("x",r,t,e),n)];case"Prod":return n=M("axis",r,t,e),a=M("keepDims",r,t,e),[Jd(M("x",r,t,e),n,a)];default:throw TypeError("Node type "+r.op+" is not implemented")}},Tj=function(r,t,e){switch(r.op){case"ConcatV2":case"Concat":var n=M("axis",r,t,e),a=M("tensors",r,t,e);return[Gn(a,n)];case"GatherV2":case"Gather":n=M("axis",r,t,e);var i=M("x",r,t,e),s=M("indices",r,t,e);return[Uu(i,s.asType("int32"),n)];case"ReverseV2":case"Reverse":return n=M("axis",r,t,e),i=M("x",r,t,e),[Ia(i,n)];case"Slice":var l=M("begin",r,t,e),c=M("size",r,t,e);return[Rr(M("x",r,t,e),l,c)];case"StridedSlice":l=M("begin",r,t,e);var f=M("end",r,t,e),d=M("strides",r,t,e),p=M("beginMask",r,t,e),g=M("endMask",r,t,e),v=M("ellipsisMask",r,t,e),b=M("newAxisMask",r,t,e),w=M("shrinkAxisMask",r,t,e),S=M("x",r,t,e);if(l.length===1&&S.shape.length>1)for(var x=1;x<S.shape.length;x++)l.push(0),f.push(S.shape[x]),d.push(d[0]);return[Gb(S,l,f,d,p,g,v,b,w)];case"Pack":return ae(function(){var I=M("axis",r,t,e),_=M("tensors",r,t,e),F=_[0].shape,B=_[0].squeeze().shape,V=_.map(function(X){var Y=Be.arraysEqual(X.shape,F);if(!Y&&!Be.arraysEqual(X.squeeze().shape,B))throw new Error("the input tensors shape does not match");return Y?X:X.reshape(F)});return[ia(V,I)]});case"Unpack":return ae(function(){var I=M("axis",r,t,e),_=M("tensor",r,t,e);return ts(_,I)});case"Tile":var C=M("reps",r,t,e);return[Yi(M("x",r,t,e),C)];case"Split":case"SplitV":n=M("axis",r,t,e);var A=M("numOrSizeSplits",r,t,e);return ii(M("x",r,t,e),A,n);case"ScatterNd":s=M("indices",r,t,e);var T=M("values",r,t,e),R=M("shape",r,t,e);return[$b(s,T,R)];case"GatherNd":var O=M("x",r,t,e);return s=M("indices",r,t,e),[Kb(O,s)];case"SparseToDense":s=M("sparseIndices",r,t,e),R=M("outputShape",r,t,e);var N=M("sparseValues",r,t,e),D=M("defaultValue",r,t,e);return[ap(s,N,R,N.dtype===D.dtype?D:D.asType(N.dtype))];default:throw TypeError("Node type "+r.op+" is not implemented")}},Nj=function(r,t,e){switch(r.op){case"FFT":return[Pc(M("x",r,t,e))];case"IFFT":return[Cu(M("x",r,t,e))];case"RFFT":return[Vc(M("x",r,t,e))];case"IRFFT":return[rp(M("x",r,t,e))];default:throw TypeError("Node type "+r.op+" is not implemented")}},Rj=function(r,t,e){switch(r.op){case"Cast":return[Td(M("x",r,t,e),M("dtype",r,t,e))];case"ExpandDims":var n=M("axis",r,t,e);return[Sr(M("x",r,t,e),n)];case"Squeeze":return n=M("axis",r,t,e),[kc(M("x",r,t,e),n)];case"Reshape":return[Ic(M("x",r,t,e),M("shape",r,t,e))];case"PadV2":case"Pad":return[so(M("x",r,t,e),pv(M("padding",r,t,e),2),M("constantValue",r,t,e))];case"SpaceToBatchND":var a=M("blockShape",r,t,e),i=pv(M("paddings",r,t,e),2);return[Rd(M("x",r,t,e),a,i)];case"BatchToSpaceND":a=M("blockShape",r,t,e);var s=pv(M("crops",r,t,e),2);return[Ad(M("x",r,t,e),a,s)];case"DepthToSpace":var l=M("blockSize",r,t,e),c=M("dataFormat",r,t,e).toUpperCase();return[Gy(M("x",r,t,e),l,c)];default:throw TypeError("Node type "+r.op+" is not implemented")}};function tE(r,t,e){var n=function(a,i,s){switch(a.category){case"arithmetic":return hj(a,i,s);case"basic_math":return dj(a,i,s);case"control":return mj(a,i,s);case"convolution":return gj(a,i,s);case"creation":return vj(a,i,s);case"dynamic":return yj(a,i,s);case"evaluation":return bj(a,i,s);case"image":return xj(a,i,s);case"graph":return wj(a,i,s);case"logical":return Sj(a,i,s);case"matrices":return Ej(a,i,s);case"normalization":return Cj(a,i,s);case"reduction":return Aj(a,i,s);case"slice_join":return Tj(a,i,s);case"spectral":return Nj(a,i,s);case"transformation":return Rj(a,i,s);case"custom":var l=UI(a.op);if(l&&l.customExecutor)return l.customExecutor(new fj(a,i,s));throw TypeError("Custom op "+a.op+" is not registered.");default:throw TypeError("Unknown op '"+a.op+"'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()")}}(r,t,e);return n instanceof Promise?n.then(function(a){return[].concat(a)}):[].concat(n)}var nE=function(){function r(t,e){this.weightMap=t,this.tensorArrayMap=e,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}return r.prototype.newFrame=function(t,e){return{id:t,frameName:e,iterationId:0}},Object.defineProperty(r.prototype,"currentContext",{get:function(){return this.contexts},set:function(t){this.contexts!==t&&(this.contexts=t,this.generateCurrentContextIds())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"currentContextId",{get:function(){return this._currentContextIds[0]},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"currentContextIds",{get:function(){return this._currentContextIds},enumerable:!0,configurable:!0}),r.prototype.generateCurrentContextIds=function(){for(var t=[],e=0;e<this.contexts.length-1;e++){var n=this.contexts.slice(0,this.contexts.length-e);t.push(this.contextIdforContexts(n))}t.push(""),this._currentContextIds=t},r.prototype.contextIdforContexts=function(t){return t?t.map(function(e){return e.id===0&&e.iterationId===0?"":e.frameName+"-"+e.iterationId}).join("/"):""},r.prototype.enterFrame=function(t){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,t)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))},r.prototype.exitFrame=function(){if(!(this.contexts&&this.contexts.length>1))throw new Error("Cannot exit frame, the context is empty");this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift()},r.prototype.nextIteration=function(){if(!(this.contexts&&this.contexts.length>0))throw new Error("Cannot increase frame iteration, the context is empty");this.contexts=this.contexts.slice(),this.lastId++;var t=Object.assign({},this.contexts[this.contexts.length-1]);t.iterationId+=1,t.id=this.lastId,this.contexts.splice(-1,1,t),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))},r.prototype.getWeight=function(t){return this.weightMap[t]},r.prototype.addTensorArray=function(t){this.tensorArrayMap[t.id]=t},r.prototype.getTensorArray=function(t){return this.tensorArrayMap[t]},r}();function rE(r,t,e){for(var n=new Set,a=[],i=null,s=null,l=new Set,c=t.slice();c.length>0;){var f=c.pop();(WI(f)||Oj(f))&&i==null&&(s=(i=f).children.map(function(d){return d.name}).filter(function(d){return n.has(d)})),n.add(f.name),e[f.name]==null&&r[f.name]==null&&(f.inputs.length!==0?f.inputs.forEach(function(d){l.has(d.name)||(l.add(d.name),c.push(d))}):a.push(f.name))}return{inputs:r,outputs:t,usedNodes:n,missingInputs:a,dynamicNode:i,syncInputs:s}}function Ij(r,t,e){var n=e.usedNodes,a=e.inputs,i=[];Object.keys(a).map(function(f){return r.nodes[f]}).forEach(function(f){n.has(f.name)&&i.push(f)}),r.weights.forEach(function(f){n.has(f.name)&&i.push(f)});for(var s=new Set,l=[];i.length>0;){var c=i.pop();s.add(c.name),t[c.name]||l.push(c),c.children.forEach(function(f){!s.has(f.name)&&n.has(f.name)&&f.inputs.every(function(d){return s.has(d.name)})&&i.push(f)})}return l}var kj=["Switch","Merge","Enter","Exit","NextIteration"],Dj=["NonMaxSuppressionV2","NonMaxSuppressionV3","Where"];function WI(r){return kj.indexOf(r.op)>=0}function Oj(r){return Dj.indexOf(r.op)>=0}var _j=function(){function r(t){this.graph=t,this.compiledMap=new Map,this._weightMap={},this.SEPERATOR=",",this.placeholders=t.placeholders,this._outputs=t.outputs}return Object.defineProperty(r.prototype,"weightMap",{get:function(){return this._weightMap},set:function(t){var e=Object.keys(t).map(function(n){return t[n].map(function(a){return a.id})});this.weightIds=[].concat.apply([],e),this._weightMap=t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"inputs",{get:function(){return this.placeholders.map(function(t){return{name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}})},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"outputs",{get:function(){return this._outputs.map(function(t){return{name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}})},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"inputNodes",{get:function(){return this.placeholders.map(function(t){return t.name})},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"outputNodes",{get:function(){return this.outputs.map(function(t){return t.name})},enumerable:!0,configurable:!0}),r.prototype.getCompilationKey=function(t,e){var n=t.map(function(i){return i.name}).sort(),a=e.map(function(i){return i.name}).sort();return n.join(this.SEPERATOR)+"--"+a.join(this.SEPERATOR)},r.prototype.compile=function(t,e){var n=rE(t,e,this.weightMap),a=n.missingInputs,i=n.dynamicNode,s=n.syncInputs;if(i!=null)throw new Error("This execution contains the node '"+i.name+"', which has the dynamic op '"+i.op+"'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs ["+s+"]");if(a.length>0){var l=e.map(function(f){return f.name}),c=Object.keys(t);throw new Error("Cannot compute the outputs ["+l+"] from the provided inputs ["+c+"]. Missing the following inputs: ["+a+"]")}return Ij(this.graph,this.weightMap,n)},r.prototype.execute=function(t,e){var n=this,a=Object.keys(t).sort();this.checkInputs(t),this.checkInputShapeAndType(t),this.checkOutputs(e);var i=a.map(function(d){return n.graph.nodes[d]}),s=e.map(function(d){return n.graph.nodes[oc(d)[0]]}),l=this.getCompilationKey(i,s),c=this.compiledMap.get(l);c==null&&(c=this.compile(t,s),this.compiledMap.set(l,c));var f={};return ae(function(){var d=new nE(n._weightMap,f),p=ay({},n.weightMap);Object.keys(t).forEach(function(x){p[x]=[t[x]]});for(var g=n.getFrozenTensorIds(p),v={},b=0;b<c.length;b++){var w=c[b];if(!p[w.name]){var S=tE(w,p,d);if(S instanceof Promise)throw new Error("The execution of the op '"+w.op+"' returned a promise. Please use model.executeAsync() instead.");p[w.name]=S,n.checkTensorForDisposal(w.name,w,p,d,g,e,v)}}return e.map(function(x){return Zn(x,p,d)})})},r.prototype.getFrozenTensorIds=function(t){var e=[].concat.apply([],Object.keys(t).map(function(n){return t[n]}).map(function(n){return n.map(function(a){return a.id})}));return new Set(e)},r.prototype.checkTensorForDisposal=function(t,e,n,a,i,s,l){e.category!=="control"&&s.indexOf(t)===-1&&(n[t].forEach(function(c){c!=null&&(l[c.id]=(l[c.id]||0)+e.children.length)}),e.inputs.forEach(function(c){if(c.category!=="control"){var f=kV(c.name,n,a);f!=null&&f.forEach(function(d){if(d&&!i.has(d.id)){var p=l[d.id];p===1?(d.dispose(),delete l[d.id]):p!=null&&l[d.id]--}})}}))},r.prototype.executeAsync=function(t,e){return as(this,void 0,void 0,function(){var n,a,i,s,l,c,f=this;return is(this,function(d){switch(d.label){case 0:return this.checkInputs(t),this.checkInputShapeAndType(t),this.checkOutputs(e),n={},a=new nE(this._weightMap,n),[4,this.executeWithControlFlow(t,a,e)];case 1:return i=d.sent(),s=e.map(function(p){return Zn(p,i,a)}),l=new Set(s.map(function(p){return p.id})),c=new Set(Object.keys(t).map(function(p){return t[p].id})),Object.keys(i).forEach(function(p){i[p].forEach(function(g){!g||g.isDisposed||l.has(g.id)||c.has(g.id)||f.weightIds.indexOf(g.id)!==-1||g.dispose()})}),[2,s]}})})},r.prototype.executeWithControlFlow=function(t,e,n){return as(this,void 0,void 0,function(){var a,i,s,l,c,f,d,p,g,v,b,w,S,x,C,A,T=this;return is(this,function(R){switch(R.label){case 0:a=Object.keys(t),i=a.map(function(O){return T.graph.nodes[O]}),s=n.map(function(O){return T.graph.nodes[oc(O)[0]]}),l=rE(t,s,this.weightMap),c=l.usedNodes,f=l.missingInputs,d=l.dynamicNode,p=l.syncInputs,g=i.concat(this.graph.weights).map(function(O){return{node:O,contexts:e.currentContext}}),v=ay({},this.weightMap),Object.keys(t).forEach(function(O){v[O]=[t[O]]}),b={},w=this.getFrozenTensorIds(v),S={},R.label=1;case 1:return g.length>0?(x=this.processStack(i,g,e,v,S,w,n,b,c),[4,Promise.all(x)]):[3,3];case 2:return R.sent(),[3,1];case 3:if(d==null&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead."),(C=s.filter(function(O){return!WI(O)&&!Zn(O.name,v,e)}).map(function(O){return O.name})).length>0)throw A="",d!=null&&(A="Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs ["+p+"]"),new Error("Cannot compute the outputs ["+C+"] from the provided inputs ["+a+"]. Consider providing the following inputs: ["+f+"]. "+A);return[2,v]}})})},r.prototype.processStack=function(t,e,n,a,i,s,l,c,f){for(var d=this,p=[],g=function(){var b=e.pop();n.currentContext=b.contexts;var w="";if(b.node.op==="Enter"&&M("isConstant",b.node,a,n)&&(w=Ph(b.node.name,n)[0]),t.indexOf(b.node)===-1){var S=tE(b.node,a,n);w||(w=Ph(b.node.name,n)[0]);var x=n.currentContext;S instanceof Promise?p.push(S.then(function(C){return a[w]=C,n.currentContext=x,d.checkTensorForDisposal(w,b.node,a,n,s,l,c),d.processChildNodes(b.node,e,n,a,i,f),C})):(a[w]=S,v.checkTensorForDisposal(w,b.node,a,n,s,l,c),v.processChildNodes(b.node,e,n,a,i,f))}else v.processChildNodes(b.node,e,n,a,i,f)},v=this;e.length>0;)g();return p},r.prototype.processChildNodes=function(t,e,n,a,i,s){t.children.forEach(function(l){var c=Ph(l.name,n)[0];!i[c]&&s.has(l.name)&&(l.op==="Merge"?l.inputNames.some(function(f){return!!Zn(f,a,n)})&&(i[c]=!0,e.push({contexts:n.currentContext,node:l})):l.inputNames.every(function(f){return!!Zn(f,a,n)})&&(i[c]=!0,e.push({contexts:n.currentContext,node:l})))})},r.prototype.dispose=function(){var t=this;Object.keys(this.weightMap).forEach(function(e){return t.weightMap[e].forEach(function(n){return n.dispose()})})},r.prototype.checkInputShapeAndType=function(t){var e=this;Object.keys(t).forEach(function(n){var a=t[n],i=e.graph.nodes[n];if(i.attrParams.shape&&i.attrParams.shape.value){var s=i.attrParams.shape.value,l=s.length===a.shape.length&&a.shape.every(function(c,f){return s[f]===-1||s[f]===c});Be.assert(l,function(){return"The shape of dict['"+i.name+"'] provided in model.execute(dict) must be ["+s+"], but was ["+a.shape+"]"})}i.attrParams.dtype&&i.attrParams.dtype.value&&Be.assert(a.dtype===i.attrParams.dtype.value,function(){return"The dtype of dict['"+i.name+"'] provided in model.execute(dict) must be "+i.attrParams.dtype.value+", but was "+a.dtype})})},r.prototype.checkInputs=function(t){var e=this,n=Object.keys(t).filter(function(a){return!e.graph.nodes[a]});if(n.length>0)throw new Error("The dict provided in model.execute(dict) has keys: ["+n+"] that are not part of graph")},r.prototype.checkOutputs=function(t){var e=this;t.forEach(function(n){var a=oc(n)[0];if(!e.graph.nodes[a])throw new Error("The output '"+n+"' is not found in the graph")})},r}(),Mj="?tfjs-format=file",zj="model.json",HI=function(){function r(t,e){e===void 0&&(e={}),this.modelUrl=t,this.loadOptions=e,this.version="n/a",e==null&&(this.loadOptions={})}return Object.defineProperty(r.prototype,"modelVersion",{get:function(){return this.version},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"inputNodes",{get:function(){return this.executor.inputNodes},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"outputNodes",{get:function(){return this.executor.outputNodes},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"inputs",{get:function(){return this.executor.inputs},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"outputs",{get:function(){return this.executor.outputs},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"weights",{get:function(){return this.executor.weightMap},enumerable:!0,configurable:!0}),r.prototype.findIOHandler=function(){var t=this.modelUrl;if(t.load!=null)this.handler=t;else if(this.loadOptions.requestInit!=null)this.handler=Ar.browserHTTPRequest(t,this.loadOptions);else{var e=Ar.getLoadHandlers(t,this.loadOptions.onProgress);if(e.length===0)e.push(Ar.browserHTTPRequest(t,this.loadOptions));else if(e.length>1)throw new Error("Found more than one ("+e.length+") load handlers for URL '"+[t]+"'");this.handler=e[0]}},r.prototype.load=function(){return as(this,void 0,void 0,function(){var t,e,n;return is(this,function(a){switch(a.label){case 0:if(this.findIOHandler(),this.handler.load==null)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");return[4,this.handler.load()];case 1:return t=a.sent(),e=t.modelTopology,this.version=e.versions.producer+"."+e.versions.minConsumer,n=Ar.decodeWeights(t.weightData,t.weightSpecs),this.executor=new _j(lj.Instance.transformGraph(e)),this.executor.weightMap=this.convertTensorMapToTensorsMap(n),[2,!0]}})})},r.prototype.predict=function(t,e){return this.execute(t,this.outputNodes)},r.prototype.normalizeInputs=function(t){if(!(t instanceof Ct||Array.isArray(t)))return t;if((t=Array.isArray(t)?t:[t]).length!==this.inputNodes.length)throw new Error("Input tensor count mismatch,the graph model has "+this.inputNodes.length+" placeholders, while there are "+t.length+" input tensors.");return this.inputNodes.reduce(function(e,n,a){return e[n]=t[a],e},{})},r.prototype.normalizeOutputs=function(t){return t=t||this.outputNodes,Array.isArray(t)?t:[t]},r.prototype.execute=function(t,e){t=this.normalizeInputs(t),e=this.normalizeOutputs(e);var n=this.executor.execute(t,e);return n.length>1?n:n[0]},r.prototype.executeAsync=function(t,e){return as(this,void 0,void 0,function(){var n;return is(this,function(a){switch(a.label){case 0:return t=this.normalizeInputs(t),e=this.normalizeOutputs(e),[4,this.executor.executeAsync(t,e)];case 1:return[2,(n=a.sent()).length>1?n:n[0]]}})})},r.prototype.convertTensorMapToTensorsMap=function(t){return Object.keys(t).reduce(function(e,n){return e[n]=[t[n]],e},{})},r.prototype.dispose=function(){this.executor.dispose()},r}();function Lj(r,t){return t===void 0&&(t={}),as(this,void 0,void 0,function(){var e;return is(this,function(n){switch(n.label){case 0:if(r==null)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");return t==null&&(t={}),t.fromTFHub&&r.load==null&&(r.endsWith("/")||(r+="/"),r=""+r+zj+Mj),[4,(e=new HI(r,t)).load()];case 1:return n.sent(),[2,e]}})})}var qI="1.3.1";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var GI=function(r,t){return(GI=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var a in n)n.hasOwnProperty(a)&&(e[a]=n[a])})(r,t)};function xt(r,t){function e(){this.constructor=r}GI(r,t),r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}function Ce(r,t,e,n){return new(e||(e=Promise))(function(a,i){function s(f){try{c(n.next(f))}catch(d){i(d)}}function l(f){try{c(n.throw(f))}catch(d){i(d)}}function c(f){f.done?a(f.value):new e(function(d){d(f.value)}).then(s,l)}c((n=n.apply(r,[])).next())})}function Ae(r,t){var e,n,a,i,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function l(c){return function(f){return function(d){if(e)throw new TypeError("Generator is already executing.");for(;s;)try{if(e=1,n&&(a=2&d[0]?n.return:d[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,d[1])).done)return a;switch(n=0,a&&(d=[2&d[0],a.value]),d[0]){case 0:case 1:a=d;break;case 4:return s.label++,{value:d[1],done:!1};case 5:s.label++,n=d[1],d=[0];continue;case 7:d=s.ops.pop(),s.trys.pop();continue;default:if(!(a=(a=s.trys).length>0&&a[a.length-1])&&(d[0]===6||d[0]===2)){s=0;continue}if(d[0]===3&&(!a||d[1]>a[0]&&d[1]<a[3])){s.label=d[1];break}if(d[0]===6&&s.label<a[1]){s.label=a[1],a=d;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(d);break}a[2]&&s.ops.pop(),s.trys.pop();continue}d=t.call(r,s)}catch(p){d=[6,p],n=0}finally{e=a=0}if(5&d[0])throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}([c,f])}}}function ys(r,t){return r(t={exports:{}},t.exports),t.exports}var Fj=ys(function(r){(function(t,e,n){function a(s,l){return l.c=s.c,l.s0=s.s0,l.s1=s.s1,l.s2=s.s2,l}function i(s,l){var c=new function(p){var g,v=this,b=(g=4022871197,function(w){w=w.toString();for(var S=0;S<w.length;S++){var x=.02519603282416938*(g+=w.charCodeAt(S));x-=g=x>>>0,g=(x*=g)>>>0,g+=4294967296*(x-=g)}return 23283064365386963e-26*(g>>>0)});v.next=function(){var w=2091639*v.s0+23283064365386963e-26*v.c;return v.s0=v.s1,v.s1=v.s2,v.s2=w-(v.c=0|w)},v.c=1,v.s0=b(" "),v.s1=b(" "),v.s2=b(" "),v.s0-=b(p),v.s0<0&&(v.s0+=1),v.s1-=b(p),v.s1<0&&(v.s1+=1),v.s2-=b(p),v.s2<0&&(v.s2+=1),b=null}(s),f=l&&l.state,d=c.next;return d.int32=function(){return 4294967296*c.next()|0},d.double=function(){return d()+11102230246251565e-32*(2097152*d()|0)},d.quick=d,f&&(typeof f=="object"&&a(f,c),d.state=function(){return a(c,{})}),d}e&&e.exports?e.exports=i:this.alea=i})(0,r)}),Bj=ys(function(r){(function(t,e,n){function a(s,l){return l.x=s.x,l.y=s.y,l.z=s.z,l.w=s.w,l}function i(s,l){var c=new function(p){var g=this,v="";g.x=0,g.y=0,g.z=0,g.w=0,g.next=function(){var w=g.x^g.x<<11;return g.x=g.y,g.y=g.z,g.z=g.w,g.w^=g.w>>>19^w^w>>>8},p===(0|p)?g.x=p:v+=p;for(var b=0;b<v.length+64;b++)g.x^=0|v.charCodeAt(b),g.next()}(s),f=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var p=((c.next()>>>11)+(c.next()>>>0)/4294967296)/2097152;while(p===0);return p},d.int32=c.next,d.quick=d,f&&(typeof f=="object"&&a(f,c),d.state=function(){return a(c,{})}),d}e&&e.exports?e.exports=i:this.xor128=i})(0,r)}),Uj=ys(function(r){(function(t,e,n){function a(s,l){return l.x=s.x,l.y=s.y,l.z=s.z,l.w=s.w,l.v=s.v,l.d=s.d,l}function i(s,l){var c=new function(p){var g=this,v="";g.next=function(){var w=g.x^g.x>>>2;return g.x=g.y,g.y=g.z,g.z=g.w,g.w=g.v,(g.d=g.d+362437|0)+(g.v=g.v^g.v<<4^w^w<<1)|0},g.x=0,g.y=0,g.z=0,g.w=0,g.v=0,p===(0|p)?g.x=p:v+=p;for(var b=0;b<v.length+64;b++)g.x^=0|v.charCodeAt(b),b==v.length&&(g.d=g.x<<10^g.x>>>4),g.next()}(s),f=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var p=((c.next()>>>11)+(c.next()>>>0)/4294967296)/2097152;while(p===0);return p},d.int32=c.next,d.quick=d,f&&(typeof f=="object"&&a(f,c),d.state=function(){return a(c,{})}),d}e&&e.exports?e.exports=i:this.xorwow=i})(0,r)}),Pj=ys(function(r){(function(t,e,n){function a(s,l){return l.x=s.x.slice(),l.i=s.i,l}function i(s,l){s==null&&(s=+new Date);var c=new function(p){var g=this;g.next=function(){var v,b,w=g.x,S=g.i;return v=w[S],b=(v^=v>>>7)^v<<24,b^=(v=w[S+1&7])^v>>>10,b^=(v=w[S+3&7])^v>>>3,b^=(v=w[S+4&7])^v<<7,v=w[S+7&7],b^=(v^=v<<13)^v<<9,w[S]=b,g.i=S+1&7,b},function(v,b){var w,S=[];if(b===(0|b))S[0]=b;else for(b=""+b,w=0;w<b.length;++w)S[7&w]=S[7&w]<<15^b.charCodeAt(w)+S[w+1&7]<<13;for(;S.length<8;)S.push(0);for(w=0;w<8&&S[w]===0;++w);for(w==8?S[7]=-1:S[w],v.x=S,v.i=0,w=256;w>0;--w)v.next()}(g,p)}(s),f=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var p=((c.next()>>>11)+(c.next()>>>0)/4294967296)/2097152;while(p===0);return p},d.int32=c.next,d.quick=d,f&&(f.x&&a(f,c),d.state=function(){return a(c,{})}),d}e&&e.exports?e.exports=i:this.xorshift7=i})(0,r)}),Vj=ys(function(r){(function(t,e,n){function a(s,l){return l.i=s.i,l.w=s.w,l.X=s.X.slice(),l}function i(s,l){s==null&&(s=+new Date);var c=new function(p){var g=this;g.next=function(){var v,b,w=g.w,S=g.X,x=g.i;return g.w=w=w+1640531527|0,b=S[x+34&127],v=S[x=x+1&127],b^=b<<13,v^=v<<17,b^=b>>>15,v^=v>>>12,b=S[x]=b^v,g.i=x,b+(w^w>>>16)|0},function(v,b){var w,S,x,C,A,T=[],R=128;for(b===(0|b)?(S=b,b=null):(b+="\0",S=0,R=Math.max(R,b.length)),x=0,C=-32;C<R;++C)b&&(S^=b.charCodeAt((C+32)%b.length)),C===0&&(A=S),S^=S<<10,S^=S>>>15,S^=S<<4,S^=S>>>13,C>=0&&(A=A+1640531527|0,x=(w=T[127&C]^=S+A)==0?x+1:0);for(x>=128&&(T[127&(b&&b.length||0)]=-1),x=127,C=512;C>0;--C)S=T[x+34&127],w=T[x=x+1&127],S^=S<<13,w^=w<<17,S^=S>>>15,w^=w>>>12,T[x]=S^w;v.w=A,v.X=T,v.i=x}(g,p)}(s),f=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var p=((c.next()>>>11)+(c.next()>>>0)/4294967296)/2097152;while(p===0);return p},d.int32=c.next,d.quick=d,f&&(f.X&&a(f,c),d.state=function(){return a(c,{})}),d}e&&e.exports?e.exports=i:this.xor4096=i})(0,r)}),jj=ys(function(r){(function(t,e,n){function a(s,l){return l.a=s.a,l.b=s.b,l.c=s.c,l.d=s.d,l}function i(s,l){var c=new function(p){var g=this,v="";g.next=function(){var w=g.b,S=g.c,x=g.d,C=g.a;return w=w<<25^w>>>7^S,S=S-x|0,x=x<<24^x>>>8^C,C=C-w|0,g.b=w=w<<20^w>>>12^S,g.c=S=S-x|0,g.d=x<<16^S>>>16^C,g.a=C-w|0},g.a=0,g.b=0,g.c=-1640531527,g.d=1367130551,p===Math.floor(p)?(g.a=p/4294967296|0,g.b=0|p):v+=p;for(var b=0;b<v.length+20;b++)g.b^=0|v.charCodeAt(b),g.next()}(s),f=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var p=((c.next()>>>11)+(c.next()>>>0)/4294967296)/2097152;while(p===0);return p},d.int32=c.next,d.quick=d,f&&(typeof f=="object"&&a(f,c),d.state=function(){return a(c,{})}),d}e&&e.exports?e.exports=i:this.tychei=i})(0,r)}),Vo=ys(function(r){(function(t,e){var n,a=this,i=256,s=6,l="random",c=e.pow(i,s),f=e.pow(2,52),d=2*f,p=i-1;function g(S,x,C){var A=[],T=b(function N(D,I){var _,F=[],B=typeof D;if(I&&B=="object")for(_ in D)try{F.push(N(D[_],I-1))}catch{}return F.length?F:B=="string"?D:D+"\0"}((x=x==1?{entropy:!0}:x||{}).entropy?[S,w(t)]:S??function(){try{var N;return n&&(N=n.randomBytes)?N=N(i):(N=new Uint8Array(i),(a.crypto||a.msCrypto).getRandomValues(N)),w(N)}catch{var D=a.navigator,I=D&&D.plugins;return[+new Date,a,I,a.screen,w(t)]}}(),3),A),R=new function(N){var D,I=N.length,_=this,F=0,B=_.i=_.j=0,V=_.S=[];for(I||(N=[I++]);F<i;)V[F]=F++;for(F=0;F<i;F++)V[F]=V[B=p&B+N[F%I]+(D=V[F])],V[B]=D;(_.g=function(X){for(var Y,j=0,G=_.i,q=_.j,ne=_.S;X--;)Y=ne[G=p&G+1],j=j*i+ne[p&(ne[G]=ne[q=p&q+Y])+(ne[q]=Y)];return _.i=G,_.j=q,j})(i)}(A),O=function(){for(var N=R.g(s),D=c,I=0;N<f;)N=(N+I)*i,D*=i,I=R.g(1);for(;N>=d;)N/=2,D/=2,I>>>=1;return(N+I)/D};return O.int32=function(){return 0|R.g(4)},O.quick=function(){return R.g(4)/4294967296},O.double=O,b(w(R.S),t),(x.pass||C||function(N,D,I,_){return _&&(_.S&&v(_,R),N.state=function(){return v(R,{})}),I?(e[l]=N,D):N})(O,T,"global"in x?x.global:this==e,x.state)}function v(S,x){return x.i=S.i,x.j=S.j,x.S=S.S.slice(),x}function b(S,x){for(var C,A=S+"",T=0;T<A.length;)x[p&T]=p&(C^=19*x[p&T])+A.charCodeAt(T++);return w(x)}function w(S){return String.fromCharCode.apply(0,S)}if(e["seed"+l]=g,b(e.random(),t),r.exports){r.exports=g;try{n=require("crypto")}catch{}}})([],Math)});Vo.alea=Fj,Vo.xor128=Bj,Vo.xorwow=Uj,Vo.xorshift7=Pj,Vo.xor4096=Vj,Vo.tychei=jj;var Wj=Vo,XI=Wj.alea;function Hj(r,t){return md(r,t)}function md(r,t,e,n){if(e===void 0&&(e=new Map),n===void 0&&(n=new Set),r==null)return null;if(n.has(r))throw new Error("Circular references are not supported.");if(e.has(r))return e.get(r);var a=t(r);if(a.recurse&&a.value!==null)throw new Error("A deep map function may not return both a value and recurse=true.");if(a.recurse){if(ku(r)){var i=Array.isArray(r)?[]:{};for(var s in n.add(r),r){var l=md(r[s],t,e,n);i[s]=l}return n.delete(r),i}throw new Error("Can't recurse into non-iterable type: "+r)}return e.set(r,a.value),a.value}function qj(r,t){return t===void 0&&(t=KI),$I(r,t)}function $I(r,t,e){e===void 0&&(e=new Set);var n=r[0];if(e.has(n))throw new Error("Circular references are not supported.");var a=t(r);if(a.recurse&&a.value!==null)throw new Error("A deep zip function may not return both a value and recurse=true.");if(a.recurse){if(ku(n)){var i=Array.isArray(n)?[]:{};e.add(n);var s=function(c){var f=$I(r.map(function(d){return d[c]}),t,e);i[c]=f};for(var l in n)s(l);return e.delete(n),i}throw new Error("Can't recurse into non-iterable type: "+n)}return a.value}function KI(r){return r===null?null:ku(r[0])?{value:null,recurse:!0}:{value:r,recurse:!1}}function YI(r,t){return Ce(this,void 0,void 0,function(){var e,n,a,i,s,l;return Ae(this,function(c){switch(c.label){case 0:e=new Map,md(r,t,e),n=0,a=Array.from(e.keys()),c.label=1;case 1:return n<a.length?(i=a[n],(s=e.get(i))instanceof Promise?[4,s]:[3,3]):[3,4];case 2:l=c.sent(),e.set(i,l),c.label=3;case 3:return n++,[3,1];case 4:return[2,md(r,t,e)]}})})}function ku(r){return r!=null&&!ArrayBuffer.isView(r)&&(Array.isArray(r)||typeof r=="object"&&!(r instanceof Ct))}function Gj(r){return r==null||Xj(r)||Array.isArray(r)||typeof r=="object"&&r instanceof Ct||Be.isTypedArray(r)}function Xj(r){return r===null||typeof r!="object"&&typeof r!="function"}function $j(r){return Hj(r,Kj)}function Kj(r){return r instanceof Ct?{value:r.clone(),recurse:!1}:ku(r)?{value:null,recurse:!0}:{value:r,recurse:!1}}var ZI=function(){function r(t){if(this.capacity=t,this.begin=0,this.end=0,t==null)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(t<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(t),this.doubledCapacity=2*t}return r.prototype.wrap=function(t){for(;t<0;)t+=this.doubledCapacity;return t%this.doubledCapacity},r.prototype.get=function(t){if(t<0)throw new RangeError("Can't get item at a negative index.");return this.data[t%this.capacity]},r.prototype.set=function(t,e){if(t<0)throw new RangeError("Can't set item at a negative index.");this.data[t%this.capacity]=e},r.prototype.length=function(){var t=this.end-this.begin;return t<0&&(t=this.doubledCapacity+t),t},r.prototype.isFull=function(){return this.length()===this.capacity},r.prototype.isEmpty=function(){return this.length()===0},r.prototype.push=function(t){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,t),this.end=this.wrap(this.end+1)},r.prototype.pushAll=function(t){for(var e=0,n=t;e<n.length;e++){var a=n[e];this.push(a)}},r.prototype.pop=function(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);var t=this.get(this.end);return this.set(this.end,void 0),t},r.prototype.unshift=function(t){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,t)},r.prototype.shift=function(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");var t=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),t},r.prototype.shuffleExcise=function(t){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");var e=this.wrap(this.begin+t),n=this.get(e);return this.set(e,this.pop()),n},r}(),Yj=function(r){function t(){return r.call(this,t.INITIAL_CAPACITY)||this}return xt(t,r),t.prototype.isFull=function(){return!1},t.prototype.push=function(e){r.prototype.isFull.call(this)&&this.expand(),r.prototype.push.call(this,e)},t.prototype.unshift=function(e){r.prototype.isFull.call(this)&&this.expand(),r.prototype.unshift.call(this,e)},t.prototype.expand=function(){for(var e=2*this.capacity,n=new Array(e),a=this.length(),i=0;i<a;i++)n[i]=this.get(this.wrap(this.begin+i));this.data=n,this.capacity=e,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=a},t.INITIAL_CAPACITY=32,t}(ZI);function QI(r){return new Jj(r)}function U0(r){return new eW(r)}function Zj(r,t){return new JI(r,t)}function Qj(r,t){return t===void 0&&(t=$i.FAIL),new lW(r,t)}var $i,En=function(){function r(){}return r.prototype.toArray=function(){return Ce(this,void 0,void 0,function(){var t,e;return Ae(this,function(n){switch(n.label){case 0:return t=[],[4,this.next()];case 1:e=n.sent(),n.label=2;case 2:return e.done?[3,4]:(t.push(e.value),[4,this.next()]);case 3:return e=n.sent(),[3,2];case 4:return[2,t]}})})},r.prototype.toArrayForTest=function(){return Ce(this,void 0,void 0,function(){var t,e,n;return Ae(this,function(a){switch(a.label){case 0:return t=this.prefetch(100),e=[],[4,t.next()];case 1:n=a.sent(),a.label=2;case 2:return n.done?[3,4]:(e.push(n.value),[4,t.next()]);case 3:return n=a.sent(),[3,2];case 4:return[2,e]}})})},r.prototype.resolveFully=function(){return Ce(this,void 0,void 0,function(){var t;return Ae(this,function(e){switch(e.label){case 0:return[4,this.next()];case 1:t=e.sent(),e.label=2;case 2:return t.done?[3,4]:[4,this.next()];case 3:return t=e.sent(),[3,2];case 4:return[2]}})})},r.prototype.resolveWhile=function(t){return Ce(this,void 0,void 0,function(){var e,n;return Ae(this,function(a){switch(a.label){case 0:return[4,this.next()];case 1:e=a.sent(),n=t(e.value),a.label=2;case 2:return e.done||!n?[3,4]:[4,this.next()];case 3:return e=a.sent(),n=t(e.value),[3,2];case 4:return[2]}})})},r.prototype.handleErrors=function(t){return new sW(this,t)},r.prototype.filter=function(t){return new iW(this,t)},r.prototype.map=function(t){return new oW(this,t)},r.prototype.mapAsync=function(t){return new aE(this,t)},r.prototype.serialMapAsync=function(t){return new aE(this,t).serial()},r.prototype.flatmap=function(t){return new uW(this,t)},r.prototype.forEachAsync=function(t){return Ce(this,void 0,void 0,function(){return Ae(this,function(e){return[2,this.map(t).resolveFully()]})})},r.prototype.serialForEach=function(t){return Ce(this,void 0,void 0,function(){return Ae(this,function(e){return[2,this.serialMapAsync(t).resolveWhile(function(n){return n===!0})]})})},r.prototype.rowMajorBatch=function(t,e){return e===void 0&&(e=!0),new aW(this,t,e)},r.prototype.columnMajorBatch=function(t,e,n){return e===void 0&&(e=!0),n===void 0&&(n=KI),this.rowMajorBatch(t,e).map(function(a){return qj(a,n)})},r.prototype.concatenate=function(t,e){return new JI(QI([this,t]),e)},r.prototype.take=function(t){return t<0||t==null?this:new rW(this,t)},r.prototype.skip=function(t){return t<0||t==null?this:new nW(this,t)},r.prototype.prefetch=function(t){return new ek(this,t)},r.prototype.shuffle=function(t,e){return new cW(this,t,e)},r.prototype.serial=function(){return new tW(this)},r}(),Jj=function(r){function t(e){var n=r.call(this)||this;return n.items=e,n.trav=0,n}return xt(t,r),t.prototype.summary=function(){return"Array of "+this.items.length+" items"},t.prototype.next=function(){return Ce(this,void 0,void 0,function(){var e;return Ae(this,function(n){return this.trav>=this.items.length?[2,{value:null,done:!0}]:(e=this.items[this.trav],this.trav++,[2,{value:$j(e),done:!1}])})})},t}(En),eW=function(r){function t(e){var n=r.call(this)||this;return n.nextFn=e,n}return xt(t,r),t.prototype.summary=function(){return"Function call"},t.prototype.next=function(){return Ce(this,void 0,void 0,function(){return Ae(this,function(e){try{return[2,this.nextFn()]}catch(n){throw n.message="Error thrown while iterating through a dataset: "+n.message,n}return[2]})})},t}(En),tW=function(r){function t(e){var n=r.call(this)||this;return n.upstream=e,n.lastRead=Promise.resolve({value:null,done:!1}),n}return xt(t,r),t.prototype.summary=function(){return this.upstream.summary()+" -> Serial"},t.prototype.next=function(){return Ce(this,void 0,void 0,function(){var e=this;return Ae(this,function(n){return this.lastRead=this.lastRead.then(function(){return e.serialNext()}),[2,this.lastRead]})})},t.prototype.serialNext=function(){return Ce(this,void 0,void 0,function(){return Ae(this,function(e){return[2,this.upstream.next()]})})},t}(En),nW=function(r){function t(e,n){var a=r.call(this)||this;return a.upstream=e,a.maxCount=n,a.count=0,a.lastRead=Promise.resolve({value:null,done:!1}),a}return xt(t,r),t.prototype.summary=function(){return this.upstream.summary()+" -> Skip"},t.prototype.next=function(){return Ce(this,void 0,void 0,function(){var e=this;return Ae(this,function(n){return this.lastRead=this.lastRead.then(function(){return e.serialNext()}),[2,this.lastRead]})})},t.prototype.serialNext=function(){return Ce(this,void 0,void 0,function(){var e;return Ae(this,function(n){switch(n.label){case 0:return this.count++<this.maxCount?[4,this.upstream.next()]:[3,2];case 1:return(e=n.sent()).done?[2,e]:(et(e.value),[3,0]);case 2:return[2,this.upstream.next()]}})})},t}(En),rW=function(r){function t(e,n){var a=r.call(this)||this;return a.upstream=e,a.maxCount=n,a.count=0,a}return xt(t,r),t.prototype.summary=function(){return this.upstream.summary()+" -> Take"},t.prototype.next=function(){return Ce(this,void 0,void 0,function(){return Ae(this,function(e){return this.count++>=this.maxCount?[2,{value:null,done:!0}]:[2,this.upstream.next()]})})},t}(En),aW=function(r){function t(e,n,a){a===void 0&&(a=!0);var i=r.call(this)||this;return i.upstream=e,i.batchSize=n,i.enableSmallLastBatch=a,i.lastRead=Promise.resolve({value:null,done:!1}),i}return xt(t,r),t.prototype.summary=function(){return this.upstream.summary()+" -> RowMajorBatch"},t.prototype.next=function(){return Ce(this,void 0,void 0,function(){var e=this;return Ae(this,function(n){return this.lastRead=this.lastRead.then(function(){return e.serialNext()}),[2,this.lastRead]})})},t.prototype.serialNext=function(){return Ce(this,void 0,void 0,function(){var e,n;return Ae(this,function(a){switch(a.label){case 0:e=[],a.label=1;case 1:return e.length<this.batchSize?[4,this.upstream.next()]:[3,3];case 2:return(n=a.sent()).done?this.enableSmallLastBatch&&e.length>0?[2,{value:e,done:!1}]:[2,{value:null,done:!0}]:(e.push(n.value),[3,1]);case 3:return[2,{value:e,done:!1}]}})})},t}(En),iW=function(r){function t(e,n){var a=r.call(this)||this;return a.upstream=e,a.predicate=n,a.lastRead=Promise.resolve({value:null,done:!1}),a}return xt(t,r),t.prototype.summary=function(){return this.upstream.summary()+" -> Filter"},t.prototype.next=function(){return Ce(this,void 0,void 0,function(){var e=this;return Ae(this,function(n){return this.lastRead=this.lastRead.then(function(){return e.serialNext()}),[2,this.lastRead]})})},t.prototype.serialNext=function(){return Ce(this,void 0,void 0,function(){var e;return Ae(this,function(n){switch(n.label){case 0:return[4,this.upstream.next()];case 1:return(e=n.sent()).done||this.predicate(e.value)?[2,e]:(et(e.value),[3,0]);case 2:return[2]}})})},t}(En),oW=function(r){function t(e,n){var a=r.call(this)||this;return a.upstream=e,a.transform=n,a}return xt(t,r),t.prototype.summary=function(){return this.upstream.summary()+" -> Map"},t.prototype.next=function(){return Ce(this,void 0,void 0,function(){var e,n,a,i,s,l,c;return Ae(this,function(f){switch(f.label){case 0:return[4,this.upstream.next()];case 1:if((e=f.sent()).done)return[2,{value:null,done:!0}];for(n=Aa.getTensorsInContainer(e.value),a=this.transform(e.value),i=Aa.getTensorsInContainer(a),s=0,l=n;s<l.length;s++)c=l[s],Aa.isTensorInList(c,i)||c.dispose();return[2,{value:a,done:!1}]}})})},t}(En),sW=function(r){function t(e,n){var a=r.call(this)||this;return a.upstream=e,a.handler=n,a.count=0,a.lastRead=Promise.resolve({value:null,done:!1}),a}return xt(t,r),t.prototype.summary=function(){return this.upstream.summary()+" -> handleErrors"},t.prototype.next=function(){return Ce(this,void 0,void 0,function(){var e=this;return Ae(this,function(n){return this.lastRead=this.lastRead.then(function(){return e.serialNext()}),[2,this.lastRead]})})},t.prototype.serialNext=function(){return Ce(this,void 0,void 0,function(){var e;return Ae(this,function(n){switch(n.label){case 0:n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.upstream.next()];case 2:return[2,n.sent()];case 3:return e=n.sent(),this.handler(e)?[3,4]:[2,{value:null,done:!0}];case 4:return[3,0];case 5:return[2]}})})},t}(En),aE=function(r){function t(e,n){var a=r.call(this)||this;return a.upstream=e,a.transform=n,a}return xt(t,r),t.prototype.summary=function(){return this.upstream.summary()+" -> AsyncMap"},t.prototype.next=function(){return Ce(this,void 0,void 0,function(){var e,n,a,i,s,l,c;return Ae(this,function(f){switch(f.label){case 0:return[4,this.upstream.next()];case 1:return(e=f.sent()).done?[2,{value:null,done:!0}]:(n=Aa.getTensorsInContainer(e.value),[4,this.transform(e.value)]);case 2:for(a=f.sent(),i=Aa.getTensorsInContainer(a),s=0,l=n;s<l.length;s++)c=l[s],Aa.isTensorInList(c,i)||c.dispose();return[2,{value:a,done:!1}]}})})},t}(En),P0=function(r){function t(){var e=r.call(this)||this;return e.outputQueue=new Yj,e.lastRead=Promise.resolve({value:null,done:!1}),e}return xt(t,r),t.prototype.next=function(){return Ce(this,void 0,void 0,function(){var e=this;return Ae(this,function(n){return this.lastRead=this.lastRead.then(function(){return e.serialNext()}),[2,this.lastRead]})})},t.prototype.serialNext=function(){return Ce(this,void 0,void 0,function(){return Ae(this,function(e){switch(e.label){case 0:return this.outputQueue.length()!==0?[3,2]:[4,this.pump()];case 1:return e.sent()?[3,0]:[2,{value:null,done:!0}];case 2:return[2,{value:this.outputQueue.shift(),done:!1}]}})})},t}(En),uW=function(r){function t(e,n){var a=r.call(this)||this;return a.upstream=e,a.transform=n,a}return xt(t,r),t.prototype.summary=function(){return this.upstream.summary()+" -> Flatmap"},t.prototype.pump=function(){return Ce(this,void 0,void 0,function(){var e,n,a,i,s,l,c;return Ae(this,function(f){switch(f.label){case 0:return[4,this.upstream.next()];case 1:if((e=f.sent()).done)return[2,!1];for(n=Aa.getTensorsInContainer(e.value),a=this.transform(e.value),i=Aa.getTensorsInContainer(a),this.outputQueue.pushAll(a),s=0,l=n;s<l.length;s++)c=l[s],Aa.isTensorInList(c,i)||c.dispose();return[2,!0]}})})},t}(P0),JI=function(r){function t(e,n){var a=r.call(this)||this;return a.baseErrorHandler=n,a.lastRead=null,a.iterator=null,a.moreIterators=e,a}return xt(t,r),t.prototype.summary=function(){return"TODO: fill in upstream of chained summaries -> Chained"},t.prototype.next=function(){return Ce(this,void 0,void 0,function(){return Ae(this,function(e){return this.lastRead=this.readFromChain(this.lastRead),[2,this.lastRead]})})},t.prototype.readFromChain=function(e){return Ce(this,void 0,void 0,function(){var n,a;return Ae(this,function(i){switch(i.label){case 0:return[4,e];case 1:return i.sent(),this.iterator!=null?[3,3]:[4,this.moreIterators.next()];case 2:if((n=i.sent()).done)return[2,{value:null,done:!0}];this.iterator=n.value,this.baseErrorHandler!=null&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler)),i.label=3;case 3:return[4,this.iterator.next()];case 4:return(a=i.sent()).done?(this.iterator=null,[2,this.readFromChain(e)]):[2,a]}})})},t}(En);(function(r){r[r.FAIL=0]="FAIL",r[r.SHORTEST=1]="SHORTEST",r[r.LONGEST=2]="LONGEST"})($i||($i={}));var lW=function(r){function t(e,n){n===void 0&&(n=$i.FAIL);var a=r.call(this)||this;return a.iterators=e,a.mismatchMode=n,a.count=0,a.currentPromise=null,a}return xt(t,r),t.prototype.summary=function(){return"{TODO: fill in upstream of zip summaries} -> Zip"},t.prototype.nextState=function(e){return Ce(this,void 0,void 0,function(){function n(l){return l instanceof En?{value:l.next().then(function(c){return a++,c.done&&i++,c.value}),recurse:!1}:{value:null,recurse:!0}}var a,i,s;return Ae(this,function(l){switch(l.label){case 0:return[4,e];case 1:return l.sent(),a=0,i=0,[4,YI(this.iterators,n)];case 2:if(s=l.sent(),a===i)return[2,{value:null,done:!0}];if(i>0)switch(this.mismatchMode){case $i.FAIL:throw new Error("Zipped streams should have the same length. Mismatched at element "+this.count+".");case $i.SHORTEST:return[2,{value:null,done:!0}];case $i.LONGEST:}return this.count++,[2,{value:s,done:!1}]}})})},t.prototype.next=function(){return Ce(this,void 0,void 0,function(){return Ae(this,function(e){return this.currentPromise=this.nextState(this.currentPromise),[2,this.currentPromise]})})},t}(En),ek=function(r){function t(e,n){var a=r.call(this)||this;return a.upstream=e,a.bufferSize=n,a.buffer=new ZI(n),a}return xt(t,r),t.prototype.summary=function(){return this.upstream.summary()+" -> Prefetch"},t.prototype.refill=function(){for(;!this.buffer.isFull();){var e=this.upstream.next();this.buffer.push(e)}},t.prototype.next=function(){return this.refill(),this.buffer.shift()},t}(En),cW=function(r){function t(e,n,a){var i=r.call(this,e,n)||this;return i.upstream=e,i.windowSize=n,i.upstreamExhausted=!1,i.random=XI(a||Be.now().toString()),i.lastRead=Promise.resolve({value:null,done:!1}),i}return xt(t,r),t.prototype.next=function(){return Ce(this,void 0,void 0,function(){var e=this;return Ae(this,function(n){return this.lastRead=this.lastRead.then(function(){return e.serialNext()}),[2,this.lastRead]})})},t.prototype.randomInt=function(e){return Math.floor(this.random()*e)},t.prototype.chooseIndex=function(){return this.randomInt(this.buffer.length())},t.prototype.serialNext=function(){return Ce(this,void 0,void 0,function(){var e,n;return Ae(this,function(a){switch(a.label){case 0:this.upstreamExhausted||this.refill(),a.label=1;case 1:return this.buffer.isEmpty()?[3,3]:(e=this.chooseIndex(),[4,this.buffer.shuffleExcise(e)]);case 2:return(n=a.sent()).done?(this.upstreamExhausted=!0,[3,1]):(this.refill(),[2,n]);case 3:return[2,{value:null,done:!0}]}})})},t}(ek),Yc=function(){function r(){this.size=null}return r.prototype.batch=function(t,e){var n=this;e===void 0&&(e=!0);var a=this;return Be.assert(t>0,function(){return`batchSize needs to be positive, but it is
      `+t}),sr(function(){return Ce(n,void 0,void 0,function(){return Ae(this,function(i){switch(i.label){case 0:return[4,a.iterator()];case 1:return[2,i.sent().columnMajorBatch(t,e,dW)]}})})},this.size===1/0||this.size==null?this.size:e?Math.ceil(this.size/t):Math.floor(this.size/t))},r.prototype.concatenate=function(t){var e=this,n=this;return sr(function(){return Ce(e,void 0,void 0,function(){var a,i;return Ae(this,function(s){switch(s.label){case 0:return[4,n.iterator()];case 1:return i=(a=s.sent()).concatenate,[4,t.iterator()];case 2:return[2,i.apply(a,[s.sent()])]}})})},this.size===1/0||t.size===1/0?1/0:this.size!=null&&t.size!=null?this.size+t.size:null)},r.prototype.filter=function(t){var e=this,n=this;return sr(function(){return Ce(e,void 0,void 0,function(){return Ae(this,function(a){switch(a.label){case 0:return[4,n.iterator()];case 1:return[2,a.sent().filter(function(i){return ae(function(){return t(i)})})]}})})},this.size===1/0?1/0:null)},r.prototype.forEachAsync=function(t){return Ce(this,void 0,void 0,function(){return Ae(this,function(e){switch(e.label){case 0:return[4,this.iterator()];case 1:return[2,e.sent().forEachAsync(t)]}})})},r.prototype.forEach=function(t){return Ce(this,void 0,void 0,function(){return Ae(this,function(e){return xd("dataset.forEach() is deprecated and will be removed. Please use dataset.forEachAsync() instead"),[2,this.forEachAsync(t)]})})},r.prototype.map=function(t){var e=this,n=this;return sr(function(){return Ce(e,void 0,void 0,function(){return Ae(this,function(a){switch(a.label){case 0:return[4,n.iterator()];case 1:return[2,a.sent().map(function(i){return ae(function(){return t(i)})})]}})})},this.size)},r.prototype.mapAsync=function(t){var e=this,n=this;return sr(function(){return Ce(e,void 0,void 0,function(){return Ae(this,function(a){switch(a.label){case 0:return[4,n.iterator()];case 1:return[2,a.sent().mapAsync(t)]}})})},this.size)},r.prototype.prefetch=function(t){var e=this;if(t==null)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");var n=this;return sr(function(){return Ce(e,void 0,void 0,function(){return Ae(this,function(a){switch(a.label){case 0:return[4,n.iterator()];case 1:return[2,a.sent().prefetch(t)]}})})},this.size)},r.prototype.repeat=function(t){var e=this,n=this;return sr(function(){return Ce(e,void 0,void 0,function(){var a=this;return Ae(this,function(i){return[2,Zj(U0(function(){return Ce(a,void 0,void 0,function(){var s;return Ae(this,function(l){switch(l.label){case 0:return s={},[4,n.iterator()];case 1:return[2,(s.value=l.sent(),s.done=!1,s)]}})})}).take(t))]})})},this.size!=null&&t>0?this.size*t:t===0?0:this.size!=null&&(t===void 0||t<0)?1/0:null)},r.prototype.skip=function(t){var e=this,n=this;return sr(function(){return Ce(e,void 0,void 0,function(){return Ae(this,function(a){switch(a.label){case 0:return[4,n.iterator()];case 1:return[2,a.sent().skip(t)]}})})},this.size!=null&&t>=0&&this.size>=t?this.size-t:this.size!=null&&(this.size<t||t===void 0||t<0)?0:null)},r.prototype.shuffle=function(t,e,n){var a=this;if(n===void 0&&(n=!0),t==null||t<0)throw this.size==null?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError("`Dataset.shuffle()` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for `tf.Tensor`s), consider setting bufferSize to the dataset size ("+this.size+" elements)");var i=this,s=XI(e||Be.now().toString());return sr(function(){return Ce(a,void 0,void 0,function(){var l;return Ae(this,function(c){switch(c.label){case 0:return l=s.int32(),n&&(l+=s.int32()),[4,i.iterator()];case 1:return[2,c.sent().shuffle(t,l.toString())]}})})},this.size)},r.prototype.take=function(t){var e=this,n=this;return sr(function(){return Ce(e,void 0,void 0,function(){return Ae(this,function(a){switch(a.label){case 0:return[4,n.iterator()];case 1:return[2,a.sent().take(t)]}})})},this.size!=null&&this.size>t?t:this.size!=null&&this.size<=t?this.size:null)},r.prototype.toArray=function(){return Ce(this,void 0,void 0,function(){return Ae(this,function(t){switch(t.label){case 0:if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return[4,this.iterator()];case 1:return[2,t.sent().toArray()]}})})},r.prototype.toArrayForTest=function(){return Ce(this,void 0,void 0,function(){return Ae(this,function(t){switch(t.label){case 0:if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return[4,this.iterator()];case 1:return[2,t.sent().toArrayForTest()]}})})},r.MAX_BUFFER_SIZE=1e4,r}();function sr(r,t){return t===void 0&&(t=null),new(function(e){function n(){var a=e!==null&&e.apply(this,arguments)||this;return a.size=t,a}return xt(n,e),n.prototype.iterator=function(){return Ce(this,void 0,void 0,function(){return Ae(this,function(a){return[2,r()]})})},n}(Yc))}function fW(r){var t=this;return sr(function(){return Ce(t,void 0,void 0,function(){return Ae(this,function(e){return[2,QI(r)]})})},r.length)}function hW(r){var t,e=this;if(!ku(r))throw new Error("The argument to zip() must be an object or array.");if(Array.isArray(r))for(var n=0;n<r.length;n++)t=t==null?r[n].size:Math.min(t,r[n].size);else if(r instanceof Object)for(var a in r)t=t==null?r[a].size:Math.min(t,r[a].size);return sr(function(){return Ce(e,void 0,void 0,function(){return Ae(this,function(i){switch(i.label){case 0:return[4,YI(r,function(s){if(s instanceof Yc)return{value:s.iterator(),recurse:!1};if(ku(s))return{value:null,recurse:!0};throw new Error("Leaves of the structure passed to zip() must be Datasets, not primitives.")})];case 1:return[2,Qj(i.sent(),$i.SHORTEST)]}})})},t)}function dW(r){return r===null?null:Gj(r[0])?{value:pW(r),recurse:!1}:{value:null,recurse:!0}}function pW(r){if(r.length===0)throw new Error("Can't make a batch of zero elements.");return r[0]instanceof Ct?ia(r):rn(r)}var tk=function(r){function t(e){var n=r.call(this)||this;return n.input=e,n}return xt(t,r),t.prototype.iterator=function(){return Ce(this,void 0,void 0,function(){var e,n;return Ae(this,function(a){switch(a.label){case 0:return[4,this.input.iterator()];case 1:return e=a.sent(),n=e.decodeUTF8(),[2,n.split(`
`).map(function(i){return i.endsWith("\r")&&(i=i.slice(0,-1)),i})]}})})},t}(Yc),Th='"',Kl=Symbol("out"),iE=Symbol("field"),Nh=Symbol("quote"),mv=Symbol("quoteafterquote"),oE=Symbol("quoteinquote"),nk=function(r){function t(e,n){var a=r.call(this)||this;return a.input=e,a.hasHeader=!0,a.fullColumnNames=null,a.columnNamesValidated=!1,a.columnConfigs=null,a.configuredColumnsOnly=!1,a.delimiter=",",a.delimWhitespace=!1,a.base=new tk(e),n||(n={}),a.hasHeader=n.hasHeader!==!1,a.fullColumnNames=n.columnNames,a.columnConfigs=n.columnConfigs,a.configuredColumnsOnly=n.configuredColumnsOnly,n.delimWhitespace?(Be.assert(n.delimiter==null,function(){return"Delimiter should not be provided when delimWhitespace is true."}),a.delimWhitespace=!0,a.delimiter=" "):a.delimiter=n.delimiter?n.delimiter:",",a}return xt(t,r),t.prototype.columnNames=function(){return Ce(this,void 0,void 0,function(){return Ae(this,function(e){switch(e.label){case 0:return this.columnNamesValidated?[3,2]:[4,this.setColumnNames()];case 1:e.sent(),e.label=2;case 2:return[2,this.configuredColumnsOnly?Object.keys(this.columnConfigs):this.fullColumnNames]}})})},t.prototype.setColumnNames=function(){return Ce(this,void 0,void 0,function(){var e,n,a,i,s,l,c=this;return Ae(this,function(f){switch(f.label){case 0:return[4,this.maybeReadHeaderLine()];case 1:if(e=f.sent(),!this.fullColumnNames&&!e)throw new Error("Column names must be provided if there is no header line.");if(this.fullColumnNames&&e&&Be.assert(e.length===this.fullColumnNames.length,function(){return"The length of provided columnNames ("+c.fullColumnNames.length.toString()+") does not match the length of the header line read from file ("+e.length.toString()+")."}),this.fullColumnNames||(this.fullColumnNames=e),n=this.fullColumnNames.reduce(function(d,p){return d[p]=d[p]+1||1,d},{}),a=Object.keys(n).filter(function(d){return n[d]>1}),Be.assert(a.length===0,function(){return"Duplicate column names found: "+a.toString()}),this.columnConfigs){for(i=0,s=Object.keys(this.columnConfigs);i<s.length;i++)if(l=s[i],this.fullColumnNames.indexOf(l)===-1)throw new Error('The key "'+l+'" provided in columnConfigs does not match any of the column names ('+this.fullColumnNames.toString()+").")}return this.columnNamesValidated=!0,[2]}})})},t.prototype.maybeReadHeaderLine=function(){return Ce(this,void 0,void 0,function(){var e,n;return Ae(this,function(a){switch(a.label){case 0:return this.hasHeader?[4,this.base.iterator()]:[3,3];case 1:return[4,a.sent().next()];case 2:if((e=a.sent()).done)throw new Error("No data was found for CSV parsing.");return n=e.value,[2,this.parseRow(n,!1)];case 3:return[2,null]}})})},t.prototype.iterator=function(){return Ce(this,void 0,void 0,function(){var e,n=this;return Ae(this,function(a){switch(a.label){case 0:return this.columnNamesValidated?[3,2]:[4,this.setColumnNames()];case 1:a.sent(),a.label=2;case 2:return[4,this.base.iterator()];case 3:return e=a.sent(),this.hasHeader&&(e=e.skip(1)),[2,e.map(function(i){return n.makeDataElement(i)})]}})})},t.prototype.makeDataElement=function(e){for(var n=this.parseRow(e),a={},i={},s=0;s<this.fullColumnNames.length;s++){var l=this.fullColumnNames[s],c=this.columnConfigs?this.columnConfigs[l]:null;if(!this.configuredColumnsOnly||c){var f=n[s],d=null;if(f==="")if(c&&c.default!==void 0)d=c.default;else{if(c&&(c.required||c.isLabel))throw new Error("Required column "+l+" is empty in this line: "+e);d=void 0}else{var p=Number(f);if(isNaN(p))d=c&&c.dtype==="bool"?this.getBoolean(f):f;else if(c&&c.dtype)switch(c.dtype){case"float32":d=p;break;case"int32":d=Math.floor(p);break;case"bool":d=this.getBoolean(f);break;default:d=p}else d=p}c&&c.isLabel?i[l]=d:a[l]=d}}return Object.keys(i).length===0?a:{xs:a,ys:i}},t.prototype.getBoolean=function(e){return e==="1"||e.toLowerCase()==="true"?1:0},t.prototype.parseRow=function(e,n){n===void 0&&(n=!0);for(var a=[],i=0,s=e.length,l=Kl,c=0;c<s;c++)switch(l){case Kl:switch(e.charAt(c)){case Th:i=c+1,l=Nh;break;case this.delimiter:if(i=c+1,this.delimiter===" "&&this.delimWhitespace)break;a.push(""),l=Kl;break;default:l=iE,i=c}break;case iE:switch(e.charAt(c)){case this.delimiter:a.push(e.substring(i,c)),l=Kl,i=c+1}break;case Nh:switch(e.charAt(c)){case Th:l=mv}break;case mv:switch(e.charAt(c)){case this.delimiter:a.push(e.substring(i,c-1)),l=Kl,i=c+1;break;case Th:l=Nh;break;default:l=oE}break;case oE:switch(e.charAt(c)){case Th:l=Nh}}if(l===mv?a.push(e.substring(i,s-1)):a.push(e.substring(i)),n&&a.length!==this.fullColumnNames.length)throw new Error("Invalid row in csv file. Should have "+this.fullColumnNames.length+" elements in a row, but got "+a);return a},t}(Yc),mW=function(r){function t(e){var n=r.call(this)||this;n.microphoneConfig=e,n.isClosed=!1,n.fftSize=e.fftSize||1024;var a=Math.log2(n.fftSize);if(n.fftSize<0||a<4||a>14||!Number.isInteger(a))throw new Error("Invalid fftSize: it must be a power of 2 between 2 to 4 and 2 to 14, but got "+n.fftSize);if(n.numFrames=e.numFramesPerSpectrogram||43,n.sampleRateHz=e.sampleRateHz,n.columnTruncateLength=e.columnTruncateLength||n.fftSize,n.audioTrackConstraints=e.audioTrackConstraints,n.smoothingTimeConstant=e.smoothingTimeConstant||0,n.includeSpectrogram=e.includeSpectrogram!==!1,n.includeWaveform=e.includeWaveform===!0,!n.includeSpectrogram&&!n.includeWaveform)throw new Error("Both includeSpectrogram and includeWaveform are false. At least one type of data should be returned.");return n}return xt(t,r),t.prototype.summary=function(){return"microphone"},t.create=function(e){return e===void 0&&(e={}),Ce(this,void 0,void 0,function(){var n;return Ae(this,function(a){switch(a.label){case 0:if(se().get("IS_NODE"))throw new Error("microphone API is only supported in browser environment.");return[4,(n=new t(e)).start()];case 1:return a.sent(),[2,n]}})})},t.prototype.start=function(){return Ce(this,void 0,void 0,function(){var e,n,a,i;return Ae(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),e=this,[4,navigator.mediaDevices.getUserMedia({audio:this.audioTrackConstraints==null||this.audioTrackConstraints,video:!1})];case 1:return e.stream=s.sent(),[3,3];case 2:throw n=s.sent(),new Error("Error thrown while initializing video stream: "+n.message);case 3:if(!this.stream)throw new Error("Could not obtain audio from microphone.");if(a=window.AudioContext||window.webkitAudioContext,this.audioContext=new a,this.sampleRateHz){if(this.audioContext.sampleRate!==this.sampleRateHz)throw new Error("Mismatch in sampling rate: Expected: "+this.sampleRateHz+"; Actual: "+this.audioContext.sampleRate)}else this.sampleRateHz=this.audioContext.sampleRate;return i=this.audioContext.createMediaStreamSource(this.stream),this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=2*this.fftSize,this.analyser.smoothingTimeConstant=this.smoothingTimeConstant,i.connect(this.analyser),this.freqData=new Float32Array(this.fftSize),this.timeData=new Float32Array(this.fftSize),[2]}})})},t.prototype.next=function(){return Ce(this,void 0,void 0,function(){var e,n,a,i,s;return Ae(this,function(l){switch(l.label){case 0:return this.isClosed?[2,{value:null,done:!0}]:[4,this.getAudioData()];case 1:return a=l.sent(),this.includeSpectrogram&&(i=this.flattenQueue(a.freqDataQueue),e=this.getTensorFromAudioDataArray(i,[this.numFrames,this.columnTruncateLength,1])),this.includeWaveform&&(s=this.flattenQueue(a.timeDataQueue),n=this.getTensorFromAudioDataArray(s,[this.numFrames*this.fftSize,1])),[2,{value:{spectrogram:e,waveform:n},done:!1}]}})})},t.prototype.capture=function(){return Ce(this,void 0,void 0,function(){return Ae(this,function(e){switch(e.label){case 0:return[4,this.next()];case 1:return[2,e.sent().value]}})})},t.prototype.getAudioData=function(){return Ce(this,void 0,void 0,function(){var e,n,a,i=this;return Ae(this,function(s){return e=[],n=[],a=0,[2,new Promise(function(l){var c=setInterval(function(){i.includeSpectrogram&&(i.analyser.getFloatFrequencyData(i.freqData),i.freqData[0]===-1/0&&l({freqDataQueue:e,timeDataQueue:n}),e.push(i.freqData.slice(0,i.columnTruncateLength))),i.includeWaveform&&(i.analyser.getFloatTimeDomainData(i.timeData),n.push(i.timeData.slice())),++a===i.numFrames&&(clearInterval(c),l({freqDataQueue:e,timeDataQueue:n}))},i.fftSize/i.sampleRateHz*1e3)})]})})},t.prototype.stop=function(){this.isClosed||(this.isClosed=!0,this.analyser.disconnect(),this.audioContext.close(),this.stream!=null&&this.stream.getTracks().length>0&&this.stream.getTracks()[0].stop())},t.prototype.toArray=function(){throw new Error("Can not convert infinite audio stream to array.")},t.prototype.getSampleRate=function(){return this.sampleRateHz},t.prototype.flattenQueue=function(e){var n=e[0].length,a=new Float32Array(e.length*n);return e.forEach(function(i,s){return a.set(i,s*n)}),a},t.prototype.getTensorFromAudioDataArray=function(e,n){var a=new Float32Array(Be.sizeFromShape(n));return a.set(e,a.length-e.length),rn(a,n)},t}(En),gW=function(r){function t(e,n){var a=r.call(this)||this;if(a.webcamVideoElement=e,a.webcamConfig=n,a.isClosed=!0,a.resize=!1,a.needToResize())if(a.resize=!0,a.cropSize=[a.webcamConfig.resizeHeight,a.webcamConfig.resizeWidth],a.cropBoxInd=fr([0],"int32"),a.webcamConfig.centerCrop){var i=1*a.webcamConfig.resizeWidth/a.webcamVideoElement.width,s=1*a.webcamConfig.resizeHeight/a.webcamVideoElement.height,l=(1-i)/2,c=(1-s)/2,f=l+i,d=s+c;a.cropBox=ai([c,l,d,f],[1,4])}else a.cropBox=ai([0,0,1,1],[1,4]);return a}return xt(t,r),t.prototype.summary=function(){return"webcam"},t.create=function(e,n){return n===void 0&&(n={}),Ce(this,void 0,void 0,function(){var a;return Ae(this,function(i){switch(i.label){case 0:if(se().get("IS_NODE"))throw new Error("tf.data.webcam is only supported in browser environment.");if(!e){if(e=document.createElement("video"),!n.resizeWidth||!n.resizeHeight)throw new Error("Please provide webcam video element, or resizeWidth and resizeHeight to create a hidden video element.");e.width=n.resizeWidth,e.height=n.resizeHeight}return[4,(a=new t(e,n)).start()];case 1:return i.sent(),[2,a]}})})},t.prototype.start=function(){return Ce(this,void 0,void 0,function(){var e,n,a=this;return Ae(this,function(i){switch(i.label){case 0:this.webcamConfig.facingMode&&Be.assert(this.webcamConfig.facingMode==="user"||this.webcamConfig.facingMode==="environment",function(){return"Invalid webcam facing mode: "+a.webcamConfig.facingMode+". Please provide 'user' or 'environment'"}),i.label=1;case 1:return i.trys.push([1,3,,4]),e=this,[4,navigator.mediaDevices.getUserMedia({video:{deviceId:this.webcamConfig.deviceId,facingMode:this.webcamConfig.facingMode?this.webcamConfig.facingMode:"user",width:this.webcamVideoElement.width,height:this.webcamVideoElement.height}})];case 2:return e.stream=i.sent(),[3,4];case 3:throw(n=i.sent()).message="Error thrown while initializing video stream: "+n.message,n;case 4:if(!this.stream)throw new Error("Could not obtain video from webcam.");try{this.webcamVideoElement.srcObject=this.stream}catch(s){console.log(s),this.webcamVideoElement.src=window.URL.createObjectURL(this.stream)}return this.webcamVideoElement.play(),this.isClosed=!1,[2,new Promise(function(s){a.webcamVideoElement.onloadedmetadata=function(){s()}})]}})})},t.prototype.next=function(){return Ce(this,void 0,void 0,function(){var e;return Ae(this,function(n){if(this.isClosed)return[2,{value:null,done:!0}];try{e=IN.fromPixels(this.webcamVideoElement)}catch(a){throw new Error("Error thrown converting video to pixels: "+JSON.stringify(a))}if(!this.resize)return[2,{value:e,done:!1}];try{return[2,{value:this.cropAndResizeFrame(e),done:!1}]}catch(a){throw new Error("Error thrown cropping the video: "+a.message)}finally{e.dispose()}return[2]})})},t.prototype.needToResize=function(){return!(!this.webcamConfig.resizeWidth||!this.webcamConfig.resizeHeight||this.webcamVideoElement.width===this.webcamConfig.resizeWidth&&this.webcamVideoElement.height===this.webcamConfig.resizeHeight)},t.prototype.cropAndResizeFrame=function(e){var n=this;return ae(function(){var a,i=e.toFloat().expandDims(0),s=(a=$o.cropAndResize(i,n.cropBox,n.cropBoxInd,n.cropSize,"bilinear")).shape;return a.reshape(s.slice(1))})},t.prototype.capture=function(){return Ce(this,void 0,void 0,function(){return Ae(this,function(e){switch(e.label){case 0:return[4,this.next()];case 1:return[2,e.sent().value]}})})},t.prototype.stop=function(){this.stream.getTracks().forEach(function(e){return e.stop()});try{this.webcamVideoElement.srcObject=null}catch(e){console.log(e),this.webcamVideoElement.src=null}this.isClosed=!0},t.prototype.toArray=function(){throw new Error("Can not convert infinite video stream to array.")},t}(En),rk=function(){return function(){}}(),ak=function(r){function t(){return r!==null&&r.apply(this,arguments)||this}return xt(t,r),t.prototype.split=function(e){return new vW(this,e)},t}(En),vW=function(r){function t(e,n){var a=r.call(this)||this;return a.upstream=e,a.impl=new yW(e,n),a}return xt(t,r),t.prototype.summary=function(){return this.impl.summary()},t.prototype.next=function(){return Ce(this,void 0,void 0,function(){return Ae(this,function(e){return[2,this.impl.next()]})})},t}(ak),yW=function(r){function t(e,n){var a=r.call(this)||this;return a.upstream=e,a.separator=n,a.carryover="",a}return xt(t,r),t.prototype.summary=function(){return this.upstream.summary()+" -> Split('"+this.separator+"')"},t.prototype.pump=function(){return Ce(this,void 0,void 0,function(){var e,n,a,i,s;return Ae(this,function(l){switch(l.label){case 0:return[4,this.upstream.next()];case 1:if((e=l.sent()).done)return this.carryover===""?[2,!1]:(this.outputQueue.push(this.carryover),this.carryover="",[2,!0]);for((n=e.value.split(this.separator))[0]=this.carryover+n[0],a=0,i=n.slice(0,-1);a<i.length;a++)s=i[a],this.outputQueue.push(s);return this.carryover=n[n.length-1],[2,!0]}})})},t}(P0),bW=function(r){function t(){return r!==null&&r.apply(this,arguments)||this}return xt(t,r),t.prototype.decodeUTF8=function(){return new wW(this)},t}(En),wW=function(r){function t(e){var n=r.call(this)||this;return n.upstream=e,n.impl=new xW(e),n}return xt(t,r),t.prototype.summary=function(){return this.impl.summary()},t.prototype.next=function(){return Ce(this,void 0,void 0,function(){return Ae(this,function(e){return[2,this.impl.next()]})})},t}(ak),xW=function(r){function t(e){var n=r.call(this)||this;if(n.upstream=e,se().get("IS_BROWSER"))n.decoder=new TextDecoder("utf-8");else{var a=require("string_decoder").StringDecoder;n.decoder=new a("utf8")}return n}return xt(t,r),t.prototype.summary=function(){return this.upstream.summary()+" -> Utf8"},t.prototype.pump=function(){return Ce(this,void 0,void 0,function(){var e,n,a;return Ae(this,function(i){switch(i.label){case 0:return[4,this.upstream.next()];case 1:return(e=i.sent()).done?[2,!1]:(n=e.value,a=se().get("IS_BROWSER")?this.decoder.decode(n,{stream:!0}):this.decoder.write(Buffer.from(n.buffer)),this.outputQueue.push(a),[2,!0])}})})},t}(P0),ik=function(r){function t(e,n){n===void 0&&(n={});var a=r.call(this)||this;return a.file=e,a.options=n,Be.assert(e instanceof Uint8Array||!!se().get("IS_BROWSER")&&(e instanceof File||e instanceof Blob),function(){return"FileChunkIterator only supports File, Blob and Uint8Array right now."}),a.offset=n.offset||0,a.chunkSize=n.chunkSize||1048576,a}return xt(t,r),t.prototype.summary=function(){return"FileChunks "+this.file},t.prototype.next=function(){return Ce(this,void 0,void 0,function(){var e,n,a=this;return Ae(this,function(i){switch(i.label){case 0:return this.offset>=(this.file instanceof Uint8Array?this.file.byteLength:this.file.size)?[2,{value:null,done:!0}]:(e=new Promise(function(s,l){var c=a.offset+a.chunkSize;if(a.file instanceof Uint8Array)s(new Uint8Array(a.file.slice(a.offset,c)));else{var f=new FileReader;f.onload=function(p){var g=f.result;if(g instanceof ArrayBuffer&&(g=new Uint8Array(g)),!(g instanceof Uint8Array))return l(new TypeError("FileReader returned unknown type."));s(g)},f.onabort=function(p){return l(new Error("Aborted"))},f.onerror=function(p){return l(new Error(p.type))};var d=a.file.slice(a.offset,c);f.readAsArrayBuffer(d)}a.offset=c}),n={},[4,e]);case 1:return[2,(n.value=i.sent(),n.done=!1,n)]}})})},t}(bW);function SW(r,t){return t===void 0&&(t={}),Ce(this,void 0,void 0,function(){var e,n,a,i,s;return Ae(this,function(l){switch(l.label){case 0:return typeof r=="string"?e=r:(e=r.url,n=EW(r)),[4,Be.fetch(e,n)];case 1:return(a=l.sent()).ok?(s=Uint8Array.bind,[4,a.arrayBuffer()]):[3,3];case 2:return i=new(s.apply(Uint8Array,[void 0,l.sent()])),[2,new ik(i,t)];case 3:throw new Error(a.statusText)}})})}var EW=function(r){return{method:r.method,headers:r.headers,body:r.body,mode:r.mode,credentials:r.credentials,cache:r.cache,redirect:r.redirect,referrer:r.referrer,integrity:r.integrity}};function ok(r){return typeof r=="string"&&r.substr(0,7)==="file://"}var sk=function(r){function t(e,n){n===void 0&&(n={});var a=r.call(this)||this;return a.input=e,a.options=n,a}return xt(t,r),t.prototype.iterator=function(){return Ce(this,void 0,void 0,function(){var e;return Ae(this,function(n){return ok(this.input)&&se().get("IS_NODE")&&(e=require("fs"),this.input=e.readFileSync(this.input.substr(7))),[2,new ik(this.input,this.options)]})})},t}(rk),uk=function(r){function t(e,n){n===void 0&&(n={});var a=r.call(this)||this;return a.url=e,a.fileOptions=n,a}return xt(t,r),t.prototype.iterator=function(){return Ce(this,void 0,void 0,function(){return Ae(this,function(e){return ok(this.url)?[2,new sk(this.url,this.fileOptions).iterator()]:[2,SW(this.url,this.fileOptions)]})})},t}(rk);function CW(r,t){return t===void 0&&(t={}),new nk(new uk(r),t)}function AW(r){var t=this,e=U0(r);return sr(function(){return Ce(t,void 0,void 0,function(){return Ae(this,function(n){return[2,e]})})})}function TW(r){var t=this;return sr(function(){return Ce(t,void 0,void 0,function(){var e;return Ae(this,function(n){switch(n.label){case 0:return[4,r()];case 1:return e=n.sent(),[2,U0(function(){return e.next()})]}})})})}function NW(r,t){return Ce(this,void 0,void 0,function(){return Ae(this,function(e){return[2,gW.create(r,t)]})})}function RW(r){return Ce(this,void 0,void 0,function(){return Ae(this,function(t){return[2,mW.create(r)]})})}var lk="1.3.1";const IW=Object.freeze(Object.defineProperty({__proto__:null,CSVDataset:nk,Dataset:Yc,FileDataSource:sk,TextLineDataset:tk,URLDataSource:uk,array:fW,csv:CW,func:AW,generator:TW,microphone:RW,version_data:lk,webcam:NW,zip:hW},Symbol.toStringTag,{value:"Module"}));var kW="1.3.1",DW={"tfjs-core":_N,"tfjs-data":lk,"tfjs-layers":dp,"tfjs-converter":qI,tfjs:kW};const OW=Object.freeze(Object.defineProperty({__proto__:null,AdadeltaOptimizer:i0,AdagradOptimizer:o0,AdamOptimizer:s0,AdamaxOptimizer:u0,Callback:FI,CallbackList:sR,CustomCallback:lR,DataStorage:Qy,get ENV(){return Ry},EarlyStopping:BI,Environment:MC,GraphModel:HI,History:uR,InputSpec:In,KernelBackend:Jy,LayerVariable:rR,LayersModel:Zo,MomentumOptimizer:l0,Optimizer:vi,RMSPropOptimizer:c0,RNN:vs,get Rank(){return Iv},get Reduction(){return Bn},SGDOptimizer:sp,Sequential:N0,SymbolicTensor:ra,Tensor:Ct,TensorBuffer:yu,Variable:fc,abs:to,acos:lb,acosh:cb,add:ot,addN:_b,addStrict:zT,all:Zd,any:yc,argMax:bc,argMin:jb,asin:fb,asinh:hb,atan:db,atan2:Mb,atanh:pb,avgPool:Xd,avgPool3d:Kd,backend:SA,backend_util:o4,basicLSTMCell:dN,batchNorm:Rb,batchNorm2d:Ib,batchNorm3d:kb,batchNorm4d:Db,batchNormalization:_T,batchNormalization2d:kT,batchNormalization3d:DT,batchNormalization4d:OT,batchToSpaceND:Ad,booleanMaskAsync:KT,browser:IN,buffer:$e,callbacks:NV,cast:Td,ceil:mb,clipByValue:Jn,clone:RA,complex:Sn,concat:Gn,concat1d:Vy,concat2d:jy,concat3d:Wy,concat4d:Hy,constraints:PF,conv1d:jd,conv2d:ps,conv2dTranspose:Hd,conv3d:Wd,conv3dTranspose:tN,cos:gb,cosh:vb,cumsum:IA,customGrad:Lu,data:IW,deprecationWarn:xd,depthToSpace:Gy,depthwiseConv2d:Pu,deregisterOp:IV,diag:vN,disableDeprecationWarnings:_z,dispose:et,disposeVariables:Mz,div:Xn,divStrict:LT,dot:nN,dropout:Yb,elu:Vu,enableDebugMode:Oz,enableProdMode:Dz,engine:zz,env:se,equal:ds,equalStrict:WT,erf:yb,exp:bb,expandDims:Sr,expm1:wb,eye:Nd,fft:Pc,fill:zu,findBackend:jz,findBackendFactory:Wz,floor:_d,floorDiv:Pd,frame:op,fused:Au,gather:Uu,gatherND:Kb,getBackend:Pz,getKernel:zC,getKernelsForBackend:Av,grad:n4,grads:r4,greater:Bu,greaterEqual:Lc,greaterEqualStrict:HT,greaterStrict:qT,hammingWindow:Zb,hannWindow:ip,ifft:Cu,imag:Gr,image:$o,inTopKAsync:wN,initializers:wB,input:ER,io:Ar,irfft:rp,isFinite:AT,isInf:CT,isNaN:ET,keep:Na,layers:aV,leakyRelu:ep,less:Fb,lessEqual:Bb,lessEqualStrict:GT,lessStrict:XT,linalg:Jb,linspace:Py,loadGraphModel:Lj,loadLayersModel:TU,localResponseNormalization:Hb,log:ci,log1p:xb,logSigmoid:ST,logSoftmax:Dd,logSumExp:hN,logicalAnd:mi,logicalNot:Ob,logicalOr:Bd,logicalXor:MT,losses:xN,matMul:qd,math:TF,max:no,maxPool:Gd,maxPool3d:$d,maximum:_a,maximumStrict:FT,mean:an,memory:Bv,metrics:wV,min:Qd,minimum:Fu,minimumStrict:BT,mod:zb,modStrict:UT,model:CU,models:xV,moments:Uc,movingAverage:mN,mul:Xe,mulStrict:Vd,multiRNNCell:pN,multinomial:Xy,neg:hs,nextFrame:Uh,norm:qb,notEqual:Su,notEqualStrict:$T,oneHot:bu,ones:Oa,onesLike:Nr,op:K,outerProduct:rN,pad:so,pad1d:kA,pad2d:DA,pad3d:OA,pad4d:_A,pool:cN,pow:xu,powStrict:PT,prelu:tp,print:NA,prod:Jd,profile:Lz,rand:MA,randomGamma:zA,randomNormal:$y,randomUniform:cs,range:Ed,ready:Uz,real:lr,reciprocal:Sb,registerBackend:Hz,registerCallbackConstructor:NU,registerKernel:Tv,registerOp:RV,regularizers:AV,relu:lo,relu6:Wb,removeBackend:Vz,reshape:Ic,reverse:Ia,reverse1d:aN,reverse2d:iN,reverse3d:oN,reverse4d:sN,rfft:Vc,round:Eb,rsqrt:Md,scalar:Re,scatterND:$b,selu:np,separableConv2d:Vb,sequential:AU,serialization:be,setBackend:Bz,setPlatform:qz,setdiff1dAsync:Ky,sigmoid:zd,sign:Cb,signal:bN,sin:Ab,sinh:Tb,slice:Rr,slice1d:Fc,slice2d:Yd,slice3d:Bc,slice4d:Eu,slice_util:t4,softmax:fs,softplus:_c,spaceToBatchND:Rd,sparseToDense:ap,spectral:gN,split:ii,sqrt:Mc,square:ub,squaredDifference:Lb,squaredDifferenceStrict:VT,squeeze:kc,stack:ia,step:TT,stft:Qb,stridedSlice:Gb,sub:Dn,subStrict:jT,sum:hr,tan:Nb,tanh:Ld,tensor:rn,tensor1d:fr,tensor2d:ai,tensor3d:By,tensor4d:Hi,tensor5d:AA,tensor6d:TA,tensor_util:Aa,test_util:IF,tidy:ae,tile:Yi,time:Fz,topk:Xb,train:Uo,transpose:Ut,truncatedNormal:Dc,unregisterKernel:xz,unsortedSegmentSum:Ub,unstack:ts,util:Be,valueAndGrad:a4,valueAndGrads:i4,variable:Uy,variableGrads:WA,version:DW,version_converter:qI,version_core:_N,version_layers:dp,webgl:kF,where:fi,whereAsync:Ud,zeros:St,zerosLike:ct},Symbol.toStringTag,{value:"Module"})),Ec=my(OW);var Lo={},sE;function ck(){if(sE)return Lo;sE=1;/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(Lo,"__esModule",{value:!0}),Lo.cropTensor=Lo.capture=void 0;var r=Ec;function t(n,a){return r.tidy(function(){var i=r.browser.fromPixels(n),s=e(i,a),l=s.expandDims(0);return l.toFloat().div(r.scalar(127)).sub(r.scalar(1))})}Lo.capture=t;function e(n,a,i){var s=Math.min(n.shape[0],n.shape[1]),l=n.shape[0]/2,c=l-s/2,f=n.shape[1]/2,d=f-s/2;if(a&&!i){var p=n.slice([c,d,0],[s,s,3]);p=p.reshape([s*s,1,3]);var g=[.2989,.587,.114];return p=r.mul(p,g),p=p.reshape([s,s,3]),p=r.sum(p,-1),p=r.expandDims(p,-1),p}return n.slice([c,d,0],[s,s,3])}return Lo.cropTensor=e,Lo}var Jr={},uE;function fk(){if(uE)return Jr;uE=1;/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(Jr,"__esModule",{value:!0}),Jr.cropTo=Jr.resizeMinTo=Jr.resizeMaxTo=Jr.resize=void 0;var r=function(){return document.createElement("canvas")};function t(i,s,l){l===void 0&&(l=r()),l.width=i.width*s,l.height=i.height*s;var c=l.getContext("2d");return c.drawImage(i,0,0,l.width,l.height),l}Jr.resize=t;function e(i,s,l){l===void 0&&(l=r());var c=Math.max(i.width,i.height);return t(i,s/c,l)}Jr.resizeMaxTo=e;function n(i,s,l){l===void 0&&(l=r());var c=Math.min(i.width,i.height);return t(i,s/c,l)}Jr.resizeMinTo=n;function a(i,s,l,c){l===void 0&&(l=!1),c===void 0&&(c=r());var f=i.width,d=i.height;i instanceof HTMLVideoElement&&(f=i.videoWidth,d=i.videoHeight);var p=Math.min(f,d),g=s/p,v=Math.ceil(f*g),b=Math.ceil(d*g),w=v-s,S=b-s;c.width=c.height=s;var x=c.getContext("2d");return x.drawImage(i,~~(w/2)*-1,~~(S/2)*-1,v,b),l&&(x.scale(-1,1),x.drawImage(c,s*-1,0)),c}return Jr.cropTo=a,Jr}var Yl={},lE;function hk(){if(lE)return Yl;lE=1;/** @license See the LICENSE file. */Object.defineProperty(Yl,"__esModule",{value:!0}),Yl.version=void 0;var r="0.8.4-alpha2";return Yl.version=r,Yl}var cE;function dk(){return cE||(cE=1,function(r){/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var t=_o&&_o.__awaiter||function(N,D,I,_){function F(B){return B instanceof I?B:new I(function(V){V(B)})}return new(I||(I=Promise))(function(B,V){function X(G){try{j(_.next(G))}catch(q){V(q)}}function Y(G){try{j(_.throw(G))}catch(q){V(q)}}function j(G){G.done?B(G.value):F(G.value).then(X,Y)}j((_=_.apply(N,D||[])).next())})},e=_o&&_o.__generator||function(N,D){var I={label:0,sent:function(){if(B[0]&1)throw B[1];return B[1]},trys:[],ops:[]},_,F,B,V;return V={next:X(0),throw:X(1),return:X(2)},typeof Symbol=="function"&&(V[Symbol.iterator]=function(){return this}),V;function X(j){return function(G){return Y([j,G])}}function Y(j){if(_)throw new TypeError("Generator is already executing.");for(;I;)try{if(_=1,F&&(B=j[0]&2?F.return:j[0]?F.throw||((B=F.return)&&B.call(F),0):F.next)&&!(B=B.call(F,j[1])).done)return B;switch(F=0,B&&(j=[j[0]&2,B.value]),j[0]){case 0:case 1:B=j;break;case 4:return I.label++,{value:j[1],done:!1};case 5:I.label++,F=j[1],j=[0];continue;case 7:j=I.ops.pop(),I.trys.pop();continue;default:if(B=I.trys,!(B=B.length>0&&B[B.length-1])&&(j[0]===6||j[0]===2)){I=0;continue}if(j[0]===3&&(!B||j[1]>B[0]&&j[1]<B[3])){I.label=j[1];break}if(j[0]===6&&I.label<B[1]){I.label=B[1],B=j;break}if(B&&I.label<B[2]){I.label=B[2],I.ops.push(j);break}B[2]&&I.ops.pop(),I.trys.pop();continue}j=D.call(N,I)}catch(G){j=[6,G],F=0}finally{_=B=0}if(j[0]&5)throw j[1];return{value:j[0]?j[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.loadFromFiles=r.load=r.loadTruncatedMobileNet=r.CustomMobileNet=r.getTopKClasses=r.IMAGE_SIZE=void 0;var n=Ec,a=Ec,i=ck(),s=fk(),l=hk(),c=1,f="conv_pw_13_relu",d="out_relu",p=.25,g=.35;r.IMAGE_SIZE=224;var v=function(N){return N.packageVersion=N.packageVersion||l.version,N.packageName=N.packageName||"@teachablemachine/image",N.timeStamp=N.timeStamp||new Date().toISOString(),N.userMetadata=N.userMetadata||{},N.modelName=N.modelName||"untitled",N.labels=N.labels||[],N.imageSize=N.imageSize||r.IMAGE_SIZE,N},b=function(N){return!!N&&Array.isArray(N.labels)},w=function(N,D){if(N===1){if(D!==.25&&D!==.5&&D!==.75&&D!==1)return console.warn("Invalid alpha. Options are: 0.25, 0.50, 0.75 or 1.00."),console.log("Loading model with alpha: ",p.toFixed(2)),p}else if(D!==.35&&D!==.5&&D!==.75&&D!==1)return console.warn("Invalid alpha. Options are: 0.35, 0.50, 0.75 or 1.00."),console.log("Loading model with alpha: ",g.toFixed(2)),g;return D},S=function(N){if(N=N||{},N.checkpointUrl&&N.trainingLayer)return(N.alpha||N.version)&&console.warn("Checkpoint URL passed to modelOptions, alpha options are ignored"),[N.checkpointUrl,N.trainingLayer];if(N.version=N.version||c,N.version===1){N.alpha=N.alpha||p,N.alpha=w(N.version,N.alpha),console.log("Loading mobilenet "+N.version+" and alpha "+N.alpha);var D=N.alpha.toFixed(2);return D==="1.00"&&(D="1.0"),["https://storage.googleapis.com/tfjs-models/tfjs/mobilenet_v1_"+D+"_"+r.IMAGE_SIZE+"/model.json",f]}else{if(N.version===2)return N.alpha=N.alpha||g,N.alpha=w(N.version,N.alpha),console.log("Loading mobilenet "+N.version+" and alpha "+N.alpha),["https://storage.googleapis.com/teachable-machine-models/mobilenet_v2_weights_tf_dim_ordering_tf_kernels_"+N.alpha.toFixed(2)+"_"+r.IMAGE_SIZE+"_no_top/model.json",d];throw new Error("MobileNet V"+N.version+" doesn't exist")}},x=function(N){return t(void 0,void 0,void 0,function(){var D,I;return e(this,function(_){switch(_.label){case 0:return typeof N!="string"?[3,3]:[4,fetch(N)];case 1:return I=_.sent(),[4,I.json()];case 2:return D=_.sent(),[3,4];case 3:if(b(N))D=N;else throw new Error("Invalid Metadata provided");_.label=4;case 4:return[2,v(D)]}})})};function C(N,D,I){return I===void 0&&(I=3),t(this,void 0,void 0,function(){var _;return e(this,function(F){switch(F.label){case 0:return[4,D.data()];case 1:return _=F.sent(),[2,n.tidy(function(){I=Math.min(I,_.length);for(var B=[],V=0;V<_.length;V++)B.push({value:_[V],index:V});B.sort(function(G,q){return q.value-G.value});for(var X=new Float32Array(I),Y=new Int32Array(I),V=0;V<I;V++)X[V]=B[V].value,Y[V]=B[V].index;for(var j=[],V=0;V<Y.length;V++)j.push({className:N[Y[V]],probability:X[V]});return j})]}})})}r.getTopKClasses=C;var A=function(){function N(D,I){this.model=D,this._metadata=v(I)}return Object.defineProperty(N,"EXPECTED_IMAGE_SIZE",{get:function(){return r.IMAGE_SIZE},enumerable:!1,configurable:!0}),N.prototype.getMetadata=function(){return this._metadata},N.prototype.getTotalClasses=function(){var D=this.model.output,I=D.shape[1];return I},N.prototype.getClassLabels=function(){return this._metadata.labels},N.prototype.predictTopK=function(D,I,_){return I===void 0&&(I=10),_===void 0&&(_=!1),t(this,void 0,void 0,function(){var F,B,V,X=this;return e(this,function(Y){switch(Y.label){case 0:return F=s.cropTo(D,this._metadata.imageSize,_),B=n.tidy(function(){var j=i.capture(F,X._metadata.grayscale);return X.model.predict(j)}),[4,C(this._metadata.labels,B,I)];case 1:return V=Y.sent(),a.dispose(B),[2,V]}})})},N.prototype.predict=function(D,I){return I===void 0&&(I=!1),t(this,void 0,void 0,function(){var _,F,B,V,X,Y=this;return e(this,function(j){switch(j.label){case 0:return _=s.cropTo(D,this._metadata.imageSize,I),F=n.tidy(function(){var G=i.capture(_,Y._metadata.grayscale);return Y.model.predict(G)}),[4,F.data()];case 1:for(B=j.sent(),V=[],X=0;X<B.length;X++)V.push({className:this._metadata.labels[X],probability:B[X]});return a.dispose(F),[2,V]}})})},N.prototype.dispose=function(){this.truncatedModel.dispose()},N}();r.CustomMobileNet=A;function T(N){return t(this,void 0,void 0,function(){var D,I,_,F,B,V,X,B,V,X;return e(this,function(Y){switch(Y.label){case 0:return D=S(N),I=D[0],_=D[1],[4,n.loadLayersModel(I)];case 1:return F=Y.sent(),N&&N.version===1?(B=F.getLayer(_),V=n.model({inputs:F.inputs,outputs:B.output}),X=n.sequential(),X.add(V),X.add(n.layers.flatten()),[2,X]):(B=F.getLayer(_),V=n.model({inputs:F.inputs,outputs:B.output}),X=n.sequential(),X.add(V),X.add(n.layers.globalAveragePooling2d({})),[2,X])}})})}r.loadTruncatedMobileNet=T;function R(N,D){return t(this,void 0,void 0,function(){var I,_,F;return e(this,function(B){switch(B.label){case 0:return[4,n.loadLayersModel(N)];case 1:return I=B.sent(),D?[4,x(D)]:[3,3];case 2:return F=B.sent(),[3,4];case 3:F=null,B.label=4;case 4:return _=F,[2,new A(I,_)]}})})}r.load=R;function O(N,D,I){return t(this,void 0,void 0,function(){var _,F,B,V;return e(this,function(X){switch(X.label){case 0:return[4,n.loadLayersModel(n.io.browserFiles([N,D]))];case 1:return _=X.sent(),[4,new Response(I).json()];case 2:return F=X.sent(),I?[4,x(F)]:[3,4];case 3:return V=X.sent(),[3,5];case 4:V=null,X.label=5;case 5:return B=V,[2,new A(_,B)]}})})}r.loadFromFiles=O}(_o)),_o}var wr={},Vh={exports:{}},_W=Vh.exports,fE;function MW(){return fE||(fE=1,function(r){(function(t,e,n){function a(c){var f=this,d=l();f.next=function(){var p=2091639*f.s0+f.c*23283064365386963e-26;return f.s0=f.s1,f.s1=f.s2,f.s2=p-(f.c=p|0)},f.c=1,f.s0=d(" "),f.s1=d(" "),f.s2=d(" "),f.s0-=d(c),f.s0<0&&(f.s0+=1),f.s1-=d(c),f.s1<0&&(f.s1+=1),f.s2-=d(c),f.s2<0&&(f.s2+=1),d=null}function i(c,f){return f.c=c.c,f.s0=c.s0,f.s1=c.s1,f.s2=c.s2,f}function s(c,f){var d=new a(c),p=f&&f.state,g=d.next;return g.int32=function(){return d.next()*4294967296|0},g.double=function(){return g()+(g()*2097152|0)*11102230246251565e-32},g.quick=g,p&&(typeof p=="object"&&i(p,d),g.state=function(){return i(d,{})}),g}function l(){var c=4022871197,f=function(d){d=d.toString();for(var p=0;p<d.length;p++){c+=d.charCodeAt(p);var g=.02519603282416938*c;c=g>>>0,g-=c,g*=c,c=g>>>0,g-=c,c+=g*4294967296}return(c>>>0)*23283064365386963e-26};return f}e&&e.exports?e.exports=s:this.alea=s})(_W,r)}(Vh)),Vh.exports}var jh={exports:{}},zW=jh.exports,hE;function LW(){return hE||(hE=1,function(r){(function(t,e,n){function a(l){var c=this,f="";c.x=0,c.y=0,c.z=0,c.w=0,c.next=function(){var p=c.x^c.x<<11;return c.x=c.y,c.y=c.z,c.z=c.w,c.w^=c.w>>>19^p^p>>>8},l===(l|0)?c.x=l:f+=l;for(var d=0;d<f.length+64;d++)c.x^=f.charCodeAt(d)|0,c.next()}function i(l,c){return c.x=l.x,c.y=l.y,c.z=l.z,c.w=l.w,c}function s(l,c){var f=new a(l),d=c&&c.state,p=function(){return(f.next()>>>0)/4294967296};return p.double=function(){do var g=f.next()>>>11,v=(f.next()>>>0)/4294967296,b=(g+v)/(1<<21);while(b===0);return b},p.int32=f.next,p.quick=p,d&&(typeof d=="object"&&i(d,f),p.state=function(){return i(f,{})}),p}e&&e.exports?e.exports=s:this.xor128=s})(zW,r)}(jh)),jh.exports}var Wh={exports:{}},FW=Wh.exports,dE;function BW(){return dE||(dE=1,function(r){(function(t,e,n){function a(l){var c=this,f="";c.next=function(){var p=c.x^c.x>>>2;return c.x=c.y,c.y=c.z,c.z=c.w,c.w=c.v,(c.d=c.d+362437|0)+(c.v=c.v^c.v<<4^(p^p<<1))|0},c.x=0,c.y=0,c.z=0,c.w=0,c.v=0,l===(l|0)?c.x=l:f+=l;for(var d=0;d<f.length+64;d++)c.x^=f.charCodeAt(d)|0,d==f.length&&(c.d=c.x<<10^c.x>>>4),c.next()}function i(l,c){return c.x=l.x,c.y=l.y,c.z=l.z,c.w=l.w,c.v=l.v,c.d=l.d,c}function s(l,c){var f=new a(l),d=c&&c.state,p=function(){return(f.next()>>>0)/4294967296};return p.double=function(){do var g=f.next()>>>11,v=(f.next()>>>0)/4294967296,b=(g+v)/(1<<21);while(b===0);return b},p.int32=f.next,p.quick=p,d&&(typeof d=="object"&&i(d,f),p.state=function(){return i(f,{})}),p}e&&e.exports?e.exports=s:this.xorwow=s})(FW,r)}(Wh)),Wh.exports}var Hh={exports:{}},UW=Hh.exports,pE;function PW(){return pE||(pE=1,function(r){(function(t,e,n){function a(l){var c=this;c.next=function(){var d=c.x,p=c.i,g,v;return g=d[p],g^=g>>>7,v=g^g<<24,g=d[p+1&7],v^=g^g>>>10,g=d[p+3&7],v^=g^g>>>3,g=d[p+4&7],v^=g^g<<7,g=d[p+7&7],g=g^g<<13,v^=g^g<<9,d[p]=v,c.i=p+1&7,v};function f(d,p){var g,v=[];if(p===(p|0))v[0]=p;else for(p=""+p,g=0;g<p.length;++g)v[g&7]=v[g&7]<<15^p.charCodeAt(g)+v[g+1&7]<<13;for(;v.length<8;)v.push(0);for(g=0;g<8&&v[g]===0;++g);for(g==8?v[7]=-1:v[g],d.x=v,d.i=0,g=256;g>0;--g)d.next()}f(c,l)}function i(l,c){return c.x=l.x.slice(),c.i=l.i,c}function s(l,c){l==null&&(l=+new Date);var f=new a(l),d=c&&c.state,p=function(){return(f.next()>>>0)/4294967296};return p.double=function(){do var g=f.next()>>>11,v=(f.next()>>>0)/4294967296,b=(g+v)/(1<<21);while(b===0);return b},p.int32=f.next,p.quick=p,d&&(d.x&&i(d,f),p.state=function(){return i(f,{})}),p}e&&e.exports?e.exports=s:this.xorshift7=s})(UW,r)}(Hh)),Hh.exports}var qh={exports:{}},VW=qh.exports,mE;function jW(){return mE||(mE=1,function(r){(function(t,e,n){function a(l){var c=this;c.next=function(){var d=c.w,p=c.X,g=c.i,v,b;return c.w=d=d+1640531527|0,b=p[g+34&127],v=p[g=g+1&127],b^=b<<13,v^=v<<17,b^=b>>>15,v^=v>>>12,b=p[g]=b^v,c.i=g,b+(d^d>>>16)|0};function f(d,p){var g,v,b,w,S,x=[],C=128;for(p===(p|0)?(v=p,p=null):(p=p+"\0",v=0,C=Math.max(C,p.length)),b=0,w=-32;w<C;++w)p&&(v^=p.charCodeAt((w+32)%p.length)),w===0&&(S=v),v^=v<<10,v^=v>>>15,v^=v<<4,v^=v>>>13,w>=0&&(S=S+1640531527|0,g=x[w&127]^=v+S,b=g==0?b+1:0);for(b>=128&&(x[(p&&p.length||0)&127]=-1),b=127,w=4*128;w>0;--w)v=x[b+34&127],g=x[b=b+1&127],v^=v<<13,g^=g<<17,v^=v>>>15,g^=g>>>12,x[b]=v^g;d.w=S,d.X=x,d.i=b}f(c,l)}function i(l,c){return c.i=l.i,c.w=l.w,c.X=l.X.slice(),c}function s(l,c){l==null&&(l=+new Date);var f=new a(l),d=c&&c.state,p=function(){return(f.next()>>>0)/4294967296};return p.double=function(){do var g=f.next()>>>11,v=(f.next()>>>0)/4294967296,b=(g+v)/(1<<21);while(b===0);return b},p.int32=f.next,p.quick=p,d&&(d.X&&i(d,f),p.state=function(){return i(f,{})}),p}e&&e.exports?e.exports=s:this.xor4096=s})(VW,r)}(qh)),qh.exports}var Gh={exports:{}},WW=Gh.exports,gE;function HW(){return gE||(gE=1,function(r){(function(t,e,n){function a(l){var c=this,f="";c.next=function(){var p=c.b,g=c.c,v=c.d,b=c.a;return p=p<<25^p>>>7^g,g=g-v|0,v=v<<24^v>>>8^b,b=b-p|0,c.b=p=p<<20^p>>>12^g,c.c=g=g-v|0,c.d=v<<16^g>>>16^b,c.a=b-p|0},c.a=0,c.b=0,c.c=-1640531527,c.d=1367130551,l===Math.floor(l)?(c.a=l/4294967296|0,c.b=l|0):f+=l;for(var d=0;d<f.length+20;d++)c.b^=f.charCodeAt(d)|0,c.next()}function i(l,c){return c.a=l.a,c.b=l.b,c.c=l.c,c.d=l.d,c}function s(l,c){var f=new a(l),d=c&&c.state,p=function(){return(f.next()>>>0)/4294967296};return p.double=function(){do var g=f.next()>>>11,v=(f.next()>>>0)/4294967296,b=(g+v)/(1<<21);while(b===0);return b},p.int32=f.next,p.quick=p,d&&(typeof d=="object"&&i(d,f),p.state=function(){return i(f,{})}),p}e&&e.exports?e.exports=s:this.tychei=s})(WW,r)}(Gh)),Gh.exports}var gv={exports:{}};const qW={},GW=Object.freeze(Object.defineProperty({__proto__:null,default:qW},Symbol.toStringTag,{value:"Module"})),XW=my(GW);var vE;function $W(){return vE||(vE=1,function(r){(function(t,e){var n=(0,eval)("this"),a=256,i=6,s=52,l="random",c=e.pow(a,i),f=e.pow(2,s),d=f*2,p=a-1,g;function v(T,R,O){var N=[];R=R==!0?{entropy:!0}:R||{};var D=x(S(R.entropy?[T,A(t)]:T??C(),3),N),I=new b(N),_=function(){for(var F=I.g(i),B=c,V=0;F<f;)F=(F+V)*a,B*=a,V=I.g(1);for(;F>=d;)F/=2,B/=2,V>>>=1;return(F+V)/B};return _.int32=function(){return I.g(4)|0},_.quick=function(){return I.g(4)/4294967296},_.double=_,x(A(I.S),t),(R.pass||O||function(F,B,V,X){return X&&(X.S&&w(X,I),F.state=function(){return w(I,{})}),V?(e[l]=F,B):F})(_,D,"global"in R?R.global:this==e,R.state)}e["seed"+l]=v;function b(T){var R,O=T.length,N=this,D=0,I=N.i=N.j=0,_=N.S=[];for(O||(T=[O++]);D<a;)_[D]=D++;for(D=0;D<a;D++)_[D]=_[I=p&I+T[D%O]+(R=_[D])],_[I]=R;(N.g=function(F){for(var B,V=0,X=N.i,Y=N.j,j=N.S;F--;)B=j[X=p&X+1],V=V*a+j[p&(j[X]=j[Y=p&Y+B])+(j[Y]=B)];return N.i=X,N.j=Y,V})(a)}function w(T,R){return R.i=T.i,R.j=T.j,R.S=T.S.slice(),R}function S(T,R){var O=[],N=typeof T,D;if(R&&N=="object")for(D in T)try{O.push(S(T[D],R-1))}catch{}return O.length?O:N=="string"?T:T+"\0"}function x(T,R){for(var O=T+"",N,D=0;D<O.length;)R[p&D]=p&(N^=R[p&D]*19)+O.charCodeAt(D++);return A(R)}function C(){try{var T;return g&&(T=g.randomBytes)?T=T(a):(T=new Uint8Array(a),(n.crypto||n.msCrypto).getRandomValues(T)),A(T)}catch{var R=n.navigator,O=R&&R.plugins;return[+new Date,n,O,n.screen,A(t)]}}function A(T){return String.fromCharCode.apply(0,T)}if(x(e.random(),t),r.exports){r.exports=v;try{g=XW}catch{}}})([],Math)}(gv)),gv.exports}var vv,yE;function KW(){if(yE)return vv;yE=1;var r=MW(),t=LW(),e=BW(),n=PW(),a=jW(),i=HW(),s=$W();return s.alea=r,s.xor128=t,s.xorwow=e,s.xorshift7=n,s.xor4096=a,s.tychei=i,vv=s,vv}var bE;function YW(){if(bE)return wr;bE=1;/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var r=wr&&wr.__extends||function(){var b=function(w,S){return b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,C){x.__proto__=C}||function(x,C){for(var A in C)C.hasOwnProperty(A)&&(x[A]=C[A])},b(w,S)};return function(w,S){b(w,S);function x(){this.constructor=w}w.prototype=S===null?Object.create(S):(x.prototype=S.prototype,new x)}}(),t=wr&&wr.__awaiter||function(b,w,S,x){function C(A){return A instanceof S?A:new S(function(T){T(A)})}return new(S||(S=Promise))(function(A,T){function R(D){try{N(x.next(D))}catch(I){T(I)}}function O(D){try{N(x.throw(D))}catch(I){T(I)}}function N(D){D.done?A(D.value):C(D.value).then(R,O)}N((x=x.apply(b,w||[])).next())})},e=wr&&wr.__generator||function(b,w){var S={label:0,sent:function(){if(A[0]&1)throw A[1];return A[1]},trys:[],ops:[]},x,C,A,T;return T={next:R(0),throw:R(1),return:R(2)},typeof Symbol=="function"&&(T[Symbol.iterator]=function(){return this}),T;function R(N){return function(D){return O([N,D])}}function O(N){if(x)throw new TypeError("Generator is already executing.");for(;S;)try{if(x=1,C&&(A=N[0]&2?C.return:N[0]?C.throw||((A=C.return)&&A.call(C),0):C.next)&&!(A=A.call(C,N[1])).done)return A;switch(C=0,A&&(N=[N[0]&2,A.value]),N[0]){case 0:case 1:A=N;break;case 4:return S.label++,{value:N[1],done:!1};case 5:S.label++,C=N[1],N=[0];continue;case 7:N=S.ops.pop(),S.trys.pop();continue;default:if(A=S.trys,!(A=A.length>0&&A[A.length-1])&&(N[0]===6||N[0]===2)){S=0;continue}if(N[0]===3&&(!A||N[1]>A[0]&&N[1]<A[3])){S.label=N[1];break}if(N[0]===6&&S.label<A[1]){S.label=A[1],A=N;break}if(A&&S.label<A[2]){S.label=A[2],S.ops.push(N);break}A[2]&&S.ops.pop(),S.trys.pop();continue}N=w.call(b,S)}catch(D){N=[6,D],C=0}finally{x=A=0}if(N[0]&5)throw N[1];return{value:N[0]?N[1]:void 0,done:!0}}};Object.defineProperty(wr,"__esModule",{value:!0}),wr.createTeachable=wr.TeachableMobileNet=void 0;var n=Ec,a=Ec,i=ck(),s=dk(),l=KW(),c=.15,f=function(b){return typeof b.dataId=="object"&&typeof b.shape=="object"};function d(b,w){var S=new Array(w).fill(0);return S[b]=1,S}function p(b,w){for(var S,x=b.length,C=b.slice(),A=x-1;A>0;A-=1){var T=void 0;w?T=Math.floor(w()*(A+1)):T=Math.floor(Math.random()*(A+1)),S=[C[T],C[A]],C[A]=S[0],C[T]=S[1]}return C}var g=function(b){r(w,b);function w(S,x){var C=b.call(this,n.sequential(),x)||this;return C.totalSamples=0,C.examples=[],C.truncatedModel=S,C}return Object.defineProperty(w.prototype,"asSequentialModel",{get:function(){return this.model},enumerable:!1,configurable:!0}),Object.defineProperty(w.prototype,"isTrained",{get:function(){return!!this.model&&this.model.layers&&this.model.layers.length>2},enumerable:!1,configurable:!0}),Object.defineProperty(w.prototype,"isPrepared",{get:function(){return!!this.trainDataset},enumerable:!1,configurable:!0}),Object.defineProperty(w.prototype,"numClasses",{get:function(){return this._metadata.labels.length},enumerable:!1,configurable:!0}),w.prototype.addExample=function(S,x){return t(this,void 0,void 0,function(){var C,A,T;return e(this,function(R){return C=f(x)?x:i.capture(x,this._metadata.grayscale),A=this.truncatedModel.predict(C),T=A.dataSync(),C.dispose(),A.dispose(),this.examples[S].push(T),this.totalSamples++,[2]})})},w.prototype.predict=function(S,x){return x===void 0&&(x=!1),t(this,void 0,void 0,function(){return e(this,function(C){if(!this.model)throw new Error("Model has not been trained yet, called train() first");return[2,b.prototype.predict.call(this,S,x)]})})},w.prototype.predictTopK=function(S,x,C){return x===void 0&&(x=10),C===void 0&&(C=!1),t(this,void 0,void 0,function(){return e(this,function(A){if(!this.model)throw new Error("Model has not been trained yet, called train() first");return[2,b.prototype.predictTopK.call(this,S,x,C)]})})},w.prototype.prepare=function(){for(var S in this.examples)if(S.length===0)throw new Error("Add some examples before training");var x=this.convertToTfDataset();this.trainDataset=x.trainDataset,this.validationDataset=x.validationDataset},w.prototype.convertToTfDataset=function(){for(var S=0;S<this.examples.length;S++)this.examples[S]=p(this.examples[S],this.seed);for(var x=[],C=[],A=function(I){var _=d(I,T.numClasses),F=T.examples[I].length,B=Math.ceil(c*F),V=F-B,X=T.examples[I].slice(0,V).map(function(j){return{data:j,label:_}}),Y=T.examples[I].slice(V).map(function(j){return{data:j,label:_}});x=x.concat(X),C=C.concat(Y)},T=this,S=0;S<this.examples.length;S++)A(S);x=p(x,this.seed),C=p(C,this.seed);var R=n.data.array(x.map(function(I){return I.data})),O=n.data.array(C.map(function(I){return I.data})),N=n.data.array(x.map(function(I){return I.label})),D=n.data.array(C.map(function(I){return I.label}));return{trainDataset:n.data.zip({xs:R,ys:N}),validationDataset:n.data.zip({xs:O,ys:D})}},w.prototype.save=function(S,x){return t(this,void 0,void 0,function(){return e(this,function(C){return[2,this.model.save(S,x)]})})},w.prototype.train=function(S,x){return x===void 0&&(x={}),t(this,void 0,void 0,function(){var C,A,T,R,O,N,D,I,_,F=this;return e(this,function(B){switch(B.label){case 0:if(C=x.onTrainEnd||function(){},x.onTrainEnd=function(V){F.__stopTrainingResolve&&(F.__stopTrainingResolve(),F.__stopTrainingResolve=null),C(V)},this.isPrepared||this.prepare(),A=this.getLabels().length,a.util.assert(A===this.numClasses,function(){return"Can not train, has "+A+" labels and "+F.numClasses+" classes"}),T=this.truncatedModel.outputs[0].shape.slice(1),R=n.util.sizeFromShape(T),this.seed?O=n.initializers.varianceScaling({seed:3.14}):O=n.initializers.varianceScaling({}),this.trainingModel=n.sequential({layers:[n.layers.dense({inputShape:[R],units:S.denseUnits,activation:"relu",kernelInitializer:O,useBias:!0}),n.layers.dense({kernelInitializer:O,useBias:!1,activation:"softmax",units:this.numClasses})]}),N=n.train.adam(S.learningRate),this.trainingModel.compile({optimizer:N,loss:"categoricalCrossentropy",metrics:["accuracy"]}),!(S.batchSize>0))throw new Error("Batch size is 0 or NaN. Please choose a non-zero fraction");return D=this.trainDataset.batch(S.batchSize),I=this.validationDataset.batch(S.batchSize),[4,this.trainingModel.fitDataset(D,{epochs:S.epochs,validationData:I,callbacks:x})];case 1:return B.sent(),_=n.sequential(),_.add(this.truncatedModel),_.add(this.trainingModel),this.model=_,N.dispose(),[2,this.model]}})})},w.prototype.prepareDataset=function(){for(var S=0;S<this.numClasses;S++)this.examples[S]=[]},w.prototype.setLabel=function(S,x){this._metadata.labels[S]=x},w.prototype.setLabels=function(S){this._metadata.labels=S,this.prepareDataset()},w.prototype.getLabel=function(S){return this._metadata.labels[S]},w.prototype.getLabels=function(){return this._metadata.labels},w.prototype.setName=function(S){this._metadata.modelName=S},w.prototype.getName=function(){return this._metadata.modelName},w.prototype.stopTraining=function(){var S=this,x=new Promise(function(C,A){S.trainingModel.stopTraining=!0,S.__stopTrainingResolve=C});return x},w.prototype.dispose=function(){this.trainingModel.dispose(),b.prototype.dispose.call(this)},w.prototype.calculateAccuracyPerClass=function(){return t(this,void 0,void 0,function(){var S,x,C,A,T,R,O,N,D,I,G,_,F,B,V,X,Y,j,G,q=this;return e(this,function(ne){switch(ne.label){case 0:return S=this.validationDataset.mapAsync(function(L){return t(q,void 0,void 0,function(){return e(this,function(Z){return[2,L.xs]})})}),x=this.validationDataset.mapAsync(function(L){return t(q,void 0,void 0,function(){return e(this,function(Z){return[2,L.ys]})})}),C=Math.min(x.size,32),A=Math.ceil(x.size/C),T=S.batch(C),R=x.batch(C),[4,T.iterator()];case 1:return O=ne.sent(),[4,R.iterator()];case 2:N=ne.sent(),D=[],I=[],G=0,ne.label=3;case 3:return G<A?[4,O.next()]:[3,7];case 4:return _=ne.sent(),F=this.trainingModel.predict(_.value),B=F.argMax(1),D.push(B),[4,N.next()];case 5:V=ne.sent(),X=V.value.argMax(1),I.push(X),_.value.dispose(),F.dispose(),V.value.dispose(),ne.label=6;case 6:return G++,[3,3];case 7:if(Y=n.concat(I),j=n.concat(D),A!==1)for(G=0;G<D.length;G++)D[G].dispose(),I[G].dispose();return[2,{reference:Y,predictions:j}]}})})},w.prototype.setSeed=function(S){this.seed=l(S)},w}(s.CustomMobileNet);wr.TeachableMobileNet=g;function v(b,w){return t(this,void 0,void 0,function(){var S;return e(this,function(x){switch(x.label){case 0:return[4,s.loadTruncatedMobileNet(w)];case 1:return S=x.sent(),[2,new g(S,b)]}})})}return wr.createTeachable=v,wr}var ea={};function Xh(r){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Xh=function(e){return typeof e}:Xh=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xh(r)}function V0(r,t,e){var n=e.value;if(typeof n!="function")throw new TypeError("@boundMethod decorator can only be applied to methods not: ".concat(Xh(n)));var a=!1;return{configurable:!0,get:function(){if(a||this===r.prototype||this.hasOwnProperty(t)||typeof n!="function")return n;var s=n.bind(this);return a=!0,Object.defineProperty(this,t,{configurable:!0,get:function(){return s},set:function(c){n=c,delete this[t]}}),a=!1,s},set:function(s){n=s}}}function pk(r){var t;return typeof Reflect<"u"&&typeof Reflect.ownKeys=="function"?t=Reflect.ownKeys(r.prototype):(t=Object.getOwnPropertyNames(r.prototype),typeof Object.getOwnPropertySymbols=="function"&&(t=t.concat(Object.getOwnPropertySymbols(r.prototype)))),t.forEach(function(e){if(e!=="constructor"){var n=Object.getOwnPropertyDescriptor(r.prototype,e);typeof n.value=="function"&&Object.defineProperty(r.prototype,e,V0(r,e,n))}}),r}function ZW(){return arguments.length===1?pk.apply(void 0,arguments):V0.apply(void 0,arguments)}const QW=Object.freeze(Object.defineProperty({__proto__:null,boundClass:pk,boundMethod:V0,default:ZW},Symbol.toStringTag,{value:"Module"})),JW=my(QW);var wE;function eH(){if(wE)return ea;wE=1;/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var r=ea&&ea.__decorate||function(c,f,d,p){var g=arguments.length,v=g<3?f:p===null?p=Object.getOwnPropertyDescriptor(f,d):p,b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")v=Reflect.decorate(c,f,d,p);else for(var w=c.length-1;w>=0;w--)(b=c[w])&&(v=(g<3?b(v):g>3?b(f,d,v):b(f,d))||v);return g>3&&v&&Object.defineProperty(f,d,v),v},t=ea&&ea.__awaiter||function(c,f,d,p){function g(v){return v instanceof d?v:new d(function(b){b(v)})}return new(d||(d=Promise))(function(v,b){function w(C){try{x(p.next(C))}catch(A){b(A)}}function S(C){try{x(p.throw(C))}catch(A){b(A)}}function x(C){C.done?v(C.value):g(C.value).then(w,S)}x((p=p.apply(c,f||[])).next())})},e=ea&&ea.__generator||function(c,f){var d={label:0,sent:function(){if(v[0]&1)throw v[1];return v[1]},trys:[],ops:[]},p,g,v,b;return b={next:w(0),throw:w(1),return:w(2)},typeof Symbol=="function"&&(b[Symbol.iterator]=function(){return this}),b;function w(x){return function(C){return S([x,C])}}function S(x){if(p)throw new TypeError("Generator is already executing.");for(;d;)try{if(p=1,g&&(v=x[0]&2?g.return:x[0]?g.throw||((v=g.return)&&v.call(g),0):g.next)&&!(v=v.call(g,x[1])).done)return v;switch(g=0,v&&(x=[x[0]&2,v.value]),x[0]){case 0:case 1:v=x;break;case 4:return d.label++,{value:x[1],done:!1};case 5:d.label++,g=x[1],x=[0];continue;case 7:x=d.ops.pop(),d.trys.pop();continue;default:if(v=d.trys,!(v=v.length>0&&v[v.length-1])&&(x[0]===6||x[0]===2)){d=0;continue}if(x[0]===3&&(!v||x[1]>v[0]&&x[1]<v[3])){d.label=x[1];break}if(x[0]===6&&d.label<v[1]){d.label=v[1],v=x;break}if(v&&d.label<v[2]){d.label=v[2],d.ops.push(x);break}v[2]&&d.ops.pop(),d.trys.pop();continue}x=f.call(c,d)}catch(C){x=[6,C],g=0}finally{p=v=0}if(x[0]&5)throw x[1];return{value:x[0]?x[1]:void 0,done:!0}}};Object.defineProperty(ea,"__esModule",{value:!0}),ea.Webcam=void 0;var n=JW,a=fk(),i={facingMode:"user",frameRate:24},s=function(c){return c.facingMode=c.facingMode||i.facingMode,c.frameRate=c.frameRate||i.frameRate,c.aspectRatio=c.aspectRatio||i.aspectRatio,c},l=function(){function c(f,d,p){f===void 0&&(f=400),d===void 0&&(d=400),p===void 0&&(p=!1),this.width=f,this.height=d,this.flip=p}return c.prototype.getWebcam=function(f){if(f===void 0&&(f={}),!window.navigator.mediaDevices||!window.navigator.mediaDevices.getUserMedia)return Promise.reject("Your browser does not support WebRTC. Please try another one.");f.width=640;var d=s(f),p=document.createElement("video");return window.navigator.mediaDevices.getUserMedia({video:d}).then(function(g){return p.srcObject=g,p.addEventListener("loadedmetadata",function(v){var b=p.videoWidth,w=p.videoHeight;p.width=b,p.height=w}),p},function(){return Promise.reject("Could not open your camera. You may have denied access.")})},c.prototype.setup=function(f){return f===void 0&&(f={}),t(this,void 0,void 0,function(){var d;return e(this,function(p){switch(p.label){case 0:return this.webcam?[3,2]:(d=this,[4,this.getWebcam(f)]);case 1:d.webcam=p.sent(),this.canvas||(this.canvas=document.createElement("canvas"),this.canvas.width=this.width,this.canvas.height=this.height),p.label=2;case 2:return[2]}})})},c.prototype.play=function(){var f=this.webcam.play();return f},c.prototype.pause=function(){this.webcam.pause()},c.prototype.stop=function(){this.stopStreamedVideo(this.webcam)},c.prototype.update=function(){this.renderCameraToCanvas()},c.prototype.stopStreamedVideo=function(f){var d=f.srcObject,p=d.getTracks();p.forEach(function(g){g.stop()}),f.srcObject=null},c.prototype.renderCameraToCanvas=function(){if(this.canvas&&this.webcam){var f=this.canvas.getContext("2d");if(this.webcam.videoWidth!==0){var d=a.cropTo(this.webcam,this.width,this.flip);f.drawImage(d,0,0)}}},r([n.default],c.prototype,"getWebcam",null),r([n.default],c.prototype,"setup",null),r([n.default],c.prototype,"play",null),r([n.default],c.prototype,"pause",null),r([n.default],c.prototype,"stop",null),r([n.default],c.prototype,"update",null),r([n.default],c.prototype,"stopStreamedVideo",null),r([n.default],c.prototype,"renderCameraToCanvas",null),c}();return ea.Webcam=l,ea}var xE;function tH(){return xE||(xE=1,function(r){/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(r,"__esModule",{value:!0});var t=dk();Object.defineProperty(r,"IMAGE_SIZE",{enumerable:!0,get:function(){return t.IMAGE_SIZE}}),Object.defineProperty(r,"CustomMobileNet",{enumerable:!0,get:function(){return t.CustomMobileNet}}),Object.defineProperty(r,"load",{enumerable:!0,get:function(){return t.load}}),Object.defineProperty(r,"loadFromFiles",{enumerable:!0,get:function(){return t.loadFromFiles}}),Object.defineProperty(r,"loadTruncatedMobileNet",{enumerable:!0,get:function(){return t.loadTruncatedMobileNet}});var e=YW();Object.defineProperty(r,"TeachableMobileNet",{enumerable:!0,get:function(){return e.TeachableMobileNet}}),Object.defineProperty(r,"createTeachable",{enumerable:!0,get:function(){return e.createTeachable}});var n=eH();Object.defineProperty(r,"Webcam",{enumerable:!0,get:function(){return n.Webcam}});var a=hk();Object.defineProperty(r,"version",{enumerable:!0,get:function(){return a.version}})}(jg)),jg}var nH=tH();const rH=async()=>{const r="https://teachablemachine.withgoogle.com/models/RfJZMLgp4/",t=r+"model.json",e=r+"metadata.json";return await nH.load(t,e)},mk=W.createContext(void 0),gk=(r=100)=>{const[t,e]=W.useState(),n=W.useContext(mk);return W.useEffect(()=>{if(console.log("HERE",n),!n||!n.model||!n.videoRef.current){console.log("Model not yet initialized");return}const{model:a,videoRef:i}=n;let s=!0;const l=async()=>{if(!s)return;const c=await a.predict(i.current);e(c),setTimeout(l,r)};return l(),()=>{s=!1}},[n,n==null?void 0:n.model,r]),t},vk=(r=100,t=2e3)=>{const e=gk(r),[n,a]=W.useState([]);if(W.useEffect(()=>{e&&a(l=>[...l,...e].slice(-t))},[e]),n.length===0)return;const i=n.reduce((l,{className:c,probability:f})=>(l[c]||(l[c]={count:0,totalProbability:0}),l[c].count+=1,l[c].totalProbability+=f,l),{}),s=Object.entries(i).reduce((l,[c,{count:f,totalProbability:d}])=>{const p=d/f;return!l||p>l.averageProbability?{className:c,averageProbability:p}:l},void 0);return s==null?void 0:s.className},aH=(r=100)=>{const t=vk(r);if(!t)return;console.log(t);const e=CE.find(n=>n.fileName.replace(".png","")===t);return console.log(e==null?void 0:e.title),e},iH=({children:r,videoRef:t})=>{const[e,n]=W.useState();return W.useEffect(()=>{rH().then(a=>n(a))},[]),ve.jsx(mk.Provider,{value:{model:e,videoRef:t},children:r})},yk=()=>{const r=gk(),t=vk();return r?ve.jsxs("div",{children:[ve.jsx("h3",{children:t}),r.filter(e=>e.probability>.1).sort((e,n)=>n.probability-e.probability).map((e,n)=>ve.jsxs("div",{children:[e.className,": ",(e.probability*100).toFixed(1),"%"]},n))]}):ve.jsx("div",{children:"No predictions yet"})},oH=({videoRef:r})=>ve.jsxs(ve.Fragment,{children:[ve.jsx(OC,{videoRef:r}),ve.jsx(yk,{})]}),sH=({videoRef:r})=>{const t=aH();return console.log(t==null?void 0:t.title),ve.jsxs("div",{className:"bg-gray-900",children:[ve.jsx(pC,{}),ve.jsx(dC,{dream:t,open:!0,children:ve.jsxs("div",{className:" bg-gray-100",children:[ve.jsx(OC,{videoRef:r}),ve.jsx(yk,{})]})})]})},uH=()=>{const r=W.useRef(null);return ve.jsx(iH,{videoRef:r,children:ve.jsxs(j3,{children:[ve.jsx(Zl,{path:"/",element:ve.jsx(PO,{})}),ve.jsx(Zl,{path:"/gallery",element:ve.jsx(ZM,{})}),ve.jsx(Zl,{path:"/debug",element:ve.jsx(oH,{videoRef:r})}),ve.jsx(Zl,{path:"/ar",element:ve.jsx(sH,{videoRef:r})})]})})};UO.createRoot(document.getElementById("root")).render(ve.jsx(fz,{children:ve.jsx(W.StrictMode,{children:ve.jsx(uH,{})})}));
